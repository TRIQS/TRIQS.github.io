
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>triqs_tprf::lindhard_chi00_wk &#8212; TPRF - Two-Particle Response Function tool box for TRIQS  documentation</title>
    <link rel="stylesheet" href="../../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="triqs_tprf::solve_rpa_PH" href="solve_rpa_PH.html" />
    <link rel="prev" title="triqs_tprf::fourier_tr_to_wr" href="fourier_tr_to_wr.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head><body>
<div class="pageheader">
  <ul>
    
    <li><a href="../../install.html">Install</a></li>
    
    <li><a href="../../documentation.html">Documentation</a></li>
    
    <li><a href="../../issues.html">Issues</a></li>
    
    <li><a href="../../about.html">About tprf</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../../index.html">triqs_tprf</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">An example application using cpp2py and <a class="triqs" style="font-size: 12px" href="https://triqs.github.io">TRIQS</a></span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="solve_rpa_PH.html" title="triqs_tprf::solve_rpa_PH"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fourier_tr_to_wr.html" title="triqs_tprf::fourier_tr_to_wr"
             accesskey="P">previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../reference/cpp_reference.html" accesskey="U">Lattice Green’s functions</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="fourier_tr_to_wr.html"
                        title="previous chapter">triqs_tprf::fourier_tr_to_wr</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="solve_rpa_PH.html"
                        title="next chapter">triqs_tprf::solve_rpa_PH</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/cpp2rst_generated/triqs_tprf/lindhard_chi00_wk.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="triqs-tprf-lindhard-chi00-wk">
<span id="id1"></span><h1>triqs_tprf::lindhard_chi00_wk<a class="headerlink" href="#triqs-tprf-lindhard-chi00-wk" title="Permalink to this headline">¶</a></h1>
<p><em>#include &lt;triqs_tprf.hpp&gt;</em></p>
<p><strong>Synopsis</strong></p>
<blockquote>
<div><div class="cppsynopsis line-block">
<div class="line">chi_wk_t <span class="red">lindhard_chi00_wk</span> (e_k_cvt <span class="param">e_k</span>, int <span class="param">nw</span>, double <span class="param">beta</span>, double <span class="param">mu</span>)</div>
</div>
</div></blockquote>
<p>Generalized Lindhard susceptibility in the particle-hole channel <span class="math notranslate nohighlight">\(\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q})\)</span>.</p>
<blockquote>
<div><p>Analytic calculation of the generalized (non-interacting) Lindhard susceptibility
in the particle-hole channel. The analytic expression is obtained using residue calculus
to explicitly evaluate the matsubara sum of the fourier transformed imaginary time
bubble product of two non-interacting single-particle Green’s functions.</p>
<div class="math notranslate nohighlight">
\[G^{(0)}_{a\bar{b}}(\mathbf{k}, i\omega_n) =
\left[ i\omega_n \cdot \mathbf{1} - \epsilon(\mathbf{k}) \right]^{-1} .\]</div>
<p>The analytic evaluation of the bubble diagram gives</p>
<div class="math notranslate nohighlight">
\[\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q}) \equiv
\mathcal{F} \left\{\]</div>
<ul class="simple">
<li>G^{(0)}_{dbar{a}}(tau, mathbf{r}) G^{(0)}_{bbar{c}}(-tau, -mathbf{r})</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>right}</dt>
<dd>=</dd>
</dl>
<ul>
<li><dl class="first docutils">
<dt>frac{1}{N_k} sum_{nu} sum_{mathbf{k}}</dt>
<dd><p class="first last">G^{(0)}_{dbar{a}}(nu, mathbf{k})</p>
</dd>
</dl>
<p>G^{(0)}_{bbar{c}}(nu + omega, mathbf{k} + mathbf{q})</p>
</li>
</ul>
<p>\ =
- frac{1}{N_k} sum_{nu} sum_{mathbf{k}}</p>
<blockquote>
<div><dl class="docutils">
<dt>left( sum_{i}</dt>
<dd>U^dagger_{di}(mathbf{k}) frac{1}{inu - epsilon_{mathbf{k}, i}} U_{ibar{a}}(mathbf{k})</dd>
</dl>
<p>right)
left( sum_j
U^dagger_{bj}(mathbf{k} + mathbf{q})
frac{1}{inu + iomega - epsilon_{mathbf{k} + mathbf{q}, j}}
U_{jbar{c}}(mathbf{k} + mathbf{q})
right)</p>
</div></blockquote>
<p>\ =
frac{1}{N_k} sum_{mathbf{k}} sum_{ij}</p>
<blockquote>
<div><dl class="docutils">
<dt>left(</dt>
<dd><p class="first">[1 - delta_{0, omega_n} delta_{epsilon_{mathbf{k},i},epsilon_{mathbf{k}+mathbf{q}, j}})]
frac{ f(epsilon_{mathbf{k}, i}) - f(epsilon_{mathbf{k}+mathbf{q}, j}) }</p>
<blockquote>
<div>{iomega_n + epsilon_{mathbf{k} + mathbf{q}, j} - epsilon_{mathbf{k}, i}}</div></blockquote>
<ul class="simple">
<li>delta_{0, omega_n} delta_{epsilon_{mathbf{k},i},epsilon_{mathbf{k}+mathbf{q}, j}}</li>
</ul>
<p class="last">frac{beta}{4 cosh^2 (beta epsilon_{mathbf{k}, i} / 2) }</p>
</dd>
</dl>
<p>right)
\ times
U_{ibar{a}}(mathbf{k}) U^dagger_{di}(mathbf{k})
U_{jbar{c}}(mathbf{k} + mathbf{q}) U^dagger_{bj}(mathbf{k} + mathbf{q})</p>
<p>where the <span class="math notranslate nohighlight">\(U(\mathbf{k})\)</span> matrices are the diagonalizing unitary transform of the matrix valued
dispersion relation <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, i.e.</p>
<div class="math notranslate nohighlight">
\[\sum_{\bar{a}b} U_{i\bar{a}}(\mathbf{k}) \epsilon_{\bar{a}b}(\mathbf{k}) U^\dagger_{bj} (\mathbf{k})
= \delta_{ij} \epsilon_{\mathbf{k}, i}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The analytic formula is sub-optimal in terms of performance for higher temperatures. The evaluation
scales as <span class="math notranslate nohighlight">\(\mathcal{O}(N_k^2)\)</span> which is worse than computing the bubble explicitly in imaginary
time, with scaling <span class="math notranslate nohighlight">\(\mathcal{O}(N_k N_\tau \log(N_k N_\tau)\)</span> for <span class="math notranslate nohighlight">\(N_k \gg N_\tau\)</span>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Care must be taken when evaluating the fermionic Matsubara frequency sum of the
product of two simple poles. By extending the sum to an integral over the complex
plane the standard expression for the Lindhard response is obtained when the
poles are non-degenerate. The degenerate case produces an additional frequency independent
contribution (the last term on the last row).</p>
</div>
</div></blockquote>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="solve_rpa_PH.html" title="triqs_tprf::solve_rpa_PH"
             >next</a> |</li>
        <li class="right" >
          <a href="fourier_tr_to_wr.html" title="triqs_tprf::fourier_tr_to_wr"
             >previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../reference/cpp_reference.html" >Lattice Green’s functions</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, H. U.R. Strand.
    </div>
  </body>
</html>