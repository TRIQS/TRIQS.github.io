
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>lindhard_chi00_wk &#8212; TPRF - Two-Particle Response Function tool box for TRIQS  documentation</title>
    <link rel="stylesheet" href="../../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=default"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="solve_rpa_PH" href="solve_rpa_PH.html" />
    <link rel="prev" title="fourier_wr_to_tr" href="fourier_wr_to_tr.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head>
  <body>
<div class="pageheader">
  <ul>
    
    <li><a href="../../install.html">Install</a></li>
    
    <li><a href="../../documentation.html">Documentation</a></li>
    
    <li><a href="../../issues.html">Issues</a></li>
    
    <li><a href="../../about.html">About tprf</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../../index.html">tprf</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">two-particle response function tools based on the <a class="triqs" style="font-size: 12px" href="http://ipht.cea.fr/triqs">TRIQS</a> library</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="solve_rpa_PH.html" title="solve_rpa_PH"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fourier_wr_to_tr.html" title="fourier_wr_to_tr"
             accesskey="P">previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../reference/cpp_reference.html" accesskey="U">Lattice Green’s functions</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">lindhard_chi00_wk</a><ul>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fourier_wr_to_tr.html"
                        title="previous chapter">fourier_wr_to_tr</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="solve_rpa_PH.html"
                        title="next chapter">solve_rpa_PH</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/cpp2rst_generated/triqs_tprf/lindhard_chi00_wk.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lindhard-chi00-wk">
<span id="id1"></span><h1>lindhard_chi00_wk<a class="headerlink" href="#lindhard-chi00-wk" title="Permalink to this headline">¶</a></h1>
<p><strong>Synopsis</strong>:</p>
<div class="highlight-c"><div class="highlight"><pre><span></span> <span class="n">triqs_tprf</span><span class="o">::</span><span class="n">chi_wk_t</span> <span class="n">lindhard_chi00_wk</span> <span class="p">(</span><span class="n">triqs_tprf</span><span class="o">::</span><span class="n">e_k_cvt</span> <span class="n">e_k</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nw</span><span class="p">,</span> <span class="kt">double</span> <span class="n">beta</span><span class="p">,</span>
<span class="kt">double</span> <span class="n">mu</span><span class="p">)</span>
</pre></div>
</div>
<p>Generalized Lindhard susceptibility in the particle-hole channel <span class="math">\(\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q})\)</span>.</p>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Analytic calculation of the generalized (non-interacting) Lindhard susceptibility
in the particle-hole channel. The analytic expression is obtained using residue calculus
to explicitly evaluate the matsubara sum of the fourier transformed imaginary time
bubble product of two non-interacting single-particle Green’s functions.</p>
<div class="math" id="equation-cpp2rst-generated-triqs-tprf-lindhard-chi00-wk-0">
<span class="eqno">(1)<a class="headerlink" href="#equation-cpp2rst-generated-triqs-tprf-lindhard-chi00-wk-0" title="Permalink to this equation">¶</a></span>\[G^{(0)}_{a\bar{b}}(\mathbf{k}, i\omega_n) =
\left[ i\omega_n \cdot \mathbf{1} - \epsilon(\mathbf{k}) \right]^{-1} .\]</div>
<p>The analytic evaluation of the bubble diagram gives</p>
<div class="math" id="equation-cpp2rst-generated-triqs-tprf-lindhard-chi00-wk-1">
<span class="eqno">(2)<a class="headerlink" href="#equation-cpp2rst-generated-triqs-tprf-lindhard-chi00-wk-1" title="Permalink to this equation">¶</a></span>\[\begin{split}\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q}) \equiv
\mathcal{F} \left\{
  - G^{(0)}_{d\bar{a}}(\tau, \mathbf{r}) G^{(0)}_{b\bar{c}}(-\tau, -\mathbf{r})
\right\}
=
- \frac{1}{N_k} \sum_{\nu} \sum_{\mathbf{k}}
  G^{(0)}_{d\bar{a}}(\nu, \mathbf{k})
  G^{(0)}_{b\bar{c}}(\nu + \omega, \mathbf{k} + \mathbf{q})
\\ =
- \frac{1}{N_k} \sum_{\nu} \sum_{\mathbf{k}}
  \left( \sum_{i}
  U^\dagger_{di}(\mathbf{k}) \frac{1}{i\nu - \epsilon_{\mathbf{k}, i}} U_{i\bar{a}}(\mathbf{k})
  \right)
  \left( \sum_j
  U^\dagger_{bj}(\mathbf{k} + \mathbf{q})
  \frac{1}{i\nu + i\omega - \epsilon_{\mathbf{k} + \mathbf{q}, j}}
  U_{j\bar{c}}(\mathbf{k} + \mathbf{q})
  \right)
\\ =
\frac{1}{N_k} \sum_{\mathbf{k}} \sum_{ij}
  \left(
    [1-\delta(\epsilon_{\mathbf{k},i} - \epsilon_{\mathbf{k}+\mathbf{q}, j})]
    \frac{ f(\epsilon_{\mathbf{k}, i}) - f(\epsilon_{\mathbf{k}+\mathbf{q}, j}) }
         {i\omega_n + \epsilon_{\mathbf{k} + \mathbf{q}, j} - \epsilon_{\mathbf{k}, i}}
    +
    \delta(\epsilon_{\mathbf{k},i} - \epsilon_{\mathbf{k}+\mathbf{q}, j})
    \frac{\beta}{4 \cosh^2 (\beta \epsilon_{\mathbf{k}, i} / 2) }
  \right)
  \\ \times
  U_{i\bar{a}}(\mathbf{k}) U^\dagger_{di}(\mathbf{k})
  U_{j\bar{c}}(\mathbf{k} + \mathbf{q}) U^\dagger_{bj}(\mathbf{k} + \mathbf{q})\end{split}\]</div>
<p>where the <span class="math">\(U(\mathbf{k})\)</span> matrices are the diagonalizing unitary transform of the matrix valued
dispersion relation <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, i.e.</p>
<div class="math" id="equation-cpp2rst-generated-triqs-tprf-lindhard-chi00-wk-2">
<span class="eqno">(3)<a class="headerlink" href="#equation-cpp2rst-generated-triqs-tprf-lindhard-chi00-wk-2" title="Permalink to this equation">¶</a></span>\[\sum_{\bar{a}b} U_{i\bar{a}}(\mathbf{k}) \epsilon_{\bar{a}b}(\mathbf{k}) U^\dagger_{bj} (\mathbf{k})
= \delta_{ij} \epsilon_{\mathbf{k}, i}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The analytic formula is sub-optimal in terms of performance for higher temperatures. The evaluation
scales as <span class="math">\(\mathcal{O}(N_k^2)\)</span> which is worse than computing the bubble explicitly in imaginary
time, with scaling <span class="math">\(\mathcal{O}(N_k N_\tau \log(N_k N_\tau)\)</span> for <span class="math">\(N_k \gg N_\tau\)</span>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Care must be taken when evaluating the fermionic Matsubara frequency sum of the
product of two simple poles. By extending the sum to an integral over the complex
plane the standard expression for the Lindhard response is obtained when the
poles are non-degenerate. The degenerate case produces an additional frequency independent
contribution (the last term on the last row).</p>
</div>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="solve_rpa_PH.html" title="solve_rpa_PH"
             >next</a> |</li>
        <li class="right" >
          <a href="fourier_wr_to_tr.html" title="fourier_wr_to_tr"
             >previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../reference/cpp_reference.html" >Lattice Green’s functions</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, H. U.R. Strand.
    </div>
  </body>
</html>