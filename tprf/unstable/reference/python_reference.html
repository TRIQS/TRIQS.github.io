<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lattice Green’s functions &mdash; triqs_tprf  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f7f783a0" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../_static/triqs_favicon.ico"/>
  
        <script src="../_static/jquery.js?v=8dae8fb0"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lattice Green’s functions" href="cpp_reference.html" />
    <link rel="prev" title="Solving the linearized Eliashberg equation in the random phase approximation limit" href="../user_guide/Solving%20the%20linearized%20Eliashberg%20equation%20in%20the%20random%20phase%20approximation%20limit.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            triqs_tprf
          </a>
              <div class="version">
                3.3.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install TPRF</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#packaged-versions-of-tprf">Packaged Versions of TPRF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#ubuntu-debian-packages">Ubuntu Debian packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#anaconda">Anaconda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#docker">Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-tprf-from-source">Compiling TPRF from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/Square%20lattice%20susceptibility.html">Square lattice susceptibility and the Random Phase Approximation (RPA)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Square%20lattice%20susceptibility.html#Tight-binding-Hamiltonian">Tight binding Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Square%20lattice%20susceptibility.html#Dispersion-\epsilon(\mathbf{k})-and-Fermi-surface">Dispersion <span class="math notranslate nohighlight">\(\epsilon(\mathbf{k})\)</span> and Fermi surface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Square%20lattice%20susceptibility.html#Bare-generalized-susceptibility-\chi_0">Bare generalized susceptibility <span class="math notranslate nohighlight">\(\chi_0\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Square%20lattice%20susceptibility.html#Physical-response-function-\chi_{S_z,-S_z}">Physical response function <span class="math notranslate nohighlight">\(\chi_{S_z, S_z}\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Square%20lattice%20susceptibility.html#Random-phase-approximation-(RPA)">Random phase approximation (RPA)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/Bethe-Salpeter%20Equation%20on%20the%20Hubbard%20atom.html">Bethe-Salpeter Equation (BSE) on the Hubbard atom</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Bethe-Salpeter%20Equation%20on%20the%20Hubbard%20atom.html#Single-particle-Green’s-function-G_{\sigma-\sigma'}(i\omega_n)">Single-particle Green’s function <span class="math notranslate nohighlight">\(G_{\sigma \sigma'}(i\omega_n)\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Bethe-Salpeter%20Equation%20on%20the%20Hubbard%20atom.html#Bare-and-full-susceptibility-\chi_0-and-\chi">Bare and full susceptibility <span class="math notranslate nohighlight">\(\chi_0\)</span> and <span class="math notranslate nohighlight">\(\chi\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Bethe-Salpeter%20Equation%20on%20the%20Hubbard%20atom.html#Bethe-Salpeter-Equation-(BSE)-for-\Gamma_m^{(PH)}">Bethe-Salpeter Equation (BSE) for <span class="math notranslate nohighlight">\(\Gamma_m^{(PH)}\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Bethe-Salpeter%20Equation%20on%20the%20Hubbard%20atom.html#Analytic-vertex-\Gamma_m^{(PH)}">Analytic vertex <span class="math notranslate nohighlight">\(\Gamma_m^{(PH)}\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Bethe-Salpeter%20Equation%20on%20the%20Hubbard%20atom.html#BSE-frequency-window-convergence">BSE frequency window convergence</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/Lattice%20BSE%20on%20Hubbard%20atom.html">Lattice Bethe-Salpeter Equation (BSE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/dmft_susceptibility/dmft_susceptibility.html">DMFT lattice susceptibility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/dmft_susceptibility/dmft_susceptibility.html#self-consistent-calculations-in-applied-field">Self consistent calculations in applied field</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/dmft_susceptibility/dmft_susceptibility.html#lattice-susceptibility-from-the-bethe-salpeter-equation">Lattice susceptibility from the Bethe-Salpeter Equation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../user_guide/dmft_susceptibility/dmft_susceptibility.html#dmft-local-vertex">DMFT local vertex</a></li>
<li class="toctree-l5"><a class="reference internal" href="../user_guide/dmft_susceptibility/dmft_susceptibility.html#lattice-bethe-salpeter-equation">Lattice Bethe-Salpeter Equation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/dmft_susceptibility/dmft_susceptibility.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/dmft_susceptibility_dbse/dmft_susceptibility_dbse.html">Spin susceptibility in Sr2RuO4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/dmft_susceptibility_dbse/dmft_susceptibility_dbse.html#dual-bethe-salpeter-equation">Dual Bethe-Salpeter equation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/Linearized%20Eliashberg%20equation%20on%20the%20attractive%20Hubbard%20model.html">Linearized Eliashberg equation on the attractive Hubbard model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Linearized%20Eliashberg%20equation%20on%20the%20attractive%20Hubbard%20model.html#Hubbard-model-on-a-square-lattice">Hubbard model on a square lattice</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../user_guide/Linearized%20Eliashberg%20equation%20on%20the%20attractive%20Hubbard%20model.html#Semi-particle-hole-transformation">Semi particle-hole transformation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Linearized%20Eliashberg%20equation%20on%20the%20attractive%20Hubbard%20model.html#Solving-the-linearized-Eliashberg-equation">Solving the linearized Eliashberg equation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/Solving%20the%20linearized%20Eliashberg%20equation%20in%20the%20random%20phase%20approximation%20limit.html">Solving the linearized Eliashberg equation in the random phase approximation limit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Solving%20the%20linearized%20Eliashberg%20equation%20in%20the%20random%20phase%20approximation%20limit.html#1.-Construct-the-density--and-magnetic-susceptibilties-in-RPA">1. Construct the density- and magnetic-susceptibilties in RPA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Solving%20the%20linearized%20Eliashberg%20equation%20in%20the%20random%20phase%20approximation%20limit.html#2.-Construct-the-particle-particle-vertex-in-RPA">2. Construct the particle-particle vertex in RPA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Solving%20the%20linearized%20Eliashberg%20equation%20in%20the%20random%20phase%20approximation%20limit.html#3.-Construct-the-symmetrizing-functions">3. Construct the symmetrizing functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../user_guide/Solving%20the%20linearized%20Eliashberg%20equation%20in%20the%20random%20phase%20approximation%20limit.html#Frequency:-Even,-Momentum:-Even">Frequency: Even, Momentum: Even</a></li>
<li class="toctree-l5"><a class="reference internal" href="../user_guide/Solving%20the%20linearized%20Eliashberg%20equation%20in%20the%20random%20phase%20approximation%20limit.html#Frequency:-Odd,-Momentum:-Odd">Frequency: Odd, Momentum: Odd</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Solving%20the%20linearized%20Eliashberg%20equation%20in%20the%20random%20phase%20approximation%20limit.html#4.-Solve-the-linearized-Eliashberg-equation">4. Solve the linearized Eliashberg equation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../documentation.html#python-reference-manual">Python reference manual</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Lattice Green’s functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.lattice_dyson_g0_wk"><code class="docutils literal notranslate"><span class="pre">lattice_dyson_g0_wk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.lattice_dyson_g0_fk"><code class="docutils literal notranslate"><span class="pre">lattice_dyson_g0_fk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.lattice_dyson_g_wk"><code class="docutils literal notranslate"><span class="pre">lattice_dyson_g_wk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.lattice_dyson_g_fk"><code class="docutils literal notranslate"><span class="pre">lattice_dyson_g_fk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.lattice_dyson_g_f"><code class="docutils literal notranslate"><span class="pre">lattice_dyson_g_f()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.lattice_dyson_g_w"><code class="docutils literal notranslate"><span class="pre">lattice_dyson_g_w()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#non-interacting-generalized-susceptibility">Non-interacting generalized susceptibility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice_utils.imtime_bubble_chi0_wk"><code class="docutils literal notranslate"><span class="pre">imtime_bubble_chi0_wk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.lindhard_chi00"><code class="docutils literal notranslate"><span class="pre">lindhard_chi00()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#random-phase-approximation">Random Phase Approximation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.solve_rpa_PH"><code class="docutils literal notranslate"><span class="pre">solve_rpa_PH()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.rpa_tensor.kanamori_quartic_tensor"><code class="docutils literal notranslate"><span class="pre">kanamori_quartic_tensor()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#impurity-susceptibility-and-bethe-salpeter-equation">Impurity susceptibility and Bethe-Salpeter Equation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.chi_from_gg2.chi0_from_gg2_PH"><code class="docutils literal notranslate"><span class="pre">chi0_from_gg2_PH()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.chi_from_gg2.chi0_from_gg2_PP"><code class="docutils literal notranslate"><span class="pre">chi0_from_gg2_PP()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.chi_from_gg2.chi_from_gg2_PH"><code class="docutils literal notranslate"><span class="pre">chi_from_gg2_PH()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.chi_from_gg2.chi_from_gg2_PP"><code class="docutils literal notranslate"><span class="pre">chi_from_gg2_PP()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.bse.solve_local_bse"><code class="docutils literal notranslate"><span class="pre">solve_local_bse()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lattice-bethe-salpeter-equation">Lattice Bethe-Salpeter Equation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.bse.solve_lattice_bse"><code class="docutils literal notranslate"><span class="pre">solve_lattice_bse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.bse.solve_lattice_bse_at_specific_w"><code class="docutils literal notranslate"><span class="pre">solve_lattice_bse_at_specific_w()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.bse.get_chi0_wnk"><code class="docutils literal notranslate"><span class="pre">get_chi0_wnk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.bse.get_chi0_nk_at_specific_w"><code class="docutils literal notranslate"><span class="pre">get_chi0_nk_at_specific_w()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dual-bethe-salpeter-equation">Dual Bethe-Salpeter Equation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.dbse.solve_lattice_dbse"><code class="docutils literal notranslate"><span class="pre">solve_lattice_dbse()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.dbse.impurity_reducible_vertex_F"><code class="docutils literal notranslate"><span class="pre">impurity_reducible_vertex_F()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gw-approximation">GW approximation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.gw_solver.GWSolver"><code class="docutils literal notranslate"><span class="pre">GWSolver</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.dynamical_screened_interaction_W"><code class="docutils literal notranslate"><span class="pre">dynamical_screened_interaction_W()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice.dynamical_screened_interaction_W_from_generalized_susceptibility"><code class="docutils literal notranslate"><span class="pre">dynamical_screened_interaction_W_from_generalized_susceptibility()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.gw.bubble_PI_wk"><code class="docutils literal notranslate"><span class="pre">bubble_PI_wk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.gw.gw_sigma"><code class="docutils literal notranslate"><span class="pre">gw_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.gw.g0w_sigma"><code class="docutils literal notranslate"><span class="pre">g0w_sigma()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#linearized-eliashberg-equation">Linearized Eliashberg equation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.eliashberg.solve_eliashberg"><code class="docutils literal notranslate"><span class="pre">solve_eliashberg()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.eliashberg.preprocess_gamma_for_fft"><code class="docutils literal notranslate"><span class="pre">preprocess_gamma_for_fft()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.eliashberg.semi_random_initial_delta"><code class="docutils literal notranslate"><span class="pre">semi_random_initial_delta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.eliashberg.power_method_LR"><code class="docutils literal notranslate"><span class="pre">power_method_LR()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.eliashberg.implicitly_restarted_arnoldi_method"><code class="docutils literal notranslate"><span class="pre">implicitly_restarted_arnoldi_method()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.eliashberg.construct_gamma_singlet_rpa"><code class="docutils literal notranslate"><span class="pre">construct_gamma_singlet_rpa()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.eliashberg.construct_gamma_triplet_rpa"><code class="docutils literal notranslate"><span class="pre">construct_gamma_triplet_rpa()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hubbard-atom-analytic-response-functions">Hubbard atom analytic response functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.analytic_hubbard_atom.analytic_hubbard_atom"><code class="docutils literal notranslate"><span class="pre">analytic_hubbard_atom()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#two-particle-response-function-linear-algebra-operations">Two-particle response function linear-algebra operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.linalg.inverse_PH"><code class="docutils literal notranslate"><span class="pre">inverse_PH()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.linalg.inverse_PP"><code class="docutils literal notranslate"><span class="pre">inverse_PP()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.linalg.inverse_PH_bar"><code class="docutils literal notranslate"><span class="pre">inverse_PH_bar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.linalg.product_PH"><code class="docutils literal notranslate"><span class="pre">product_PH()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.linalg.product_PP"><code class="docutils literal notranslate"><span class="pre">product_PP()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.linalg.product_PH_bar"><code class="docutils literal notranslate"><span class="pre">product_PH_bar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.linalg.identity_PH"><code class="docutils literal notranslate"><span class="pre">identity_PH()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.linalg.identity_PP"><code class="docutils literal notranslate"><span class="pre">identity_PP()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.linalg.identity_PH_bar"><code class="docutils literal notranslate"><span class="pre">identity_PH_bar()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wannier90-tight-binding-parsers">Wannier90 tight binding parsers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.wannier90.parse_hopping_from_wannier90_hr_dat"><code class="docutils literal notranslate"><span class="pre">parse_hopping_from_wannier90_hr_dat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.wannier90.parse_lattice_vectors_from_wannier90_wout"><code class="docutils literal notranslate"><span class="pre">parse_lattice_vectors_from_wannier90_wout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.wannier90.parse_reciprocal_lattice_vectors_from_wannier90_wout"><code class="docutils literal notranslate"><span class="pre">parse_reciprocal_lattice_vectors_from_wannier90_wout()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.wannier90.parse_band_structure_from_wannier90_band_dat"><code class="docutils literal notranslate"><span class="pre">parse_band_structure_from_wannier90_band_dat()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tight-binding-lattice-model">Tight binding lattice model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice"><code class="docutils literal notranslate"><span class="pre">TBLattice</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.dispersion"><code class="docutils literal notranslate"><span class="pre">TBLattice.dispersion()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.fourier"><code class="docutils literal notranslate"><span class="pre">TBLattice.fourier()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.get_kmesh"><code class="docutils literal notranslate"><span class="pre">TBLattice.get_kmesh()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.get_rmesh"><code class="docutils literal notranslate"><span class="pre">TBLattice.get_rmesh()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.lattice_to_real_coordinates"><code class="docutils literal notranslate"><span class="pre">TBLattice.lattice_to_real_coordinates()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.n_orbitals"><code class="docutils literal notranslate"><span class="pre">TBLattice.n_orbitals</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.ndim"><code class="docutils literal notranslate"><span class="pre">TBLattice.ndim</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.orbital_names"><code class="docutils literal notranslate"><span class="pre">TBLattice.orbital_names</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.orbital_positions"><code class="docutils literal notranslate"><span class="pre">TBLattice.orbital_positions</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.units"><code class="docutils literal notranslate"><span class="pre">TBLattice.units</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.tight_binding.create_square_lattice"><code class="docutils literal notranslate"><span class="pre">create_square_lattice()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice"><code class="docutils literal notranslate"><span class="pre">TBSuperLattice</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_L_to_SL"><code class="docutils literal notranslate"><span class="pre">TBSuperLattice.change_coordinates_L_to_SL()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_SL_to_L"><code class="docutils literal notranslate"><span class="pre">TBSuperLattice.change_coordinates_SL_to_L()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.cluster_sites"><code class="docutils literal notranslate"><span class="pre">TBSuperLattice.cluster_sites()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.fold"><code class="docutils literal notranslate"><span class="pre">TBSuperLattice.fold()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.pack_index_site_orbital"><code class="docutils literal notranslate"><span class="pre">TBSuperLattice.pack_index_site_orbital()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.unpack_index_site_orbital"><code class="docutils literal notranslate"><span class="pre">TBSuperLattice.unpack_index_site_orbital()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hartree-fock-and-hartree-solvers">Hartree-Fock and Hartree solvers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver"><code class="docutils literal notranslate"><span class="pre">HartreeFockSolver</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.mat2vec"><code class="docutils literal notranslate"><span class="pre">HartreeFockSolver.mat2vec()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_iter"><code class="docutils literal notranslate"><span class="pre">HartreeFockSolver.solve_iter()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton"><code class="docutils literal notranslate"><span class="pre">HartreeFockSolver.solve_newton()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton_mu"><code class="docutils literal notranslate"><span class="pre">HartreeFockSolver.solve_newton_mu()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.vec2mat"><code class="docutils literal notranslate"><span class="pre">HartreeFockSolver.vec2mat()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.hf_response.HartreeFockResponse"><code class="docutils literal notranslate"><span class="pre">HartreeFockResponse</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeSolver"><code class="docutils literal notranslate"><span class="pre">HartreeSolver</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeSolver.mat2vec"><code class="docutils literal notranslate"><span class="pre">HartreeSolver.mat2vec()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeSolver.vec2mat"><code class="docutils literal notranslate"><span class="pre">HartreeSolver.vec2mat()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.hf_response.HartreeResponse"><code class="docutils literal notranslate"><span class="pre">HartreeResponse</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#utility-functions">Utility functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice_utils.k_space_path"><code class="docutils literal notranslate"><span class="pre">k_space_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.lattice_utils.chi_contraction"><code class="docutils literal notranslate"><span class="pre">chi_contraction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#parameter-collections">Parameter collections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.ParameterCollection.ParameterCollection"><code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.ParameterCollection.ParameterCollection.alter"><code class="docutils literal notranslate"><span class="pre">ParameterCollection.alter()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.ParameterCollection.ParameterCollection.convert_keys_from_string_to_python"><code class="docutils literal notranslate"><span class="pre">ParameterCollection.convert_keys_from_string_to_python()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#triqs_tprf.ParameterCollection.ParameterCollection.copy"><code class="docutils literal notranslate"><span class="pre">ParameterCollection.copy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.ParameterCollection.ParameterCollections"><code class="docutils literal notranslate"><span class="pre">ParameterCollections</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#triqs_tprf.ParameterCollection.parameter_scan"><code class="docutils literal notranslate"><span class="pre">parameter_scan()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#c-reference-manual">C++ reference manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html">Lattice Green’s functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g0_wk.html">triqs_tprf::lattice_dyson_g0_wk</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g0_wk.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g0_wk.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g0_fk.html">triqs_tprf::lattice_dyson_g0_fk</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g0_fk.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g0_fk.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g_wk.html">triqs_tprf::lattice_dyson_g_wk</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g_wk.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g_wk.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g_fk.html">triqs_tprf::lattice_dyson_g_fk</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g_fk.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g_fk.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g_w.html">triqs_tprf::lattice_dyson_g_w</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g_w.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lattice_dyson_g_w.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_wk_to_wr.html">triqs_tprf::fourier_wk_to_wr</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_wk_to_wr.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_wk_to_wr.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_wr_to_wk.html">triqs_tprf::fourier_wr_to_wk</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_wr_to_wk.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_wr_to_wk.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_wr_to_tr.html">triqs_tprf::fourier_wr_to_tr</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_wr_to_tr.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_wr_to_tr.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_tr_to_wr.html">triqs_tprf::fourier_tr_to_wr</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_tr_to_wr.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/fourier_tr_to_wr.html#returns">Returns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html#lindhard-non-interacting-generalized-susceptibility">Lindhard non-interacting generalized susceptibility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lindhard_chi00.html">triqs_tprf::lindhard_chi00</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lindhard_chi00.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/lindhard_chi00.html#returns">Returns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html#random-phase-approximation">Random Phase Approximation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/solve_rpa_PH.html">triqs_tprf::solve_rpa_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/solve_rpa_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/solve_rpa_PH.html#returns">Returns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html#generalized-impurity-susceptibility">Generalized impurity susceptibility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_from_gg2_PH.html">triqs_tprf::chi0_from_gg2_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_from_gg2_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_from_gg2_PH.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_from_gg2_PP.html">triqs_tprf::chi0_from_gg2_PP</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_from_gg2_PP.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_from_gg2_PP.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_from_gg2_PH.html">triqs_tprf::chi_from_gg2_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_from_gg2_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_from_gg2_PH.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_from_gg2_PP.html">triqs_tprf::chi_from_gg2_PP</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_from_gg2_PP.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_from_gg2_PP.html#returns">Returns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html#generalized-bubble-susceptibility-for-rpa">Generalized bubble susceptibility (for RPA)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_tr_from_grt_PH.html">triqs_tprf::chi0_tr_from_grt_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_tr_from_grt_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_tr_from_grt_PH.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_w0r_from_grt_PH.html">triqs_tprf::chi0_w0r_from_grt_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_w0r_from_grt_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0_w0r_from_grt_PH.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_w0r_from_chi_tr.html">triqs_tprf::chi_w0r_from_chi_tr</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_w0r_from_chi_tr.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_w0r_from_chi_tr.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_wr_from_chi_tr.html">triqs_tprf::chi_wr_from_chi_tr</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_wr_from_chi_tr.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_wr_from_chi_tr.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_tr_from_chi_wr.html">triqs_tprf::chi_tr_from_chi_wr</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_tr_from_chi_wr.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_tr_from_chi_wr.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_wk_from_chi_wr.html">triqs_tprf::chi_wk_from_chi_wr</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_wk_from_chi_wr.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_wk_from_chi_wr.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_wr_from_chi_wk.html">triqs_tprf::chi_wr_from_chi_wk</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_wr_from_chi_wk.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi_wr_from_chi_wk.html#returns">Returns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html#generalized-susceptibility-and-the-bethe-salpeter-equation">Generalized susceptibility and the Bethe-Salpeter equation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0r_from_gr_PH.html">triqs_tprf::chi0r_from_gr_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0r_from_gr_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0r_from_gr_PH.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0r_from_gr_PH_nompi.html">triqs_tprf::chi0r_from_gr_PH_nompi</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0r_from_gr_PH_nompi.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0r_from_gr_PH_nompi.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_from_g_wk_PH.html">triqs_tprf::chi0q_from_g_wk_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_from_g_wk_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_from_g_wk_PH.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0r_from_chi0q.html">triqs_tprf::chi0r_from_chi0q</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0r_from_chi0q.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0r_from_chi0q.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_from_chi0r.html">triqs_tprf::chi0q_from_chi0r</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_from_chi0r.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_from_chi0r.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_sum_nu.html">triqs_tprf::chi0q_sum_nu</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_sum_nu.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_sum_nu.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_sum_nu_tail_corr_PH.html">triqs_tprf::chi0q_sum_nu_tail_corr_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_sum_nu_tail_corr_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_sum_nu_tail_corr_PH.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_sum_nu_q.html">triqs_tprf::chi0q_sum_nu_q</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_sum_nu_q.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chi0q_sum_nu_q.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chiq_from_chi0q_and_gamma_PH.html">triqs_tprf::chiq_from_chi0q_and_gamma_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chiq_from_chi0q_and_gamma_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chiq_from_chi0q_and_gamma_PH.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chiq_sum_nu_from_chi0q_and_gamma_PH.html">triqs_tprf::chiq_sum_nu_from_chi0q_and_gamma_PH</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chiq_sum_nu_from_chi0q_and_gamma_PH.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/chiq_sum_nu_from_chi0q_and_gamma_PH.html#returns">Returns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html#gw-approximation">GW approximation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/dynamical_screened_interaction_W.html">triqs_tprf::dynamical_screened_interaction_W</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/dynamical_screened_interaction_W.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/dynamical_screened_interaction_W.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/dynamical_screened_interaction_W_from_generalized_susceptibility.html">triqs_tprf::dynamical_screened_interaction_W_from_generalized_susceptibility</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/dynamical_screened_interaction_W_from_generalized_susceptibility.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/dynamical_screened_interaction_W_from_generalized_susceptibility.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/gw_sigma.html">triqs_tprf::gw_sigma</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/gw_sigma.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/gw_sigma.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/g0w_sigma.html">triqs_tprf::g0w_sigma</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/g0w_sigma.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/g0w_sigma.html#returns">Returns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html#linearized-eliashberg-equation">Linearized Eliashberg equation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/eliashberg_product.html">triqs_tprf::eliashberg_product</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/eliashberg_product.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/eliashberg_product.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/eliashberg_product_fft.html">triqs_tprf::eliashberg_product_fft</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/eliashberg_product_fft.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/eliashberg_product_fft.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/split_into_dynamic_wk_and_constant_k.html">triqs_tprf::split_into_dynamic_wk_and_constant_k</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/split_into_dynamic_wk_and_constant_k.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/split_into_dynamic_wk_and_constant_k.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/dynamic_and_constant_to_tr.html">triqs_tprf::dynamic_and_constant_to_tr</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/dynamic_and_constant_to_tr.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/dynamic_and_constant_to_tr.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/construct_phi_wk.html">triqs_tprf::construct_phi_wk</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/construct_phi_wk.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/construct_phi_wk.html#returns">Returns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html#hubbard-atom-analytic-response-functions">Hubbard atom analytic response functions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cpp_reference.html#two-particle-response-function-linear-algebra-operations">Two-particle response function linear-algebra operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/inverse.html">triqs_tprf::inverse</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/inverse.html#template-parameters">Template parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/inverse.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/inverse.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/product.html">triqs_tprf::product</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/product.html#template-parameters">Template parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/product.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/product.html#returns">Returns</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/identity.html">triqs_tprf::identity</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/identity.html#template-parameters">Template parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/identity.html#parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/triqs_tprf/identity.html#returns">Returns</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#theory-and-notation">Theory and notation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../theory/notation.html">Response function notation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../theory/notation.html#generalized-susceptibility-chi">Generalized susceptibility <span class="math notranslate nohighlight">\(\chi\)</span></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../theory/notation.html#bare-generalized-susceptibility-chi-0">Bare generalized susceptibility <span class="math notranslate nohighlight">\(\chi_0\)</span></a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/notation.html#reducible-vertex-function-f">Reducible vertex function <span class="math notranslate nohighlight">\(F\)</span></a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/notation.html#full-generalized-particle-hole-susceptibility-chi">Full generalized particle-hole susceptibility <span class="math notranslate nohighlight">\(\chi\)</span></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../theory/notation.html#bethe-salpeter-equations-bse">Bethe-Salpeter equations (BSE)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../theory/notation.html#matsubara-frequency-transforms">Matsubara frequency transforms</a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/notation.html#particle-hole-channel-ph">Particle-hole channel (<span class="math notranslate nohighlight">\(PH\)</span>)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/notation.html#crossed-particle-particle-channel-ppx">Crossed-Particle-particle channel (<span class="math notranslate nohighlight">\(PPx\)</span>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../theory/single_particle_gf.html">On the single particle Green’s function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../theory/single_particle_gf.html#field-operator-matsubara-transforms">Field operator Matsubara transforms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../theory/vertex.html">Vertex functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../theory/vertex.html#fully-reducible-vertex-f">Fully reducible vertex <span class="math notranslate nohighlight">\(F\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../theory/vertex.html#bethe-salpeter-equations-for-the-fully-reducible-vertex-f">Bethe-Salpeter equations for the fully reducible vertex <span class="math notranslate nohighlight">\(F\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../theory/vertex.html#matsubara-frequency-parametrization">Matsubara frequency parametrization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../theory/vertex.html#derivation-product-relations">Derivation: Product relations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../theory/vertex.html#particle-hole-channel-ph">Particle-Hole channel (<span class="math notranslate nohighlight">\(PH\)</span>)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/vertex.html#vertical-particle-hole-channel-bar-ph">Vertical-Particle-Hole channel (<span class="math notranslate nohighlight">\(\bar{PH}\)</span>)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/vertex.html#particle-particle-channel-pp">Particle-Particle channel (<span class="math notranslate nohighlight">\(PP\)</span>)</a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/vertex.html#crossed-particle-particle-channel-ppx">Crossed-Particle-Particle channel (<span class="math notranslate nohighlight">\(PPx\)</span>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../theory/boundary_conditions.html">(Anti-)Periodicity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../theory/boundary_conditions.html#two-particle-green-s-functions">Two-particle Green’s functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../theory/boundary_conditions.html#kubo-martin-schwinger-kms-boundary-conditions">Kubo-Martin-Schwinger (KMS) boundary conditions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../theory/boundary_conditions.html#generalization-to-two-particle-green-s-functions">Generalization to two-particle Green’s functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../theory/linear_response.html">Linear response</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../theory/linear_response.html#from-the-generalized-susceptibility">From the generalized susceptibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../theory/linear_response.html#from-an-applied-external-field">From an applied external field</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../theory/rpa.html">Random phase approximation (RPA)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../theory/rpa.html#interaction">Interaction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../theory/rpa.html#antisymmetrized-interaction-tensor-u">Antisymmetrized interaction tensor <span class="math notranslate nohighlight">\(U\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../theory/rpa.html#spin-independent-rpa-calculations">Spin-independent RPA calculations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../theory/rpa.html#id1">Matrix RPA</a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/rpa.html#mapping-between-spin-dependent-and-independent-quantities">Mapping between spin-dependent and independent quantities</a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/rpa.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../theory/eliashberg.html">Linearized Eliashberg Equation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../theory/eliashberg.html#deriving-the-linearized-eliashberg-equation-from-the-normal-state">Deriving the linearized Eliashberg equation from the normal state</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../theory/eliashberg.html#relation-to-the-bcs-gap-equation">Relation to the BCS gap equation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../theory/eliashberg.html#details-for-applications">Details for applications</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../theory/eliashberg.html#spot-condition">SPOT Condition</a></li>
<li class="toctree-l5"><a class="reference internal" href="../theory/eliashberg.html#random-phase-approximation-for-the-irreducible-particle-particle-vertex">Random phase approximation for the irreducible particle-particle vertex</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#faqs">FAQs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs.html">Frequently-asked questions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../faqs.html#q-why-is-not-feature-x-implemented">Q: Why is not feature X implemented?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-3-1">Version 3.3.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#general">General</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-3-0">Version 3.3.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id2">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#gw">gw</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#doc">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#cmake">cmake</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-2-0">Version 3.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#dual-bethe-salpeter-equation-dbse">Dual Bethe-Salpeter Equation (DBSE)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#hedins-gw-approximation">Hedin’s GW approximation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#discrete-lehmann-representation-dlr-support">Discrete Lehmann Representation (DLR) support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-1-1">Version 3.1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id3">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#py">py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id4">doc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-1-0">Version 3.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#eliashberg">Eliashberg</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#bethe-salpeter-equation-bse">Bethe-Salpeter equation (BSE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#chi0">Chi0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#maintenance">Maintenance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#triqs-compatibility">TRIQS compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-0-0">Version 3.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id5">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id6">cmake</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id7">doc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#py3">py3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#python">python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-2-0">Version 2.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id8">doc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#fourier">fourier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id9">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#hf">hf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-1-1">Version 2.1.1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">Authors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">triqs_tprf</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../documentation.html">Documentation</a></li>
      <li class="breadcrumb-item active">Lattice Green’s functions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reference/python_reference.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="lattice-green-s-functions">
<span id="gf-functions"></span><h1>Lattice Green’s functions<a class="headerlink" href="#lattice-green-s-functions" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.lattice_dyson_g0_wk">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">lattice_dyson_g0_wk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g0_wk" title="Link to this definition"></a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, triqs::mesh::imfreq mesh) -&gt; triqs_tprf::g_wk_t
Construct a non-interacting Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G^{(0)}_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[G^{(0)}_{a\bar{b}}(i\omega_n, \mathbf{k}) = \left[
(i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k})
\right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>,
and a Matsubara frequency Green’s function mesh.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mu</strong></dt><dd><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</dd>
<dt><strong>e_k</strong></dt><dd><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</dd>
<dt><strong>mesh</strong></dt><dd><p>imaginary frequency mesh</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G^{(0)}_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.lattice_dyson_g0_fk">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">lattice_dyson_g0_fk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g0_fk" title="Link to this definition"></a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, triqs::mesh::refreq mesh, float delta) -&gt; triqs_tprf::g_fk_t
Construct a non-interacting real frequency lattice Green’s function <span class="math notranslate nohighlight">\(G^{(0)}_{a\bar{b}}(\omega, \mathbf{k})\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[G^{(0)}_{a\bar{b}}(\omega, \mathbf{k}) = \left[
(\omega + i\delta + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k})
\right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>,
broadening <span class="math notranslate nohighlight">\(\delta\)</span>, and a real frequency Green’s function mesh.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mu</strong></dt><dd><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</dd>
<dt><strong>e_k</strong></dt><dd><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</dd>
<dt><strong>mesh</strong></dt><dd><p>real frequency mesh</p>
</dd>
<dt><strong>delta</strong></dt><dd><p>broadening <span class="math notranslate nohighlight">\(\delta\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G^{(0)}_{a\bar{b}}(\omega, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.lattice_dyson_g_wk">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">lattice_dyson_g_wk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g_wk" title="Link to this definition"></a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, triqs_tprf::g_w_cvt sigma_w) -&gt; triqs_tprf::g_wk_t
Construct an interacting Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[G_{a\bar{b}}(i\omega_n, \mathbf{k}) = \left[
(i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(i\omega_n)
\right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>,
chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>, and a momentum independent Matsubara frequency
self energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mu</strong></dt><dd><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</dd>
<dt><strong>e_k</strong></dt><dd><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</dd>
<dt><strong>sigma_w</strong></dt><dd><p>imaginary frequency self-energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.lattice_dyson_g_fk">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">lattice_dyson_g_fk</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g_fk" title="Link to this definition"></a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, triqs_tprf::g_fk_cvt sigma_fk, float delta) -&gt; triqs_tprf::g_fk_t
Construct an interacting real frequency lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(\omega, \mathbf{k})\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[G_{a\bar{b}}(\omega, \mathbf{k}) = \left[
(\omega + i\delta + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(\omega, \mathbf{k})
\right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>,
chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>, broadening <span class="math notranslate nohighlight">\(\delta\)</span>, and a real frequency
self energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(\omega, \mathbf{k})\)</span>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mu</strong></dt><dd><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</dd>
<dt><strong>e_k</strong></dt><dd><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</dd>
<dt><strong>sigma_fk</strong></dt><dd><p>real frequency self-energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(\omega, \mathbf{k})\)</span></p>
</dd>
<dt><strong>delta</strong></dt><dd><p>broadening <span class="math notranslate nohighlight">\(\delta\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>real frequency lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(\omega, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.lattice_dyson_g_f">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">lattice_dyson_g_f</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g_f" title="Link to this definition"></a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, triqs_tprf::g_f_cvt sigma_f, float delta) -&gt; triqs_tprf::g_f_t
Construct an interacting real frequency local (<span class="math notranslate nohighlight">\(\mathbf{r}=\mathbf{0}\)</span>) lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(\omega)\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[G_{a\bar{b}}(\omega) = \frac{1}{N_k} \sum_\mathbf{k} \left[
(i\omega_n + i\delta + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(\omega)
\right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>,
chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>, and a momentum independent real frequency
self energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(\omega)\)</span>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mu</strong></dt><dd><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</dd>
<dt><strong>e_k</strong></dt><dd><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</dd>
<dt><strong>sigma_f</strong></dt><dd><p>real frequency self-energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(\omega)\)</span></p>
</dd>
<dt><strong>delta</strong></dt><dd><p>broadening <span class="math notranslate nohighlight">\(\delta\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>Real frequency lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(\omega, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.lattice_dyson_g_w">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">lattice_dyson_g_w</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g_w" title="Link to this definition"></a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, triqs_tprf::g_w_cvt sigma_w) -&gt; triqs_tprf::g_w_t
Construct an interacting Matsubara frequency local (<span class="math notranslate nohighlight">\(\mathbf{r}=\mathbf{0}\)</span>) lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\omega_n)\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[G_{a\bar{b}}(i\omega_n) = \frac{1}{N_k} \sum_\mathbf{k} \left[
(i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(i\omega_n)
\right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>,
chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>, and a momentum independent Matsubara frequency
self energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span>.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mu</strong></dt><dd><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</dd>
<dt><strong>e_k</strong></dt><dd><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</dd>
<dt><strong>sigma_w</strong></dt><dd><p>imaginary frequency self-energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="non-interacting-generalized-susceptibility">
<h1>Non-interacting generalized susceptibility<a class="headerlink" href="#non-interacting-generalized-susceptibility" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice_utils.imtime_bubble_chi0_wk">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice_utils.</span></span><span class="sig-name descname"><span class="pre">imtime_bubble_chi0_wk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_memory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/lattice_utils.html#imtime_bubble_chi0_wk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.lattice_utils.imtime_bubble_chi0_wk" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.lindhard_chi00">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">lindhard_chi00</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lindhard_chi00" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::e_k_cvt e_k, triqs::mesh::imfreq mesh, float mu) -&gt; triqs_tprf::chi_wk_t
Generalized Lindhard susceptibility in the particle-hole channel <span class="math notranslate nohighlight">\(\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q})\)</span>.</p>
<blockquote>
<div><p>Analytic calculation of the generalized (non-interacting) Lindhard susceptibility
in the particle-hole channel. The analytic expression is obtained using residue calculus
to explicitly evaluate the matsubara sum of the fourier transformed imaginary time
bubble product of two non-interacting single-particle Green’s functions.</p>
<div class="math notranslate nohighlight">
\[G^{(0)}_{a\bar{b}}(\mathbf{k}, i\omega_n) =
\left[ i\omega_n \cdot \mathbf{1} - \epsilon(\mathbf{k}) \right]^{-1} .\]</div>
<p>The analytic evaluation of the bubble diagram gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q}) \equiv
\mathcal{F} \left\{
  - G^{(0)}_{d\bar{a}}(\tau, \mathbf{r}) G^{(0)}_{b\bar{c}}(-\tau, -\mathbf{r})
\right\}
=
- \frac{1}{N_k} \sum_{\nu} \sum_{\mathbf{k}}
  G^{(0)}_{d\bar{a}}(\nu, \mathbf{k})
  G^{(0)}_{b\bar{c}}(\nu + \omega, \mathbf{k} + \mathbf{q})
\\ =
- \frac{1}{N_k} \sum_{\nu} \sum_{\mathbf{k}}
  \left( \sum_{i}
  U^\dagger_{di}(\mathbf{k}) \frac{1}{i\nu - \epsilon_{\mathbf{k}, i}} U_{i\bar{a}}(\mathbf{k})
  \right)
  \left( \sum_j
  U^\dagger_{bj}(\mathbf{k} + \mathbf{q})
  \frac{1}{i\nu + i\omega - \epsilon_{\mathbf{k} + \mathbf{q}, j}}
  U_{j\bar{c}}(\mathbf{k} + \mathbf{q})
  \right)
\\ =
\frac{1}{N_k} \sum_{\mathbf{k}} \sum_{ij}
  \left(
    [1 - \delta_{0, \omega_n} \delta_{\epsilon_{\mathbf{k},i},\epsilon_{\mathbf{k}+\mathbf{q}, j}})]
    \frac{ f(\epsilon_{\mathbf{k}, i}) - f(\epsilon_{\mathbf{k}+\mathbf{q}, j}) }
         {i\omega_n + \epsilon_{\mathbf{k} + \mathbf{q}, j} - \epsilon_{\mathbf{k}, i}}
    +
\delta_{0, \omega_n} \delta_{\epsilon_{\mathbf{k},i},\epsilon_{\mathbf{k}+\mathbf{q}, j}}
    \frac{\beta}{4 \cosh^2 (\beta \epsilon_{\mathbf{k}, i} / 2) }
  \right)
  \\ \times
  U_{\bar{a}i}(\mathbf{k}) U^\dagger_{id}(\mathbf{k})
  U_{\bar{c}j}(\mathbf{k} + \mathbf{q}) U^\dagger_{jb}(\mathbf{k} + \mathbf{q})\end{split}\]</div>
<p>where the <span class="math notranslate nohighlight">\(U(\mathbf{k})\)</span> matrices are the diagonalizing unitary transform of the matrix valued
dispersion relation <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, i.e.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>e_k</strong></dt><dd><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</dd>
<dt><strong>mesh</strong></dt><dd><p>bosonic Matsubara frequency mesh</p>
</dd>
<dt><strong>mu</strong></dt><dd><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt>out</dt><dd><p>generalized Lindhard susceptibility in the particle-hole channel <span class="math notranslate nohighlight">\(\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q})\)</span></p>
<div class="math notranslate nohighlight">
\[\]</div>
<p>sum_{bar{a}b} U_{ibar{a}}(mathbf{k}) epsilon_{bar{a}b}(mathbf{k}) U^dagger_{bj} (mathbf{k})
= delta_{ij} epsilon_{mathbf{k}, i}</p>
<p>The analytic formula is sub-optimal in terms of performance for higher temperatures. The evaluation
scales as <span class="math notranslate nohighlight">\(\mathcal{O}(N_k^2)\)</span> which is worse than computing the bubble explicitly in imaginary
time, with scaling <span class="math notranslate nohighlight">\(\mathcal{O}(N_k N_\tau \log(N_k N_\tau)\)</span> for <span class="math notranslate nohighlight">\(N_k \gg N_\tau\)</span>.</p>
<p>Care must be taken when evaluating the fermionic Matsubara frequency sum of the
product of two simple poles. By extending the sum to an integral over the complex
plane the standard expression for the Lindhard response is obtained when the
poles are non-degenerate. The degenerate case produces an additional frequency independent
contribution (the last term on the last row).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="random-phase-approximation">
<h1>Random Phase Approximation<a class="headerlink" href="#random-phase-approximation" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.solve_rpa_PH">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">solve_rpa_PH</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.solve_rpa_PH" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::chi_wk_vt chi0, array_contiguous_view&lt;std::complex&lt;double&gt;,4&gt; U) -&gt; triqs_tprf::chi_wk_t
Random Phase Approximation (RPA) in the particle-hole channel</p>
<blockquote>
<div><p>Computes the equation</p>
<div class="math notranslate nohighlight">
\[\chi(\bar{a}b\bar{c}d) = \big(
\mathbb{1}
- \chi^{(0)}(\bar{a}b\bar{B}A) U(A\bar{B}D\bar{C})
\big)^{-1} \chi^{(0)}(\bar{C}D\bar{c}d)\,.\]</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chi0</strong></dt><dd><p>bare particle-hole bubble <span class="math notranslate nohighlight">\(\chi^{(0)}_{\bar{a}b\bar{c}d}(\mathbf{k}, i\omega_n)\)</span></p>
</dd>
<dt><strong>U</strong></dt><dd><p>RPA static vertex as obtained from triqs_tprf.rpa_tensor.get_rpa_tensor <span class="math notranslate nohighlight">\(U_{a\bar{b}c\bar{d}}\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>RPA suceptibility <span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\mathbf{k}, i\omega_n)\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.rpa_tensor.kanamori_quartic_tensor">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.rpa_tensor.</span></span><span class="sig-name descname"><span class="pre">kanamori_quartic_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Jp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/rpa_tensor.html#kanamori_quartic_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.rpa_tensor.kanamori_quartic_tensor" title="Link to this definition"></a></dt>
<dd><p>Return Kanamori interaction as a quartic tensor</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{U}_{\text { Kanamori }} = U \sum_{i} \hat{n}_{i, \uparrow} \hat{n}_{i, \downarrow}+
\sum_{i&gt;j, s, s^{\prime}}\left(U^{\prime}-J \delta_{\sigma, \sigma^{\prime}}\right)
\hat{n}_{i, \sigma} \hat{n}_{j, \sigma^{\prime}} - 
\\ J \sum_{i \neq j}\left(\hat{c}_{i, \downarrow}^{\dagger} \hat{c}_{j, \uparrow}^{\dagger}
\hat{c}_{j, \downarrow} \hat{c}_{i, \uparrow}+\hat{c}_{j, \uparrow}^{\dagger}
\hat{c}_{j, \downarrow}^{\dagger} \hat{c}_{i, \uparrow} \hat{c}_{i, \downarrow}+
\mathrm{h.c.}\right)\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>norb</strong><span class="classifier">int,</span></dt><dd><p>Number of orbitals excluding spin.</p>
</dd>
<dt><strong>U</strong><span class="classifier">complex,</span></dt><dd><p>Strength of intra-orbital interaction.</p>
</dd>
<dt><strong>Up</strong><span class="classifier">complex,</span></dt><dd><p>Strength of inter-orbital interaction.</p>
</dd>
<dt><strong>J</strong><span class="classifier">complex,</span></dt><dd><p>Strength of Hound’s coupling.</p>
</dd>
<dt><strong>Jp</strong><span class="classifier">complex,</span></dt><dd><p>Strength pair hopping and spin-flip.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>U</strong><span class="classifier">np.ndarray,</span></dt><dd><p>shape = (2*norb, 2*norb, 2*norb, 2*norb)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="impurity-susceptibility-and-bethe-salpeter-equation">
<h1>Impurity susceptibility and Bethe-Salpeter Equation<a class="headerlink" href="#impurity-susceptibility-and-bethe-salpeter-equation" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.chi_from_gg2.chi0_from_gg2_PH">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.chi_from_gg2.</span></span><span class="sig-name descname"><span class="pre">chi0_from_gg2_PH</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi0_from_gg2_PH" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Bubble susceptibility <span class="math notranslate nohighlight">\(\chi^{(0)} = GG\)</span> in the Particle-Hole channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
- \beta \delta_{\nu, \nu'} G_{da}(\nu) \cdot G_{bc}(\omega + \nu)\]</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g</strong></dt><dd><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\nu)\)</span></p>
</dd>
<dt><strong>g2</strong></dt><dd><p>two-particle Green’s function with the mesh to use for
<span class="math notranslate nohighlight">\(\chi^{(0)}\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>chi0 particle-hole bubble
<span class="math notranslate nohighlight">\(\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.chi_from_gg2.chi0_from_gg2_PP">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.chi_from_gg2.</span></span><span class="sig-name descname"><span class="pre">chi0_from_gg2_PP</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi0_from_gg2_PP" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Bubble susceptibility <span class="math notranslate nohighlight">\(\chi^{(0)} = GG\)</span> in the Particle-Particle</p>
<blockquote>
<div><p>channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
- \beta \delta_{\nu, \nu'} G_{da}(\nu) \cdot G_{bc}(\omega - \nu)\]</div>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g</strong></dt><dd><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\nu)\)</span></p>
</dd>
<dt><strong>g2</strong></dt><dd><p>two-particle Green’s function with the mesh to use for
<span class="math notranslate nohighlight">\(\chi^{(0)}\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>chi0 particle-particle bubble
<span class="math notranslate nohighlight">\(\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.chi_from_gg2.chi_from_gg2_PH">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.chi_from_gg2.</span></span><span class="sig-name descname"><span class="pre">chi_from_gg2_PH</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi_from_gg2_PH" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Generalized susceptibility <span class="math notranslate nohighlight">\(\chi^{(0)} = G^{(2)} - GG\)</span> in the</p>
<blockquote>
<div><p>Particle-Hole channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[\chi_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')
- \beta \delta_{\omega} G_{ba}(\nu) \cdot G_{dc}(\nu')\]</div>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g</strong></dt><dd><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\nu)\)</span></p>
</dd>
<dt><strong>g2</strong></dt><dd><p>two-particle Green’s function
<span class="math notranslate nohighlight">\(G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>chi generalized particle-hole susceptibility
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.chi_from_gg2.chi_from_gg2_PP">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.chi_from_gg2.</span></span><span class="sig-name descname"><span class="pre">chi_from_gg2_PP</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi_from_gg2_PP" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Generalized susceptibility <span class="math notranslate nohighlight">\(\chi^{(0)} = G^{(2)} - GG\)</span> in the</p>
<blockquote>
<div><p>Particle-Particle channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[\chi_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')
- \beta \delta_{\nu + \nu' - \omega} G_{ba}(\nu) \cdot G_{dc}(\nu')\]</div>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g</strong></dt><dd><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\nu)\)</span></p>
</dd>
<dt><strong>g2</strong></dt><dd><p>two-particle Green’s function
<span class="math notranslate nohighlight">\(G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>chi generalized particle-hole susceptibility
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.bse.solve_local_bse">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.bse.</span></span><span class="sig-name descname"><span class="pre">solve_local_bse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chi0_wnn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi_wnn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#solve_local_bse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.bse.solve_local_bse" title="Link to this definition"></a></dt>
<dd><p>Solve the Bethe-Salpeter equation for the local vertex function 
<span class="math notranslate nohighlight">\(\Gamma_{abcd}(\omega, \nu, \nu')\)</span>.</p>
<p>Computes:</p>
<div class="math notranslate nohighlight">
\[\Gamma_{abcd}(\omega, \nu, \nu') = [\chi^{(0)}]^{-1} - \chi^{-1}\]</div>
<p>where the inverses are taken in the particle-hole channel pairing
of fermionic frequencies <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(\nu'\)</span> and orbital
indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chi0_wnn</strong><span class="classifier">Gerealized local bubble susceptibility</span></dt><dd><p><span class="math notranslate nohighlight">\(\chi^{(0)}_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
<dt><strong>chi_wnn</strong><span class="classifier">Generalized local susceptibility</span></dt><dd><p><span class="math notranslate nohighlight">\(\chi_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>gamma_wnn</strong><span class="classifier">Particle-hole vertex function</span></dt><dd><p><span class="math notranslate nohighlight">\(\Gamma_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="lattice-bethe-salpeter-equation">
<h1>Lattice Bethe-Salpeter Equation<a class="headerlink" href="#lattice-bethe-salpeter-equation" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.bse.solve_lattice_bse">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.bse.</span></span><span class="sig-name descname"><span class="pre">solve_lattice_bse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_wnn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#solve_lattice_bse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.bse.solve_lattice_bse" title="Link to this definition"></a></dt>
<dd><p>Compute the generalized lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\mathbf{k}, \omega_n)\)</span> using the Bethe-Salpeter 
equation (BSE).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g_wk</strong><span class="classifier">Gf,</span></dt><dd><p>Single-particle Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\nu_n, \mathbf{k})\)</span>.</p>
</dd>
<dt><strong>gamma_wnn</strong><span class="classifier">Gf,</span></dt><dd><p>Local particle-hole vertex function 
<span class="math notranslate nohighlight">\(\Gamma_{a\bar{b}c\bar{d}}(i\omega_n, i\nu_n, i\nu_n')\)</span>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>chi_kw</strong><span class="classifier">Gf,</span></dt><dd><p>Generalized lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\mathbf{k}, i\omega_n)\)</span>.</p>
</dd>
<dt><strong>chi0_kw</strong><span class="classifier">Gf,</span></dt><dd><p>Generalized bare lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi^0_{\bar{a}b\bar{c}d}(\mathbf{k}, i\omega_n)\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.bse.solve_lattice_bse_at_specific_w">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.bse.</span></span><span class="sig-name descname"><span class="pre">solve_lattice_bse_at_specific_w</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_wnn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nw_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#solve_lattice_bse_at_specific_w"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.bse.solve_lattice_bse_at_specific_w" title="Link to this definition"></a></dt>
<dd><p>Compute the generalized lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(i\omega_{n=\mathrm{nw\_index}}, \mathbf{k})\)</span> using the Bethe-Salpeter 
equation (BSE) for a specific <span class="math notranslate nohighlight">\(i\omega_{n=\mathrm{nw\_index}}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g_wk</strong><span class="classifier">Gf,</span></dt><dd><p>Single-particle Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\nu_n, \mathbf{k})\)</span>.</p>
</dd>
<dt><strong>gamma_wnn</strong><span class="classifier">Gf,</span></dt><dd><p>Local particle-hole vertex function 
<span class="math notranslate nohighlight">\(\Gamma_{a\bar{b}c\bar{d}}(i\omega_n, i\nu_n, i\nu_n')\)</span>.</p>
</dd>
<dt><strong>nw_index</strong><span class="classifier">int,</span></dt><dd><p>The bosonic Matsubara frequency index <span class="math notranslate nohighlight">\(i\omega_{n=\mathrm{nw\_index}}\)</span>
at which the BSE is solved.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>chi_k</strong><span class="classifier">Gf,</span></dt><dd><p>Generalized lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(i\omega_{n=\mathrm{nw\_index}}, \mathbf{k})\)</span>.</p>
</dd>
<dt><strong>chi0_k</strong><span class="classifier">Gf,</span></dt><dd><p>Generalized bare lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi^0_{\bar{a}b\bar{c}d}(i\omega_{n=\mathrm{nw\_index}}, \mathbf{k})\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.bse.get_chi0_wnk">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.bse.</span></span><span class="sig-name descname"><span class="pre">get_chi0_wnk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#get_chi0_wnk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.bse.get_chi0_wnk" title="Link to this definition"></a></dt>
<dd><p>Compute the generalized bare lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi^{0}_{\bar{a}b\bar{c}d}(i\omega_n, i\nu_n, \mathbf{k})\)</span> from the single-particle
Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\nu_n, \mathbf{k})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g_wk</strong><span class="classifier">Gf,</span></dt><dd><p>Single-particle Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\nu_n, \mathbf{k})\)</span>.</p>
</dd>
<dt><strong>nw</strong><span class="classifier">int,</span></dt><dd><p>Number of bosonic frequencies in <span class="math notranslate nohighlight">\(\chi^0\)</span>.</p>
</dd>
<dt><strong>nwf</strong><span class="classifier">int,</span></dt><dd><p>Number of fermionic frequencies in <span class="math notranslate nohighlight">\(\chi^0\)</span>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>chi0_wnk</strong><span class="classifier">Gf,</span></dt><dd><p>Generalized bare lattice susceptibility
<span class="math notranslate nohighlight">\(\chi^{0}_{\bar{a}b\bar{c}d}(i\omega_n, i\nu_n, \mathbf{k})\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.bse.get_chi0_nk_at_specific_w">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.bse.</span></span><span class="sig-name descname"><span class="pre">get_chi0_nk_at_specific_w</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nw_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#get_chi0_nk_at_specific_w"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.bse.get_chi0_nk_at_specific_w" title="Link to this definition"></a></dt>
<dd><p>Compute the generalized bare lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi^{0}_{\bar{a}b\bar{c}d}(i\omega_{n=\mathrm{nw\_index}}, i\nu_n, \mathbf{k})\)</span> from the single-particle
Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\nu_n, \mathbf{k})\)</span> for a specific <span class="math notranslate nohighlight">\(i\omega_{n=\mathrm{nw\_index}}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g_wk</strong><span class="classifier">Gf,</span></dt><dd><p>Single-particle Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\nu_n, \mathbf{k})\)</span>.</p>
</dd>
<dt><strong>nw_index</strong><span class="classifier">int,</span></dt><dd><p>The bosonic Matsubara frequency index <span class="math notranslate nohighlight">\(i\omega_{n=\mathrm{nw\_index}}\)</span>
at which <span class="math notranslate nohighlight">\(\chi^0\)</span> is calculated.</p>
</dd>
<dt><strong>nwf</strong><span class="classifier">int,</span></dt><dd><p>Number of fermionic frequencies in <span class="math notranslate nohighlight">\(\chi^0\)</span>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>chi0_nk</strong><span class="classifier">Gf,</span></dt><dd><p>Generalized bare lattice susceptibility
<span class="math notranslate nohighlight">\(\chi^{0}_{\bar{a}b\bar{c}d}(i\omega_{n=\mathrm{nw\_index}}, i\nu_n, \mathbf{k})\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="dual-bethe-salpeter-equation">
<h1>Dual Bethe-Salpeter Equation<a class="headerlink" href="#dual-bethe-salpeter-equation" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.dbse.solve_lattice_dbse">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.dbse.</span></span><span class="sig-name descname"><span class="pre">solve_lattice_dbse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F_wnn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L_wn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi_imp_w</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/dbse.html#solve_lattice_dbse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.dbse.solve_lattice_dbse" title="Link to this definition"></a></dt>
<dd><p>Compute the generalized lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\mathbf{k}, \omega_n)\)</span> using the dual Bethe-Salpeter 
equation (DBSE).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g_wk</strong><span class="classifier">Gf,</span></dt><dd><p>Single-particle Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\nu_n, \mathbf{k})\)</span>.</p>
</dd>
<dt><strong>F_wnn</strong><span class="classifier">Gf,</span></dt><dd><p>Local particle-hole reducible vertex function 
<span class="math notranslate nohighlight">\(F_{a\bar{b}c\bar{d}}(i\omega_n, i\nu_n, i\nu_n')\)</span>.</p>
</dd>
<dt><strong>L_wn</strong><span class="classifier">Gf,</span></dt><dd><p>Local particle-hole reducible triangle vertex function 
<span class="math notranslate nohighlight">\(L_{a\bar{b}c\bar{d}}(i\omega_n, i\nu_n)\)</span>.</p>
</dd>
<dt><strong>chi_imp_w</strong><span class="classifier">Gf,</span></dt><dd><p>Generalized DMFT impurity susceptibility
<span class="math notranslate nohighlight">\(\chi_{a\bar{b}c\bar{d}}(i\omega_n)\)</span>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>chi_kw</strong><span class="classifier">Gf,</span></dt><dd><p>Generalized lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\mathbf{k}, i\omega_n)\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.dbse.impurity_reducible_vertex_F">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.dbse.</span></span><span class="sig-name descname"><span class="pre">impurity_reducible_vertex_F</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g2_wnn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/dbse.html#impurity_reducible_vertex_F"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.dbse.impurity_reducible_vertex_F" title="Link to this definition"></a></dt>
<dd><p>Compute the impurity reducible vertex function 
<span class="math notranslate nohighlight">\(F_{abcd}(\omega, \nu, \nu')\)</span>.</p>
<p>Computes:</p>
<div class="math notranslate nohighlight">
\[F_{abcd}(\omega, \nu, \nu') =  [\chi^{(0)}]^{-1} (\chi - \chi^{(0)} ) [\chi^{(0)}]^{-1} \]</div>
<p>where the inverses are taken in the particle-hole channel pairing
of fermionic frequencies <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(\nu'\)</span> and orbital
indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g_w</strong><span class="classifier">Single particle Green’s function</span></dt><dd><p><span class="math notranslate nohighlight">\(G_{ab}(\nu)\)</span></p>
</dd>
<dt><strong>g2_wnn</strong><span class="classifier">Two-particle Green’s function</span></dt><dd><p><span class="math notranslate nohighlight">\(G^{(2)}_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>F_wnn</strong><span class="classifier">Particle-hole reducible vertex function</span></dt><dd><p><span class="math notranslate nohighlight">\(F_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="gw-approximation">
<h1>GW approximation<a class="headerlink" href="#gw-approximation" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="triqs_tprf.gw_solver.GWSolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">triqs_tprf.gw_solver.</span></span><span class="sig-name descname"><span class="pre">GWSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_wk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bracket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/gw_solver.html#GWSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.gw_solver.GWSolver" title="Link to this definition"></a></dt>
<dd><p class="rubric">Methods</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>calc_real_freq</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>calc_real_space</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>calc_rho_k</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>calc_rho_loc</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>calc_rho_r</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>calc_total_density</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>dynamic_and_static_interaction</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>dyson_equation</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>fock_sigma</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_local_density_matrix</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>get_total_density</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>gw_dynamic_sigma</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>hartree_sigma</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>logo</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>polarization</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>screened_interaction</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>solve_iter</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>susceptibiltiy</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.dynamical_screened_interaction_W">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">dynamical_screened_interaction_W</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.dynamical_screened_interaction_W" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::chi_wk_cvt PI_wk, triqs_tprf::chi_k_cvt V_k) -&gt; triqs_tprf::chi_wk_t
Dynamical screened interaction <span class="math notranslate nohighlight">\(W(i\omega_n, \mathbf{k})\)</span> calculator for static momentum-dependent bare interactions <span class="math notranslate nohighlight">\(V(\mathbf{k})\)</span>.</p>
<blockquote>
<div><p>The full screened interaction <span class="math notranslate nohighlight">\(W(i\omega_n, \mathbf{k})\)</span>
is given by</p>
<div class="math notranslate nohighlight">
\[W^{(full)}_{abcd}(i\omega_n, \mathbf{k}) =
V_{abcd}(\mathbf{k}) +
 \sum_{efgh} V_{abef}(\mathbf{k}) \cdot
\Pi_{fegh}(i\omega_n, \mathbf{k}) \cdot
W^{(full)}_{hgcd}(i\omega_n, \mathbf{k})\]</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>PI_wk</strong></dt><dd><p>polarization bubble <span class="math notranslate nohighlight">\(\Pi_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
<dt><strong>V_k</strong></dt><dd><p>static bare interaction <span class="math notranslate nohighlight">\(V_{abcd}(\mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>dynamical screened interaction <span class="math notranslate nohighlight">\(W_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice.dynamical_screened_interaction_W_from_generalized_susceptibility">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></span><span class="sig-name descname"><span class="pre">dynamical_screened_interaction_W_from_generalized_susceptibility</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.dynamical_screened_interaction_W_from_generalized_susceptibility" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::chi_wk_cvt chi_wk, triqs_tprf::chi_k_cvt V_k) -&gt; triqs_tprf::chi_wk_t
Dynamical screened interaction <span class="math notranslate nohighlight">\(W(i\omega_n, \mathbf{k})\)</span> calculator for static momentum-dependent bare interactions <span class="math notranslate nohighlight">\(V(\mathbf{k})\)</span> and known generalized susceptibility <span class="math notranslate nohighlight">\(\chi(i\omega_n, \mathbf{k})\)</span></p>
<blockquote>
<div><p>The full screened interaction <span class="math notranslate nohighlight">\(W(i\omega_n, \mathbf{k})\)</span>
is given by</p>
<div class="math notranslate nohighlight">
\[W^{(full)}_{abcd}(i\omega_n, \mathbf{k}) =
V_{abcd}(\mathbf{k}) +
 \sum_{efgh} V_{abef}(\mathbf{k}) \cdot
\chi_{fegh}(i\omega_n, \mathbf{k}) \cdot
V_{hgcd}(\mathbf{k})\]</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chi_wk</strong></dt><dd><p>generalized susceptibility <span class="math notranslate nohighlight">\(\chi_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
<dt><strong>V_k</strong></dt><dd><p>static bare interaction <span class="math notranslate nohighlight">\(V_{abcd}(\mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>dynamical screened interaction <span class="math notranslate nohighlight">\(W_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.gw.bubble_PI_wk">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.gw.</span></span><span class="sig-name descname"><span class="pre">bubble_PI_wk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/gw.html#bubble_PI_wk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.gw.bubble_PI_wk" title="Link to this definition"></a></dt>
<dd><p>Compute the particle-hole bubble from the single particle lattice Green’s function</p>
<div class="math notranslate nohighlight">
\[\Pi_{abcd}(i\omega_n, k) = - 
\mathcal{F}_{\tau, \mathbf{r} \rightarrow i\omega_n, \mathbf{k}}
\left\{ G_{d\bar{a}}(\tau, \mathbf{r}) G_{b\bar{c}}(-\tau, -\mathbf{r}) \right\}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g_wk</strong><span class="classifier">TRIQS Green’s function (rank 2) on Matsubara and Brillouinzone meshes</span></dt><dd><p>Single particle lattice Green’s function.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>PI_wk</strong><span class="classifier">TRIQS Green’s function (rank 4) on Matsubara and Brillouinzone meshes</span></dt><dd><p>Particle hole bubble.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.gw.gw_sigma">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.gw.</span></span><span class="sig-name descname"><span class="pre">gw_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.gw.gw_sigma" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::chi_wk_cvt W_wk, triqs_tprf::g_wk_cvt g_wk) -&gt; triqs_tprf::g_wk_t
GW self energy <span class="math notranslate nohighlight">\(\Sigma(i\omega_n, \mathbf{k})\)</span> calculator for dynamic interactions</p>
<blockquote>
<div><p>Splits the interaction into a dynamic and a static part</p>
<div class="math notranslate nohighlight">
\[W_{abcd}(i\omega_n, \mathbf{k}) =
    W^{(dyn)}_{abcd}(i\omega_n, \mathbf{k})
    + V_{abcd}(\mathbf{k})\]</div>
<p>by fitting the high-frequency tail.</p>
<p>Fourier transforms the dynamic part of the interaction and the
single-particle Green’s function to imaginary time and real space.</p>
<div class="math notranslate nohighlight">
\[G_{ab}(\tau, \mathbf{r}) = \mathcal{F}^{-1}
  \left\{ G_{ab}(i\omega_n, \mathbf{k}) \right\}\]</div>
<div class="math notranslate nohighlight">
\[W^{(dyn)}_{abcd}(\tau, \mathbf{r}) = \mathcal{F}^{-1}
  \left\{ W^{(dyn)}_{abcd}(i\omega_n, \mathbf{k}) \right\}\]</div>
<p>computes the GW self-energy as the product</p>
<div class="math notranslate nohighlight">
\[\Sigma^{(dyn)}_{ab}(\tau, \mathbf{r}) =
  - \sum_{cd} W^{(dyn)}_{abcd}(\tau, \mathbf{r}) G_{cd}(\tau, \mathbf{r})\]</div>
<p>and transforms back to frequency and momentum</p>
<div class="math notranslate nohighlight">
\[\Sigma^{(dyn)}_{ab}(i\omega_n, \mathbf{k}) =
  \mathcal{F} \left\{ \Sigma^{(dyn)}_{ab}(\tau, \mathbf{r}) \right\}\]</div>
<p>The self-energy of the static part of the interaction is calculated
as the sum</p>
<div class="math notranslate nohighlight">
\[\Sigma^{(stat)}_{ab}(\mathbf{k}) = -\frac{1}{N_k}
  \sum_{\mathbf{q}} V_{abab}(\mathbf{k}) \rho(G(i\omega_n, \mathbf{k+q}))_{ab}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho(G(i\omega_n, \mathbf{k+q}))\)</span> is the density matrix of the
single particle Green’s function.</p>
<p>The total GW self-energy is given by</p>
<div class="math notranslate nohighlight">
\[\Sigma_{ab}(i\omega_n, \mathbf{k}) =
  \Sigma^{(dyn)}_{ab}(i\omega_n, \mathbf{k})
  + \Sigma^{(stat)}_{ab}(\mathbf{k})\]</div>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>W_wk</strong></dt><dd><p>interaction <span class="math notranslate nohighlight">\(W_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
<dt><strong>g_wk</strong></dt><dd><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>GW self-energy <span class="math notranslate nohighlight">\(\Sigma_{ab}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.gw.g0w_sigma">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.gw.</span></span><span class="sig-name descname"><span class="pre">g0w_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.gw.g0w_sigma" title="Link to this definition"></a></dt>
<dd><p>Signature : (float mu, float beta, triqs_tprf::e_k_cvt e_k, triqs_tprf::chi_k_cvt v_k, mesh::brzone::value_t kpoint) -&gt; array&lt;std::complex&lt;double&gt;, 2&gt;
Add some docs</p>
</dd></dl>

</section>
<section id="linearized-eliashberg-equation">
<h1>Linearized Eliashberg equation<a class="headerlink" href="#linearized-eliashberg-equation" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.eliashberg.solve_eliashberg">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></span><span class="sig-name descname"><span class="pre">solve_eliashberg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Gamma_pp_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_delta=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gamma_pp_const_k=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol=1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">product='FFT'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver='IRAM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetrize_fct=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k=6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#solve_eliashberg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.solve_eliashberg" title="Link to this definition"></a></dt>
<dd><p>Solve the linearized Eliashberg equation</p>
<p>Returns the biggest eigenvalues and corresponding eigenvectors of the linearized Eliashberg
equation, for a particle-particle vertex in the random phase approximation,
as described here <a class="reference internal" href="../theory/eliashberg.html#eliashberg-rpa"><span class="std std-ref">Random phase approximation for the irreducible particle-particle vertex</span></a>. The Eliashberg equation implementation is
using fourier transformations for computational efficiency. The eigenvalues are found
using an iterative algorithm from scipy.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>Gamma_pp_wk</strong><span class="classifier">Gf,</span></dt><dd><p>Pairing vertex <span class="math notranslate nohighlight">\(\Gamma(i\omega_n, \mathbf{k})\)</span>. The mesh attribute of
the Gf must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</dd>
<dt><strong>g_wk</strong><span class="classifier">Gf,</span></dt><dd><p>Green’s function <span class="math notranslate nohighlight">\(G(i\nu_n, \mathbf{k})\)</span>. The mesh attribute of the Gf must
be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</dd>
<dt><strong>initial_delta</strong><span class="classifier">Gf, optional</span></dt><dd><p>An initial anomalous self-energy <span class="math notranslate nohighlight">\(\Delta(i\nu_n, \mathbf{k})\)</span> to start
an iterative solver, given as a Gf with MeshProduct with the components
(MeshImFreq, MeshBrZone).
If not given <a class="reference internal" href="#triqs_tprf.eliashberg.semi_random_initial_delta" title="triqs_tprf.eliashberg.semi_random_initial_delta"><code class="xref py py-func docutils literal notranslate"><span class="pre">semi_random_initial_delta()</span></code></a> will be called.</p>
</dd>
<dt><strong>Gamma_pp_const_k</strong><span class="classifier">float or np.ndarray or Gf, optional</span></dt><dd><p>Part of the pairing vertex that is constant in Matsubara frequency space
<span class="math notranslate nohighlight">\(\Gamma(\mathbf{k})\)</span>. If given as a Gf its mesh attribute needs to
be a MeshBrZone. If not given, the constant part will be fitted.</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float, optional</span></dt><dd><p>Relative accuracy for eigenvalues (stopping criterion).</p>
</dd>
<dt><strong>product</strong><span class="classifier">str, [‘FFT’, ‘SUM’], optional</span></dt><dd><p>Which function of the Eliashberg product shall be used:</p>
<blockquote>
<div><dl class="simple">
<dt>‘FFT’<span class="classifier">triqs_tprf.lattice.eliashberg_product_fft,</span></dt><dd><p>which uses Fourier transformation for optimal computational efficiency.</p>
</dd>
<dt>‘SUM’<span class="classifier">triqs_tprf.lattice.eliashberg_product, uses the explicit sum.</span></dt><dd><p>Restrictions : wmesh of Gamma_pp_wk must be atleast twice the size of the one of g_wk.</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt><strong>solver</strong><span class="classifier">str, [‘IRAM’, ‘PM’], optional</span></dt><dd><p>Which eigenvalue solver shall be used:</p>
<blockquote>
<div><p>‘IRAM’ : Use the Implicitly Restarted Arnoldi Method implemented in <a class="reference internal" href="#triqs_tprf.eliashberg.implicitly_restarted_arnoldi_method" title="triqs_tprf.eliashberg.implicitly_restarted_arnoldi_method"><code class="xref py py-func docutils literal notranslate"><span class="pre">implicitly_restarted_arnoldi_method()</span></code></a>.</p>
<p>‘PM’ : Use the Power Method implemented in <a class="reference internal" href="#triqs_tprf.eliashberg.power_method_LR" title="triqs_tprf.eliashberg.power_method_LR"><code class="xref py py-func docutils literal notranslate"><span class="pre">power_method_LR()</span></code></a>.</p>
</div></blockquote>
</dd>
<dt><strong>symmetrize_fct</strong><span class="classifier">function, optional</span></dt><dd><p>A function that takes one parameter: A Green’s function 
<span class="math notranslate nohighlight">\(G(i\nu_n, \mathbf{k})\)</span>. The mesh attribute of the
Gf must be a MeshProduct with the components 
(MeshImFreq, MeshBrZone).
This function is applied after every iteration of the
eigenvalue solver and can be used to enforce a specific
symmetry. If no symmetries are enforced, caution is need, because
unphysical symmetries can occur.</p>
</dd>
<dt><strong>k</strong><span class="classifier">int, optional</span></dt><dd><p>The number of leading superconducting gaps that shall be calculated. Does
only have an effect, if ‘IRAM’ is used as a solver.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Es</strong><span class="classifier">list of float,</span></dt><dd><p>Biggest eigenvalues of the linearized Eliashberg equation <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</dd>
<dt><strong>eigen_modes</strong><span class="classifier">list of Gf,</span></dt><dd><p>Corresponding eigenvectors (anomalous self-energies) 
<span class="math notranslate nohighlight">\(\Delta(i\nu_n, \mathbf{k})\)</span> as Gf with MeshProduct with the components
(MeshImFreq, MeshBrZone).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../theory/eliashberg.html#eliashberg"><span class="std std-ref">Linearized Eliashberg Equation</span></a></dt><dd><p>Theory of the linearized Eliashberg equation.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.eliashberg.preprocess_gamma_for_fft">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></span><span class="sig-name descname"><span class="pre">preprocess_gamma_for_fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Gamma_pp_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gamma_pp_const_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#preprocess_gamma_for_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.preprocess_gamma_for_fft" title="Link to this definition"></a></dt>
<dd><p>Prepare Gamma to be used with the FFT implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>Gamma_pp_wk</strong><span class="classifier">Gf,</span></dt><dd><p>Pairing vertex <span class="math notranslate nohighlight">\(\Gamma(i\omega_n, \mathbf{k})\)</span>. The mesh attribute of
the Gf must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</dd>
<dt><strong>Gamma_pp_const_k</strong><span class="classifier">float or np.ndarray or Gf</span></dt><dd><p>Part of the pairing vertex that is constant in Matsubara frequency space
<span class="math notranslate nohighlight">\(\Gamma(\mathbf{k})\)</span>. If given as a Gf its mesh attribute needs to
be a MeshBrZone. If not given, the constant part will be fitted.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Gamma_pp_dyn_tr</strong><span class="classifier">Gf,</span></dt><dd><p>The dynamic part of Gamma, which converges to zero for
<span class="math notranslate nohighlight">\(\omega_n \rightarrow \infty\)</span>, but now in <span class="math notranslate nohighlight">\(\tau\)</span>-space.
Its mesh attribute is MeshProduct with the components
(MeshImTime, MeshCycLat).</p>
</dd>
<dt><strong>Gamma_pp_const_r</strong><span class="classifier">Gf,</span></dt><dd><p>The constant part of Gamma with mesh attribute MeshCycLat.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.eliashberg.semi_random_initial_delta">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></span><span class="sig-name descname"><span class="pre">semi_random_initial_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#semi_random_initial_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.semi_random_initial_delta" title="Link to this definition"></a></dt>
<dd><p>Create a delta based on the GF with random elements</p>
<p>Returns an anomalous self-energy that can be used as an inital input for the iterative
solvers. The momentum space is random, while the Matsubara space is only partialy 
randomized to ensure working tail fits for the Fourier transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g_wk</strong><span class="classifier">Gf,</span></dt><dd><p>Green’s function <span class="math notranslate nohighlight">\(G(i\nu_n, \mathbf{k})\)</span>. The mesh attribute of the Gf must
be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</dd>
<dt><strong>nr_factor</strong><span class="classifier">float, optional</span></dt><dd><p>Percentage of <span class="math notranslate nohighlight">\(\omega\)</span> points which shall not be randomized. This is needed
to assure a working tail fit for the Fourier transformations. The default is 0.5,
meaning that 50% of the <span class="math notranslate nohighlight">\(\omega\)</span> points will not be randomized.</p>
</dd>
<dt><strong>seed</strong><span class="classifier">int, optional</span></dt><dd><p>Set a np.random.seed to enforce predictable results.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>delta</strong><span class="classifier">Gf,</span></dt><dd><p>An initial anomalous self-energy <span class="math notranslate nohighlight">\(\Delta(i\nu_n, \mathbf{k})\)</span> to start
an iterative solver, given as a Gf with MeshProduct with the components
(MeshImFreq, MeshBrZone).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.eliashberg.power_method_LR">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></span><span class="sig-name descname"><span class="pre">power_method_LR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#power_method_LR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.power_method_LR" title="Link to this definition"></a></dt>
<dd><p>Find the eigenvalue with the largest real value via the power method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>matvec</strong><span class="classifier">callable f(v),</span></dt><dd><p>Returns A*v.</p>
</dd>
<dt><strong>init</strong><span class="classifier">np.ndarray,</span></dt><dd><p>The array representation of the anomalous self-energy to start the iterative
method with. Restriction: len(init.shape) == 1.</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float, optional</span></dt><dd><p>The tolerance at which the iterative scheme is considered to be converged.</p>
</dd>
<dt><strong>max_it</strong><span class="classifier">float, optional</span></dt><dd><p>The maximum number of iterations that shall be done before a error is raised.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>norm</strong><span class="classifier">float,</span></dt><dd><p>The eigenvalue with the largest positive real part.</p>
</dd>
<dt><strong>v_k</strong><span class="classifier">np.ndarray,</span></dt><dd><p>The corresponding eigenvector.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.eliashberg.implicitly_restarted_arnoldi_method">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></span><span class="sig-name descname"><span class="pre">implicitly_restarted_arnoldi_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#implicitly_restarted_arnoldi_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.implicitly_restarted_arnoldi_method" title="Link to this definition"></a></dt>
<dd><p>Find the eigenvalue with the largest real value via the Implicitly Restarted 
Arnoldi Method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>matvec</strong><span class="classifier">callable f(v),</span></dt><dd><p>Returns A*v.</p>
</dd>
<dt><strong>init</strong><span class="classifier">np.ndarray,</span></dt><dd><p>The array representation of the anomalous self-energy to start the iterative
method with. Restriction: len(init.shape) == 1.</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float, optional</span></dt><dd><p>The tolerance at which the iterative scheme is considered to be converged.</p>
</dd>
<dt><strong>k</strong><span class="classifier">int, optional</span></dt><dd><p>The number of eigenvalues and eigenvectors desired.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Es</strong><span class="classifier">list of float,</span></dt><dd><p>The eigenvalues with the largest positive real part.</p>
</dd>
<dt><strong>U</strong><span class="classifier">list of np.ndarray,</span></dt><dd><p>The corresponding eigenvectors.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.sparse.linalg.eigs.html" rel="noopener noreferrer" target="_blank">scipy.sparse.linalg.eigs</a></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.LinearOperator.html" rel="noopener noreferrer" target="_blank">scipy.sparse.linalg.LinearOperator</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.eliashberg.construct_gamma_singlet_rpa">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></span><span class="sig-name descname"><span class="pre">construct_gamma_singlet_rpa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_d_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_m_wk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#construct_gamma_singlet_rpa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.construct_gamma_singlet_rpa" title="Link to this definition"></a></dt>
<dd><p>Construct the irreducible singlet vertex in the RPA limit</p>
<p>The irreducible singlet vertex in the random phase approximation limit for a
symmetrized calculations of the Eliashberg equation is given by</p>
<div class="math notranslate nohighlight">
\[\Gamma^{\text{s}}_{a\overline{b}c\overline{d}}(Q=0, K, K') \equiv
\frac{1}{2}U_{a\overline{b}c\overline{d}}^{\mathrm{d}}
+
\frac{3}{2}U_{a\overline{b}c\overline{d}}^{\mathrm{m}}
+
\text{Complex Conjugate}
\left[
3 
\Phi^{\text{m}}_{c\overline{b}a\overline{d}}(K-K')
-
\Phi^{\text{d}}_{c\overline{b}a\overline{d}}(K-K')
\right]
\,.\]</div>
<p>For more details see <a class="reference internal" href="../theory/eliashberg.html#eliashberg"><span class="std std-ref">Linearized Eliashberg Equation</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>U_d</strong><span class="classifier">np.ndarray,</span></dt><dd><p>The local static interaction in the density channel.</p>
</dd>
<dt><strong>U_m</strong><span class="classifier">np.ndarray,</span></dt><dd><p>The local static interaction in the magnetic channel.</p>
</dd>
<dt><strong>phi_d_wk</strong><span class="classifier">Gf,</span></dt><dd><p>The reducible ladder vertex in the density channel
<span class="math notranslate nohighlight">\(\Phi^{\mathrm{d}}(i\omega_n, \mathbf{q})\)</span>. The mesh attribute of the Gf
must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</dd>
<dt><strong>phi_m_wk</strong><span class="classifier">Gf,</span></dt><dd><p>The reducible ladder vertex in the magnetic channel
<span class="math notranslate nohighlight">\(\Phi^{\mathrm{m}}(i\omega_n, \mathbf{q})\)</span>. The mesh attribute of the Gf
must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>gamma_singlet</strong><span class="classifier">Gf,</span></dt><dd><p>The irreducible singlet vertex in the RPA limit for a symmetrized
calculation of the Eliashberg equation
<span class="math notranslate nohighlight">\(\Gamma^{\mathrm{s}}(i\omega_n,\mathbf{q})\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.eliashberg.construct_gamma_triplet_rpa">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></span><span class="sig-name descname"><span class="pre">construct_gamma_triplet_rpa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_d_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_m_wk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#construct_gamma_triplet_rpa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.construct_gamma_triplet_rpa" title="Link to this definition"></a></dt>
<dd><p>Construct the irreducible triplet vertex in the RPA limit</p>
<p>The irreducible triplet vertex in the random phase approximation limit for a
symmetrized calculations of the Eliashberg equation is given by</p>
<div class="math notranslate nohighlight">
\[\Gamma^{\text{t}}_{a\overline{b}c\overline{d}}(Q=0, K, K') \equiv
-
\frac{1}{2}U_{a\overline{b}c\overline{d}}^{\mathrm{d}}
+
\frac{1}{2}U_{a\overline{b}c\overline{d}}^{\mathrm{m}} 
+
\text{Complex Conjuate}
\left[
-
\Phi^{\text{m}}_{c\overline{b}a\overline{d}}(K-K')
-
\Phi^{\text{d}}_{c\overline{b}a\overline{d}}(K-K')
\right]
\,.\]</div>
<p>For more details see <a class="reference internal" href="../theory/eliashberg.html#eliashberg"><span class="std std-ref">Linearized Eliashberg Equation</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>U_d</strong><span class="classifier">np.ndarray,</span></dt><dd><p>The local static interaction in the density channel.</p>
</dd>
<dt><strong>U_m</strong><span class="classifier">np.ndarray,</span></dt><dd><p>The local static interaction in the magnetic channel.</p>
</dd>
<dt><strong>phi_d_wk</strong><span class="classifier">Gf,</span></dt><dd><p>The reducible ladder vertex in the density channel
<span class="math notranslate nohighlight">\(\Phi^{\mathrm{d}}(i\omega_n, \mathbf{q})\)</span>. The mesh attribute of the Gf
must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</dd>
<dt><strong>phi_m_wk</strong><span class="classifier">Gf,</span></dt><dd><p>The reducible ladder vertex in the magnetic channel
<span class="math notranslate nohighlight">\(\Phi^{\mathrm{m}}(i\omega_n, \mathbf{q})\)</span>. The mesh attribute of the Gf
must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>gamma_triplet</strong><span class="classifier">Gf,</span></dt><dd><p>The irreducible triplet vertex in the RPA limit for a symmetrized
calculation of the Eliashberg equation
<span class="math notranslate nohighlight">\(\Gamma^{\mathrm{t}}(i\omega_n,\mathbf{q})\)</span>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="hubbard-atom-analytic-response-functions">
<h1>Hubbard atom analytic response functions<a class="headerlink" href="#hubbard-atom-analytic-response-functions" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.analytic_hubbard_atom.analytic_hubbard_atom">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.analytic_hubbard_atom.</span></span><span class="sig-name descname"><span class="pre">analytic_hubbard_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwf_gf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/analytic_hubbard_atom.html#analytic_hubbard_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.analytic_hubbard_atom.analytic_hubbard_atom" title="Link to this definition"></a></dt>
<dd><p>Compute dynamical response functions for the Hubbard atom at half filling.</p>
<p>This function returns an object that contains the single-particle
Greens function <span class="math notranslate nohighlight">\(G(\omega)\)</span>, the magnetic two-particle generalized susceptibility
<span class="math notranslate nohighlight">\(\chi_m(\omega, \nu, \nu')\)</span>, and the corresponding bare bubble 
<span class="math notranslate nohighlight">\(\chi^{(0)}_m(\omega, \nu, \nu')\)</span>, and the magnetic vertex function
<span class="math notranslate nohighlight">\(\Gamma_m(\omega, \nu, \nu')\)</span>.</p>
<p>This is implemented using analytical formulas from 
Thunstrom et al. [PRB 98, 235107 (2018)]
please cite the paper if you use this function!</p>
<p>In particular this is one exact solution to the Bethe-Salpeter
equation, that is the infinite matrix inverse problem:</p>
<div class="math notranslate nohighlight">
\[\Gamma_m = [\chi^{(0)}_m]^{-1} - \chi_m^{-1}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>beta</strong><span class="classifier">float</span></dt><dd><p>Inverse temperature.</p>
</dd>
<dt><strong>U</strong><span class="classifier">float</span></dt><dd><p>Hubbard U interaction parameter.</p>
</dd>
<dt><strong>nw</strong><span class="classifier">int</span></dt><dd><p>Number of bosonic Matsubara frequencies 
in the computed two-particle response functions.</p>
</dd>
<dt><strong>nwf</strong><span class="classifier">int</span></dt><dd><p>Number of fermionic Matsubara frequencies
in the computed two-particle response functions.</p>
</dd>
<dt><strong>nwf_gf</strong><span class="classifier">int</span></dt><dd><p>Number of fermionic Matsubara frequencies
in the computed single-particle Greens function.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>p</strong><span class="classifier">ParameterCollection</span></dt><dd><p>Object containing all the response functions and some other
observables, <cite>p.G_iw</cite>, <cite>p.chi_m</cite>, <cite>p.chi0_m</cite>, 
<cite>p.gamma_m</cite>, <cite>p.Z</cite>, <cite>p.m2</cite>, <cite>p.chi_m_static</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="two-particle-response-function-linear-algebra-operations">
<h1>Two-particle response function linear-algebra operations<a class="headerlink" href="#two-particle-response-function-linear-algebra-operations" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.linalg.inverse_PH">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></span><span class="sig-name descname"><span class="pre">inverse_PH</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.inverse_PH" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t
Two-particle response-function inversion <span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the particle-hole channel (PH).</p>
<blockquote>
<div><p>The two-particle response function <span class="math notranslate nohighlight">\(g_{abcd}(\omega, \nu, \nu')\)</span>
is cast to matrix form and inverted</p>
<div class="math notranslate nohighlight">
\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g</strong></dt><dd><p>two-particle response function to invert, <span class="math notranslate nohighlight">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p><span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the given channel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.linalg.inverse_PP">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></span><span class="sig-name descname"><span class="pre">inverse_PP</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.inverse_PP" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t
Two-particle response-function inversion <span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the particle-particle channel (PP).</p>
<blockquote>
<div><p>The two-particle response function <span class="math notranslate nohighlight">\(g_{abcd}(\omega, \nu, \nu')\)</span>
is cast to matrix form and inverted</p>
<div class="math notranslate nohighlight">
\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g</strong></dt><dd><p>two-particle response function to invert, <span class="math notranslate nohighlight">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p><span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the given channel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.linalg.inverse_PH_bar">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></span><span class="sig-name descname"><span class="pre">inverse_PH_bar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.inverse_PH_bar" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t
Two-particle response-function inversion <span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote>
<div><p>The two-particle response function <span class="math notranslate nohighlight">\(g_{abcd}(\omega, \nu, \nu')\)</span>
is cast to matrix form and inverted</p>
<div class="math notranslate nohighlight">
\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>g</strong></dt><dd><p>two-particle response function to invert, <span class="math notranslate nohighlight">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p><span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the given channel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.linalg.product_PH">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></span><span class="sig-name descname"><span class="pre">product_PH</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.product_PH" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g2_iw_vt A, triqs_tprf::g2_iw_vt B) -&gt; triqs_tprf::g2_iw_t
Two-particle response-function product <span class="math notranslate nohighlight">\(A * B\)</span> in the particle-hole channel (PH).</p>
<blockquote>
<div><p>The two-particle response functions <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
and <span class="math notranslate nohighlight">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math notranslate nohighlight">
\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
= \sum_{\bar{\nu}ab}
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega)
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega)\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>A</strong></dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
<dt><strong>B</strong></dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p><span class="math notranslate nohighlight">\((A * B)\)</span> in the given channel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.linalg.product_PP">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></span><span class="sig-name descname"><span class="pre">product_PP</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.product_PP" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g2_iw_vt A, triqs_tprf::g2_iw_vt B) -&gt; triqs_tprf::g2_iw_t
Two-particle response-function product <span class="math notranslate nohighlight">\(A * B\)</span> in the particle-particle channel (PP).</p>
<blockquote>
<div><p>The two-particle response functions <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
and <span class="math notranslate nohighlight">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math notranslate nohighlight">
\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
= \sum_{\bar{\nu}ab}
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega)
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega)\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>A</strong></dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
<dt><strong>B</strong></dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p><span class="math notranslate nohighlight">\((A * B)\)</span> in the given channel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.linalg.product_PH_bar">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></span><span class="sig-name descname"><span class="pre">product_PH_bar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.product_PH_bar" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g2_iw_vt A, triqs_tprf::g2_iw_vt B) -&gt; triqs_tprf::g2_iw_t
Two-particle response-function product <span class="math notranslate nohighlight">\(A * B\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote>
<div><p>The two-particle response functions <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
and <span class="math notranslate nohighlight">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math notranslate nohighlight">
\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
= \sum_{\bar{\nu}ab}
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega)
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega)\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>A</strong></dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
<dt><strong>B</strong></dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p><span class="math notranslate nohighlight">\((A * B)\)</span> in the given channel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.linalg.identity_PH">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></span><span class="sig-name descname"><span class="pre">identity_PH</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.identity_PH" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t
Two-particle response-function identity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span> in the particle-hole channel (PH).</p>
<blockquote>
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math notranslate nohighlight">
\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
\equiv
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>A</strong></dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>the unity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span>, in the given channel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.linalg.identity_PP">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></span><span class="sig-name descname"><span class="pre">identity_PP</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.identity_PP" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t
Two-particle response-function identity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span> in the particle-particle channel (PP).</p>
<blockquote>
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math notranslate nohighlight">
\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
\equiv
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>A</strong></dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>the unity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span>, in the given channel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.linalg.identity_PH_bar">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></span><span class="sig-name descname"><span class="pre">identity_PH_bar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.identity_PH_bar" title="Link to this definition"></a></dt>
<dd><p>Signature : (triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t
Two-particle response-function identity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote>
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math notranslate nohighlight">
\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
\equiv
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>A</strong></dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>out</dt><dd><p>the unity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span>, in the given channel</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="wannier90-tight-binding-parsers">
<h1>Wannier90 tight binding parsers<a class="headerlink" href="#wannier90-tight-binding-parsers" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.wannier90.parse_hopping_from_wannier90_hr_dat">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.wannier90.</span></span><span class="sig-name descname"><span class="pre">parse_hopping_from_wannier90_hr_dat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_hopping_from_wannier90_hr_dat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_hopping_from_wannier90_hr_dat" title="Link to this definition"></a></dt>
<dd><p>Wannier90 real space hopping parser of <code class="docutils literal notranslate"><span class="pre">*_hr.dat</span></code> files.</p>
<p>Returns a dictionary where the keys are the real-space hopping vectors, 
in terms of multiples of the lattice vectors, and the values are
<code class="docutils literal notranslate"><span class="pre">num_wann</span> <span class="pre">*</span> <span class="pre">num_wann</span></code> numpy ndarrays with the hopping integrals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Wannier90 <code class="docutils literal notranslate"><span class="pre">*_hr.dat</span></code> file to parse.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hopp_dict</strong><span class="classifier">dict</span></dt><dd><p>Dictionary of real space hoppings.</p>
</dd>
<dt><strong>num_wann</strong><span class="classifier">int</span></dt><dd><p>Total number of Wannier functions per unit-cell.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.wannier90.parse_lattice_vectors_from_wannier90_wout">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.wannier90.</span></span><span class="sig-name descname"><span class="pre">parse_lattice_vectors_from_wannier90_wout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_lattice_vectors_from_wannier90_wout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_lattice_vectors_from_wannier90_wout" title="Link to this definition"></a></dt>
<dd><p>Wannier90 real space lattice vectors parser of <code class="docutils literal notranslate"><span class="pre">*.wout</span></code> files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Wannier90 <code class="docutils literal notranslate"><span class="pre">*.wout</span></code> file to parse.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>vectors</strong><span class="classifier">list of three three-tuples of floats</span></dt><dd><p>Lattice vectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.wannier90.parse_reciprocal_lattice_vectors_from_wannier90_wout">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.wannier90.</span></span><span class="sig-name descname"><span class="pre">parse_reciprocal_lattice_vectors_from_wannier90_wout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_reciprocal_lattice_vectors_from_wannier90_wout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_reciprocal_lattice_vectors_from_wannier90_wout" title="Link to this definition"></a></dt>
<dd><p>Wannier90 reciprocal space lattice vectors parser of <code class="docutils literal notranslate"><span class="pre">*.wout</span></code> files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Wannier90 <code class="docutils literal notranslate"><span class="pre">*.wout</span></code> file to parse.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>vectors</strong><span class="classifier">list of three three-tuples of floats</span></dt><dd><p>Reciprocal lattice vectors.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.wannier90.parse_band_structure_from_wannier90_band_dat">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.wannier90.</span></span><span class="sig-name descname"><span class="pre">parse_band_structure_from_wannier90_band_dat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_band_structure_from_wannier90_band_dat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_band_structure_from_wannier90_band_dat" title="Link to this definition"></a></dt>
<dd><p>Wannier90 band structure parser of <code class="docutils literal notranslate"><span class="pre">*_band.dat`</span></code> files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Wannier90 <code class="docutils literal notranslate"><span class="pre">*_band.dat</span></code> file to parse.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>E</strong><span class="classifier">ndarray (2D)</span></dt><dd><p>Band energies.</p>
</dd>
<dt><strong>w</strong><span class="classifier">ndarray (1D)</span></dt><dd><p>k-space path points.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="tight-binding-lattice-model">
<h1>Tight binding lattice model<a class="headerlink" href="#tight-binding-lattice-model" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">triqs_tprf.tight_binding.</span></span><span class="sig-name descname"><span class="pre">TBLattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hoppings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(0,</span> <span class="pre">0,</span> <span class="pre">0)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/tight_binding.html#TBLattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice" title="Link to this definition"></a></dt>
<dd><p>Class describing a tight binding hamiltonian on top of a bravais lattice.
Has objects of type BravaisLattice, BrillouinZone and TightBinding as attributes,
and exposes part of their interfaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>bl</strong><span class="classifier">BravaisLattice</span></dt><dd><p>The associated Bravais Lattice</p>
</dd>
<dt><strong>bz</strong><span class="classifier">BrillouinZone</span></dt><dd><p>The associated Brillouin Zone</p>
</dd>
<dt><strong>tb</strong><span class="classifier">TightBinding</span></dt><dd><p>The tight-binding Hamiltonian</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.dispersion" title="triqs_tprf.tight_binding.TBLattice.dispersion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dispersion</span></code></a>(arg)</p></td>
<td><p>Signature : (k_cvt K) -&gt; nda::array&lt;double, 1&gt; Evaluate the dispersion relation for a momentum vector k in units of the reciprocal lattice vectors</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.fourier" title="triqs_tprf.tight_binding.TBLattice.fourier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fourier</span></code></a>(arg)</p></td>
<td><p>Signature : (k_cvt K) -&gt; matrix&lt;dcomplex&gt; Evaluate the fourier transform for a momentum vector k in units of the reciprocal lattice vectors</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.get_kmesh" title="triqs_tprf.tight_binding.TBLattice.get_kmesh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_kmesh</span></code></a>(n_k)</p></td>
<td><p>Return a mesh on the Brillouin zone with a given discretization</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.get_rmesh" title="triqs_tprf.tight_binding.TBLattice.get_rmesh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_rmesh</span></code></a>(n_r)</p></td>
<td><p>Return a mesh on the Bravais lattice with a given periodicity</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.tight_binding.TBLattice.lattice_to_real_coordinates" title="triqs_tprf.tight_binding.TBLattice.lattice_to_real_coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice_to_real_coordinates</span></code></a>(x)</p></td>
<td><p>Signature : (r_t x) -&gt; r_t Transform into real coordinates.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.dispersion">
<span class="sig-name descname"><span class="pre">dispersion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/tight_binding.html#TBLattice.dispersion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.dispersion" title="Link to this definition"></a></dt>
<dd><p>Signature : (k_cvt K) -&gt; nda::array&lt;double, 1&gt;
Evaluate the dispersion relation for a momentum vector k in units of the reciprocal lattice vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.fourier">
<span class="sig-name descname"><span class="pre">fourier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/tight_binding.html#TBLattice.fourier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.fourier" title="Link to this definition"></a></dt>
<dd><p>Signature : (k_cvt K) -&gt; matrix&lt;dcomplex&gt;
Evaluate the fourier transform for a momentum vector k in units of the reciprocal lattice vectors</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.get_kmesh">
<span class="sig-name descname"><span class="pre">get_kmesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/tight_binding.html#TBLattice.get_kmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.get_kmesh" title="Link to this definition"></a></dt>
<dd><p>Return a mesh on the Brillouin zone with a given discretization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_k</strong><span class="classifier">int or three-tuple of int</span></dt><dd><p>The linear dimension(s)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>MeshBrZone</dt><dd><p>The mesh on the Brillouin zone</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.get_rmesh">
<span class="sig-name descname"><span class="pre">get_rmesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/tight_binding.html#TBLattice.get_rmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.get_rmesh" title="Link to this definition"></a></dt>
<dd><p>Return a mesh on the Bravais lattice with a given periodicity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>n_r</strong><span class="classifier">int or three-tuple of int</span></dt><dd><p>The periodicity in each dimension</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>MeshCycLat</dt><dd><p>The cyclic lattice mesh</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.lattice_to_real_coordinates">
<span class="sig-name descname"><span class="pre">lattice_to_real_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/tight_binding.html#TBLattice.lattice_to_real_coordinates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.lattice_to_real_coordinates" title="Link to this definition"></a></dt>
<dd><p>Signature : (r_t x) -&gt; r_t
Transform into real coordinates.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.n_orbitals">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_orbitals</span></span><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.n_orbitals" title="Link to this definition"></a></dt>
<dd><p>Number of orbitals in the unit cell</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.ndim">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndim</span></span><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.ndim" title="Link to this definition"></a></dt>
<dd><p>Number of dimensions of the lattice</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.orbital_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orbital_names</span></span><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.orbital_names" title="Link to this definition"></a></dt>
<dd><p>The list of orbital names</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.orbital_positions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orbital_positions</span></span><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.orbital_positions" title="Link to this definition"></a></dt>
<dd><p>The list of orbital positions</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.TBLattice.units">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">units</span></span><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.units" title="Link to this definition"></a></dt>
<dd><p>Number of dimensions of the lattice</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.tight_binding.create_square_lattice">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.tight_binding.</span></span><span class="sig-name descname"><span class="pre">create_square_lattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeeman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/tight_binding.html#create_square_lattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.create_square_lattice" title="Link to this definition"></a></dt>
<dd><p>Retuns TBLattice that represents a model on a square lattice</p>
<p>The model is described by the Hamiltonian</p>
<div class="math notranslate nohighlight">
\[H=-t \sum_{\langle j, l\rangle \sigma}\left(c_{j \sigma}^{\dagger}
c_{l \sigma}+c_{l \sigma}^{\dagger} c_{j \sigma}\right) -
t' \sum_{\langle\langle j, l\rangle\rangle \sigma}\left(c_{j \sigma}^{\dagger}
c_{l \sigma}+c_{l \sigma}^{\dagger} c_{j \sigma}\right) +
\xi \sum_j \left(n_{j \uparrow} - n_{j \downarrow} \right)\,,\]</div>
<p>where the angular bracket describes a sum over nearest neighbors and the double
angular bracket over next-nearest neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>norb</strong><span class="classifier">int,</span></dt><dd><p>Number of orbitals excluding spin</p>
</dd>
<dt><strong>t</strong><span class="classifier">complex,</span></dt><dd><p>Kinetic energy of nearest neighbor hopping.
Corresponds to <span class="math notranslate nohighlight">\(t\)</span>.</p>
</dd>
<dt><strong>tp</strong><span class="classifier">complex, optional</span></dt><dd><p>Kinetic energy of next-nearest neighbor hopping.
Corresponds to <span class="math notranslate nohighlight">\(t'\)</span>.</p>
</dd>
<dt><strong>zeeman</strong><span class="classifier">complex, optional</span></dt><dd><p>Strength of Zeeman term.
Corresponds to <span class="math notranslate nohighlight">\(\xi\)</span>.</p>
</dd>
<dt><strong>spin</strong><span class="classifier">bool,</span></dt><dd><p>True if spin index should be used explicitly, False otherwise.
The Zeeman term can only be applied if spin=True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>square_lattice</strong><span class="classifier">TBLattice</span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="triqs_tprf.super_lattice.TBSuperLattice">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">triqs_tprf.super_lattice.</span></span><span class="sig-name descname"><span class="pre">TBSuperLattice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tb_lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">super_lattice_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_internal_hoppings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/super_lattice.html#TBSuperLattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice" title="Link to this definition"></a></dt>
<dd><p>Builds a superlattice on top of a base TBLattice.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>tb_lattice</strong><span class="classifier">TBLattice instance</span></dt><dd><p>The base tight binding lattice.</p>
</dd>
<dt><strong>super_lattice_units</strong><span class="classifier">ndarray (2D)</span></dt><dd><p>The unit vectors of the superlattice in the <code class="docutils literal notranslate"><span class="pre">tb_lattice</span></code> (integer) coordinates.</p>
</dd>
<dt><strong>cluster_sites</strong></dt><dd><p>Coordinates of the cluster in tb_lattice coordinates.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, an automatic computation of cluster positions
is made as follows: it takes all points whose coordinates
in the basis of the superlattice are in [0, 1[^dimension.</p>
</dd>
<dt><strong>remove_internal_hoppings</strong><span class="classifier">bool</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">true</span></code>, the hopping terms are removed inside the cluster.
Useful to add Hartree Fock terms at the boundary of a cluster, e.g.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hoppings</strong></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_orbitals</span></code></dt><dd><p>Number of orbitals in the unit cell</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndim</span></code></dt><dd><p>Number of dimensions of the lattice</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_names</span></code></dt><dd><p>The list of orbital names</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">orbital_positions</span></code></dt><dd><p>The list of orbital positions</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">units</span></code></dt><dd><p>Number of dimensions of the lattice</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_L_to_SL" title="triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_L_to_SL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">change_coordinates_L_to_SL</span></code></a>(x)</p></td>
<td><p>Given a point on the tb_lattice in lattice coordinates, returns its coordinates (R, alpha) in the Superlattice</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_SL_to_L" title="triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_SL_to_L"><code class="xref py py-obj docutils literal notranslate"><span class="pre">change_coordinates_SL_to_L</span></code></a>(R, alpha)</p></td>
<td><p>Given a point in the supercell R, site (number) alpha, it computes its position on the tb_lattice in lattice coordinates</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.cluster_sites" title="triqs_tprf.super_lattice.TBSuperLattice.cluster_sites"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cluster_sites</span></code></a>()</p></td>
<td><p>Generate the position of the cluster site in the tb_lattice coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dispersion</span></code>(arg)</p></td>
<td><p>Signature : (k_cvt K) -&gt; nda::array&lt;double, 1&gt; Evaluate the dispersion relation for a momentum vector k in units of the reciprocal lattice vectors</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.fold" title="triqs_tprf.super_lattice.TBSuperLattice.fold"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fold</span></code></a>(D1[, remove_internal, create_zero])</p></td>
<td><p>Input: a function  r-&gt; f(r) on the tb_lattice given as a dictionnary Output: the function R-&gt; F(R) folded on the superlattice.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fourier</span></code>(arg)</p></td>
<td><p>Signature : (k_cvt K) -&gt; matrix&lt;dcomplex&gt; Evaluate the fourier transform for a momentum vector k in units of the reciprocal lattice vectors</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_kmesh</span></code>(n_k)</p></td>
<td><p>Return a mesh on the Brillouin zone with a given discretization</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_rmesh</span></code>(n_r)</p></td>
<td><p>Return a mesh on the Bravais lattice with a given periodicity</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattice_to_real_coordinates</span></code>(x)</p></td>
<td><p>Signature : (r_t x) -&gt; r_t Transform into real coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.pack_index_site_orbital" title="triqs_tprf.super_lattice.TBSuperLattice.pack_index_site_orbital"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pack_index_site_orbital</span></code></a>(n_site, n_orbital)</p></td>
<td><p>nsite and n_orbital must start at 0</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.super_lattice.TBSuperLattice.unpack_index_site_orbital" title="triqs_tprf.super_lattice.TBSuperLattice.unpack_index_site_orbital"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unpack_index_site_orbital</span></code></a>(index)</p></td>
<td><p>Inverse of pack_index_site_orbital</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_L_to_SL">
<span class="sig-name descname"><span class="pre">change_coordinates_L_to_SL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/super_lattice.html#TBSuperLattice.change_coordinates_L_to_SL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_L_to_SL" title="Link to this definition"></a></dt>
<dd><p>Given a point on the tb_lattice in lattice coordinates, returns its coordinates (R, alpha) in the Superlattice</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_SL_to_L">
<span class="sig-name descname"><span class="pre">change_coordinates_SL_to_L</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/super_lattice.html#TBSuperLattice.change_coordinates_SL_to_L"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_SL_to_L" title="Link to this definition"></a></dt>
<dd><p>Given a point in the supercell R, site (number) alpha, it computes its position on the tb_lattice in lattice coordinates</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.super_lattice.TBSuperLattice.cluster_sites">
<span class="sig-name descname"><span class="pre">cluster_sites</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/super_lattice.html#TBSuperLattice.cluster_sites"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.cluster_sites" title="Link to this definition"></a></dt>
<dd><p>Generate the position of the cluster site in the tb_lattice coordinates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.super_lattice.TBSuperLattice.fold">
<span class="sig-name descname"><span class="pre">fold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_internal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/super_lattice.html#TBSuperLattice.fold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.fold" title="Link to this definition"></a></dt>
<dd><p>Input: a function  r-&gt; f(r) on the tb_lattice given as a dictionnary
Output: the function R-&gt; F(R) folded on the superlattice.
Only requirement is that f(r)[orbital1, orbital2] is properly defined.
Hence f(r) can be a numpy, a GFBloc, etc…</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.super_lattice.TBSuperLattice.pack_index_site_orbital">
<span class="sig-name descname"><span class="pre">pack_index_site_orbital</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_site</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_orbital</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/super_lattice.html#TBSuperLattice.pack_index_site_orbital"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.pack_index_site_orbital" title="Link to this definition"></a></dt>
<dd><p>nsite and n_orbital must start at 0</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.super_lattice.TBSuperLattice.unpack_index_site_orbital">
<span class="sig-name descname"><span class="pre">unpack_index_site_orbital</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs/lattice/super_lattice.html#TBSuperLattice.unpack_index_site_orbital"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.unpack_index_site_orbital" title="Link to this definition"></a></dt>
<dd><p>Inverse of pack_index_site_orbital</p>
</dd></dl>

</dd></dl>

</section>
<section id="hartree-fock-and-hartree-solvers">
<h1>Hartree-Fock and Hartree solvers<a class="headerlink" href="#hartree-fock-and-hartree-solvers" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="triqs_tprf.hf_solver.HartreeFockSolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">triqs_tprf.hf_solver.</span></span><span class="sig-name descname"><span class="pre">HartreeFockSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_struct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock solver for local interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>e_k</strong><span class="classifier">TRIQS Greens function on a Brillouin zone mesh</span></dt><dd><p>Single-particle dispersion.</p>
</dd>
<dt><strong>beta</strong><span class="classifier">float</span></dt><dd><p>inverse temperature</p>
</dd>
<dt><strong>H_int</strong><span class="classifier">TRIQS Operator instance</span></dt><dd><p>Local interaction Hamiltonian</p>
</dd>
<dt><strong>gf_struct</strong><span class="classifier">list of pairs of block index and its size</span></dt><dd><p>gf_struct fixing orbital order between e_k and H_int</p>
</dd>
<dt><strong>mu0</strong><span class="classifier">float</span></dt><dd><p>chemical potential</p>
</dd>
<dt><strong>mu_min, mu_max</strong><span class="classifier">float, optional</span></dt><dd><p>range for chemical potential search.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">chemical_potential</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">density_matrix</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">density_matrix_step</span></code>(rho_vec[, N_target])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expectation_value</span></code>(op_ab)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logo</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.mat2vec" title="triqs_tprf.hf_solver.HartreeFockSolver.mat2vec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mat2vec</span></code></a>(mat)</p></td>
<td><p>Converts a unitary matrix to a vector representation with the order</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean_field_matrix</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_iter" title="triqs_tprf.hf_solver.HartreeFockSolver.solve_iter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_iter</span></code></a>(N_target[, M0, mu0, nitermax, ...])</p></td>
<td><p>Solve the HF-equations using forward recursion at fixed density.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton" title="triqs_tprf.hf_solver.HartreeFockSolver.solve_newton"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_newton</span></code></a>(N_target[, M0, mu0])</p></td>
<td><p>Solve the HF-equations using a quasi Newton method at fixed density.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton_mu" title="triqs_tprf.hf_solver.HartreeFockSolver.solve_newton_mu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_newton_mu</span></code></a>(mu[, M0])</p></td>
<td><p>Solve the HF-equations using a quasi Newton method at fixed chemical potential.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_setup</span></code>(N_target[, M0, mu0])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">total_density</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_chemical_potential</span></code>(N_target[, mu0])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_density_matrix</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_interaction_energy</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_kinetic_energy</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_mean_field</span></code>(rho_ab)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_mean_field_dispersion</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_momentum_density_matrix</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_non_int_free_energy</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_total_energy</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeFockSolver.vec2mat" title="triqs_tprf.hf_solver.HartreeFockSolver.vec2mat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vec2mat</span></code></a>(vec)</p></td>
<td><p>Converts from vector representation to a unitary matrix see mat2vec(...) for details.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.hf_solver.HartreeFockSolver.mat2vec">
<span class="sig-name descname"><span class="pre">mat2vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.mat2vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.mat2vec" title="Link to this definition"></a></dt>
<dd><p>Converts a unitary matrix to a vector representation
with the order</p>
<ol class="arabic simple">
<li><p>the real diagonal entries</p></li>
<li><p>the real part of the upper triangular entries</p></li>
<li><p>the imaginary part of the upper triangular entries</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.hf_solver.HartreeFockSolver.solve_iter">
<span class="sig-name descname"><span class="pre">solve_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.solve_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_iter" title="Link to this definition"></a></dt>
<dd><p>Solve the HF-equations using forward recursion at fixed density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>N_target</strong><span class="classifier">float</span></dt><dd><p>Total density.</p>
</dd>
<dt><strong>M0</strong><span class="classifier">ndarray (2D), optional</span></dt><dd><p>Initial mean-field (0 if None).</p>
</dd>
<dt><strong>mu0</strong><span class="classifier">float, optional</span></dt><dd><p>Initial chemical potential.</p>
</dd>
<dt><strong>nitermax</strong><span class="classifier">int, optional</span></dt><dd><p>Maximal number of self consistent iterations.</p>
</dd>
<dt><strong>mixing</strong><span class="classifier">float, optional</span></dt><dd><p>Linear mixing parameter.</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float, optional</span></dt><dd><p>Convergence in relative change of the density matrix.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rho</strong><span class="classifier">ndarray (2D)</span></dt><dd><p>Local density matrix.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.hf_solver.HartreeFockSolver.solve_newton">
<span class="sig-name descname"><span class="pre">solve_newton</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.solve_newton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton" title="Link to this definition"></a></dt>
<dd><p>Solve the HF-equations using a quasi Newton method at fixed density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>N_tot</strong><span class="classifier">float</span></dt><dd><p>Total density.</p>
</dd>
<dt><strong>M0</strong><span class="classifier">ndarray (2D), optional</span></dt><dd><p>Initial mean-field (0 if None).</p>
</dd>
<dt><strong>mu0</strong><span class="classifier">float, optional</span></dt><dd><p>Initial chemical potential.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.hf_solver.HartreeFockSolver.solve_newton_mu">
<span class="sig-name descname"><span class="pre">solve_newton_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.solve_newton_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton_mu" title="Link to this definition"></a></dt>
<dd><p>Solve the HF-equations using a quasi Newton method at fixed chemical potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mu0</strong><span class="classifier">float</span></dt><dd><p>Initial chemical potential.</p>
</dd>
<dt><strong>M0</strong><span class="classifier">ndarray (2D), optional</span></dt><dd><p>Initial mean-field (0 if None).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.hf_solver.HartreeFockSolver.vec2mat">
<span class="sig-name descname"><span class="pre">vec2mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.vec2mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.vec2mat" title="Link to this definition"></a></dt>
<dd><p>Converts from vector representation to a unitary matrix
see mat2vec(…) for details.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="triqs_tprf.hf_response.HartreeFockResponse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">triqs_tprf.hf_response.</span></span><span class="sig-name descname"><span class="pre">HartreeFockResponse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hartree_fock_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_response.html#HartreeFockResponse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_response.HartreeFockResponse" title="Link to this definition"></a></dt>
<dd><p>Hartree-Fock linear response calculator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>hartree_fock_solver</strong><span class="classifier">HartreeFockSolver instance</span></dt><dd><p>Converged Hartree-Fock solver.</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float</span></dt><dd><p>Step size in finite difference linear response calculation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logo</span></code>()</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>bare_response</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>compute_chi0_k</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>mode_decomposition</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>response</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="triqs_tprf.hf_solver.HartreeSolver">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">triqs_tprf.hf_solver.</span></span><span class="sig-name descname"><span class="pre">HartreeSolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_struct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeSolver" title="Link to this definition"></a></dt>
<dd><p>Hartree solver for local interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>e_k</strong><span class="classifier">TRIQS Greens function on a Brillouin zone mesh</span></dt><dd><p>Single-particle dispersion.</p>
</dd>
<dt><strong>beta</strong><span class="classifier">float</span></dt><dd><p>inverse temperature</p>
</dd>
<dt><strong>H_int</strong><span class="classifier">TRIQS Operator instance</span></dt><dd><p>Local interaction Hamiltonian</p>
</dd>
<dt><strong>gf_struct</strong><span class="classifier">list of lists of block index and list of internal orbital indices</span></dt><dd><p>gf_struct fixing orbital order between e_k and H_int</p>
</dd>
<dt><strong>mu0</strong><span class="classifier">float</span></dt><dd><p>chemical potential</p>
</dd>
<dt><strong>mu_min, mu_max</strong><span class="classifier">float, optional</span></dt><dd><p>range for chemical potential search.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">chemical_potential</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">density_matrix</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">density_matrix_step</span></code>(rho_vec[, N_target])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expectation_value</span></code>(op_ab)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logo</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeSolver.mat2vec" title="triqs_tprf.hf_solver.HartreeSolver.mat2vec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mat2vec</span></code></a>(mat)</p></td>
<td><p>Converts a unitary matrix to a vector representation with the order</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean_field_matrix</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_iter</span></code>(N_target[, M0, mu0, nitermax, ...])</p></td>
<td><p>Solve the HF-equations using forward recursion at fixed density.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_newton</span></code>(N_target[, M0, mu0])</p></td>
<td><p>Solve the HF-equations using a quasi Newton method at fixed density.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_newton_mu</span></code>(mu[, M0])</p></td>
<td><p>Solve the HF-equations using a quasi Newton method at fixed chemical potential.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_setup</span></code>(N_target[, M0, mu0])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">total_density</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_chemical_potential</span></code>(N_target[, mu0])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_density_matrix</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_interaction_energy</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_kinetic_energy</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_mean_field</span></code>(rho_ab)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_mean_field_dispersion</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_momentum_density_matrix</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_non_int_free_energy</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_total_energy</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.hf_solver.HartreeSolver.vec2mat" title="triqs_tprf.hf_solver.HartreeSolver.vec2mat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vec2mat</span></code></a>(vec)</p></td>
<td><p>Converts from vector representation to a unitary matrix see mat2vec(...) for details.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.hf_solver.HartreeSolver.mat2vec">
<span class="sig-name descname"><span class="pre">mat2vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeSolver.mat2vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeSolver.mat2vec" title="Link to this definition"></a></dt>
<dd><p>Converts a unitary matrix to a vector representation
with the order</p>
<ol class="arabic simple">
<li><p>the real diagonal entries</p></li>
<li><p>the real part of the upper triangular entries</p></li>
<li><p>the imaginary part of the upper triangular entries</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.hf_solver.HartreeSolver.vec2mat">
<span class="sig-name descname"><span class="pre">vec2mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeSolver.vec2mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeSolver.vec2mat" title="Link to this definition"></a></dt>
<dd><p>Converts from vector representation to a unitary matrix
see mat2vec(…) for details.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="triqs_tprf.hf_response.HartreeResponse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">triqs_tprf.hf_response.</span></span><span class="sig-name descname"><span class="pre">HartreeResponse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hartree_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_response.html#HartreeResponse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_response.HartreeResponse" title="Link to this definition"></a></dt>
<dd><p>Hartree linear response calculator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>hartree_solver</strong><span class="classifier">HartreeSolver instance</span></dt><dd><p>Converged Hartree solver.</p>
</dd>
<dt><strong>eps</strong><span class="classifier">float</span></dt><dd><p>Step size in finite difference linear response calculation.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">logo</span></code>()</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>bare_response</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>extract_dens_dens</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>response</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>
<section id="utility-functions">
<h1>Utility functions<a class="headerlink" href="#utility-functions" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice_utils.k_space_path">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice_utils.</span></span><span class="sig-name descname"><span class="pre">k_space_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relative_coordinates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/lattice_utils.html#k_space_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.lattice_utils.k_space_path" title="Link to this definition"></a></dt>
<dd><p>Generate an array of k-vectors along a path defined by a list of pairs of k-vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>paths</strong><span class="classifier">list of pairs of three-vectors of floats</span></dt><dd><p>List of pairs of k-vectors in reciprocal units to create a path in-between.</p>
</dd>
<dt><strong>num</strong><span class="classifier">int, default=100</span></dt><dd><p>Number of k-vectors along each segment of the overall path</p>
</dd>
<dt><strong>bz</strong><span class="classifier">brillouin_zone, optional</span></dt><dd><p>When a Brillouin Zone is passed, calculate distance in absolute units</p>
</dd>
<dt><strong>relative_coordinates</strong><span class="classifier">bool, optional</span></dt><dd><p>Return k-vectors in reciprocal units. (Default <cite>False</cite>)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>kvecs: numpy.ndarray [shape=(len(paths)*num,3)]</dt><dd><p>Two-dimensional numpy array containing the path vectors (in reciprocal units) as rows</p>
</dd>
<dt>dist: numpy.ndarray  [shape=(kvecs.shape[0])]</dt><dd><p>One-dimensional numpy array containing, for each element in kvecs,
the distance travelled along the path. Useful for plotting.
If bz is provided, calculate the distance in absolute units.
The distances for the relevant k-points in paths can be obtained with dist[num::num].</p>
</dd>
<dt><strong>ticks</strong><span class="classifier">numpy.ndarray [shape=(len(paths)+1)]</span></dt><dd><p>Array with tick points, i.e. distances at the interfaces of path segments.
Only returned if <cite>return_ticks</cite> is <cite>True</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.lattice_utils.chi_contraction">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice_utils.</span></span><span class="sig-name descname"><span class="pre">chi_contraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">op2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/lattice_utils.html#chi_contraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.lattice_utils.chi_contraction" title="Link to this definition"></a></dt>
<dd><p>Contract a susceptibility with two operators</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chi</strong><span class="classifier">Gf,</span></dt><dd><p>Susceptibility <span class="math notranslate nohighlight">\(\chi(i\omega_n, \mathbf{k})\)</span>. The mesh attribute of
the Gf must be a MeshProduct with the components (MeshImFreq, MeshBrZone)
and its target_rank 4.</p>
</dd>
<dt><strong>op1, op2</strong><span class="classifier">np.ndarray,</span></dt><dd><p>Operators in matrix representation.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>Gf,</dt><dd></dd>
<dt>Susceptibility <span class="math notranslate nohighlight">\(\chi(i\omega_n, \mathbf{k})\)</span>. With a target_rank of 0.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="parameter-collections">
<h1>Parameter collections<a class="headerlink" href="#parameter-collections" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="triqs_tprf.ParameterCollection.ParameterCollection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">triqs_tprf.ParameterCollection.</span></span><span class="sig-name descname"><span class="pre">ParameterCollection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection" title="Link to this definition"></a></dt>
<dd><p>Helper class for handing collections of parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>kwargs</strong><span class="classifier">dict</span></dt><dd><p>Key-word argument list of parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>A <code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code> has any number of attributes, accessible with the
dot operator.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span>
<span class="go">U = 1.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">beta</span>
<span class="go">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span>
<span class="go">U = 1.0</span>
<span class="go">W = 1.2</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
</pre></div>
</div>
<p>and can be stored and loaded to/from TRIQS hdf archives.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">h5</span> <span class="kn">import</span> <span class="n">HDFArchive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">arch</span><span class="p">:</span> <span class="n">arch</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">arch</span><span class="p">:</span> <span class="n">p_ref</span> <span class="o">=</span> <span class="n">arch</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p_ref</span>
<span class="go">U = 1.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.ParameterCollection.ParameterCollection.alter" title="triqs_tprf.ParameterCollection.ParameterCollection.alter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alter</span></code></a>(**kwargs)</p></td>
<td><p>Change or add attributes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#triqs_tprf.ParameterCollection.ParameterCollection.convert_keys_from_string_to_python" title="triqs_tprf.ParameterCollection.ParameterCollection.convert_keys_from_string_to_python"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_keys_from_string_to_python</span></code></a>(dict_key)</p></td>
<td><p>h5.HDFArchive incorrectly mangles tuple keys to string running this on the affected dict tries to revert this by running eval on the string representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#triqs_tprf.ParameterCollection.ParameterCollection.copy" title="triqs_tprf.ParameterCollection.ParameterCollection.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Shallow copy</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>dict</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>get_my_name</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>grab_attribs</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>items</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>keys</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.ParameterCollection.ParameterCollection.alter">
<span class="sig-name descname"><span class="pre">alter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection.alter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection.alter" title="Link to this definition"></a></dt>
<dd><p>Change or add attributes</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>p</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code></span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.ParameterCollection.ParameterCollection.convert_keys_from_string_to_python">
<span class="sig-name descname"><span class="pre">convert_keys_from_string_to_python</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection.convert_keys_from_string_to_python"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection.convert_keys_from_string_to_python" title="Link to this definition"></a></dt>
<dd><p>h5.HDFArchive incorrectly mangles tuple keys to string
running this on the affected dict tries to revert this by running eval
on the string representation. UGLY FIX…</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="triqs_tprf.ParameterCollection.ParameterCollection.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection.copy" title="Link to this definition"></a></dt>
<dd><p>Shallow copy</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="triqs_tprf.ParameterCollection.ParameterCollections">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">triqs_tprf.ParameterCollection.</span></span><span class="sig-name descname"><span class="pre">ParameterCollections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollections" title="Link to this definition"></a></dt>
<dd><p>Helper class for handing a series of collections of parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>objects</strong><span class="classifier">list</span></dt><dd><p>List of <code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code> instances.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ParameterCollections</span></code> class makes it easy to get vectors of 
parameters from a list of <code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code> objects.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.337</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ps</span> <span class="o">=</span> <span class="n">ParameterCollections</span><span class="p">(</span><span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="o">.</span><span class="n">beta</span>
<span class="go">[10.  5.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="o">.</span><span class="n">U</span>
<span class="go">[1. 2.]</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>append</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>getattr_from_objects</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>set_sorted_order</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>sort_on</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="triqs_tprf.ParameterCollection.parameter_scan">
<span class="sig-prename descclassname"><span class="pre">triqs_tprf.ParameterCollection.</span></span><span class="sig-name descname"><span class="pre">parameter_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#parameter_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.parameter_scan" title="Link to this definition"></a></dt>
<dd><p>Return ParameterCollections with copies of ParameterCollection for different parameters</p>
<p>Uses a given ParameterCollection as a template to create copies of it with one or more
parameters changing. Stores all of these copies in a ParameterCollections for easy access.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>p</strong><span class="classifier">ParameterCollection,</span></dt><dd><p>The ParameterCollection that shall be used as a template for all the others</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">Sequence,</span></dt><dd><p>The keyword gives the parameter name and the Sequence the values that shall
be scanned through.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>ParameterCollections</dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ps</span> <span class="o">=</span> <span class="n">parameter_scan</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">U = 1.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">U = 1.5</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">U = 2.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../user_guide/Solving%20the%20linearized%20Eliashberg%20equation%20in%20the%20random%20phase%20approximation%20limit.html" class="btn btn-neutral float-left" title="Solving the linearized Eliashberg equation in the random phase approximation limit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cpp_reference.html" class="btn btn-neutral float-right" title="Lattice Green’s functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, H. U.R. Strand.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>