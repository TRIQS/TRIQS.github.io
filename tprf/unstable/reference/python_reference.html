
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lattice Green’s functions &#8212; TPRF - Two-Particle Response Function tool box for TRIQS  documentation</title>
    <link rel="stylesheet" href="../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=default"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lattice Green’s functions" href="cpp_reference.html" />
    <link rel="prev" title="Mean field and RPA response for the one dimensional Hubbard model." href="../user_guide/Mean field and RPA response of the one dimensional Hubbard model.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head>
  <body>
<div class="pageheader">
  <ul>
    
    <li><a href="../install.html">Install</a></li>
    
    <li><a href="../documentation.html">Documentation</a></li>
    
    <li><a href="../issues.html">Issues</a></li>
    
    <li><a href="../about.html">About tprf</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../index.html">tprf</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">two-particle response function tools based on the <a class="triqs" style="font-size: 12px" href="http://ipht.cea.fr/triqs">TRIQS</a> library</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="cpp_reference.html" title="Lattice Green’s functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../user_guide/Mean field and RPA response of the one dimensional Hubbard model.html" title="Mean field and RPA response for the one dimensional Hubbard model."
             accesskey="P">previous</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../documentation.html" accesskey="U">Documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lattice Green’s functions</a></li>
<li><a class="reference internal" href="#lindhard-non-interacting-generalized-susceptibility">Lindhard non-interacting generalized susceptibility</a></li>
<li><a class="reference internal" href="#random-phase-approximation">Random Phase Approximation</a></li>
<li><a class="reference internal" href="#impurity-susceptibility-and-bethe-salpeter-equation">Impurity susceptibility and Bethe-Salpeter Equation</a></li>
<li><a class="reference internal" href="#lattice-bethe-salpeter-equation">Lattice Bethe-Salpeter Equation</a></li>
<li><a class="reference internal" href="#gw-approximation">GW approximation</a></li>
<li><a class="reference internal" href="#linearized-eliashberg-equation">Linearized Eliashberg equation</a></li>
<li><a class="reference internal" href="#hubbard-atom-analytic-response-functions">Hubbard atom analytic response functions</a></li>
<li><a class="reference internal" href="#two-particle-response-function-linear-algebra-operations">Two-particle response function linear-algebra operations</a></li>
<li><a class="reference internal" href="#wannier90-tight-binding-parsers">Wannier90 tight binding parsers</a></li>
<li><a class="reference internal" href="#tight-binding-lattice-model">Tight binding lattice model</a></li>
<li><a class="reference internal" href="#hartree-fock-and-hartree-solvers">Hartree-Fock and Hartree solvers</a></li>
<li><a class="reference internal" href="#parameter-collections">Parameter collections</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../user_guide/Mean field and RPA response of the one dimensional Hubbard model.html"
                        title="previous chapter">Mean field and RPA response for the one dimensional Hubbard model.</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="cpp_reference.html"
                        title="next chapter">Lattice Green’s functions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/python_reference.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lattice-green-s-functions">
<span id="gf-functions"></span><h1>Lattice Green’s functions<a class="headerlink" href="#lattice-green-s-functions" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.lattice.lattice_dyson_g0_wk">
<code class="descclassname">triqs_tprf.lattice.</code><code class="descname">lattice_dyson_g0_wk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g0_wk" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, gf_mesh&lt;triqs::gfs::imfreq&gt; mesh) -&gt; triqs_tprf::g_wk_t
Construct a non-interacting Matsubara frequency lattice Green’s function <span class="math">\(G^{(0)}_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math" id="equation-reference-python-reference-0">
<span class="eqno">(1)<a class="headerlink" href="#equation-reference-python-reference-0" title="Permalink to this equation">¶</a></span>\[G^{(0)}_{a\bar{b}}(i\omega_n, \mathbf{k}) = \left[
    (i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k})
 \right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, chemical potential <span class="math">\(\mu\)</span>,
and a Matsubara frequency Green’s function mesh.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param mu:</th><td class="field-body">chemical potential <span class="math">\(\mu\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param e_k:</th><td class="field-body">discretized lattice dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></td>
</tr>
<tr class="field-odd field"><th class="field-name">param mesh:</th><td class="field-body">imaginary frequency mesh</td>
</tr>
</tbody>
</table>
<p>&#64;return Matsubara frequency lattice Green’s function <span class="math">\(G^{(0)}_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.lattice.lattice_dyson_g_wk">
<code class="descclassname">triqs_tprf.lattice.</code><code class="descname">lattice_dyson_g_wk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g_wk" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an interacting Matsubara frequency lattice Green’s function <span class="math">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math" id="equation-reference-python-reference-1">
<span class="eqno">(2)<a class="headerlink" href="#equation-reference-python-reference-1" title="Permalink to this equation">¶</a></span>\[G_{a\bar{b}}(i\omega_n, \mathbf{k}) = \left[ 
    (i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(i\omega_n)
    \right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, 
chemical potential <span class="math">\(\mu\)</span>, and a momentum independent Matsubara frequency 
self energy <span class="math">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param mu:</th><td class="field-body">chemical potential <span class="math">\(\mu\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param e_k:</th><td class="field-body">discretized lattice dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></td>
</tr>
<tr class="field-odd field"><th class="field-name">param sigma_w:</th><td class="field-body">imaginary frequency self-energy <span class="math">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return Matsubara frequency lattice Green’s function <span class="math">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(float mu, triqs_tprf::e_k_cvt e_k, triqs_tprf::g_w_cvt sigma_w) -&gt; triqs_tprf::g_wk_t</span></dt>
<dd><p class="first">Construct an interacting Matsubara frequency lattice Green’s function <span class="math">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
<blockquote class="last">
<div><p>Computes</p>
<div class="math" id="equation-reference-python-reference-2">
<span class="eqno">(3)<a class="headerlink" href="#equation-reference-python-reference-2" title="Permalink to this equation">¶</a></span>\[G_{a\bar{b}}(i\omega_n, \mathbf{k}) = \left[
    (i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(i\omega_n)
 \right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>,
chemical potential <span class="math">\(\mu\)</span>, and a momentum independent Matsubara frequency
self energy <span class="math">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param mu:</th><td class="field-body">chemical potential <span class="math">\(\mu\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param e_k:</th><td class="field-body">discretized lattice dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></td>
</tr>
<tr class="field-odd field"><th class="field-name">param sigma_w:</th><td class="field-body">imaginary frequency self-energy <span class="math">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return Matsubara frequency lattice Green’s function <span class="math">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(float mu, triqs_tprf::e_k_cvt e_k, triqs_tprf::g_wk_cvt sigma_wk) -&gt; triqs_tprf::g_wk_t</span></dt>
<dd><p class="first">Construct an interacting Matsubara frequency lattice Green’s function <span class="math">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
<blockquote class="last">
<div><p>Computes</p>
<div class="math" id="equation-reference-python-reference-3">
<span class="eqno">(4)<a class="headerlink" href="#equation-reference-python-reference-3" title="Permalink to this equation">¶</a></span>\[G_{a\bar{b}}(i\omega_n, \mathbf{k}) = \left[
    (i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(i\omega_n, \mathbf{k})
 \right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>,
chemical potential <span class="math">\(\mu\)</span>, and a momentum independent Matsubara frequency
self energy <span class="math">\(\Sigma_{\bar{a}b}(i\omega_n, \mathbf{k})\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param mu:</th><td class="field-body">chemical potential <span class="math">\(\mu\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param e_k:</th><td class="field-body">discretized lattice dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></td>
</tr>
<tr class="field-odd field"><th class="field-name">param sigma_wk:</th><td class="field-body">imaginary frequency self-energy <span class="math">\(\Sigma_{\bar{a}b}(i\omega_n, \mathbf{k})\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return Matsubara frequency lattice Green’s function <span class="math">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.lattice.lattice_dyson_g_w">
<code class="descclassname">triqs_tprf.lattice.</code><code class="descname">lattice_dyson_g_w</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g_w" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, triqs_tprf::g_w_cvt sigma_w) -&gt; triqs_tprf::g_w_t
Construct an interacting Matsubara frequency local (<span class="math">\(\mathbf{r}=\mathbf{0}\)</span>) lattice Green’s function <span class="math">\(G_{a\bar{b}}(i\omega_n)\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math" id="equation-reference-python-reference-4">
<span class="eqno">(5)<a class="headerlink" href="#equation-reference-python-reference-4" title="Permalink to this equation">¶</a></span>\[G_{a\bar{b}}(i\omega_n) = \frac{1}{N_k} \sum_\mathbf{k} \left[
    (i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(i\omega_n)
 \right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>,
chemical potential <span class="math">\(\mu\)</span>, and a momentum independent Matsubara frequency
self energy <span class="math">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param mu:</th><td class="field-body">chemical potential <span class="math">\(\mu\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param e_k:</th><td class="field-body">discretized lattice dispersion <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></td>
</tr>
<tr class="field-odd field"><th class="field-name">param sigma_w:</th><td class="field-body">imaginary frequency self-energy <span class="math">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return Matsubara frequency lattice Green’s function <span class="math">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="lindhard-non-interacting-generalized-susceptibility">
<h1>Lindhard non-interacting generalized susceptibility<a class="headerlink" href="#lindhard-non-interacting-generalized-susceptibility" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.lattice.lindhard_chi00_wk">
<code class="descclassname">triqs_tprf.lattice.</code><code class="descname">lindhard_chi00_wk</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lindhard_chi00_wk" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::e_k_cvt e_k, int nw, float beta, float mu) -&gt; triqs_tprf::chi_wk_t
Generalized Lindhard susceptibility in the particle-hole channel <span class="math">\(\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q})\)</span>.</p>
<blockquote>
<div><p>Analytic calculation of the generalized (non-interacting) Lindhard susceptibility
in the particle-hole channel. The analytic expression is obtained using residue calculus
to explicitly evaluate the matsubara sum of the fourier transformed imaginary time
bubble product of two non-interacting single-particle Green’s functions.</p>
<div class="math" id="equation-reference-python-reference-5">
<span class="eqno">(6)<a class="headerlink" href="#equation-reference-python-reference-5" title="Permalink to this equation">¶</a></span>\[G^{(0)}_{a\bar{b}}(\mathbf{k}, i\omega_n) =
\left[ i\omega_n \cdot \mathbf{1} - \epsilon(\mathbf{k}) \right]^{-1} .\]</div>
<p>The analytic evaluation of the bubble diagram gives</p>
<div class="math" id="equation-reference-python-reference-6">
<span class="eqno">(7)<a class="headerlink" href="#equation-reference-python-reference-6" title="Permalink to this equation">¶</a></span>\[\begin{split}\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q}) \equiv
   \mathcal{F} \left\{
  - G^{(0)}_{d\bar{a}}(\tau, \mathbf{r}) G^{(0)}_{b\bar{c}}(-\tau, -\mathbf{r})
\right\}
   =
- \frac{1}{N_k} \sum_{\nu} \sum_{\mathbf{k}}
     G^{(0)}_{d\bar{a}}(\nu, \mathbf{k})
  G^{(0)}_{b\bar{c}}(\nu + \omega, \mathbf{k} + \mathbf{q})
\\ =
- \frac{1}{N_k} \sum_{\nu} \sum_{\mathbf{k}}
  \left( \sum_{i}
     U^\dagger_{di}(\mathbf{k}) \frac{1}{i\nu - \epsilon_{\mathbf{k}, i}} U_{i\bar{a}}(\mathbf{k})
  \right)
  \left( \sum_j
  U^\dagger_{bj}(\mathbf{k} + \mathbf{q})
  \frac{1}{i\nu + i\omega - \epsilon_{\mathbf{k} + \mathbf{q}, j}}
  U_{j\bar{c}}(\mathbf{k} + \mathbf{q})
  \right)
\\ =
\frac{1}{N_k} \sum_{\mathbf{k}} \sum_{ij}
  \left(
    [1-\delta(\epsilon_{\mathbf{k},i} - \epsilon_{\mathbf{k}+\mathbf{q}, j})]
    \frac{ f(\epsilon_{\mathbf{k}, i}) - f(\epsilon_{\mathbf{k}+\mathbf{q}, j}) }
         {i\omega_n + \epsilon_{\mathbf{k} + \mathbf{q}, j} - \epsilon_{\mathbf{k}, i}}
    +
    \delta(\epsilon_{\mathbf{k},i} - \epsilon_{\mathbf{k}+\mathbf{q}, j})
    \frac{\beta}{4 \cosh^2 (\beta \epsilon_{\mathbf{k}, i} / 2) }
  \right)
  \\ \times
  U_{i\bar{a}}(\mathbf{k}) U^\dagger_{di}(\mathbf{k})
  U_{j\bar{c}}(\mathbf{k} + \mathbf{q}) U^\dagger_{bj}(\mathbf{k} + \mathbf{q})\end{split}\]</div>
<p>where the <span class="math">\(U(\mathbf{k})\)</span> matrices are the diagonalizing unitary transform of the matrix valued
dispersion relation <span class="math">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, i.e.</p>
<div class="math" id="equation-reference-python-reference-7">
<span class="eqno">(8)<a class="headerlink" href="#equation-reference-python-reference-7" title="Permalink to this equation">¶</a></span>\[\sum_{\bar{a}b} U_{i\bar{a}}(\mathbf{k}) \epsilon_{\bar{a}b}(\mathbf{k}) U^\dagger_{bj} (\mathbf{k})
= \delta_{ij} \epsilon_{\mathbf{k}, i}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The analytic formula is sub-optimal in terms of performance for higher temperatures. The evaluation
scales as <span class="math">\(\mathcal{O}(N_k^2)\)</span> which is worse than computing the bubble explicitly in imaginary
time, with scaling <span class="math">\(\mathcal{O}(N_k N_\tau \log(N_k N_\tau)\)</span> for <span class="math">\(N_k \gg N_\tau\)</span>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Care must be taken when evaluating the fermionic Matsubara frequency sum of the
product of two simple poles. By extending the sum to an integral over the complex
plane the standard expression for the Lindhard response is obtained when the
poles are non-degenerate. The degenerate case produces an additional frequency independent
contribution (the last term on the last row).</p>
</div>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="random-phase-approximation">
<h1>Random Phase Approximation<a class="headerlink" href="#random-phase-approximation" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.lattice.solve_rpa_PH">
<code class="descclassname">triqs_tprf.lattice.</code><code class="descname">solve_rpa_PH</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.solve_rpa_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::chi_wk_vt chi0, array_view&lt;std::complex&lt;double&gt;,4&gt; U) -&gt; triqs_tprf::chi_wk_t
Random Phase Approximation (RPA) in the particle-hole channel</p>
<blockquote>
<div><p>Computes the equation</p>
<div class="math" id="equation-reference-python-reference-8">
<span class="eqno">(9)<a class="headerlink" href="#equation-reference-python-reference-8" title="Permalink to this equation">¶</a></span>\[\chi(\bar{a}b\bar{c}d) = \big(
\mathbb{1}
- \chi^{(0)}(\bar{a}b\bar{B}A) U(A\bar{B}D\bar{C})
\big)^{-1} \chi^{(0)}(\bar{C}D\bar{c}d)\,.\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param chi0:</th><td class="field-body">bare particle-hole bubble <span class="math">\(\chi^{(0)}_{\bar{a}b\bar{c}d}(\mathbf{k}, i\omega_n)\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param U:</th><td class="field-body">RPA static vertex as obtained from triqs_tprf.rpa_tensor.get_rpa_tensor <span class="math">\(U_{a\bar{b}c\bar{d}}\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return RPA suceptibility <span class="math">\(\chi_{\bar{a}b\bar{c}d}(\mathbf{k}, i\omega_n)\)</span></p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="impurity-susceptibility-and-bethe-salpeter-equation">
<h1>Impurity susceptibility and Bethe-Salpeter Equation<a class="headerlink" href="#impurity-susceptibility-and-bethe-salpeter-equation" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.chi_from_gg2.chi0_from_gg2_PH">
<code class="descclassname">triqs_tprf.chi_from_gg2.</code><code class="descname">chi0_from_gg2_PH</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi0_from_gg2_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Bubble susceptibility <span class="math">\(\chi^{(0)} = GG\)</span> in the Particle-Hole channel</p>
<blockquote>
<div><blockquote>
<div><p>Computes</p>
<div class="math" id="equation-reference-python-reference-9">
<span class="eqno">(10)<a class="headerlink" href="#equation-reference-python-reference-9" title="Permalink to this equation">¶</a></span>\[\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
- \beta \delta_{\nu, \nu'} G_{da}(\nu) \cdot G_{bc}(\omega + \nu)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">single particle Green’s function <span class="math">\(G_{ab}(\nu)\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param g2:</th><td class="field-body">two-particle Green’s function with the mesh to use for</td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="docutils">
<dt><span class="math">\(\chi^{(0)}\)</span></dt>
<dd>&#64;return chi0 particle-hole bubble</dd>
</dl>
<p><span class="math">\(\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.chi_from_gg2.chi0_from_gg2_PP">
<code class="descclassname">triqs_tprf.chi_from_gg2.</code><code class="descname">chi0_from_gg2_PP</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi0_from_gg2_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Bubble susceptibility <span class="math">\(\chi^{(0)} = GG\)</span> in the Particle-Particle</p>
<blockquote>
<div><p>channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math" id="equation-reference-python-reference-10">
<span class="eqno">(11)<a class="headerlink" href="#equation-reference-python-reference-10" title="Permalink to this equation">¶</a></span>\[\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
- \beta \delta_{\nu, \nu'} G_{da}(\nu) \cdot G_{bc}(\omega - \nu)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">single particle Green’s function <span class="math">\(G_{ab}(\nu)\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param g2:</th><td class="field-body">two-particle Green’s function with the mesh to use for</td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="docutils">
<dt><span class="math">\(\chi^{(0)}\)</span></dt>
<dd>&#64;return chi0 particle-particle bubble</dd>
</dl>
<p><span class="math">\(\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.chi_from_gg2.chi_from_gg2_PH">
<code class="descclassname">triqs_tprf.chi_from_gg2.</code><code class="descname">chi_from_gg2_PH</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi_from_gg2_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Generalized susceptibility <span class="math">\(\chi^{(0)} = G^{(2)} - GG\)</span> in the</p>
<blockquote>
<div><p>Particle-Hole channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math" id="equation-reference-python-reference-11">
<span class="eqno">(12)<a class="headerlink" href="#equation-reference-python-reference-11" title="Permalink to this equation">¶</a></span>\[\chi_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')
- \beta \delta_{\omega} G_{ba}(\nu) \cdot G_{dc}(\nu')\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">single particle Green’s function <span class="math">\(G_{ab}(\nu)\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param g2:</th><td class="field-body">two-particle Green’s function</td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="docutils">
<dt><span class="math">\(G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')\)</span></dt>
<dd>&#64;return chi generalized particle-hole susceptibility</dd>
</dl>
<p><span class="math">\(\chi_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.chi_from_gg2.chi_from_gg2_PP">
<code class="descclassname">triqs_tprf.chi_from_gg2.</code><code class="descname">chi_from_gg2_PP</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi_from_gg2_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Generalized susceptibility <span class="math">\(\chi^{(0)} = G^{(2)} - GG\)</span> in the</p>
<blockquote>
<div><p>Particle-Particle channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math" id="equation-reference-python-reference-12">
<span class="eqno">(13)<a class="headerlink" href="#equation-reference-python-reference-12" title="Permalink to this equation">¶</a></span>\[\chi_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')
- \beta \delta_{\nu + \nu' - \omega} G_{ba}(\nu) \cdot G_{dc}(\nu')\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">single particle Green’s function <span class="math">\(G_{ab}(\nu)\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param g2:</th><td class="field-body">two-particle Green’s function</td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="docutils">
<dt><span class="math">\(G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')\)</span></dt>
<dd>&#64;return chi generalized particle-hole susceptibility</dd>
</dl>
<p><span class="math">\(\chi_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.bse.solve_local_bse">
<code class="descclassname">triqs_tprf.bse.</code><code class="descname">solve_local_bse</code><span class="sig-paren">(</span><em>chi0_wnn</em>, <em>chi_wnn</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#solve_local_bse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.bse.solve_local_bse" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the Bethe-Salpeter equation for the local vertex function 
<span class="math">\(\Gamma_{abcd}(\omega, \nu, \nu')\)</span>.</p>
<p>Computes:</p>
<div class="math" id="equation-reference-python-reference-13">
<span class="eqno">(14)<a class="headerlink" href="#equation-reference-python-reference-13" title="Permalink to this equation">¶</a></span>\[\Gamma_{abcd}(\omega, \nu, \nu') = [\chi^{(0)}]^{-1} - \chi^{-1}\]</div>
<p>where the inverses are taken in the particle-hole channel pairing
of fermionic frequencies <span class="math">\(\nu\)</span> and <span class="math">\(\nu'\)</span> and orbital
indices.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>chi0_wnn</strong> : Gerealized local bubble susceptibility</p>
<blockquote>
<div><p><span class="math">\(\chi^{(0)}_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
<p><strong>chi_wnn</strong> : Generalized local susceptibility</p>
<blockquote>
<div><p><span class="math">\(\chi_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>gamma_wnn</strong> : Particle-hole vertex function</p>
<blockquote class="last">
<div><p><span class="math">\(\Gamma_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="lattice-bethe-salpeter-equation">
<h1>Lattice Bethe-Salpeter Equation<a class="headerlink" href="#lattice-bethe-salpeter-equation" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.bse.solve_lattice_bse">
<code class="descclassname">triqs_tprf.bse.</code><code class="descname">solve_lattice_bse</code><span class="sig-paren">(</span><em>g_wk</em>, <em>gamma_wnn</em>, <em>tail_corr_nwf=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#solve_lattice_bse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.bse.solve_lattice_bse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the generalized lattice susceptibility 
<span class="math">\(\chi_{abcd}(\omega, \mathbf{k})\)</span> using the Bethe-Salpeter 
equation (BSE).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g_wk</strong> : Single-particle Green’s function <span class="math">\(G_{ab}(\omega, \mathbf{k})\)</span>.</p>
<p><strong>gamma_wnn</strong> : Local particle-hole vertex function</p>
<blockquote>
<div><p><span class="math">\(\Gamma_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
<p><strong>tail_corr_nwf</strong> : Number of fermionic freqiencies to use in the</p>
<blockquote>
<div><p>tail correction of the sum over fermionic frequencies.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>chi0_wk</strong> : Generalized lattice susceptibility</p>
<blockquote class="last">
<div><p><span class="math">\(\chi_{abcd}(\omega, \mathbf{k})\)</span></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.bse.get_chi0_wnk">
<code class="descclassname">triqs_tprf.bse.</code><code class="descname">get_chi0_wnk</code><span class="sig-paren">(</span><em>g_wk</em>, <em>nw=1</em>, <em>nwf=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#get_chi0_wnk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.bse.get_chi0_wnk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the generalized lattice bubble susceptibility 
<span class="math">\(\chi^{(0)}_{abcd}(\omega, \nu, \mathbf{k})\)</span> from the single-particle
Green’s function <span class="math">\(G_{ab}(\omega, \mathbf{k})\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g_wk</strong> : Single-particle Green’s function <span class="math">\(G_{ab}(\omega, \mathbf{k})\)</span>.</p>
<p><strong>nw</strong> : Number of bosonic freqiencies in <span class="math">\(\chi\)</span>.</p>
<p><strong>nwf</strong> : Number of fermionic freqiencies in <span class="math">\(\chi\)</span>.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>chi0_wnk</strong> : Generalized lattice bubble susceptibility</p>
<blockquote class="last">
<div><p><span class="math">\(\chi^{(0)}_{abcd}(\omega, \nu, \mathbf{k})\)</span></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="gw-approximation">
<h1>GW approximation<a class="headerlink" href="#gw-approximation" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.lattice.gw_self_energy">
<code class="descclassname">triqs_tprf.lattice.</code><code class="descname">gw_self_energy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.gw_self_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::chi_wk_cvt Wr_wk, triqs_tprf::g_wk_cvt g_wk) -&gt; triqs_tprf::g_wk_t
GW self energy <span class="math">\(\Sigma(i\omega_n, \mathbf{k})\)</span> calculator</p>
<blockquote>
<div><p>Fourier transforms the screened interaction and the single-particle
Green’s function to imagiary time and real space.</p>
<div class="math" id="equation-reference-python-reference-14">
<span class="eqno">(15)<a class="headerlink" href="#equation-reference-python-reference-14" title="Permalink to this equation">¶</a></span>\[G_{ab}(\tau, \mathbf{r}) = \mathcal{F}^{-1}
  \left\{ G_{ab}(i\omega_n, \mathbf{k}) \right\}\]</div>
<div class="math" id="equation-reference-python-reference-15">
<span class="eqno">(16)<a class="headerlink" href="#equation-reference-python-reference-15" title="Permalink to this equation">¶</a></span>\[W^{(r)}_{abcd}(\tau, \mathbf{r}) = \mathcal{F}^{-1}
  \left\{ W^{(r)}_{abcd}(i\omega_n, \mathbf{k}) \right\}\]</div>
<p>computes the GW self-energy as the product</p>
<div class="math" id="equation-reference-python-reference-16">
<span class="eqno">(17)<a class="headerlink" href="#equation-reference-python-reference-16" title="Permalink to this equation">¶</a></span>\[\Sigma_{ab}(\tau, \mathbf{r}) =
  \sum_{cd} W^{(r)}_{abcd}(\tau, \mathbf{r}) G_{cd}(\tau, \mathbf{r})\]</div>
<p>and transforms back to frequency and momentum</p>
<div class="math" id="equation-reference-python-reference-17">
<span class="eqno">(18)<a class="headerlink" href="#equation-reference-python-reference-17" title="Permalink to this equation">¶</a></span>\[\Sigma_{ab}(i\omega_n, \mathbf{k}) =
  \mathcal{F} \left\{ \Sigma_{ab}(\tau, \mathbf{r}) \right\}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param V_k:</th><td class="field-body">static bare interaction <span class="math">\(V_{abcd}(\mathbf{k})\)</span></td>
</tr>
<tr class="field-even field"><th class="field-name">param Wr_wk:</th><td class="field-body">retarded screened interaction <span class="math">\(W^{(r)}_{abcd}(i\omega_n, \mathbf{k})\)</span></td>
</tr>
<tr class="field-odd field"><th class="field-name">param g_wk:</th><td class="field-body">single particle Green’s function <span class="math">\(G_{ab}(i\omega_n, \mathbf{k})\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return GW self-energy <span class="math">\(\Sigma_{ab}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="linearized-eliashberg-equation">
<h1>Linearized Eliashberg equation<a class="headerlink" href="#linearized-eliashberg-equation" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.eliashberg.solve_eliashberg_fft">
<code class="descclassname">triqs_tprf.eliashberg.</code><code class="descname">solve_eliashberg_fft</code><span class="sig-paren">(</span><em>Gamma_pp_wk</em>, <em>g_wk</em>, <em>Gamma_pp_const_k=None</em>, <em>tol=1e-10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#solve_eliashberg_fft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.eliashberg.solve_eliashberg_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the linearized Eliashberg equation</p>
<p>Returns the biggest eigenvalues and corresponding eigenvectors of the linearized Eliashberg
equation. The Eliashberg equation implementation is using fourier transformations for 
computational efficiency. The eigenvalues are found using an iterative algorithm from scipy.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Gamma_pp_wk</strong> : Gf,</p>
<blockquote>
<div><p>Pairing vertex <span class="math">\(\Gamma(i\omega_n, \mathbf{k})\)</span>. The mesh attribute of
the Gf must be a MeshProduct with the components (MeshImFreq, MeshBrillouinZone).</p>
</div></blockquote>
<p><strong>g_wk</strong> : Gf,</p>
<blockquote>
<div><p>Green’s function <span class="math">\(G(i\nu_n, \mathbf{k})\)</span>. The mesh attribute of the Gf must
be a MeshProduct with the components (MeshImFreq, MeshBrillouinZone).</p>
</div></blockquote>
<p><strong>Gamma_pp_const_k</strong> : float or np.ndarray or Gf, optional</p>
<blockquote>
<div><p>Part of the pairing vertex that is constant in Matsubara frequency space
<span class="math">\(\Gamma(\mathbf{k})\)</span>. If given as a Gf its mesh attribute needs to
be a MeshBrillouinZone.</p>
</div></blockquote>
<p><strong>tol</strong> : float, optional</p>
<blockquote>
<div><p>Relative accuracy for eigenvalues (stopping criterion).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Es</strong> : list of float,</p>
<blockquote>
<div><p>Biggest eigenvalues of the linearized Eliashberg equation <span class="math">\(\lambda\)</span>.</p>
</div></blockquote>
<p><strong>eigen_modes</strong> : list of Gf,</p>
<blockquote class="last">
<div><p>Corresponding eigenvectors (anomalous self-energies) 
<span class="math">\(\Delta(i\nu_n, \mathbf{k})\)</span> as Gf with MeshProduct with the components
(MeshImFreq, MeshBrillouinZone).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../theory/eliashberg.html#eliashberg"><span class="std std-ref">Linearized Eliashberg Equation</span></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="hubbard-atom-analytic-response-functions">
<h1>Hubbard atom analytic response functions<a class="headerlink" href="#hubbard-atom-analytic-response-functions" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.analytic_hubbard_atom.analytic_hubbard_atom">
<code class="descclassname">triqs_tprf.analytic_hubbard_atom.</code><code class="descname">analytic_hubbard_atom</code><span class="sig-paren">(</span><em>beta</em>, <em>U</em>, <em>nw</em>, <em>nwf</em>, <em>nwf_gf</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/analytic_hubbard_atom.html#analytic_hubbard_atom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.analytic_hubbard_atom.analytic_hubbard_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute dynamical response functions for the Hubbard atom at half filling.</p>
<p>This function returns an object that contains the single-particle
Greens function <span class="math">\(G(\omega)\)</span>, the magnetic two-particle generalized susceptibility
<span class="math">\(\chi_m(\omega, \nu, \nu')\)</span>, and the corresponding bare bubble 
<span class="math">\(\chi^{(0)}_m(\omega, \nu, \nu')\)</span>, and the magnetic vertex function
<span class="math">\(\Gamma_m(\omega, \nu, \nu')\)</span>.</p>
<p>This is implemented using analytical formulas from 
Thunstrom et al. [PRB 98, 235107 (2018)]
please cite the paper if you use this function!</p>
<p>In particular this is one exact solution to the Bethe-Salpeter
equation, that is the infinite matrix inverse problem:</p>
<div class="math" id="equation-reference-python-reference-18">
<span class="eqno">(19)<a class="headerlink" href="#equation-reference-python-reference-18" title="Permalink to this equation">¶</a></span>\[\Gamma_m = [\chi^{(0)}_m]^{-1} - \chi_m^{-1}\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>beta</strong> : float</p>
<blockquote>
<div><p>Inverse temperature.</p>
</div></blockquote>
<p><strong>U</strong> : float</p>
<blockquote>
<div><p>Hubbard U interaction parameter.</p>
</div></blockquote>
<p><strong>nw</strong> : int</p>
<blockquote>
<div><p>Number of bosonic Matsubara frequencies 
in the computed two-particle response functions.</p>
</div></blockquote>
<p><strong>nwf</strong> : int</p>
<blockquote>
<div><p>Number of fermionic Matsubara frequencies
in the computed two-particle response functions.</p>
</div></blockquote>
<p><strong>nwf_gf</strong> : int</p>
<blockquote>
<div><p>Number of fermionic Matsubara frequencies
in the computed single-particle Greens function.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>p</strong> : ParameterCollection</p>
<blockquote class="last">
<div><p>Object containing all the response functions and some other
observables, <cite>p.G_iw</cite>, <cite>p.chi_m</cite>, <cite>p.chi0_m</cite>, 
<cite>p.gamma_m</cite>, <cite>p.Z</cite>, <cite>p.m2</cite>, <cite>p.chi_m_static</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="two-particle-response-function-linear-algebra-operations">
<h1>Two-particle response function linear-algebra operations<a class="headerlink" href="#two-particle-response-function-linear-algebra-operations" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.linalg.inverse_PH">
<code class="descclassname">triqs_tprf.linalg.</code><code class="descname">inverse_PH</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.inverse_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function inversion <span class="math">\([g]^{-1}\)</span> in the particle-hole channel (PH).</p>
<blockquote>
<div><p>The two-particle response function <span class="math">\(g_{abcd}(\omega, \nu, \nu')\)</span> 
is cast to matrix form and inverted</p>
<div class="math" id="equation-reference-python-reference-19">
<span class="eqno">(20)<a class="headerlink" href="#equation-reference-python-reference-19" title="Permalink to this equation">¶</a></span>\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">two-particle response function to invert, <span class="math">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return <span class="math">\([g]^{-1}\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t</span></dt>
<dd><p class="first">Two-particle response-function inversion <span class="math">\([g]^{-1}\)</span> in the particle-hole channel (PH).</p>
<blockquote class="last">
<div><p>The two-particle response function <span class="math">\(g_{abcd}(\omega, \nu, \nu')\)</span>
is cast to matrix form and inverted</p>
<div class="math" id="equation-reference-python-reference-20">
<span class="eqno">(21)<a class="headerlink" href="#equation-reference-python-reference-20" title="Permalink to this equation">¶</a></span>\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">two-particle response function to invert, <span class="math">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return <span class="math">\([g]^{-1}\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
</dd>
</dl>
<p>Signature : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.linalg.inverse_PP">
<code class="descclassname">triqs_tprf.linalg.</code><code class="descname">inverse_PP</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.inverse_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function inversion <span class="math">\([g]^{-1}\)</span> in the particle-particle channel (PP).</p>
<blockquote>
<div><p>The two-particle response function <span class="math">\(g_{abcd}(\omega, \nu, \nu')\)</span> 
is cast to matrix form and inverted</p>
<div class="math" id="equation-reference-python-reference-21">
<span class="eqno">(22)<a class="headerlink" href="#equation-reference-python-reference-21" title="Permalink to this equation">¶</a></span>\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">two-particle response function to invert, <span class="math">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return <span class="math">\([g]^{-1}\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t</span></dt>
<dd><p class="first">Two-particle response-function inversion <span class="math">\([g]^{-1}\)</span> in the particle-particle channel (PP).</p>
<blockquote class="last">
<div><p>The two-particle response function <span class="math">\(g_{abcd}(\omega, \nu, \nu')\)</span>
is cast to matrix form and inverted</p>
<div class="math" id="equation-reference-python-reference-22">
<span class="eqno">(23)<a class="headerlink" href="#equation-reference-python-reference-22" title="Permalink to this equation">¶</a></span>\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">two-particle response function to invert, <span class="math">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return <span class="math">\([g]^{-1}\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
</dd>
</dl>
<p>Signature : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.linalg.inverse_PH_bar">
<code class="descclassname">triqs_tprf.linalg.</code><code class="descname">inverse_PH_bar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.inverse_PH_bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function inversion <span class="math">\([g]^{-1}\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote>
<div><p>The two-particle response function <span class="math">\(g_{abcd}(\omega, \nu, \nu')\)</span> 
is cast to matrix form and inverted</p>
<div class="math" id="equation-reference-python-reference-23">
<span class="eqno">(24)<a class="headerlink" href="#equation-reference-python-reference-23" title="Permalink to this equation">¶</a></span>\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">two-particle response function to invert, <span class="math">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return <span class="math">\([g]^{-1}\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t</span></dt>
<dd><p class="first">Two-particle response-function inversion <span class="math">\([g]^{-1}\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote class="last">
<div><p>The two-particle response function <span class="math">\(g_{abcd}(\omega, \nu, \nu')\)</span>
is cast to matrix form and inverted</p>
<div class="math" id="equation-reference-python-reference-24">
<span class="eqno">(25)<a class="headerlink" href="#equation-reference-python-reference-24" title="Permalink to this equation">¶</a></span>\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">param g:</th><td class="field-body">two-particle response function to invert, <span class="math">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></td>
</tr>
</tbody>
</table>
<p>&#64;return <span class="math">\([g]^{-1}\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
</dd>
</dl>
<p>Signature : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.linalg.product_PH">
<code class="descclassname">triqs_tprf.linalg.</code><code class="descname">product_PH</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.product_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function product <span class="math">\(A * B\)</span> in the particle-hole channel (PH).</p>
<blockquote>
<div><p>The two-particle response functions <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> 
and <span class="math">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math" id="equation-reference-python-reference-25">
<span class="eqno">(26)<a class="headerlink" href="#equation-reference-python-reference-25" title="Permalink to this equation">¶</a></span>\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) 
= \sum_{\bar{\nu}ab} 
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega) 
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega) \]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
:param B: two-particle response function <span class="math">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
&#64;return <span class="math">\((A * B)\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(triqs_tprf::g2_iw_vt A, triqs_tprf::g2_iw_vt B) -&gt; triqs_tprf::g2_iw_t</span></dt>
<dd><p class="first">Two-particle response-function product <span class="math">\(A * B\)</span> in the particle-hole channel (PH).</p>
<blockquote class="last">
<div><p>The two-particle response functions <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
and <span class="math">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math" id="equation-reference-python-reference-26">
<span class="eqno">(27)<a class="headerlink" href="#equation-reference-python-reference-26" title="Permalink to this equation">¶</a></span>\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
= \sum_{\bar{\nu}ab}
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega)
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega)\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
:param B: two-particle response function <span class="math">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
&#64;return <span class="math">\((A * B)\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
</dd>
</dl>
<p>Signature : (triqs_tprf::g2_nn_vt A, triqs_tprf::g2_nn_vt B) -&gt; triqs_tprf::g2_nn_t</p>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.linalg.product_PP">
<code class="descclassname">triqs_tprf.linalg.</code><code class="descname">product_PP</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.product_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function product <span class="math">\(A * B\)</span> in the particle-particle channel (PP).</p>
<blockquote>
<div><p>The two-particle response functions <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> 
and <span class="math">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math" id="equation-reference-python-reference-27">
<span class="eqno">(28)<a class="headerlink" href="#equation-reference-python-reference-27" title="Permalink to this equation">¶</a></span>\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) 
= \sum_{\bar{\nu}ab} 
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega) 
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega) \]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
:param B: two-particle response function <span class="math">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
&#64;return <span class="math">\((A * B)\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(triqs_tprf::g2_iw_vt A, triqs_tprf::g2_iw_vt B) -&gt; triqs_tprf::g2_iw_t</span></dt>
<dd><p class="first">Two-particle response-function product <span class="math">\(A * B\)</span> in the particle-particle channel (PP).</p>
<blockquote class="last">
<div><p>The two-particle response functions <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
and <span class="math">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math" id="equation-reference-python-reference-28">
<span class="eqno">(29)<a class="headerlink" href="#equation-reference-python-reference-28" title="Permalink to this equation">¶</a></span>\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
= \sum_{\bar{\nu}ab}
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega)
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega)\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
:param B: two-particle response function <span class="math">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
&#64;return <span class="math">\((A * B)\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
</dd>
</dl>
<p>Signature : (triqs_tprf::g2_nn_vt A, triqs_tprf::g2_nn_vt B) -&gt; triqs_tprf::g2_nn_t</p>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.linalg.product_PH_bar">
<code class="descclassname">triqs_tprf.linalg.</code><code class="descname">product_PH_bar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.product_PH_bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function product <span class="math">\(A * B\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote>
<div><p>The two-particle response functions <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> 
and <span class="math">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math" id="equation-reference-python-reference-29">
<span class="eqno">(30)<a class="headerlink" href="#equation-reference-python-reference-29" title="Permalink to this equation">¶</a></span>\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) 
= \sum_{\bar{\nu}ab} 
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega) 
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega) \]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
:param B: two-particle response function <span class="math">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
&#64;return <span class="math">\((A * B)\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(triqs_tprf::g2_iw_vt A, triqs_tprf::g2_iw_vt B) -&gt; triqs_tprf::g2_iw_t</span></dt>
<dd><p class="first">Two-particle response-function product <span class="math">\(A * B\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote class="last">
<div><p>The two-particle response functions <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
and <span class="math">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math" id="equation-reference-python-reference-30">
<span class="eqno">(31)<a class="headerlink" href="#equation-reference-python-reference-30" title="Permalink to this equation">¶</a></span>\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
= \sum_{\bar{\nu}ab}
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega)
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega)\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
:param B: two-particle response function <span class="math">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
&#64;return <span class="math">\((A * B)\)</span> in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
</dd>
</dl>
<p>Signature : (triqs_tprf::g2_nn_vt A, triqs_tprf::g2_nn_vt B) -&gt; triqs_tprf::g2_nn_t</p>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.linalg.identity_PH">
<code class="descclassname">triqs_tprf.linalg.</code><code class="descname">identity_PH</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.identity_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function identity operator <span class="math">\(\mathbf{1}\)</span> in the particle-hole channel (PH).</p>
<blockquote>
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math" id="equation-reference-python-reference-31">
<span class="eqno">(32)<a class="headerlink" href="#equation-reference-python-reference-31" title="Permalink to this equation">¶</a></span>\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) 
\equiv 
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator
&#64;return the unity operator <span class="math">\(\mathbf{1}\)</span>, in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t</span></dt>
<dd><p class="first">Two-particle response-function identity operator <span class="math">\(\mathbf{1}\)</span> in the particle-hole channel (PH).</p>
<blockquote class="last">
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math" id="equation-reference-python-reference-32">
<span class="eqno">(33)<a class="headerlink" href="#equation-reference-python-reference-32" title="Permalink to this equation">¶</a></span>\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
\equiv
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator
&#64;return the unity operator <span class="math">\(\mathbf{1}\)</span>, in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
</dd>
</dl>
<p>Signature : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.linalg.identity_PP">
<code class="descclassname">triqs_tprf.linalg.</code><code class="descname">identity_PP</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.identity_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function identity operator <span class="math">\(\mathbf{1}\)</span> in the particle-particle channel (PP).</p>
<blockquote>
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math" id="equation-reference-python-reference-33">
<span class="eqno">(34)<a class="headerlink" href="#equation-reference-python-reference-33" title="Permalink to this equation">¶</a></span>\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) 
\equiv 
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator
&#64;return the unity operator <span class="math">\(\mathbf{1}\)</span>, in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t</span></dt>
<dd><p class="first">Two-particle response-function identity operator <span class="math">\(\mathbf{1}\)</span> in the particle-particle channel (PP).</p>
<blockquote class="last">
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math" id="equation-reference-python-reference-34">
<span class="eqno">(35)<a class="headerlink" href="#equation-reference-python-reference-34" title="Permalink to this equation">¶</a></span>\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
\equiv
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator
&#64;return the unity operator <span class="math">\(\mathbf{1}\)</span>, in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
</dd>
</dl>
<p>Signature : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.linalg.identity_PH_bar">
<code class="descclassname">triqs_tprf.linalg.</code><code class="descname">identity_PH_bar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.identity_PH_bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function identity operator <span class="math">\(\mathbf{1}\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote>
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math" id="equation-reference-python-reference-35">
<span class="eqno">(36)<a class="headerlink" href="#equation-reference-python-reference-35" title="Permalink to this equation">¶</a></span>\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) 
\equiv 
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator
&#64;return the unity operator <span class="math">\(\mathbf{1}\)</span>, in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
<dl class="docutils">
<dt>Signature <span class="classifier-delimiter">:</span> <span class="classifier">(triqs_tprf::g2_iw_vt g) -&gt; triqs_tprf::g2_iw_t</span></dt>
<dd><p class="first">Two-particle response-function identity operator <span class="math">\(\mathbf{1}\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote class="last">
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math" id="equation-reference-python-reference-36">
<span class="eqno">(37)<a class="headerlink" href="#equation-reference-python-reference-36" title="Permalink to this equation">¶</a></span>\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
\equiv
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math">\(\{a, b, c, d \}\)</span> to <span class="math">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
<p>&#64;tparam CH selects the two-particle channel
:param A: two-particle response function <span class="math">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator
&#64;return the unity operator <span class="math">\(\mathbf{1}\)</span>, in the given channel
&#64;include tprf/linalg.hpp
&#64;note Assign to gf (g2_iw_t) yields move operation while assigning to gf_view (g2_iw_vt) causes extra copy operation</p>
</div></blockquote>
</dd>
</dl>
<p>Signature : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd></dl>

</div>
<div class="section" id="wannier90-tight-binding-parsers">
<h1>Wannier90 tight binding parsers<a class="headerlink" href="#wannier90-tight-binding-parsers" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="triqs_tprf.wannier90.parse_hopping_from_wannier90_hr_dat">
<code class="descclassname">triqs_tprf.wannier90.</code><code class="descname">parse_hopping_from_wannier90_hr_dat</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_hopping_from_wannier90_hr_dat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_hopping_from_wannier90_hr_dat" title="Permalink to this definition">¶</a></dt>
<dd><p>Wannier90 real space hopping parser of <code class="docutils literal"><span class="pre">*_hr.dat</span></code> files.</p>
<p>Returns a dictionary where the keys are the real-space hopping vectors, 
in terms of multiples of the lattice vectors, and the values are
<code class="docutils literal"><span class="pre">num_wann</span> <span class="pre">*</span> <span class="pre">num_wann</span></code> numpy ndarrays with the hopping integrals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Wannier90 <code class="docutils literal"><span class="pre">*_hr.dat</span></code> file to parse.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>hopp_dict</strong> : dict</p>
<blockquote>
<div><p>Dictionary of real space hoppings.</p>
</div></blockquote>
<p><strong>num_wann</strong> : int</p>
<blockquote class="last">
<div><p>Total number of Wannier functions per unit-cell.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.wannier90.parse_lattice_vectors_from_wannier90_wout">
<code class="descclassname">triqs_tprf.wannier90.</code><code class="descname">parse_lattice_vectors_from_wannier90_wout</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_lattice_vectors_from_wannier90_wout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_lattice_vectors_from_wannier90_wout" title="Permalink to this definition">¶</a></dt>
<dd><p>Wannier90 real space lattice vectors parser of <code class="docutils literal"><span class="pre">*.wout</span></code> files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Wannier90 <code class="docutils literal"><span class="pre">*.wout</span></code> file to parse.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>vectors</strong> : list of three three-tuples of floats</p>
<blockquote class="last">
<div><p>Lattice vectors.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.wannier90.parse_reciprocal_lattice_vectors_from_wannier90_wout">
<code class="descclassname">triqs_tprf.wannier90.</code><code class="descname">parse_reciprocal_lattice_vectors_from_wannier90_wout</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_reciprocal_lattice_vectors_from_wannier90_wout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_reciprocal_lattice_vectors_from_wannier90_wout" title="Permalink to this definition">¶</a></dt>
<dd><p>Wannier90 reciprocal space lattice vectors parser of <code class="docutils literal"><span class="pre">*.wout</span></code> files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Wannier90 <code class="docutils literal"><span class="pre">*.wout</span></code> file to parse.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>vectors</strong> : list of three three-tuples of floats</p>
<blockquote class="last">
<div><p>Reciprocal lattice vectors.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="triqs_tprf.wannier90.parse_band_structure_from_wannier90_band_dat">
<code class="descclassname">triqs_tprf.wannier90.</code><code class="descname">parse_band_structure_from_wannier90_band_dat</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_band_structure_from_wannier90_band_dat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_band_structure_from_wannier90_band_dat" title="Permalink to this definition">¶</a></dt>
<dd><p>Wannier90 band structure parser of <code class="docutils literal"><span class="pre">*_band.dat`</span></code> files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filename</strong> : str</p>
<blockquote>
<div><p>Wannier90 <code class="docutils literal"><span class="pre">*_band.dat</span></code> file to parse.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>E</strong> : ndarray (2D)</p>
<blockquote>
<div><p>Band energies.</p>
</div></blockquote>
<p><strong>w</strong> : ndarray (1D)</p>
<blockquote class="last">
<div><p>k-space path points.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="tight-binding-lattice-model">
<h1>Tight binding lattice model<a class="headerlink" href="#tight-binding-lattice-model" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="triqs_tprf.tight_binding.TBLattice">
<em class="property">class </em><code class="descclassname">triqs_tprf.tight_binding.</code><code class="descname">TBLattice</code><span class="sig-paren">(</span><em>units, hopping, orbital_positions=[(0, 0, 0)], orbital_names=['']</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/tight_binding.html#TBLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Class describing a tight binding lattice model.</p>
<p>This class is based in the TRIQS tight binding class and has been extended with
some extra convienience methods and documentation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>units</strong> : list of three-tuples of floats</p>
<blockquote>
<div><p>Basis vectors for the real space lattice.</p>
</div></blockquote>
<p><strong>hopping</strong> : dict</p>
<blockquote>
<div><p>Dictionary with three tuple of integeers as keys, 
describing real space hoppings in multiples of 
the real space lattice basis vectors, and values being 
numpy ndarray hopping matrices in the orbital indices.</p>
</div></blockquote>
<p><strong>orbital_positions</strong> : list of three three-tuples of floats.</p>
<blockquote>
<div><p>Internal orbital positions in the unit-cell.</p>
</div></blockquote>
<p><strong>orbital_names</strong> : list of strings</p>
<blockquote class="last">
<div><p>Names for each orbital.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="triqs_tprf.tight_binding.TBLattice.on_mesh_brillouin_zone">
<code class="descname">on_mesh_brillouin_zone</code><span class="sig-paren">(</span><em>n_k</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/tight_binding.html#TBLattice.on_mesh_brillouin_zone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.on_mesh_brillouin_zone" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a discretization of the tight binding model in
reciprocal space with given number of k-points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n_k</strong> : three-tuple of ints</p>
<blockquote>
<div><p>Number of k-points in every dimension.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>e_k</strong> : TRIQS Greens function on a Brillioun zone mesh</p>
<blockquote class="last">
<div><p>Reciprocal space tight binding dispersion.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="triqs_tprf.super_lattice.TBSuperLattice">
<em class="property">class </em><code class="descclassname">triqs_tprf.super_lattice.</code><code class="descname">TBSuperLattice</code><span class="sig-paren">(</span><em>tb_lattice</em>, <em>super_lattice_units</em>, <em>cluster_sites=None</em>, <em>remove_internal_hoppings=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Class building a superlattice on top of a base lattice (TBLattice).</p>
<p>The class inherits from TBLattice and has all the basic TBLattice methods, especially the <code class="docutils literal"><span class="pre">on_mesh_brillouin_zone</span></code>-method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tb_lattice</strong> : TBLattice instance</p>
<blockquote>
<div><p>The base tight binding lattice.</p>
</div></blockquote>
<p><strong>super_lattice_units</strong> : ndarray (2D)</p>
<blockquote>
<div><p>The unit vectors of the superlattice in the <code class="docutils literal"><span class="pre">tb_lattice</span></code> (integer) coordinates.</p>
</div></blockquote>
<p><strong>cluster_sites :</strong> :</p>
<blockquote>
<div><p>Coordinates of the cluster in tb_lattice coordinates. 
If <code class="docutils literal"><span class="pre">None</span></code>, an automatic computation of cluster positions 
is made as follows: it takes all points whose coordinates 
in the basis of the superlattice are in [0, 1[^dimension.</p>
</div></blockquote>
<p><strong>remove_internal_hoppings</strong> : bool</p>
<blockquote class="last">
<div><p>If <code class="docutils literal"><span class="pre">true</span></code>, the hopping terms are removed inside the cluster. 
Useful to add Hartree Fock terms at the boundary of a cluster, e.g.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_L_to_SL">
<code class="descname">change_coordinates_L_to_SL</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.change_coordinates_L_to_SL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_L_to_SL" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a point on the tb_lattice in lattice coordinates, returns its coordinates (R, alpha) in the Superlattice</p>
</dd></dl>

<dl class="method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_SL_to_L">
<code class="descname">change_coordinates_SL_to_L</code><span class="sig-paren">(</span><em>R</em>, <em>alpha</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.change_coordinates_SL_to_L"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_SL_to_L" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a point in the supercell R, site (number) alpha, it computes its position on the tb_lattice in lattice coordinates</p>
</dd></dl>

<dl class="method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.cluster_sites">
<code class="descname">cluster_sites</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.cluster_sites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.cluster_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the position of the cluster site in the tb_lattice coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.fold">
<code class="descname">fold</code><span class="sig-paren">(</span><em>D1</em>, <em>remove_internal=False</em>, <em>create_zero=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.fold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.fold" title="Permalink to this definition">¶</a></dt>
<dd><p>Input: a function  r-&gt; f(r) on the tb_lattice given as a dictionnary
Output: the function R-&gt; F(R) folded on the superlattice.
Only requirement is that f(r)[orbital1, orbital2] is properly defined.
Hence f(r) can be a numpy, a GFBloc, etc…</p>
</dd></dl>

<dl class="method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.pack_index_site_orbital">
<code class="descname">pack_index_site_orbital</code><span class="sig-paren">(</span><em>n_site</em>, <em>n_orbital</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.pack_index_site_orbital"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.pack_index_site_orbital" title="Permalink to this definition">¶</a></dt>
<dd><p>nsite and n_orbital must start at 0</p>
</dd></dl>

<dl class="method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.unpack_index_site_orbital">
<code class="descname">unpack_index_site_orbital</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.unpack_index_site_orbital"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.unpack_index_site_orbital" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse of pack_index_site_orbital</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="hartree-fock-and-hartree-solvers">
<h1>Hartree-Fock and Hartree solvers<a class="headerlink" href="#hartree-fock-and-hartree-solvers" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver">
<em class="property">class </em><code class="descclassname">triqs_tprf.hf_solver.</code><code class="descname">HartreeFockSolver</code><span class="sig-paren">(</span><em>e_k</em>, <em>beta</em>, <em>H_int=None</em>, <em>gf_struct=None</em>, <em>mu0=0.0</em>, <em>mu_max=10</em>, <em>mu_min=-10.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree-Fock solver for local interactions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>e_k</strong> : TRIQS Greens function on a Brillouin zone mesh</p>
<blockquote>
<div><p>Single-particle dispersion.</p>
</div></blockquote>
<p><strong>beta</strong> : float</p>
<blockquote>
<div><p>inverse temperature</p>
</div></blockquote>
<p><strong>H_int</strong> : TRIQS Operator instance</p>
<blockquote>
<div><p>Local interaction Hamiltonian</p>
</div></blockquote>
<p><strong>gf_struct</strong> : list of lists of block index and list of internal orbital indices</p>
<blockquote>
<div><p>gf_struct fixing orbital order between e_k and H_int</p>
</div></blockquote>
<p><strong>mu0</strong> : float</p>
<blockquote>
<div><p>chemical potential</p>
</div></blockquote>
<p><strong>mu_min, mu_max</strong> : float, optional</p>
<blockquote class="last">
<div><p>range for chemical potential search.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.mat2vec">
<code class="descname">mat2vec</code><span class="sig-paren">(</span><em>mat</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.mat2vec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.mat2vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a unitary matrix to a vector representation
with the order</p>
<ol class="arabic simple">
<li>the real diagonal entries</li>
<li>the real part of the upper triangular entries</li>
<li>the imaginary part of the upper triangular entries</li>
</ol>
</dd></dl>

<dl class="method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.solve_iter">
<code class="descname">solve_iter</code><span class="sig-paren">(</span><em>N_target</em>, <em>M0=None</em>, <em>mu0=None</em>, <em>nitermax=100</em>, <em>mixing=0.5</em>, <em>tol=1e-09</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.solve_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the HF-equations using forward recursion at fixed density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>N_target</strong> : float</p>
<blockquote>
<div><p>Total density.</p>
</div></blockquote>
<p><strong>M0</strong> : ndarray (2D), optional</p>
<blockquote>
<div><p>Initial mean-field (0 if None).</p>
</div></blockquote>
<p><strong>mu0</strong> : float, optional</p>
<blockquote>
<div><p>Initial chemical potential.</p>
</div></blockquote>
<p><strong>nitermax</strong> : int, optional</p>
<blockquote>
<div><p>Maximal number of self consistent iterations.</p>
</div></blockquote>
<p><strong>mixing</strong> : float, optional</p>
<blockquote>
<div><p>Linear mixing parameter.</p>
</div></blockquote>
<p><strong>tol</strong> : float, optional</p>
<blockquote>
<div><p>Convergence in relative change of the density matrix.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rho</strong> : ndarray (2D)</p>
<blockquote class="last">
<div><p>Local density matrix.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.solve_newton">
<code class="descname">solve_newton</code><span class="sig-paren">(</span><em>N_target</em>, <em>M0=None</em>, <em>mu0=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.solve_newton"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the HF-equations using a quasi Newton method at fixed density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>N_tot</strong> : float</p>
<blockquote>
<div><p>Total density.</p>
</div></blockquote>
<p><strong>M0</strong> : ndarray (2D), optional</p>
<blockquote>
<div><p>Initial mean-field (0 if None).</p>
</div></blockquote>
<p><strong>mu0</strong> : float, optional</p>
<blockquote class="last">
<div><p>Initial chemical potential.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.solve_newton_mu">
<code class="descname">solve_newton_mu</code><span class="sig-paren">(</span><em>mu</em>, <em>M0=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.solve_newton_mu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the HF-equations using a quasi Newton method at fixed chemical potential.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mu0</strong> : float</p>
<blockquote>
<div><p>Initial chemical potential.</p>
</div></blockquote>
<p><strong>M0</strong> : ndarray (2D), optional</p>
<blockquote class="last">
<div><p>Initial mean-field (0 if None).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.vec2mat">
<code class="descname">vec2mat</code><span class="sig-paren">(</span><em>vec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.vec2mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.vec2mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from vector representation to a unitary matrix
see mat2vec(…) for details.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="triqs_tprf.hf_response.HartreeFockResponse">
<em class="property">class </em><code class="descclassname">triqs_tprf.hf_response.</code><code class="descname">HartreeFockResponse</code><span class="sig-paren">(</span><em>hartree_fock_solver</em>, <em>eps=1e-09</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_response.html#HartreeFockResponse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.hf_response.HartreeFockResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree-Fock linear response calculator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>hartree_fock_solver</strong> : HartreeFockSolver instance</p>
<blockquote>
<div><p>Converged Hartree-Fock solver.</p>
</div></blockquote>
<p><strong>eps</strong> : float</p>
<blockquote class="last">
<div><p>Step size in finite difference linear response calculation.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="triqs_tprf.hf_solver.HartreeSolver">
<em class="property">class </em><code class="descclassname">triqs_tprf.hf_solver.</code><code class="descname">HartreeSolver</code><span class="sig-paren">(</span><em>e_k</em>, <em>beta</em>, <em>H_int=None</em>, <em>gf_struct=None</em>, <em>mu0=0.0</em>, <em>mu_max=10</em>, <em>mu_min=-10.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeSolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree solver for local interactions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>e_k</strong> : TRIQS Greens function on a Brillouin zone mesh</p>
<blockquote>
<div><p>Single-particle dispersion.</p>
</div></blockquote>
<p><strong>beta</strong> : float</p>
<blockquote>
<div><p>inverse temperature</p>
</div></blockquote>
<p><strong>H_int</strong> : TRIQS Operator instance</p>
<blockquote>
<div><p>Local interaction Hamiltonian</p>
</div></blockquote>
<p><strong>gf_struct</strong> : list of lists of block index and list of internal orbital indices</p>
<blockquote>
<div><p>gf_struct fixing orbital order between e_k and H_int</p>
</div></blockquote>
<p><strong>mu0</strong> : float</p>
<blockquote>
<div><p>chemical potential</p>
</div></blockquote>
<p><strong>mu_min, mu_max</strong> : float, optional</p>
<blockquote class="last">
<div><p>range for chemical potential search.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="triqs_tprf.hf_response.HartreeResponse">
<em class="property">class </em><code class="descclassname">triqs_tprf.hf_response.</code><code class="descname">HartreeResponse</code><span class="sig-paren">(</span><em>hartree_solver</em>, <em>eps=1e-09</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_response.html#HartreeResponse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.hf_response.HartreeResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree linear response calculator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>hartree_solver</strong> : HartreeSolver instance</p>
<blockquote>
<div><p>Converged Hartree solver.</p>
</div></blockquote>
<p><strong>eps</strong> : float</p>
<blockquote class="last">
<div><p>Step size in finite difference linear response calculation.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="parameter-collections">
<h1>Parameter collections<a class="headerlink" href="#parameter-collections" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="triqs_tprf.ParameterCollection.ParameterCollection">
<em class="property">class </em><code class="descclassname">triqs_tprf.ParameterCollection.</code><code class="descname">ParameterCollection</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper class for handing collections of parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kwargs</strong> : dict</p>
<blockquote class="last">
<div><p>Key-word argument list of parameters.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>A <code class="docutils literal"><span class="pre">ParameterCollection</span></code> has any number of attributes, accessible with the
dot operator.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">p</span>
<span class="go">U = 1.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">p</span><span class="o">.</span><span class="n">beta</span>
<span class="go">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">p</span>
<span class="go">U = 1.0</span>
<span class="go">W = 1.2</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
</pre></div>
</div>
<p>and can be stored and loaded to/from TRIQS hdf archives.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pytriqs.archive</span> <span class="kn">import</span> <span class="n">HDFArchive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">arch</span><span class="p">:</span> <span class="n">arch</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">arch</span><span class="p">:</span> <span class="n">p_ref</span> <span class="o">=</span> <span class="n">arch</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">p_ref</span>
<span class="go">U = 1.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
</pre></div>
</div>
<dl class="method">
<dt id="triqs_tprf.ParameterCollection.ParameterCollection.convert_keys_from_string_to_python">
<code class="descname">convert_keys_from_string_to_python</code><span class="sig-paren">(</span><em>dict_key</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection.convert_keys_from_string_to_python"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection.convert_keys_from_string_to_python" title="Permalink to this definition">¶</a></dt>
<dd><p>pytriqs.archive.HDFArchive incorrectly mangles tuple keys to string
running this on the affected dict tries to revert this by running eval
on the string representation. UGLY FIX…</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="triqs_tprf.ParameterCollection.ParameterCollections">
<em class="property">class </em><code class="descclassname">triqs_tprf.ParameterCollection.</code><code class="descname">ParameterCollections</code><span class="sig-paren">(</span><em>objects=[]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollections"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollections" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper class for handing a series of collections of parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>objects</strong> : list</p>
<blockquote class="last">
<div><p>List of <code class="docutils literal"><span class="pre">ParameterCollection</span></code> instances.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>The <code class="docutils literal"><span class="pre">ParameterCollections</span></code> class makes it easy to get vectors of 
parameters from a list of <code class="docutils literal"><span class="pre">ParameterCollection</span></code> objects.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.337</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ps</span> <span class="o">=</span> <span class="n">ParameterCollections</span><span class="p">(</span><span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">ps</span><span class="o">.</span><span class="n">beta</span>
<span class="go">[10.  5.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">ps</span><span class="o">.</span><span class="n">U</span>
<span class="go">[1. 2.]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="cpp_reference.html" title="Lattice Green’s functions"
             >next</a> |</li>
        <li class="right" >
          <a href="../user_guide/Mean field and RPA response of the one dimensional Hubbard model.html" title="Mean field and RPA response for the one dimensional Hubbard model."
             >previous</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../documentation.html" >Documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, H. U.R. Strand.
    </div>
  </body>
</html>