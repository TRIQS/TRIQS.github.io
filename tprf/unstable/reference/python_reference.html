
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lattice Green’s functions &#8212; TPRF - Two-Particle Response Function tool box for TRIQS  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/triqs.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head><body>
<div class="pageheader">
  <ul>
    
    <li><a href="../install.html">Install</a></li>
    
    <li><a href="../documentation.html">Documentation</a></li>
    
    <li><a href="../issues.html">Issues</a></li>
    
    <li><a href="../about.html">About tprf</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../index.html">tprf</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">Two-particle response function tool box based on the <a class="triqs" style="font-size: 12px" href="https://triqs.github.io">TRIQS</a> library</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
    <li><a href="../index.html">Home</a> &raquo;</li>

        <li class="nav-item nav-item-this"><a href="">Lattice Green’s functions</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Lattice Green’s functions</a></li>
<li><a class="reference internal" href="#lindhard-non-interacting-generalized-susceptibility">Lindhard non-interacting generalized susceptibility</a></li>
<li><a class="reference internal" href="#random-phase-approximation">Random Phase Approximation</a></li>
<li><a class="reference internal" href="#impurity-susceptibility-and-bethe-salpeter-equation">Impurity susceptibility and Bethe-Salpeter Equation</a></li>
<li><a class="reference internal" href="#lattice-bethe-salpeter-equation">Lattice Bethe-Salpeter Equation</a></li>
<li><a class="reference internal" href="#gw-approximation">GW approximation</a></li>
<li><a class="reference internal" href="#linearized-eliashberg-equation">Linearized Eliashberg equation</a></li>
<li><a class="reference internal" href="#hubbard-atom-analytic-response-functions">Hubbard atom analytic response functions</a></li>
<li><a class="reference internal" href="#two-particle-response-function-linear-algebra-operations">Two-particle response function linear-algebra operations</a></li>
<li><a class="reference internal" href="#wannier90-tight-binding-parsers">Wannier90 tight binding parsers</a></li>
<li><a class="reference internal" href="#tight-binding-lattice-model">Tight binding lattice model</a></li>
<li><a class="reference internal" href="#hartree-fock-and-hartree-solvers">Hartree-Fock and Hartree solvers</a></li>
<li><a class="reference internal" href="#parameter-collections">Parameter collections</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/python_reference.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="lattice-green-s-functions">
<span id="gf-functions"></span><h1>Lattice Green’s functions<a class="headerlink" href="#lattice-green-s-functions" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.lattice.lattice_dyson_g0_wk">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></code><code class="sig-name descname"><span class="pre">lattice_dyson_g0_wk</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g0_wk" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, gf_mesh&lt;triqs::mesh::imfreq&gt; mesh) -&gt; triqs_tprf::g_wk_t
Construct a non-interacting Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G^{(0)}_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[G^{(0)}_{a\bar{b}}(i\omega_n, \mathbf{k}) = \left[
    (i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k})
 \right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>,
and a Matsubara frequency Green’s function mesh.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mu</strong> :</p>
<blockquote>
<div><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</div></blockquote>
<p><strong>e_k</strong> :</p>
<blockquote>
<div><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</div></blockquote>
<p><strong>mesh</strong> :</p>
<blockquote>
<div><p>imaginary frequency mesh</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G^{(0)}_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.lattice.lattice_dyson_g_wk">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></code><code class="sig-name descname"><span class="pre">lattice_dyson_g_wk</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g_wk" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an interacting Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[G_{a\bar{b}}(i\omega_n, \mathbf{k}) = \left[
    (i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(i\omega_n)
    \right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>,
chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>, and a momentum independent Matsubara frequency
self energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span>.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mu</strong> :</p>
<blockquote>
<div><blockquote>
<div><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</div></blockquote>
<dl class="simple">
<dt>e_k</dt><dd><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</dd>
<dt>sigma_wk</dt><dd><p>imaginary frequency self-energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(i\omega_n, \mathbf{k})\)</span></p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.lattice.lattice_dyson_g_w">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></code><code class="sig-name descname"><span class="pre">lattice_dyson_g_w</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lattice_dyson_g_w" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (float mu, triqs_tprf::e_k_cvt e_k, triqs_tprf::g_w_cvt sigma_w) -&gt; triqs_tprf::g_w_t
Construct an interacting Matsubara frequency local (<span class="math notranslate nohighlight">\(\mathbf{r}=\mathbf{0}\)</span>) lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\omega_n)\)</span></p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[G_{a\bar{b}}(i\omega_n) = \frac{1}{N_k} \sum_\mathbf{k} \left[
    (i\omega_n + \mu ) \cdot \mathbf{1}  - \epsilon(\mathbf{k}) - \Sigma(i\omega_n)
 \right]^{-1}_{a\bar{b}},\]</div>
<p>using a discretized dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>,
chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>, and a momentum independent Matsubara frequency
self energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span>.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mu</strong> :</p>
<blockquote>
<div><p>chemical potential <span class="math notranslate nohighlight">\(\mu\)</span></p>
</div></blockquote>
<p><strong>e_k</strong> :</p>
<blockquote>
<div><p>discretized lattice dispersion <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span></p>
</div></blockquote>
<p><strong>sigma_w</strong> :</p>
<blockquote>
<div><p>imaginary frequency self-energy <span class="math notranslate nohighlight">\(\Sigma_{\bar{a}b}(i\omega_n)\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>Matsubara frequency lattice Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lindhard-non-interacting-generalized-susceptibility">
<h1>Lindhard non-interacting generalized susceptibility<a class="headerlink" href="#lindhard-non-interacting-generalized-susceptibility" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.lattice.lindhard_chi00_wk">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></code><code class="sig-name descname"><span class="pre">lindhard_chi00_wk</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.lindhard_chi00_wk" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::e_k_cvt e_k, int nw, float beta, float mu) -&gt; triqs_tprf::chi_wk_t
Generalized Lindhard susceptibility in the particle-hole channel <span class="math notranslate nohighlight">\(\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q})\)</span>.</p>
<blockquote>
<div><p>Analytic calculation of the generalized (non-interacting) Lindhard susceptibility
in the particle-hole channel. The analytic expression is obtained using residue calculus
to explicitly evaluate the matsubara sum of the fourier transformed imaginary time
bubble product of two non-interacting single-particle Green’s functions.</p>
<div class="math notranslate nohighlight">
\[G^{(0)}_{a\bar{b}}(\mathbf{k}, i\omega_n) =
\left[ i\omega_n \cdot \mathbf{1} - \epsilon(\mathbf{k}) \right]^{-1} .\]</div>
<p>The analytic evaluation of the bubble diagram gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\chi^{(00)}_{\bar{a}b\bar{c}d}(i\omega_n, \mathbf{q}) \equiv
   \mathcal{F} \left\{
  - G^{(0)}_{d\bar{a}}(\tau, \mathbf{r}) G^{(0)}_{b\bar{c}}(-\tau, -\mathbf{r})
\right\}
   =
- \frac{1}{N_k} \sum_{\nu} \sum_{\mathbf{k}}
     G^{(0)}_{d\bar{a}}(\nu, \mathbf{k})
  G^{(0)}_{b\bar{c}}(\nu + \omega, \mathbf{k} + \mathbf{q})
\\ =
- \frac{1}{N_k} \sum_{\nu} \sum_{\mathbf{k}}
  \left( \sum_{i}
     U^\dagger_{di}(\mathbf{k}) \frac{1}{i\nu - \epsilon_{\mathbf{k}, i}} U_{i\bar{a}}(\mathbf{k})
  \right)
  \left( \sum_j
  U^\dagger_{bj}(\mathbf{k} + \mathbf{q})
  \frac{1}{i\nu + i\omega - \epsilon_{\mathbf{k} + \mathbf{q}, j}}
  U_{j\bar{c}}(\mathbf{k} + \mathbf{q})
  \right)
\\ =
\frac{1}{N_k} \sum_{\mathbf{k}} \sum_{ij}
  \left(
    [1 - \delta_{0, \omega_n} \delta_{\epsilon_{\mathbf{k},i},\epsilon_{\mathbf{k}+\mathbf{q}, j}})]
    \frac{ f(\epsilon_{\mathbf{k}, i}) - f(\epsilon_{\mathbf{k}+\mathbf{q}, j}) }
         {i\omega_n + \epsilon_{\mathbf{k} + \mathbf{q}, j} - \epsilon_{\mathbf{k}, i}}
    +
    \delta_{0, \omega_n} \delta_{\epsilon_{\mathbf{k},i},\epsilon_{\mathbf{k}+\mathbf{q}, j}}
    \frac{\beta}{4 \cosh^2 (\beta \epsilon_{\mathbf{k}, i} / 2) }
  \right)
  \\ \times
  U_{i\bar{a}}(\mathbf{k}) U^\dagger_{di}(\mathbf{k})
  U_{j\bar{c}}(\mathbf{k} + \mathbf{q}) U^\dagger_{bj}(\mathbf{k} + \mathbf{q})\end{split}\]</div>
<p>where the <span class="math notranslate nohighlight">\(U(\mathbf{k})\)</span> matrices are the diagonalizing unitary transform of the matrix valued
dispersion relation <span class="math notranslate nohighlight">\(\epsilon_{\bar{a}b}(\mathbf{k})\)</span>, i.e.</p>
<div class="math notranslate nohighlight">
\[\sum_{\bar{a}b} U_{i\bar{a}}(\mathbf{k}) \epsilon_{\bar{a}b}(\mathbf{k}) U^\dagger_{bj} (\mathbf{k})
= \delta_{ij} \epsilon_{\mathbf{k}, i}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The analytic formula is sub-optimal in terms of performance for higher temperatures. The evaluation
scales as <span class="math notranslate nohighlight">\(\mathcal{O}(N_k^2)\)</span> which is worse than computing the bubble explicitly in imaginary
time, with scaling <span class="math notranslate nohighlight">\(\mathcal{O}(N_k N_\tau \log(N_k N_\tau)\)</span> for <span class="math notranslate nohighlight">\(N_k \gg N_\tau\)</span>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Care must be taken when evaluating the fermionic Matsubara frequency sum of the
product of two simple poles. By extending the sum to an integral over the complex
plane the standard expression for the Lindhard response is obtained when the
poles are non-degenerate. The degenerate case produces an additional frequency independent
contribution (the last term on the last row).</p>
</div>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="random-phase-approximation">
<h1>Random Phase Approximation<a class="headerlink" href="#random-phase-approximation" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.lattice.solve_rpa_PH">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></code><code class="sig-name descname"><span class="pre">solve_rpa_PH</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.solve_rpa_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::chi_wk_vt chi0, array_contiguous_view&lt;std::complex&lt;double&gt;,4&gt; U) -&gt; triqs_tprf::chi_wk_t
Random Phase Approximation (RPA) in the particle-hole channel</p>
<blockquote>
<div><p>Computes the equation</p>
<div class="math notranslate nohighlight">
\[\chi(\bar{a}b\bar{c}d) = \big(
\mathbb{1}
- \chi^{(0)}(\bar{a}b\bar{B}A) U(A\bar{B}D\bar{C})
\big)^{-1} \chi^{(0)}(\bar{C}D\bar{c}d)\,.\]</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chi0</strong> :</p>
<blockquote>
<div><p>bare particle-hole bubble <span class="math notranslate nohighlight">\(\chi^{(0)}_{\bar{a}b\bar{c}d}(\mathbf{k}, i\omega_n)\)</span></p>
</div></blockquote>
<p><strong>U</strong> :</p>
<blockquote>
<div><p>RPA static vertex as obtained from triqs_tprf.rpa_tensor.get_rpa_tensor <span class="math notranslate nohighlight">\(U_{a\bar{b}c\bar{d}}\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>RPA suceptibility <span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\mathbf{k}, i\omega_n)\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.rpa_tensor.kanamori_quartic_tensor">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.rpa_tensor.</span></code><code class="sig-name descname"><span class="pre">kanamori_quartic_tensor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">J</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Jp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/rpa_tensor.html#kanamori_quartic_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.rpa_tensor.kanamori_quartic_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Kanamori interaction as a quartic tensor</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{U}_{\text { Kanamori }} = U \sum_{i} \hat{n}_{i, \uparrow} \hat{n}_{i, \downarrow}+
\sum_{i&gt;j, s, s^{\prime}}\left(U^{\prime}-J \delta_{\sigma, \sigma^{\prime}}\right)
\hat{n}_{i, \sigma} \hat{n}_{j, \sigma^{\prime}} - 
\\ J \sum_{i \neq j}\left(\hat{c}_{i, \downarrow}^{\dagger} \hat{c}_{j, \uparrow}^{\dagger}
\hat{c}_{j, \downarrow} \hat{c}_{i, \uparrow}+\hat{c}_{j, \uparrow}^{\dagger}
\hat{c}_{j, \downarrow}^{\dagger} \hat{c}_{i, \uparrow} \hat{c}_{i, \downarrow}+
\mathrm{h.c.}\right)\end{split}\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>norb</strong> : int,</p>
<blockquote>
<div><p>Number of orbitals excluding spin.</p>
</div></blockquote>
<p><strong>U</strong> : complex,</p>
<blockquote>
<div><p>Strength of intra-orbital interaction.</p>
</div></blockquote>
<p><strong>Up</strong> : complex,</p>
<blockquote>
<div><p>Strength of inter-orbital interaction.</p>
</div></blockquote>
<p><strong>J</strong> : complex,</p>
<blockquote>
<div><p>Strength of Hound’s coupling.</p>
</div></blockquote>
<p><strong>Jp</strong> : complex,</p>
<blockquote>
<div><p>Strength pair hopping and spin-flip.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>U</strong> : np.ndarray,</p>
<blockquote>
<div><p>shape = (2*norb, 2*norb, 2*norb, 2*norb)</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="impurity-susceptibility-and-bethe-salpeter-equation">
<h1>Impurity susceptibility and Bethe-Salpeter Equation<a class="headerlink" href="#impurity-susceptibility-and-bethe-salpeter-equation" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.chi_from_gg2.chi0_from_gg2_PH">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.chi_from_gg2.</span></code><code class="sig-name descname"><span class="pre">chi0_from_gg2_PH</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi0_from_gg2_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Bubble susceptibility <span class="math notranslate nohighlight">\(\chi^{(0)} = GG\)</span> in the Particle-Hole channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
- \beta \delta_{\nu, \nu'} G_{da}(\nu) \cdot G_{bc}(\omega + \nu)\]</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g</strong> :</p>
<blockquote>
<div><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\nu)\)</span></p>
</div></blockquote>
<p><strong>g2</strong> :</p>
<blockquote>
<div><p>two-particle Green’s function with the mesh to use for
<span class="math notranslate nohighlight">\(\chi^{(0)}\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>chi0 particle-hole bubble
<span class="math notranslate nohighlight">\(\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.chi_from_gg2.chi0_from_gg2_PP">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.chi_from_gg2.</span></code><code class="sig-name descname"><span class="pre">chi0_from_gg2_PP</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi0_from_gg2_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Bubble susceptibility <span class="math notranslate nohighlight">\(\chi^{(0)} = GG\)</span> in the Particle-Particle</p>
<blockquote>
<div><p>channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
- \beta \delta_{\nu, \nu'} G_{da}(\nu) \cdot G_{bc}(\omega - \nu)\]</div>
</div></blockquote>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g</strong> :</p>
<blockquote>
<div><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\nu)\)</span></p>
</div></blockquote>
<p><strong>g2</strong> :</p>
<blockquote>
<div><p>two-particle Green’s function with the mesh to use for
<span class="math notranslate nohighlight">\(\chi^{(0)}\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>chi0 particle-particle bubble
<span class="math notranslate nohighlight">\(\chi^{(0)}_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.chi_from_gg2.chi_from_gg2_PH">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.chi_from_gg2.</span></code><code class="sig-name descname"><span class="pre">chi_from_gg2_PH</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi_from_gg2_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Generalized susceptibility <span class="math notranslate nohighlight">\(\chi^{(0)} = G^{(2)} - GG\)</span> in the</p>
<blockquote>
<div><p>Particle-Hole channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[\chi_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')
- \beta \delta_{\omega} G_{ba}(\nu) \cdot G_{dc}(\nu')\]</div>
</div></blockquote>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g</strong> :</p>
<blockquote>
<div><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\nu)\)</span></p>
</div></blockquote>
<p><strong>g2</strong> :</p>
<blockquote>
<div><p>two-particle Green’s function
<span class="math notranslate nohighlight">\(G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>chi generalized particle-hole susceptibility
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.chi_from_gg2.chi_from_gg2_PP">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.chi_from_gg2.</span></code><code class="sig-name descname"><span class="pre">chi_from_gg2_PP</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.chi_from_gg2.chi_from_gg2_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::g_iw_vt g, triqs_tprf::g2_iw_vt g2) -&gt; triqs_tprf::g2_iw_t
Generalized susceptibility <span class="math notranslate nohighlight">\(\chi^{(0)} = G^{(2)} - GG\)</span> in the</p>
<blockquote>
<div><p>Particle-Particle channel</p>
<blockquote>
<div><p>Computes</p>
<div class="math notranslate nohighlight">
\[\chi_{\bar{a}b\bar{c}d}(\omega, \nu, \nu') =
G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')
- \beta \delta_{\nu + \nu' - \omega} G_{ba}(\nu) \cdot G_{dc}(\nu')\]</div>
</div></blockquote>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g</strong> :</p>
<blockquote>
<div><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\nu)\)</span></p>
</div></blockquote>
<p><strong>g2</strong> :</p>
<blockquote>
<div><p>two-particle Green’s function
<span class="math notranslate nohighlight">\(G^{(2)}_{\bar{a}b\bar{c}d}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>chi generalized particle-hole susceptibility
<span class="math notranslate nohighlight">\(\chi_{\bar{a}b\bar{c}d}(\omega, \nu,\nu')\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.bse.solve_local_bse">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.bse.</span></code><code class="sig-name descname"><span class="pre">solve_local_bse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chi0_wnn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chi_wnn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#solve_local_bse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.bse.solve_local_bse" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the Bethe-Salpeter equation for the local vertex function 
<span class="math notranslate nohighlight">\(\Gamma_{abcd}(\omega, \nu, \nu')\)</span>.</p>
<p>Computes:</p>
<div class="math notranslate nohighlight">
\[\Gamma_{abcd}(\omega, \nu, \nu') = [\chi^{(0)}]^{-1} - \chi^{-1}\]</div>
<p>where the inverses are taken in the particle-hole channel pairing
of fermionic frequencies <span class="math notranslate nohighlight">\(\nu\)</span> and <span class="math notranslate nohighlight">\(\nu'\)</span> and orbital
indices.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chi0_wnn</strong> : Gerealized local bubble susceptibility</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\chi^{(0)}_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
<p><strong>chi_wnn</strong> : Generalized local susceptibility</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\chi_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gamma_wnn</strong> : Particle-hole vertex function</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\Gamma_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="lattice-bethe-salpeter-equation">
<h1>Lattice Bethe-Salpeter Equation<a class="headerlink" href="#lattice-bethe-salpeter-equation" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.bse.solve_lattice_bse">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.bse.</span></code><code class="sig-name descname"><span class="pre">solve_lattice_bse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_wnn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#solve_lattice_bse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.bse.solve_lattice_bse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the generalized lattice susceptibility 
<span class="math notranslate nohighlight">\(\chi_{abcd}(\omega, \mathbf{k})\)</span> using the Bethe-Salpeter 
equation (BSE).</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g_wk</strong> : Single-particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\omega, \mathbf{k})\)</span>.</p>
<p><strong>gamma_wnn</strong> : Local particle-hole vertex function</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\Gamma_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>chi0_wk</strong> : Generalized lattice susceptibility</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\chi_{abcd}(\omega, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.bse.get_chi0_wnk">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.bse.</span></code><code class="sig-name descname"><span class="pre">get_chi0_wnk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/bse.html#get_chi0_wnk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.bse.get_chi0_wnk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the generalized lattice bubble susceptibility 
<span class="math notranslate nohighlight">\(\chi^{(0)}_{abcd}(\omega, \nu, \mathbf{k})\)</span> from the single-particle
Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\omega, \mathbf{k})\)</span>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g_wk</strong> : Single-particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(\omega, \mathbf{k})\)</span>.</p>
<p><strong>nw</strong> : Number of bosonic freqiencies in <span class="math notranslate nohighlight">\(\chi\)</span>.</p>
<p><strong>nwf</strong> : Number of fermionic freqiencies in <span class="math notranslate nohighlight">\(\chi\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>chi0_wnk</strong> : Generalized lattice bubble susceptibility</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(\chi^{(0)}_{abcd}(\omega, \nu, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="gw-approximation">
<h1>GW approximation<a class="headerlink" href="#gw-approximation" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.lattice.dynamical_screened_interaction_W_wk">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></code><code class="sig-name descname"><span class="pre">dynamical_screened_interaction_W_wk</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.dynamical_screened_interaction_W_wk" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::chi_wk_cvt PI_wk, triqs_tprf::chi_k_cvt V_k) -&gt; triqs_tprf::chi_wk_t
Dynamical screened interaction <span class="math notranslate nohighlight">\(W(i\omega_n, \mathbf{k})\)</span> calculator</p>
<blockquote>
<div><p>for static momentum-dependent interactions <span class="math notranslate nohighlight">\(V(\mathbf{k})\)</span>.</p>
<p>The full screened interaction <span class="math notranslate nohighlight">\(W(i\omega_n, \mathbf{k})\)</span>
is given by</p>
<div class="math notranslate nohighlight">
\[W^{(full)}_{abcd}(i\omega_n, \mathbf{k}) =
   V_{abcd}(\mathbf{k}) +
\sum_{efgh} V_{abef}(\mathbf{k}) \cdot
   \Pi_{fegh}(i\omega_n, \mathbf{k}) \cdot
   W^{(full)}_{hgcd}(i\omega_n, \mathbf{k})\]</div>
<p>Instead of returning <span class="math notranslate nohighlight">\(W^{(full)}\)</span> we return the dynamical/retarded part
<span class="math notranslate nohighlight">\(W^{(r)}\)</span> (with zero high-frequency offset)</p>
<div class="math notranslate nohighlight">
\[W_{abcd}(i\omega_n, \mathbf{k}) =
    W^{(full)}_{abcd}(i\omega_n, \mathbf{k}) - V_{abcd}(\mathbf{k})\]</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>PI_wk</strong> :</p>
<blockquote>
<div><p>polarization bubble <span class="math notranslate nohighlight">\(\Pi_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
<p><strong>V_k</strong> :</p>
<blockquote>
<div><p>static interaction <span class="math notranslate nohighlight">\(V_{abcd}(\mathbf{k})\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>dynamical screened interaction <span class="math notranslate nohighlight">\(W_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.lattice.dynamical_screened_interaction_W_wk_from_generalized_susceptibility">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.lattice.</span></code><code class="sig-name descname"><span class="pre">dynamical_screened_interaction_W_wk_from_generalized_susceptibility</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.lattice.dynamical_screened_interaction_W_wk_from_generalized_susceptibility" title="Permalink to this definition">¶</a></dt>
<dd><p>Signature : (triqs_tprf::chi_wk_cvt chi_wk, triqs_tprf::chi_k_cvt V_k) -&gt; triqs_tprf::chi_wk_t
Dynamical screened interaction <span class="math notranslate nohighlight">\(W(i\omega_n, \mathbf{k})\)</span> calculator</p>
<blockquote>
<div><p>for static momentum-dependent interactions <span class="math notranslate nohighlight">\(V(\mathbf{k})\)</span> and
known generalized susceptibility <span class="math notranslate nohighlight">\(\chi(i\omega_n, \mathbf{k})\)</span></p>
<p>The full screened interaction <span class="math notranslate nohighlight">\(W(i\omega_n, \mathbf{k})\)</span>
is given by</p>
<div class="math notranslate nohighlight">
\[W^{(full)}_{abcd}(i\omega_n, \mathbf{k}) =
   V_{abcd}(\mathbf{k}) +
\sum_{efgh} V_{abef}(\mathbf{k}) \cdot
   \chi_{fegh}(i\omega_n, \mathbf{k}) \cdot
   V_{hgcd}(\mathbf{k})\]</div>
<p>Instead of returning <span class="math notranslate nohighlight">\(W^{(full)}\)</span> we return the dynamical/retarded part
<span class="math notranslate nohighlight">\(W^{(r)}\)</span> (with zero high-frequency offset)</p>
<div class="math notranslate nohighlight">
\[W_{abcd}(i\omega_n, \mathbf{k}) =
    W^{(full)}_{abcd}(i\omega_n, \mathbf{k}) - V_{abcd}(\mathbf{k})\]</div>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chi_wk</strong> :</p>
<blockquote>
<div><p>polarization bubble <span class="math notranslate nohighlight">\(\Pi_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
<p><strong>V_k</strong> :</p>
<blockquote>
<div><p>static interaction <span class="math notranslate nohighlight">\(V_{abcd}(\mathbf{k})\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>dynamical screened interaction <span class="math notranslate nohighlight">\(W_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.gw.bubble_PI_wk">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.gw.</span></code><code class="sig-name descname"><span class="pre">bubble_PI_wk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/gw.html#bubble_PI_wk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.gw.bubble_PI_wk" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the particle-hole bubble from the single particle lattice Green’s function</p>
<div class="math notranslate nohighlight">
\[\Pi_{abcd}(i\omega_n, k) = - 
\mathcal{F}_{\tau, \mathbf{r} \rightarrow i\omega_n, \mathbf{k}}
\left\{ G_{d\bar{a}}(\tau, \mathbf{r}) G_{b\bar{c}}(-\tau, -\mathbf{r}) \right\}\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g_wk</strong> : TRIQS Green’s function (rank 2) on Matsubara and Brillouinzone meshes</p>
<blockquote>
<div><p>Single particle lattice Green’s function.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>PI_wk</strong> : TRIQS Green’s function (rank 4) on Matsubara and Brillouinzone meshes</p>
<blockquote>
<div><p>Particle hole bubble.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.gw.gw_sigma_wk">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.gw.</span></code><code class="sig-name descname"><span class="pre">gw_sigma_wk</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Wr_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fft_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/gw.html#gw_sigma_wk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.gw.gw_sigma_wk" title="Permalink to this definition">¶</a></dt>
<dd><p>GW self energy <span class="math notranslate nohighlight">\(\Sigma(i\omega_n, \mathbf{k})\)</span> calculator</p>
<p>Fourier transforms the screened interaction and the single-particle
Green’s function to imagiary time and real space.</p>
<div class="math notranslate nohighlight">
\[G_{ab}(\tau, \mathbf{r}) = \mathcal{F}^{-1}
  \left\{ G_{ab}(i\omega_n, \mathbf{k}) \right\}\]</div>
<div class="math notranslate nohighlight">
\[W^{(r)}_{abcd}(\tau, \mathbf{r}) = \mathcal{F}^{-1}
  \left\{ W^{(r)}_{abcd}(i\omega_n, \mathbf{k}) \right\}\]</div>
<p>computes the GW self-energy as the product</p>
<div class="math notranslate nohighlight">
\[\Sigma_{ab}(\tau, \mathbf{r}) =
  \sum_{cd} W^{(r)}_{abcd}(\tau, \mathbf{r}) G_{cd}(\tau, \mathbf{r})\]</div>
<p>and transforms back to frequency and momentum</p>
<div class="math notranslate nohighlight">
\[\Sigma_{ab}(i\omega_n, \mathbf{k}) =
  \mathcal{F} \left\{ \Sigma_{ab}(\tau, \mathbf{r}) \right\}\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>V_k</strong> : TRIQS Green’s function (rank 4) on a Brillouinzone mesh</p>
<blockquote>
<div><p>static bare interaction <span class="math notranslate nohighlight">\(V_{abcd}(\mathbf{k})\)</span></p>
</div></blockquote>
<p><strong>Wr_wk</strong> : TRIQS Green’s function (rank 4) on Matsubara and Brillouinzone meshes</p>
<blockquote>
<div><p>retarded screened interaction <span class="math notranslate nohighlight">\(W^{(r)}_{abcd}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
<p><strong>g_wk</strong> : TRIQS Green’s function (rank 2) on Matsubara and Brillouinzone meshes</p>
<blockquote>
<div><p>single particle Green’s function <span class="math notranslate nohighlight">\(G_{ab}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sigma_wk</strong> : TRIQS Green’s function (rank 2) on Matsubara and Brillouinzone meshes</p>
<blockquote>
<div><p>GW self-energy <span class="math notranslate nohighlight">\(\Sigma_{ab}(i\omega_n, \mathbf{k})\)</span></p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="linearized-eliashberg-equation">
<h1>Linearized Eliashberg equation<a class="headerlink" href="#linearized-eliashberg-equation" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.eliashberg.solve_eliashberg">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></code><code class="sig-name descname"><span class="pre">solve_eliashberg</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Gamma_pp_wk</span></em>, <em class="sig-param"><span class="pre">g_wk</span></em>, <em class="sig-param"><span class="pre">initial_delta=None</span></em>, <em class="sig-param"><span class="pre">Gamma_pp_const_k=None</span></em>, <em class="sig-param"><span class="pre">tol=1e-10</span></em>, <em class="sig-param"><span class="pre">product='FFT'</span></em>, <em class="sig-param"><span class="pre">solver='IRAM'</span></em>, <em class="sig-param"><span class="pre">symmetrize_fct=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></em>, <em class="sig-param"><span class="pre">k=6</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#solve_eliashberg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.solve_eliashberg" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the linearized Eliashberg equation</p>
<p>Returns the biggest eigenvalues and corresponding eigenvectors of the linearized Eliashberg
equation, for a particle-particle vertex in the random phase approximation,
as described here <a class="reference internal" href="../theory/eliashberg.html#eliashberg-rpa"><span class="std std-ref">Random phase approximation for the irreducible particle-particle vertex</span></a>. The Eliashberg equation implementation is
using fourier transformations for computational efficiency. The eigenvalues are found
using an iterative algorithm from scipy.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Gamma_pp_wk</strong> : Gf,</p>
<blockquote>
<div><p>Pairing vertex <span class="math notranslate nohighlight">\(\Gamma(i\omega_n, \mathbf{k})\)</span>. The mesh attribute of
the Gf must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</div></blockquote>
<p><strong>g_wk</strong> : Gf,</p>
<blockquote>
<div><p>Green’s function <span class="math notranslate nohighlight">\(G(i\nu_n, \mathbf{k})\)</span>. The mesh attribute of the Gf must
be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</div></blockquote>
<p><strong>initial_delta</strong> : Gf, optional</p>
<blockquote>
<div><p>An initial anomalous self-energy <span class="math notranslate nohighlight">\(\Delta(i\nu_n, \mathbf{k})\)</span> to start
an iterative solver, given as a Gf with MeshProduct with the components
(MeshImFreq, MeshBrZone).
If not given <a class="reference internal" href="#triqs_tprf.eliashberg.semi_random_initial_delta" title="triqs_tprf.eliashberg.semi_random_initial_delta"><code class="xref py py-func docutils literal notranslate"><span class="pre">semi_random_initial_delta()</span></code></a> will be called.</p>
</div></blockquote>
<p><strong>Gamma_pp_const_k</strong> : float or np.ndarray or Gf, optional</p>
<blockquote>
<div><p>Part of the pairing vertex that is constant in Matsubara frequency space
<span class="math notranslate nohighlight">\(\Gamma(\mathbf{k})\)</span>. If given as a Gf its mesh attribute needs to
be a MeshBrZone. If not given, the constant part will be fitted.</p>
</div></blockquote>
<p><strong>tol</strong> : float, optional</p>
<blockquote>
<div><p>Relative accuracy for eigenvalues (stopping criterion).</p>
</div></blockquote>
<p><strong>product</strong> : str, [‘FFT’, ‘SUM’], optional</p>
<blockquote>
<div><p>Which function of the Eliashberg product shall be used:</p>
<blockquote>
<div><dl class="simple">
<dt>‘FFT’<span class="classifier">triqs_tprf.lattice.eliashberg_product_fft,</span></dt><dd><p>which uses Fourier transformation for optimal computational efficiency.</p>
</dd>
<dt>‘SUM’<span class="classifier">triqs_tprf.lattice.eliashberg_product, uses the explicit sum.</span></dt><dd><p>Restrictions : wmesh of Gamma_pp_wk must be atleast twice the size of the one of g_wk.</p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
<p><strong>solver</strong> : str, [‘IRAM’, ‘PM’], optional</p>
<blockquote>
<div><p>Which eigenvalue solver shall be used:</p>
<blockquote>
<div><p>‘IRAM’ : Use the Implicitly Restarted Arnoldi Method implemented in <a class="reference internal" href="#triqs_tprf.eliashberg.implicitly_restarted_arnoldi_method" title="triqs_tprf.eliashberg.implicitly_restarted_arnoldi_method"><code class="xref py py-func docutils literal notranslate"><span class="pre">implicitly_restarted_arnoldi_method()</span></code></a>.</p>
<p>‘PM’ : Use the Power Method implemented in <a class="reference internal" href="#triqs_tprf.eliashberg.power_method_LR" title="triqs_tprf.eliashberg.power_method_LR"><code class="xref py py-func docutils literal notranslate"><span class="pre">power_method_LR()</span></code></a>.</p>
</div></blockquote>
</div></blockquote>
<p><strong>symmetrize_fct</strong> : function, optional</p>
<blockquote>
<div><p>A function that takes one parameter: A Green’s function 
<span class="math notranslate nohighlight">\(G(i\nu_n, \mathbf{k})\)</span>. The mesh attribute of the
Gf must be a MeshProduct with the components 
(MeshImFreq, MeshBrZone).
This function is applied after every iteration of the
eigenvalue solver and can be used to enforce a specific
symmetry. If no symmetries are enforced, caution is need, because
unphysical symmetries can occur.</p>
</div></blockquote>
<p><strong>k</strong> : int, optional</p>
<blockquote>
<div><p>The number of leading superconducting gaps that shall be calculated. Does
only have an effect, if ‘IRAM’ is used as a solver.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Es</strong> : list of float,</p>
<blockquote>
<div><p>Biggest eigenvalues of the linearized Eliashberg equation <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</div></blockquote>
<p><strong>eigen_modes</strong> : list of Gf,</p>
<blockquote>
<div><p>Corresponding eigenvectors (anomalous self-energies) 
<span class="math notranslate nohighlight">\(\Delta(i\nu_n, \mathbf{k})\)</span> as Gf with MeshProduct with the components
(MeshImFreq, MeshBrZone).</p>
</div></blockquote>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../theory/eliashberg.html#eliashberg"><span class="std std-ref">Linearized Eliashberg Equation</span></a></dt><dd><p>Theory of the linearized Eliashberg equation.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.eliashberg.preprocess_gamma_for_fft">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></code><code class="sig-name descname"><span class="pre">preprocess_gamma_for_fft</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Gamma_pp_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Gamma_pp_const_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#preprocess_gamma_for_fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.preprocess_gamma_for_fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare Gamma to be used with the FFT implementation</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Gamma_pp_wk</strong> : Gf,</p>
<blockquote>
<div><p>Pairing vertex <span class="math notranslate nohighlight">\(\Gamma(i\omega_n, \mathbf{k})\)</span>. The mesh attribute of
the Gf must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</div></blockquote>
<p><strong>Gamma_pp_const_k</strong> : float or np.ndarray or Gf</p>
<blockquote>
<div><p>Part of the pairing vertex that is constant in Matsubara frequency space
<span class="math notranslate nohighlight">\(\Gamma(\mathbf{k})\)</span>. If given as a Gf its mesh attribute needs to
be a MeshBrZone. If not given, the constant part will be fitted.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Gamma_pp_dyn_tr</strong> : Gf,</p>
<blockquote>
<div><p>The dynamic part of Gamma, which converges to zero for
<span class="math notranslate nohighlight">\(\omega_n \rightarrow \infty\)</span>, but now in <span class="math notranslate nohighlight">\(\tau\)</span>-space.
Its mesh attribute is MeshProduct with the components
(MeshImTime, MeshCycLat).</p>
</div></blockquote>
<p><strong>Gamma_pp_const_r</strong> : Gf,</p>
<blockquote>
<div><p>The constant part of Gamma with mesh attribute MeshCycLat.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.eliashberg.semi_random_initial_delta">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></code><code class="sig-name descname"><span class="pre">semi_random_initial_delta</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#semi_random_initial_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.semi_random_initial_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a delta based on the GF with random elements</p>
<p>Returns an anomalous self-energy that can be used as an inital input for the iterative
solvers. The momentum space is random, while the Matsubara space is only partialy 
randomized to ensure working tail fits for the Fourier transformations.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g_wk</strong> : Gf,</p>
<blockquote>
<div><p>Green’s function <span class="math notranslate nohighlight">\(G(i\nu_n, \mathbf{k})\)</span>. The mesh attribute of the Gf must
be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</div></blockquote>
<p><strong>nr_factor</strong> : float, optional</p>
<blockquote>
<div><p>Percentage of <span class="math notranslate nohighlight">\(\omega\)</span> points which shall not be randomized. This is needed
to assure a working tail fit for the Fourier transformations. The default is 0.5,
meaning that 50% of the <span class="math notranslate nohighlight">\(\omega\)</span> points will not be randomized.</p>
</div></blockquote>
<p><strong>seed</strong> : int, optional</p>
<blockquote>
<div><p>Set a np.random.seed to enforce predictable results.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>delta</strong> : Gf,</p>
<blockquote>
<div><p>An initial anomalous self-energy <span class="math notranslate nohighlight">\(\Delta(i\nu_n, \mathbf{k})\)</span> to start
an iterative solver, given as a Gf with MeshProduct with the components
(MeshImFreq, MeshBrZone).</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.eliashberg.power_method_LR">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></code><code class="sig-name descname"><span class="pre">power_method_LR</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_it</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#power_method_LR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.power_method_LR" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the eigenvalue with the largest real value via the power method</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>matvec</strong> : callable f(v),</p>
<blockquote>
<div><p>Returns A*v.</p>
</div></blockquote>
<p><strong>init</strong> : np.ndarray,</p>
<blockquote>
<div><p>The array representation of the anomalous self-energy to start the iterative
method with. Restriction: len(init.shape) == 1.</p>
</div></blockquote>
<p><strong>tol</strong> : float, optional</p>
<blockquote>
<div><p>The tolerance at which the iterative scheme is considered to be converged.</p>
</div></blockquote>
<p><strong>max_it</strong> : float, optional</p>
<blockquote>
<div><p>The maximum number of iterations that shall be done before a error is raised.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>norm</strong> : float,</p>
<blockquote>
<div><p>The eigenvalue with the largest positive real part.</p>
</div></blockquote>
<p><strong>v_k</strong> : np.ndarray,</p>
<blockquote>
<div><p>The corresponding eigenvector.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.eliashberg.implicitly_restarted_arnoldi_method">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></code><code class="sig-name descname"><span class="pre">implicitly_restarted_arnoldi_method</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#implicitly_restarted_arnoldi_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.implicitly_restarted_arnoldi_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the eigenvalue with the largest real value via the Implicitly Restarted 
Arnoldi Method</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>matvec</strong> : callable f(v),</p>
<blockquote>
<div><p>Returns A*v.</p>
</div></blockquote>
<p><strong>init</strong> : np.ndarray,</p>
<blockquote>
<div><p>The array representation of the anomalous self-energy to start the iterative
method with. Restriction: len(init.shape) == 1.</p>
</div></blockquote>
<p><strong>tol</strong> : float, optional</p>
<blockquote>
<div><p>The tolerance at which the iterative scheme is considered to be converged.</p>
</div></blockquote>
<p><strong>k</strong> : int, optional</p>
<blockquote>
<div><p>The number of eigenvalues and eigenvectors desired.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>Es</strong> : list of float,</p>
<blockquote>
<div><p>The eigenvalues with the largest positive real part.</p>
</div></blockquote>
<p><strong>U</strong> : list of np.ndarray,</p>
<blockquote>
<div><p>The corresponding eigenvectors.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.sparse.linalg.eigs.html">scipy.sparse.linalg.eigs</a></p>
<p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.LinearOperator.html">scipy.sparse.linalg.LinearOperator</a></p>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.eliashberg.construct_gamma_singlet_rpa">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></code><code class="sig-name descname"><span class="pre">construct_gamma_singlet_rpa</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_d_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_m_wk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#construct_gamma_singlet_rpa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.construct_gamma_singlet_rpa" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the irreducible singlet vertex in the RPA limit</p>
<p>The irreducible singlet vertex in the random phase approximation limit for a
symmetrized calculations of the Eliashberg equation is given by</p>
<div class="math notranslate nohighlight">
\[\Gamma^{\text{s}}_{a\overline{b}c\overline{d}}(Q=0, K, K') \equiv
\frac{1}{2}U_{a\overline{b}c\overline{d}}^{\mathrm{d}}
+
\frac{3}{2}U_{a\overline{b}c\overline{d}}^{\mathrm{m}}
+
\Re
\left[
3 
\Phi^{\text{m}}_{c\overline{b}a\overline{d}}(K-K')
-
\Phi^{\text{d}}_{c\overline{b}a\overline{d}}(K-K')
\right]
\,.\]</div>
<p>For more details see <a class="reference internal" href="../theory/eliashberg.html#eliashberg"><span class="std std-ref">Linearized Eliashberg Equation</span></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>U_d</strong> : np.ndarray,</p>
<blockquote>
<div><p>The local static interaction in the density channel.</p>
</div></blockquote>
<p><strong>U_m</strong> : np.ndarray,</p>
<blockquote>
<div><p>The local static interaction in the magnetic channel.</p>
</div></blockquote>
<p><strong>phi_d_wk</strong> : Gf,</p>
<blockquote>
<div><p>The reducible ladder vertex in the density channel
<span class="math notranslate nohighlight">\(\Phi^{\mathrm{d}}(i\omega_n, \mathbf{q})\)</span>. The mesh attribute of the Gf
must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</div></blockquote>
<p><strong>phi_m_wk</strong> : Gf,</p>
<blockquote>
<div><p>The reducible ladder vertex in the magnetic channel
<span class="math notranslate nohighlight">\(\Phi^{\mathrm{m}}(i\omega_n, \mathbf{q})\)</span>. The mesh attribute of the Gf
must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gamma_singlet</strong> : Gf,</p>
<blockquote>
<div><p>The irreducible singlet vertex in the RPA limit for a symmetrized
calculation of the Eliashberg equation
<span class="math notranslate nohighlight">\(\Gamma^{\mathrm{s}}(i\omega_n,\mathbf{q})\)</span>.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.eliashberg.construct_gamma_triplet_rpa">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.eliashberg.</span></code><code class="sig-name descname"><span class="pre">construct_gamma_triplet_rpa</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U_d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_d_wk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_m_wk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/eliashberg.html#construct_gamma_triplet_rpa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.eliashberg.construct_gamma_triplet_rpa" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the irreducible triplet vertex in the RPA limit</p>
<p>The irreducible triplet vertex in the random phase approximation limit for a
symmetrized calculations of the Eliashberg equation is given by</p>
<div class="math notranslate nohighlight">
\[\Gamma^{\text{t}}_{a\overline{b}c\overline{d}}(Q=0, K, K') \equiv
-
\frac{1}{2}U_{a\overline{b}c\overline{d}}^{\mathrm{d}}
+
\frac{1}{2}U_{a\overline{b}c\overline{d}}^{\mathrm{m}} 
+
\Re
\left[
-
\Phi^{\text{m}}_{c\overline{b}a\overline{d}}(K-K')
-
\Phi^{\text{d}}_{c\overline{b}a\overline{d}}(K-K')
\right]
\,.\]</div>
<p>For more details see <a class="reference internal" href="../theory/eliashberg.html#eliashberg"><span class="std std-ref">Linearized Eliashberg Equation</span></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>U_d</strong> : np.ndarray,</p>
<blockquote>
<div><p>The local static interaction in the density channel.</p>
</div></blockquote>
<p><strong>U_m</strong> : np.ndarray,</p>
<blockquote>
<div><p>The local static interaction in the magnetic channel.</p>
</div></blockquote>
<p><strong>phi_d_wk</strong> : Gf,</p>
<blockquote>
<div><p>The reducible ladder vertex in the density channel
<span class="math notranslate nohighlight">\(\Phi^{\mathrm{d}}(i\omega_n, \mathbf{q})\)</span>. The mesh attribute of the Gf
must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</div></blockquote>
<p><strong>phi_m_wk</strong> : Gf,</p>
<blockquote>
<div><p>The reducible ladder vertex in the magnetic channel
<span class="math notranslate nohighlight">\(\Phi^{\mathrm{m}}(i\omega_n, \mathbf{q})\)</span>. The mesh attribute of the Gf
must be a MeshProduct with the components (MeshImFreq, MeshBrZone).</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gamma_triplet</strong> : Gf,</p>
<blockquote>
<div><p>The irreducible triplet vertex in the RPA limit for a symmetrized
calculation of the Eliashberg equation
<span class="math notranslate nohighlight">\(\Gamma^{\mathrm{t}}(i\omega_n,\mathbf{q})\)</span>.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="hubbard-atom-analytic-response-functions">
<h1>Hubbard atom analytic response functions<a class="headerlink" href="#hubbard-atom-analytic-response-functions" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.analytic_hubbard_atom.analytic_hubbard_atom">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.analytic_hubbard_atom.</span></code><code class="sig-name descname"><span class="pre">analytic_hubbard_atom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwf_gf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/analytic_hubbard_atom.html#analytic_hubbard_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.analytic_hubbard_atom.analytic_hubbard_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute dynamical response functions for the Hubbard atom at half filling.</p>
<p>This function returns an object that contains the single-particle
Greens function <span class="math notranslate nohighlight">\(G(\omega)\)</span>, the magnetic two-particle generalized susceptibility
<span class="math notranslate nohighlight">\(\chi_m(\omega, \nu, \nu')\)</span>, and the corresponding bare bubble 
<span class="math notranslate nohighlight">\(\chi^{(0)}_m(\omega, \nu, \nu')\)</span>, and the magnetic vertex function
<span class="math notranslate nohighlight">\(\Gamma_m(\omega, \nu, \nu')\)</span>.</p>
<p>This is implemented using analytical formulas from 
Thunstrom et al. [PRB 98, 235107 (2018)]
please cite the paper if you use this function!</p>
<p>In particular this is one exact solution to the Bethe-Salpeter
equation, that is the infinite matrix inverse problem:</p>
<div class="math notranslate nohighlight">
\[\Gamma_m = [\chi^{(0)}_m]^{-1} - \chi_m^{-1}\]</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>beta</strong> : float</p>
<blockquote>
<div><p>Inverse temperature.</p>
</div></blockquote>
<p><strong>U</strong> : float</p>
<blockquote>
<div><p>Hubbard U interaction parameter.</p>
</div></blockquote>
<p><strong>nw</strong> : int</p>
<blockquote>
<div><p>Number of bosonic Matsubara frequencies 
in the computed two-particle response functions.</p>
</div></blockquote>
<p><strong>nwf</strong> : int</p>
<blockquote>
<div><p>Number of fermionic Matsubara frequencies
in the computed two-particle response functions.</p>
</div></blockquote>
<p><strong>nwf_gf</strong> : int</p>
<blockquote>
<div><p>Number of fermionic Matsubara frequencies
in the computed single-particle Greens function.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> : ParameterCollection</p>
<blockquote>
<div><p>Object containing all the response functions and some other
observables, <cite>p.G_iw</cite>, <cite>p.chi_m</cite>, <cite>p.chi0_m</cite>, 
<cite>p.gamma_m</cite>, <cite>p.Z</cite>, <cite>p.m2</cite>, <cite>p.chi_m_static</cite>.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="two-particle-response-function-linear-algebra-operations">
<h1>Two-particle response function linear-algebra operations<a class="headerlink" href="#two-particle-response-function-linear-algebra-operations" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.linalg.inverse_PH">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></code><code class="sig-name descname"><span class="pre">inverse_PH</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.inverse_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function inversion <span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the particle-hole channel (PH).</p>
<blockquote>
<div><p>The two-particle response function <span class="math notranslate nohighlight">\(g_{abcd}(\omega, \nu, \nu')\)</span>
is cast to matrix form and inverted</p>
<div class="math notranslate nohighlight">
\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g</strong> :</p>
<blockquote>
<div><p>two-particle response function to invert, <span class="math notranslate nohighlight">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the given channel</p>
</div></blockquote>
<p><strong>Signature</strong> : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.linalg.inverse_PP">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></code><code class="sig-name descname"><span class="pre">inverse_PP</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.inverse_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function inversion <span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the particle-particle channel (PP).</p>
<blockquote>
<div><p>The two-particle response function <span class="math notranslate nohighlight">\(g_{abcd}(\omega, \nu, \nu')\)</span>
is cast to matrix form and inverted</p>
<div class="math notranslate nohighlight">
\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g</strong> :</p>
<blockquote>
<div><p>two-particle response function to invert, <span class="math notranslate nohighlight">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the given channel</p>
</div></blockquote>
<p><strong>Signature</strong> : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.linalg.inverse_PH_bar">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></code><code class="sig-name descname"><span class="pre">inverse_PH_bar</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.inverse_PH_bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function inversion <span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote>
<div><p>The two-particle response function <span class="math notranslate nohighlight">\(g_{abcd}(\omega, \nu, \nu')\)</span>
is cast to matrix form and inverted</p>
<div class="math notranslate nohighlight">
\[[g]^{-1} = [ g_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega) ]^{-1}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the inverse is returned by value.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>g</strong> :</p>
<blockquote>
<div><p>two-particle response function to invert, <span class="math notranslate nohighlight">\(g \equiv g_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\([g]^{-1}\)</span> in the given channel</p>
</div></blockquote>
<p><strong>Signature</strong> : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.linalg.product_PH">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></code><code class="sig-name descname"><span class="pre">product_PH</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.product_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function product <span class="math notranslate nohighlight">\(A * B\)</span> in the particle-hole channel (PH).</p>
<blockquote>
<div><p>The two-particle response functions <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
and <span class="math notranslate nohighlight">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math notranslate nohighlight">
\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
= \sum_{\bar{\nu}ab}
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega)
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega)\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>A</strong> :</p>
<blockquote>
<div><blockquote>
<div><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
<dl class="simple">
<dt>B</dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\((A * B)\)</span> in the given channel</p>
</div></blockquote>
<p><strong>Signature</strong> : (triqs_tprf::g2_nn_vt A, triqs_tprf::g2_nn_vt B) -&gt; triqs_tprf::g2_nn_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.linalg.product_PP">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></code><code class="sig-name descname"><span class="pre">product_PP</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.product_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function product <span class="math notranslate nohighlight">\(A * B\)</span> in the particle-particle channel (PP).</p>
<blockquote>
<div><p>The two-particle response functions <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
and <span class="math notranslate nohighlight">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math notranslate nohighlight">
\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
= \sum_{\bar{\nu}ab}
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega)
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega)\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>A</strong> :</p>
<blockquote>
<div><blockquote>
<div><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
<dl class="simple">
<dt>B</dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\((A * B)\)</span> in the given channel</p>
</div></blockquote>
<p><strong>Signature</strong> : (triqs_tprf::g2_nn_vt A, triqs_tprf::g2_nn_vt B) -&gt; triqs_tprf::g2_nn_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.linalg.product_PH_bar">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></code><code class="sig-name descname"><span class="pre">product_PH_bar</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.product_PH_bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function product <span class="math notranslate nohighlight">\(A * B\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote>
<div><p>The two-particle response functions <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span>
and <span class="math notranslate nohighlight">\(B \equiv B_{abcd}(\omega, \nu, \nu')\)</span> are cast to matrix form and their
product is computed</p>
<div class="math notranslate nohighlight">
\[(A * B)_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
= \sum_{\bar{\nu}ab}
A_{\{\nu\alpha\beta\}, \{\bar{\nu}ab\}}(\omega)
B_{\{\bar{\nu}ab\}, \{\nu'\gamma\delta\}}(\omega)\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the product is returned by value.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>A</strong> :</p>
<blockquote>
<div><blockquote>
<div><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</div></blockquote>
<dl class="simple">
<dt>B</dt><dd><p>two-particle response function <span class="math notranslate nohighlight">\(B \equiv A_{abcd}(\omega, \nu, \nu')\)</span></p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\((A * B)\)</span> in the given channel</p>
</div></blockquote>
<p><strong>Signature</strong> : (triqs_tprf::g2_nn_vt A, triqs_tprf::g2_nn_vt B) -&gt; triqs_tprf::g2_nn_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.linalg.identity_PH">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></code><code class="sig-name descname"><span class="pre">identity_PH</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.identity_PH" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function identity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span> in the particle-hole channel (PH).</p>
<blockquote>
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math notranslate nohighlight">
\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
\equiv
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>A</strong> :</p>
<blockquote>
<div><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>the unity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span>, in the given channel</p>
</div></blockquote>
<p><strong>Signature</strong> : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.linalg.identity_PP">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></code><code class="sig-name descname"><span class="pre">identity_PP</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.identity_PP" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function identity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span> in the particle-particle channel (PP).</p>
<blockquote>
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math notranslate nohighlight">
\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
\equiv
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>A</strong> :</p>
<blockquote>
<div><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>the unity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span>, in the given channel</p>
</div></blockquote>
<p><strong>Signature</strong> : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.linalg.identity_PH_bar">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.linalg.</span></code><code class="sig-name descname"><span class="pre">identity_PH_bar</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#triqs_tprf.linalg.identity_PH_bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Two-particle response-function identity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span> in the particle-hole-bar channel (PH-bar).</p>
<blockquote>
<div><p>Constructs the unity-operator in the given channel</p>
<div class="math notranslate nohighlight">
\[\mathbf{1}_{abcd}(\omega,\nu,\nu') =
\mathbf{1}_{\{\nu\alpha\beta\}, \{\nu'\gamma\delta\}}(\omega)
\equiv
\delta_{\nu\nu'} \delta_{\alpha\gamma} \delta_{\beta\delta}\]</div>
<p>where the mapping of target-space indices <span class="math notranslate nohighlight">\(\{a, b, c, d \}\)</span> to <span class="math notranslate nohighlight">\(\{\alpha, \beta\}, \{\gamma, \delta\}\)</span> is channel dependent.</p>
<p>Storage is allocated and the result is returned by value.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>A</strong> :</p>
<blockquote>
<div><p>two-particle response function <span class="math notranslate nohighlight">\(A \equiv A_{abcd}(\omega, \nu, \nu')\)</span> determinig the shape and size of the unity operator</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> :</p>
<blockquote>
<div><p>the unity operator <span class="math notranslate nohighlight">\(\mathbf{1}\)</span>, in the given channel</p>
</div></blockquote>
<p><strong>Signature</strong> : (triqs_tprf::g2_nn_vt g) -&gt; triqs_tprf::g2_nn_t</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="wannier90-tight-binding-parsers">
<h1>Wannier90 tight binding parsers<a class="headerlink" href="#wannier90-tight-binding-parsers" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="triqs_tprf.wannier90.parse_hopping_from_wannier90_hr_dat">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.wannier90.</span></code><code class="sig-name descname"><span class="pre">parse_hopping_from_wannier90_hr_dat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_hopping_from_wannier90_hr_dat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_hopping_from_wannier90_hr_dat" title="Permalink to this definition">¶</a></dt>
<dd><p>Wannier90 real space hopping parser of <code class="docutils literal notranslate"><span class="pre">*_hr.dat</span></code> files.</p>
<p>Returns a dictionary where the keys are the real-space hopping vectors, 
in terms of multiples of the lattice vectors, and the values are
<code class="docutils literal notranslate"><span class="pre">num_wann</span> <span class="pre">*</span> <span class="pre">num_wann</span></code> numpy ndarrays with the hopping integrals.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> : str</p>
<blockquote>
<div><p>Wannier90 <code class="docutils literal notranslate"><span class="pre">*_hr.dat</span></code> file to parse.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hopp_dict</strong> : dict</p>
<blockquote>
<div><p>Dictionary of real space hoppings.</p>
</div></blockquote>
<p><strong>num_wann</strong> : int</p>
<blockquote>
<div><p>Total number of Wannier functions per unit-cell.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.wannier90.parse_lattice_vectors_from_wannier90_wout">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.wannier90.</span></code><code class="sig-name descname"><span class="pre">parse_lattice_vectors_from_wannier90_wout</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_lattice_vectors_from_wannier90_wout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_lattice_vectors_from_wannier90_wout" title="Permalink to this definition">¶</a></dt>
<dd><p>Wannier90 real space lattice vectors parser of <code class="docutils literal notranslate"><span class="pre">*.wout</span></code> files.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> : str</p>
<blockquote>
<div><p>Wannier90 <code class="docutils literal notranslate"><span class="pre">*.wout</span></code> file to parse.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vectors</strong> : list of three three-tuples of floats</p>
<blockquote>
<div><p>Lattice vectors.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.wannier90.parse_reciprocal_lattice_vectors_from_wannier90_wout">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.wannier90.</span></code><code class="sig-name descname"><span class="pre">parse_reciprocal_lattice_vectors_from_wannier90_wout</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_reciprocal_lattice_vectors_from_wannier90_wout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_reciprocal_lattice_vectors_from_wannier90_wout" title="Permalink to this definition">¶</a></dt>
<dd><p>Wannier90 reciprocal space lattice vectors parser of <code class="docutils literal notranslate"><span class="pre">*.wout</span></code> files.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> : str</p>
<blockquote>
<div><p>Wannier90 <code class="docutils literal notranslate"><span class="pre">*.wout</span></code> file to parse.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>vectors</strong> : list of three three-tuples of floats</p>
<blockquote>
<div><p>Reciprocal lattice vectors.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.wannier90.parse_band_structure_from_wannier90_band_dat">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.wannier90.</span></code><code class="sig-name descname"><span class="pre">parse_band_structure_from_wannier90_band_dat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/wannier90.html#parse_band_structure_from_wannier90_band_dat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.wannier90.parse_band_structure_from_wannier90_band_dat" title="Permalink to this definition">¶</a></dt>
<dd><p>Wannier90 band structure parser of <code class="docutils literal notranslate"><span class="pre">*_band.dat`</span></code> files.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> : str</p>
<blockquote>
<div><p>Wannier90 <code class="docutils literal notranslate"><span class="pre">*_band.dat</span></code> file to parse.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>E</strong> : ndarray (2D)</p>
<blockquote>
<div><p>Band energies.</p>
</div></blockquote>
<p><strong>w</strong> : ndarray (1D)</p>
<blockquote>
<div><p>k-space path points.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="tight-binding-lattice-model">
<h1>Tight binding lattice model<a class="headerlink" href="#tight-binding-lattice-model" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="triqs_tprf.tight_binding.TBLattice">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">triqs_tprf.tight_binding.</span></code><code class="sig-name descname"><span class="pre">TBLattice</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hopping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[(0,</span> <span class="pre">0,</span> <span class="pre">0)]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/tight_binding.html#TBLattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Class describing a tight binding lattice model.</p>
<p>This class is based in the TRIQS tight binding class and has been extended with
some extra convienience methods and documentation.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>units</strong> : list of three-tuples of floats</p>
<blockquote>
<div><p>Basis vectors for the real space lattice.</p>
</div></blockquote>
<p><strong>hopping</strong> : dict</p>
<blockquote>
<div><p>Dictionary with three tuple of integeers as keys, 
describing real space hoppings in multiples of 
the real space lattice basis vectors, and values being 
numpy ndarray hopping matrices in the orbital indices.</p>
</div></blockquote>
<p><strong>orbital_positions</strong> : list of three three-tuples of floats.</p>
<blockquote>
<div><p>Internal orbital positions in the unit-cell.</p>
</div></blockquote>
<p><strong>orbital_names</strong> : list of strings</p>
<blockquote>
<div><p>Names for each orbital.</p>
</div></blockquote>
</dd>
</dl>
<dl class="py method">
<dt id="triqs_tprf.tight_binding.TBLattice.on_mesh_brillouin_zone">
<code class="sig-name descname"><span class="pre">on_mesh_brillouin_zone</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/tight_binding.html#TBLattice.on_mesh_brillouin_zone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.TBLattice.on_mesh_brillouin_zone" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a discretization of the tight binding model in
reciprocal space with given number of k-points.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_k</strong> : three-tuple of ints</p>
<blockquote>
<div><p>Number of k-points in every dimension.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>e_k</strong> : TRIQS Greens function on a Brillioun zone mesh</p>
<blockquote>
<div><p>Reciprocal space tight binding dispersion.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.tight_binding.create_square_lattice">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.tight_binding.</span></code><code class="sig-name descname"><span class="pre">create_square_lattice</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeeman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/tight_binding.html#create_square_lattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.tight_binding.create_square_lattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Retuns TBLattice that represents a model on a square lattice</p>
<p>The model is described by the Hamiltonian</p>
<div class="math notranslate nohighlight">
\[H=-t \sum_{\langle j, l\rangle \sigma}\left(c_{j \sigma}^{\dagger}
c_{l \sigma}+c_{l \sigma}^{\dagger} c_{j \sigma}\right) -
t' \sum_{\langle\langle j, l\rangle\rangle \sigma}\left(c_{j \sigma}^{\dagger}
c_{l \sigma}+c_{l \sigma}^{\dagger} c_{j \sigma}\right) +
\xi \sum_j \left(n_{j \uparrow} - n_{j \downarrow} \right)\,,\]</div>
<p>where the angular bracket describes a sum over nearest neighbors and the double
angular bracket over next-nearest neighbors.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>norb</strong> : int,</p>
<blockquote>
<div><p>Number of orbitals excluding spin</p>
</div></blockquote>
<p><strong>t</strong> : complex,</p>
<blockquote>
<div><p>Kinetic energy of nearest neighbor hopping.
Corresponds to <span class="math notranslate nohighlight">\(t\)</span>.</p>
</div></blockquote>
<p><strong>tp</strong> : complex, optional</p>
<blockquote>
<div><p>Kinetic energy of next-nearest neighbor hopping.
Corresponds to <span class="math notranslate nohighlight">\(t'\)</span>.</p>
</div></blockquote>
<p><strong>zeeman</strong> : complex, optional</p>
<blockquote>
<div><p>Strength of Zeeman term.
Corresponds to <span class="math notranslate nohighlight">\(\xi\)</span>.</p>
</div></blockquote>
<p><strong>spin</strong> : bool,</p>
<blockquote>
<div><p>True if spin index should be used explicitly, False otherwise.
The Zeeman term can only be applied if spin=True.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>square_lattice</strong> : TBLattice</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="triqs_tprf.super_lattice.TBSuperLattice">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">triqs_tprf.super_lattice.</span></code><code class="sig-name descname"><span class="pre">TBSuperLattice</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tb_lattice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">super_lattice_units</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_internal_hoppings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice" title="Permalink to this definition">¶</a></dt>
<dd><p>Class building a superlattice on top of a base lattice (TBLattice).</p>
<p>The class inherits from TBLattice and has all the basic TBLattice methods, especially the <code class="docutils literal notranslate"><span class="pre">on_mesh_brillouin_zone</span></code>-method.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tb_lattice</strong> : TBLattice instance</p>
<blockquote>
<div><p>The base tight binding lattice.</p>
</div></blockquote>
<p><strong>super_lattice_units</strong> : ndarray (2D)</p>
<blockquote>
<div><p>The unit vectors of the superlattice in the <code class="docutils literal notranslate"><span class="pre">tb_lattice</span></code> (integer) coordinates.</p>
</div></blockquote>
<p><strong>cluster_sites :</strong> :</p>
<blockquote>
<div><p>Coordinates of the cluster in tb_lattice coordinates. 
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, an automatic computation of cluster positions 
is made as follows: it takes all points whose coordinates 
in the basis of the superlattice are in [0, 1[^dimension.</p>
</div></blockquote>
<p><strong>remove_internal_hoppings</strong> : bool</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">true</span></code>, the hopping terms are removed inside the cluster. 
Useful to add Hartree Fock terms at the boundary of a cluster, e.g.</p>
</div></blockquote>
</dd>
</dl>
<dl class="py method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_L_to_SL">
<code class="sig-name descname"><span class="pre">change_coordinates_L_to_SL</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.change_coordinates_L_to_SL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_L_to_SL" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a point on the tb_lattice in lattice coordinates, returns its coordinates (R, alpha) in the Superlattice</p>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_SL_to_L">
<code class="sig-name descname"><span class="pre">change_coordinates_SL_to_L</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.change_coordinates_SL_to_L"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.change_coordinates_SL_to_L" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a point in the supercell R, site (number) alpha, it computes its position on the tb_lattice in lattice coordinates</p>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.cluster_sites">
<code class="sig-name descname"><span class="pre">cluster_sites</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.cluster_sites"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.cluster_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the position of the cluster site in the tb_lattice coordinates.</p>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.fold">
<code class="sig-name descname"><span class="pre">fold</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_internal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.fold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.fold" title="Permalink to this definition">¶</a></dt>
<dd><p>Input: a function  r-&gt; f(r) on the tb_lattice given as a dictionnary
Output: the function R-&gt; F(R) folded on the superlattice.
Only requirement is that f(r)[orbital1, orbital2] is properly defined.
Hence f(r) can be a numpy, a GFBloc, etc…</p>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.pack_index_site_orbital">
<code class="sig-name descname"><span class="pre">pack_index_site_orbital</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_site</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_orbital</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.pack_index_site_orbital"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.pack_index_site_orbital" title="Permalink to this definition">¶</a></dt>
<dd><p>nsite and n_orbital must start at 0</p>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.super_lattice.TBSuperLattice.unpack_index_site_orbital">
<code class="sig-name descname"><span class="pre">unpack_index_site_orbital</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/super_lattice.html#TBSuperLattice.unpack_index_site_orbital"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.super_lattice.TBSuperLattice.unpack_index_site_orbital" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse of pack_index_site_orbital</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="hartree-fock-and-hartree-solvers">
<h1>Hartree-Fock and Hartree solvers<a class="headerlink" href="#hartree-fock-and-hartree-solvers" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">triqs_tprf.hf_solver.</span></code><code class="sig-name descname"><span class="pre">HartreeFockSolver</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_struct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree-Fock solver for local interactions.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>e_k</strong> : TRIQS Greens function on a Brillouin zone mesh</p>
<blockquote>
<div><p>Single-particle dispersion.</p>
</div></blockquote>
<p><strong>beta</strong> : float</p>
<blockquote>
<div><p>inverse temperature</p>
</div></blockquote>
<p><strong>H_int</strong> : TRIQS Operator instance</p>
<blockquote>
<div><p>Local interaction Hamiltonian</p>
</div></blockquote>
<p><strong>gf_struct</strong> : list of pairs of block index and its size</p>
<blockquote>
<div><p>gf_struct fixing orbital order between e_k and H_int</p>
</div></blockquote>
<p><strong>mu0</strong> : float</p>
<blockquote>
<div><p>chemical potential</p>
</div></blockquote>
<p><strong>mu_min, mu_max</strong> : float, optional</p>
<blockquote>
<div><p>range for chemical potential search.</p>
</div></blockquote>
</dd>
</dl>
<dl class="py method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.mat2vec">
<code class="sig-name descname"><span class="pre">mat2vec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.mat2vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.mat2vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a unitary matrix to a vector representation
with the order</p>
<ol class="arabic simple">
<li><p>the real diagonal entries</p></li>
<li><p>the real part of the upper triangular entries</p></li>
<li><p>the imaginary part of the upper triangular entries</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.solve_iter">
<code class="sig-name descname"><span class="pre">solve_iter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nitermax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.solve_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the HF-equations using forward recursion at fixed density.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>N_target</strong> : float</p>
<blockquote>
<div><p>Total density.</p>
</div></blockquote>
<p><strong>M0</strong> : ndarray (2D), optional</p>
<blockquote>
<div><p>Initial mean-field (0 if None).</p>
</div></blockquote>
<p><strong>mu0</strong> : float, optional</p>
<blockquote>
<div><p>Initial chemical potential.</p>
</div></blockquote>
<p><strong>nitermax</strong> : int, optional</p>
<blockquote>
<div><p>Maximal number of self consistent iterations.</p>
</div></blockquote>
<p><strong>mixing</strong> : float, optional</p>
<blockquote>
<div><p>Linear mixing parameter.</p>
</div></blockquote>
<p><strong>tol</strong> : float, optional</p>
<blockquote>
<div><p>Convergence in relative change of the density matrix.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rho</strong> : ndarray (2D)</p>
<blockquote>
<div><p>Local density matrix.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.solve_newton">
<code class="sig-name descname"><span class="pre">solve_newton</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.solve_newton"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the HF-equations using a quasi Newton method at fixed density.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>N_tot</strong> : float</p>
<blockquote>
<div><p>Total density.</p>
</div></blockquote>
<p><strong>M0</strong> : ndarray (2D), optional</p>
<blockquote>
<div><p>Initial mean-field (0 if None).</p>
</div></blockquote>
<p><strong>mu0</strong> : float, optional</p>
<blockquote>
<div><p>Initial chemical potential.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.solve_newton_mu">
<code class="sig-name descname"><span class="pre">solve_newton_mu</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.solve_newton_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.solve_newton_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the HF-equations using a quasi Newton method at fixed chemical potential.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mu0</strong> : float</p>
<blockquote>
<div><p>Initial chemical potential.</p>
</div></blockquote>
<p><strong>M0</strong> : ndarray (2D), optional</p>
<blockquote>
<div><p>Initial mean-field (0 if None).</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.hf_solver.HartreeFockSolver.vec2mat">
<code class="sig-name descname"><span class="pre">vec2mat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeFockSolver.vec2mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeFockSolver.vec2mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from vector representation to a unitary matrix
see mat2vec(…) for details.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="triqs_tprf.hf_response.HartreeFockResponse">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">triqs_tprf.hf_response.</span></code><code class="sig-name descname"><span class="pre">HartreeFockResponse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hartree_fock_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_response.html#HartreeFockResponse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_response.HartreeFockResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree-Fock linear response calculator.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hartree_fock_solver</strong> : HartreeFockSolver instance</p>
<blockquote>
<div><p>Converged Hartree-Fock solver.</p>
</div></blockquote>
<p><strong>eps</strong> : float</p>
<blockquote>
<div><p>Step size in finite difference linear response calculation.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="triqs_tprf.hf_solver.HartreeSolver">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">triqs_tprf.hf_solver.</span></code><code class="sig-name descname"><span class="pre">HartreeSolver</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H_int</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gf_struct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeSolver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree solver for local interactions.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>e_k</strong> : TRIQS Greens function on a Brillouin zone mesh</p>
<blockquote>
<div><p>Single-particle dispersion.</p>
</div></blockquote>
<p><strong>beta</strong> : float</p>
<blockquote>
<div><p>inverse temperature</p>
</div></blockquote>
<p><strong>H_int</strong> : TRIQS Operator instance</p>
<blockquote>
<div><p>Local interaction Hamiltonian</p>
</div></blockquote>
<p><strong>gf_struct</strong> : list of lists of block index and list of internal orbital indices</p>
<blockquote>
<div><p>gf_struct fixing orbital order between e_k and H_int</p>
</div></blockquote>
<p><strong>mu0</strong> : float</p>
<blockquote>
<div><p>chemical potential</p>
</div></blockquote>
<p><strong>mu_min, mu_max</strong> : float, optional</p>
<blockquote>
<div><p>range for chemical potential search.</p>
</div></blockquote>
</dd>
</dl>
<dl class="py method">
<dt id="triqs_tprf.hf_solver.HartreeSolver.mat2vec">
<code class="sig-name descname"><span class="pre">mat2vec</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeSolver.mat2vec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeSolver.mat2vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a unitary matrix to a vector representation
with the order</p>
<ol class="arabic simple">
<li><p>the real diagonal entries</p></li>
<li><p>the real part of the upper triangular entries</p></li>
<li><p>the imaginary part of the upper triangular entries</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.hf_solver.HartreeSolver.vec2mat">
<code class="sig-name descname"><span class="pre">vec2mat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_solver.html#HartreeSolver.vec2mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_solver.HartreeSolver.vec2mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from vector representation to a unitary matrix
see mat2vec(…) for details.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="triqs_tprf.hf_response.HartreeResponse">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">triqs_tprf.hf_response.</span></code><code class="sig-name descname"><span class="pre">HartreeResponse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hartree_solver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/hf_response.html#HartreeResponse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.hf_response.HartreeResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>Hartree linear response calculator.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hartree_solver</strong> : HartreeSolver instance</p>
<blockquote>
<div><p>Converged Hartree solver.</p>
</div></blockquote>
<p><strong>eps</strong> : float</p>
<blockquote>
<div><p>Step size in finite difference linear response calculation.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="parameter-collections">
<h1>Parameter collections<a class="headerlink" href="#parameter-collections" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="triqs_tprf.ParameterCollection.ParameterCollection">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">triqs_tprf.ParameterCollection.</span></code><code class="sig-name descname"><span class="pre">ParameterCollection</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper class for handing collections of parameters.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> : dict</p>
<blockquote>
<div><p>Key-word argument list of parameters.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>A <code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code> has any number of attributes, accessible with the
dot operator.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span>
<span class="go">U = 1.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span><span class="o">.</span><span class="n">beta</span>
<span class="go">10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p</span>
<span class="go">U = 1.0</span>
<span class="go">W = 1.2</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
</pre></div>
</div>
<p>and can be stored and loaded to/from TRIQS hdf archives.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">h5</span> <span class="kn">import</span> <span class="n">HDFArchive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">arch</span><span class="p">:</span> <span class="n">arch</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;data.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">arch</span><span class="p">:</span> <span class="n">p_ref</span> <span class="o">=</span> <span class="n">arch</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">p_ref</span>
<span class="go">U = 1.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
</pre></div>
</div>
<dl class="py method">
<dt id="triqs_tprf.ParameterCollection.ParameterCollection.alter">
<code class="sig-name descname"><span class="pre">alter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection.alter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection.alter" title="Permalink to this definition">¶</a></dt>
<dd><p>Change or add attributes</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>p</strong> : <code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.ParameterCollection.ParameterCollection.convert_keys_from_string_to_python">
<code class="sig-name descname"><span class="pre">convert_keys_from_string_to_python</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection.convert_keys_from_string_to_python"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection.convert_keys_from_string_to_python" title="Permalink to this definition">¶</a></dt>
<dd><p>h5.HDFArchive incorrectly mangles tuple keys to string
running this on the affected dict tries to revert this by running eval
on the string representation. UGLY FIX…</p>
</dd></dl>

<dl class="py method">
<dt id="triqs_tprf.ParameterCollection.ParameterCollection.copy">
<code class="sig-name descname"><span class="pre">copy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollection.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollection.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Shallow copy</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="triqs_tprf.ParameterCollection.ParameterCollections">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">triqs_tprf.ParameterCollection.</span></code><code class="sig-name descname"><span class="pre">ParameterCollections</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objects</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#ParameterCollections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.ParameterCollections" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper class for handing a series of collections of parameters.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>objects</strong> : list</p>
<blockquote>
<div><p>List of <code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code> instances.</p>
</div></blockquote>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ParameterCollections</span></code> class makes it easy to get vectors of 
parameters from a list of <code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code> objects.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.337</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ps</span> <span class="o">=</span> <span class="n">ParameterCollections</span><span class="p">(</span><span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="o">.</span><span class="n">beta</span>
<span class="go">[10.  5.]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="o">.</span><span class="n">U</span>
<span class="go">[1. 2.]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="triqs_tprf.ParameterCollection.parameter_scan">
<code class="sig-prename descclassname"><span class="pre">triqs_tprf.ParameterCollection.</span></code><code class="sig-name descname"><span class="pre">parameter_scan</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_tprf/ParameterCollection.html#parameter_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#triqs_tprf.ParameterCollection.parameter_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Return ParameterCollections with copies of ParameterCollection for different parameters</p>
<p>Uses a given ParameterCollection as a template to create copies of it with one or more
parameters changing. Stores all of these copies in a ParameterCollections for easy access.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> : ParameterCollection,</p>
<blockquote>
<div><p>The ParameterCollection that shall be used as a template for all the others</p>
</div></blockquote>
<p><strong>**kwargs</strong> : Sequence,</p>
<blockquote>
<div><p>The keyword gives the parameter name and the Sequence the values that shall
be scanned through.</p>
</div></blockquote>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ParameterCollections</strong> :</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ps</span> <span class="o">=</span> <span class="n">parameter_scan</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">U</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">U = 1.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">U = 1.5</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">ps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">U = 2.0</span>
<span class="go">beta = 10.0</span>
<span class="go">t = 1.0</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
    <li><a href="../index.html">Home</a> &raquo;</li>

        <li class="nav-item nav-item-this"><a href="">Lattice Green’s functions</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, H. U.R. Strand.
    </div>
  </body>
</html>