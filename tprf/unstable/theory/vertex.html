
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vertex functions &#8212; TPRF - Two-Particle Response Function tool box for TRIQS  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/triqs.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head><body>
<div class="pageheader">
  <ul>
    
    <li><a href="../install.html">Install</a></li>
    
    <li><a href="../documentation.html">Documentation</a></li>
    
    <li><a href="../issues.html">Issues</a></li>
    
    <li><a href="../about.html">About tprf</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../index.html">tprf</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">Two-particle response function tool box based on the <a class="triqs" style="font-size: 12px" href="https://triqs.github.io">TRIQS</a> library</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
    <li><a href="../index.html">Home</a> &raquo;</li>

        <li class="nav-item nav-item-this"><a href="">Vertex functions</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Vertex functions</a><ul>
<li><a class="reference internal" href="#fully-reducible-vertex-f">Fully reducible vertex <span class="math notranslate nohighlight">\(F\)</span></a></li>
</ul>
</li>
<li><a class="reference internal" href="#bethe-salpeter-equations-for-the-fully-reducible-vertext-f">Bethe-Salpeter equations for the fully reducible vertext <span class="math notranslate nohighlight">\(F\)</span></a></li>
<li><a class="reference internal" href="#matsubara-frequency-parametrization">Matsubara frequency parametrization</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/theory/vertex.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="vertex-functions">
<span id="vertex"></span><h1>Vertex functions<a class="headerlink" href="#vertex-functions" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This notation follows closely [Ayral, Parcollet, PRB 94, 075159 (2016)] with the exception that <span class="math notranslate nohighlight">\(PH\)</span> and <span class="math notranslate nohighlight">\(\bar{PH}\)</span> are interchanged.</p>
</div>
<div class="section" id="fully-reducible-vertex-f">
<h2>Fully reducible vertex <span class="math notranslate nohighlight">\(F\)</span><a class="headerlink" href="#fully-reducible-vertex-f" title="Permalink to this headline">¶</a></h2>
<p>The fully recucible vertex function <span class="math notranslate nohighlight">\(F(a\bar{a}b\bar{b})\)</span> is defined as the amputation of the connected two-particle Green’s function <span class="math notranslate nohighlight">\(G^{(2)}_c\)</span> by four single-particle Green’s functions <span class="math notranslate nohighlight">\(G\)</span>, one for each leg.</p>
<div class="math notranslate nohighlight">
\[G(a\bar{a}) G(b\bar{b}) F(a\bar{b}c\bar{d}) G(c\bar{c}) G(d\bar{d})
\equiv G^{(2)}_c(\bar{a}b\bar{c}d)\]</div>
</div>
</div>
<div class="section" id="bethe-salpeter-equations-for-the-fully-reducible-vertext-f">
<h1>Bethe-Salpeter equations for the fully reducible vertext <span class="math notranslate nohighlight">\(F\)</span><a class="headerlink" href="#bethe-salpeter-equations-for-the-fully-reducible-vertext-f" title="Permalink to this headline">¶</a></h1>
<p>The Bethe-Salpeter equations for the fully reducible vertex <span class="math notranslate nohighlight">\(F\)</span> is defined for any given channel <span class="math notranslate nohighlight">\(r\)</span> as</p>
<div class="math notranslate nohighlight">
\[F = \Gamma^{r} + \Gamma^{r} GG F\]</div>
<p>The possible pairings of indices in the right-hand side prodict produces three non-equivalent equations labeled <span class="math notranslate nohighlight">\(r \in \{ PH, \bar{PH}, PP\}\)</span> standing for, the particle-hole (<span class="math notranslate nohighlight">\(PH\)</span>), vertical-particle-hole (<span class="math notranslate nohighlight">\(\bar{PH}\)</span>), and particle-particle (<span class="math notranslate nohighlight">\(PP\)</span>) channel, respectively.</p>
<p>Each equation and index pairing is associated with one “channel” within which the <span class="math notranslate nohighlight">\(r\)</span>-channel-irreducible vertex <span class="math notranslate nohighlight">\(\Gamma^r\)</span>.</p>
<div class="math notranslate nohighlight">
\[F(a\bar{b}c\bar{d}) = \Gamma^{PH}(a\bar{b}c\bar{d}) -
\Gamma^{PH}(a\bar{b}u\bar{v}) G(u\bar{u}) G(v\bar{v}) F(v\bar{u}c\bar{d})\]</div>
<div class="math notranslate nohighlight">
\[F(a\bar{b}c\bar{d}) = \Gamma^{\bar{PH}}(a\bar{b}c\bar{d}) +
\Gamma^{\bar{PH}}(a\bar{u}v\bar{d}) G(u\bar{u}) G(v\bar{v}) F(u\bar{b}c\bar{v})\]</div>
<div class="math notranslate nohighlight">
\[F(a\bar{b}c\bar{d}) = \Gamma^{PP}(a\bar{b}c\bar{d}) + \frac{1}{2}
\Gamma^{PP}(a\bar{u}c\bar{v}) G(u\bar{u}) G(v\bar{v}) F(v\bar{b}u\bar{d})\]</div>
<p>Collecting the two single-particle Green’s functions into a channel dependent “bare” susceptibility <span class="math notranslate nohighlight">\(\chi^r_0\)</span> the Behte-Salpeter equations can be expressed as</p>
<div class="math notranslate nohighlight">
\[F = \Gamma^r + \Gamma^r \stackrel{r}{*} \chi^r_0 \stackrel{r}{*}  F\]</div>
<p>where the channel non-interacting vertex functions <span class="math notranslate nohighlight">\(\chi_0^r\)</span> are defined as</p>
<div class="math notranslate nohighlight">
\[\chi_0^{PH}(\bar{a}b\bar{c}d) = G(b\bar{c}) G(d\bar{a})
\, , \quad
\big(
\chi_0^{PH}(\bar{v}u\bar{u}v) = G(u\bar{u}) G(v\bar{v})
\big)\]</div>
<div class="math notranslate nohighlight">
\[\chi_0^{\bar{PH}}(\bar{a}b\bar{c}d) = G(b\bar{a}) G(d\bar{c})
\, , \quad
\big(
\chi_0^{\bar{PH}}(\bar{u}u\bar{v}v) = G(u\bar{u}) G(v\bar{v})
\big)\]</div>
<div class="math notranslate nohighlight">
\[\chi_0^{PP}(\bar{a}b\bar{c}d) = G(d\bar{a}) G(b\bar{c})
\, , \quad
\big(
\chi_0^{PP}(\bar{u}v\bar{v}u) = G(u\bar{u}) G(v\bar{v})
\big)\]</div>
<p>yielding the Bethe-Salpeter equations expressed fully in two-particle quantities</p>
<div class="math notranslate nohighlight" id="equation-bse-ph">
<span class="eqno">(1)<a class="headerlink" href="#equation-bse-ph" title="Permalink to this equation">¶</a></span>\[F(a\bar{b}c\bar{d}) = \Gamma^{PH}(a\bar{b}c\bar{d}) -
\Gamma^{PH}(a\bar{b}q\bar{p}) \, \chi^{PH}_0(\bar{p}q\bar{r}s) \, F(s\bar{r}c\bar{d})\]</div>
<div class="math notranslate nohighlight" id="equation-bse-phbar">
<span class="eqno">(2)<a class="headerlink" href="#equation-bse-phbar" title="Permalink to this equation">¶</a></span>\[F(a\bar{b}c\bar{d}) = \Gamma^{\bar{PH}}(a\bar{b}c\bar{d}) +
\Gamma^{\bar{PH}}(a\bar{p}s\bar{d}) \, \chi^{\bar{PH}}_0(\bar{p}q\bar{r}s) \, F(q\bar{b}c\bar{r})\]</div>
<div class="math notranslate nohighlight" id="equation-bse-pp">
<span class="eqno">(3)<a class="headerlink" href="#equation-bse-pp" title="Permalink to this equation">¶</a></span>\[F(a\bar{b}c\bar{d}) = \Gamma^{PP}(a\bar{b}c\bar{d}) + \frac{1}{2}
\Gamma^{PP}(a\bar{p}c\bar{r}) \, \chi^{PP}_0(\bar{p}q\bar{r}s) \, F(q\bar{b}s\bar{d})\]</div>
<p>Note that the notion of the product <span class="math notranslate nohighlight">\(\stackrel{r}{*}\)</span> is dependent on the channel <span class="math notranslate nohighlight">\(r\)</span> and consists of different choices of contracting two indices in Eqs. <a class="reference internal" href="#equation-bse-ph">(1)</a>, <a class="reference internal" href="#equation-bse-phbar">(2)</a>, and <a class="reference internal" href="#equation-bse-pp">(3)</a>.</p>
</div>
<div class="section" id="matsubara-frequency-parametrization">
<h1>Matsubara frequency parametrization<a class="headerlink" href="#matsubara-frequency-parametrization" title="Permalink to this headline">¶</a></h1>
<p>In a carefully choosen parametrization of Matsubara frequencies, the two-time integrals appearing in the products of the Bethe-Salpeter equations <a class="reference internal" href="#equation-bse-ph">(1)</a>, <a class="reference internal" href="#equation-bse-phbar">(2)</a>, and <a class="reference internal" href="#equation-bse-pp">(3)</a> can be reduced to a single sum over one Matsubara frequency. This is achieved by using a channel dependent three frequency reparametrization that directly imposes total frequency conservation, the forms are</p>
<div class="math notranslate nohighlight" id="equation-channel-freq">
<span class="eqno">(4)<a class="headerlink" href="#equation-channel-freq" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{array}{ll}
PH: \left\{
\begin{array}{rl}
\nu_1 &amp;=&amp; \nu \\
\nu_2 &amp;=&amp; \nu + \omega \\
\nu_3 &amp;=&amp; \nu' + \omega \\
\nu_4 &amp;=&amp; \nu'
\end{array}
\right.
\, , &amp; \quad
\bar{PH}: \left\{
\begin{array}{rcl}
\nu_1 &amp;=&amp; \nu \\
\nu_2 &amp;=&amp; \nu'\\
\nu_3 &amp;=&amp; \nu' + \omega\\
\nu_4 &amp;=&amp; \nu + \omega
\end{array}\right.
\, , \quad
\\ \\
PP: \left\{
\begin{array}{rcl}
\nu_1 &amp;=&amp; \nu \\
\nu_2 &amp;=&amp; \nu' \\
\nu_3 &amp;=&amp; \omega - \nu \\
\nu_4 &amp;=&amp; \omega - \nu'
\end{array}\right.
\, , &amp; \quad
PPx: \left\{
\begin{array}{rcl}
\nu_1 &amp;=&amp; \nu \\
\nu_2 &amp;=&amp; \omega - \nu' \\
\nu_3 &amp;=&amp; \omega - \nu \\
\nu_4 &amp;=&amp; \nu'
\end{array}\right.
\end{array}\end{split}\]</div>
<p>for the (horizontal) Particle-Hole (<span class="math notranslate nohighlight">\(PH\)</span>) channel, the (vertical) Particle-Hole (<span class="math notranslate nohighlight">\(\bar{PH}\)</span>) channel, the Particle-Particle (<span class="math notranslate nohighlight">\(PP\)</span>) channel, and the Crossed-Particle-Particle (<span class="math notranslate nohighlight">\(PPx\)</span>) channel, respectively.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The current definition of the <span class="math notranslate nohighlight">\(PP\)</span> channel in <cite>cthyb</cite> is actually the <span class="math notranslate nohighlight">\(PPx\)</span> channel. FIXME!</p>
</div>
<p>In terms of imaginary time the channel dependent three frequency representation maps to the follwing pairing of the four imaginary times <span class="math notranslate nohighlight">\(\tau_a\)</span>, <span class="math notranslate nohighlight">\(\tau_\bar{b}\)</span>, <span class="math notranslate nohighlight">\(\tau_c\)</span>, <span class="math notranslate nohighlight">\(tau_{\bar{d}}\)</span> of a response function <span class="math notranslate nohighlight">\(\chi_{a\bar{b}c\bar{d}}(\tau_a, \tau_{\bar{b}}, \tau_c, \tau_{\bar{d}})\)</span></p>
<div class="math notranslate nohighlight">
\[PH : \,
+ i\omega (\tau_{\bar{b}} - \tau_c)
+ i\nu    (-\tau_{a} + \tau_{\bar{b}})
+ i\nu'   (-\tau_{c} + \tau_{\bar{d}})\]</div>
<div class="math notranslate nohighlight">
\[\bar{PH} : \,
+ i\omega (-\tau_{c} + \tau_{\bar{d}})
+ i\nu    (-\tau_{a} + \tau_{\bar{d}})
+ i\nu'   (\tau_{\bar{b}} - \tau_{c})\]</div>
<div class="math notranslate nohighlight">
\[PP : \,
+ i\omega (-\tau_{c} + \tau_{\bar{d}})
+ i\nu    (-\tau_{a} + \tau_{c})
+ i\nu'   (\tau_{\bar{b}} - \tau_{\bar{d}})\]</div>
<div class="math notranslate nohighlight">
\[PPx : \,
+ i\omega (\tau_{\bar{b}} - \tau_{c})
+ i\nu    (-\tau_{a} + \tau_{c})
+ i\nu'   (-\tau_{\bar{b}} + \tau_{\bar{d}})\]</div>
<p>In a general product <span class="math notranslate nohighlight">\(P = \Gamma \stackrel{r}{*} \chi_0\)</span> the total frequency conservation of the components of the product <span class="math notranslate nohighlight">\(\Gamma\)</span> and <span class="math notranslate nohighlight">\(\chi_0\)</span> gives two constraints that when combined gives the total frequency conservation of the product <span class="math notranslate nohighlight">\(P\)</span> and a reduction of the frequency summation of the product from two frequencies to one. This is achieved by using the above global reparametrizations of the four fermionic Matsubara frequencies <span class="math notranslate nohighlight">\(\nu_1 ,\, \nu_2 ,\, \nu_3 ,\, \nu_4\)</span> of every response function <span class="math notranslate nohighlight">\(Q(\nu_1\nu_2\nu_3\nu_4)\)</span> for the particular channel <span class="math notranslate nohighlight">\(r \in \{PH, \bar{PH}, PP\}\)</span> in question.</p>
<p>In order to map the products to matrix products in index and frequency space the following index ordering has to be done</p>
<div class="math notranslate nohighlight">
\[PH: \,
\chi^{PH}_{a\bar{b}c\bar{d}}(\omega, \nu, nu') =
\chi^{PH}_{\{\bar{\nu}, \bar{a}b \},\{ \nu, d\bar{c} \}}(\omega)\]</div>
<div class="math notranslate nohighlight">
\[\bar{PH}: \,
\chi^{\bar{PH}}_{a\bar{b}c\bar{d}}(\omega, \nu, nu') =
\chi^{\bar{PH}}_{\{\bar{\nu}, \bar{a}d \}, \{\nu', b\bar{c} \} }(\omega)\]</div>
<div class="math notranslate nohighlight">
\[PP: \,
\chi^{PP}_{a\bar{b}c\bar{d}}(\omega, \nu, nu') =
\chi^{PP}_{\{ \bar{\nu}, \bar{a}\bar{c} \}, \{ \nu', bd\}}
(\omega)\]</div>
<div class="math notranslate nohighlight">
\[PPx: \,
\chi^{PPx}_{a\bar{b}c\bar{d}}(\omega, \nu, nu') =
\chi^{PPx}_{\{ \bar{\nu}, \bar{c}\bar{a} \}, \{ \nu', bd\}}
(\omega)\]</div>
<p>The resulting productformulas reads (see separate derivation chapter),</p>
<div class="math notranslate nohighlight">
\[P^{PH}_{a\bar{b}\bar{c}d}(\omega, \nu,\nu') =
\frac{1}{\beta^2} \sum_{\bar{\nu} u\bar{v}}
\Gamma^{PH}_{ \{ \nu, a\bar{b} \},\{ \bar{\nu}, \bar{v}u \}}(\omega)
\,
\chi^{PH}_{0, \{\bar{\nu}, \bar{v}u \},\{ \nu, d\bar{c} \}}(\omega)\]</div>
<div class="math notranslate nohighlight">
\[P^{\bar{PH}}_{ab\bar{c}\bar{d}}(\omega, \nu, \nu')
=
\frac{1}{\beta^2} \sum_{\bar{\nu}, \bar{u} v}
\Gamma^{\bar{PH}}_{\{ \nu, a\bar{d} \}, \{ \bar{\nu}, \bar{u}v \}}(\omega)
\,
\chi^{\bar{PH}}_{0, \{\bar{\nu}, \bar{u}v \}, \{\nu', b\bar{c} \} }(\omega)\]</div>
<div class="math notranslate nohighlight">
\[P^{PP}_{abcd}(\omega, \nu, \nu')
=
\frac{1}{\beta^2}
\sum_{\bar{u} \bar{v}}
\sum_{\bar{\nu}}
\Gamma^{PP}_{ \{ \nu , ac \}, \{\bar{\nu}, \bar{u}\bar{v} \} }
(\omega)
\,
\chi^{PP}_{0, \{ \bar{\nu}, \bar{u}\bar{v} \}, \{ \nu', bd\}}
(\omega)\]</div>
<div class="math notranslate nohighlight">
\[P^{PPx}_{abcd}(\omega, \nu, \nu')
=
\frac{1}{\beta^2}
\sum_{\bar{u} \bar{v}}
\sum_{\bar{\nu}}
\Gamma^{PPx}_{ \{ \nu , ca \}, \{\bar{\nu}, \bar{u}\bar{v} \} }
(\omega)
\,
\chi^{PPx}_{0, \{ \bar{\nu}, \bar{u}\bar{v} \}, \{ \nu', bd\}}
(\omega)\]</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
    <li><a href="../index.html">Home</a> &raquo;</li>

        <li class="nav-item nav-item-this"><a href="">Vertex functions</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, H. U.R. Strand.
    </div>
  </body>
</html>