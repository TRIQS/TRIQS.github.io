
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Linearized Eliashberg equation on the attractive Hubbard model &#8212; TPRF - Two-Particle Response Function tool box for TRIQS  documentation</title>
    <link rel="stylesheet" href="../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Solving the linearized Eliashberg equation in the random phase approximation limit" href="Solving the linearized Eliashberg equation in the random phase approximation limit.html" />
    <link rel="prev" title="DMFT lattice susceptibility" href="dmft_susceptibility/dmft_susceptibility.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head><body>
<div class="pageheader">
  <ul>
    
    <li><a href="../install.html">Install</a></li>
    
    <li><a href="../documentation.html">Documentation</a></li>
    
    <li><a href="../issues.html">Issues</a></li>
    
    <li><a href="../about.html">About tprf</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../index.html">tprf</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">Two-particle response function tool box based on the <a class="triqs" style="font-size: 12px" href="https://triqs.github.io">TRIQS</a> library</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="Solving the linearized Eliashberg equation in the random phase approximation limit.html" title="Solving the linearized Eliashberg equation in the random phase approximation limit"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="dmft_susceptibility/dmft_susceptibility.html" title="DMFT lattice susceptibility"
             accesskey="P">previous</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../documentation.html" accesskey="U">Documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Linearized Eliashberg equation on the attractive Hubbard model</a><ul>
<li><a class="reference internal" href="#Hubbard-model-on-a-square-lattice">Hubbard model on a square lattice</a><ul>
<li><a class="reference internal" href="#Semi-particle-hole-transformation">Semi particle-hole transformation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Solving-the-linearized-Eliashberg-equation">Solving the linearized Eliashberg equation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="dmft_susceptibility/dmft_susceptibility.html"
                        title="previous chapter">DMFT lattice susceptibility</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Solving the linearized Eliashberg equation in the random phase approximation limit.html"
                        title="next chapter">Solving the linearized Eliashberg equation in the random phase approximation limit</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/user_guide/Linearized Eliashberg equation on the attractive Hubbard model.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Linearized-Eliashberg-equation-on-the-attractive-Hubbard-model">
<h1>Linearized Eliashberg equation on the attractive Hubbard model<a class="headerlink" href="#Linearized-Eliashberg-equation-on-the-attractive-Hubbard-model" title="Permalink to this headline">¶</a></h1>
<p>A simple example for the usage of the linearized Eliashberg equation is the attractive Hubbard model on a square lattice. It is not only fast and simple to setup, but the particle-hole symmetry of the Hubbard model also serves as a benchmark for the correctness of such a calculation.</p>
<p>In the following we will first introduce the Hubbard model and present the semi particle-hole transformation and its usage. Then we will show how to solve the linearized Eliashberg equation for this model to find the superconducting phase transition using TRIQS and TPRF routines.</p>
<p>If you want a more detailed study of this problem, checkout this <a class="reference external" href="https://github.com/TRIQS/tprf/blob/eliashberg/benchmark/eliashberg/particle_hole_transformation/PHT_Hubbard_Model.ipynb">notebook</a>.</p>
<div class="section" id="Hubbard-model-on-a-square-lattice">
<h2>Hubbard model on a square lattice<a class="headerlink" href="#Hubbard-model-on-a-square-lattice" title="Permalink to this headline">¶</a></h2>
<p>The particle-hole symmetric Hamiltonian for the Hubbard model is given by</p>
<div class="math notranslate nohighlight">
\[H=-t \sum_{\langle j, l\rangle \sigma}\left(c_{j \sigma}^{\dagger} c_{l \sigma}+c_{l \sigma}^{\dagger} c_{j \sigma}\right)+U \sum_{j}\left(n_{j \uparrow}-\frac{1}{2}\right)\left(n_{j \downarrow}-\frac{1}{2}\right)-\mu \sum_{j}\left(n_{j \uparrow}+n_{j \downarrow}\right)\,,\]</div>
<p>here <span class="math notranslate nohighlight">\(c_{j\sigma}^{\dagger}\)</span> creates an electron on site <span class="math notranslate nohighlight">\(j\)</span> with spin <span class="math notranslate nohighlight">\(\sigma\)</span> while <span class="math notranslate nohighlight">\(c_{j\sigma}\)</span> destroys such an electron, further the operator <span class="math notranslate nohighlight">\(n_{j\sigma}\)</span> count the number of electrons on site <span class="math notranslate nohighlight">\(j\)</span> with spin <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<p>The first term describes the kinetic energy of the electrons, which can be interpreted as an electron with spin <span class="math notranslate nohighlight">\(\sigma\)</span> <em>hopping</em> from site <span class="math notranslate nohighlight">\(l\)</span> to site <span class="math notranslate nohighlight">\(j\)</span> and vice versa. Here the angular braket under the sum means that we only take <em>hopping</em> terms between neighboring lattice sites into account and the energy that is gained by such a <em>hopping</em> process is given by <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>The second term describes the repulsive interaction between the electrons. This repulsion is crudely approximated in the Hubbard model in the sense, that electrons only <em>see</em> each other if they occupy the same lattice site. The energy that is needed to have a lattice site doubly occupied is given by <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>The last term describes the filling of the lattice via an energy offset by the chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<p>The Hubbard model is therefore defined by the parameters <span class="math notranslate nohighlight">\(t\)</span>, <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span>, but we also need to know the temperature <span class="math notranslate nohighlight">\(T\)</span> at which we shall observe the Hubbard model. We will record these parameters using the <code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code> class of <code class="docutils literal notranslate"><span class="pre">triqs_tprf.ParameterCollection</span></code> module.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">triqs_tprf.ParameterCollection</span> <span class="kn">import</span> <span class="n">ParameterCollection</span>

<span class="n">hubbard</span> <span class="o">=</span> <span class="n">ParameterCollection</span><span class="p">(</span>   <span class="c1"># -- Model Parameter</span>
                                 <span class="n">norb</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># Number of orbitals.</span>
                                 <span class="n">t</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="c1"># Hopping to nearest neighbor</span>
                                 <span class="n">U</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="c1"># Strength of the on-site interaction</span>
                                 <span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="c1"># Chemical potential determining the filling.</span>
                                 <span class="n">T</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="c1"># Temperature.</span>
                                 <span class="n">spin</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="c1"># Treat indices only for orbital character.</span>

                                 <span class="c1"># -- Technical parameter</span>
                                 <span class="n">nk</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="c1"># Number of points in one dimension considered in the Brillouin zone.</span>
                                 <span class="n">nw</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="c1"># Number of Matsubara points in positive dimension.</span>
                                        <span class="p">)</span>
<span class="n">hubbard</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>T = 1000
U = 1.0
mu = 0.0
nk = 32
norb = 1
nw = 50
spin = False
t = 1.0
</pre></div>
</div>
</div>
<div class="section" id="Semi-particle-hole-transformation">
<h3>Semi particle-hole transformation<a class="headerlink" href="#Semi-particle-hole-transformation" title="Permalink to this headline">¶</a></h3>
<p>The Hubbard model with only nearest neighbor hopping inhibts a useful semi particle-hole symmetry, which we will present without any rigorous derivations.</p>
<p>First off, a bipartite lattice can be subdivided into two sublattices for which every lattice site on one of them only has neighboring sites from the other sublattice. This is the case for our square lattice. With this knowledge we can define the particle-hole transformation (PHT) for the creation and annihilation operators as</p>
<div class="math notranslate nohighlight">
\[\begin{split}c^\dagger_{j \sigma} \xrightarrow{\mathrm{PHT}} (-1)^{j} d_{j \sigma} \,,\quad
\mathrm{and}\quad
c_{j \sigma} \xrightarrow{\mathrm{PHT}}(-1)^{j}d_{j \sigma}^{\dagger}\,,\\\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(j\)</span> is either <span class="math notranslate nohighlight">\(0\)</span> for one sublattice and <span class="math notranslate nohighlight">\(1\)</span> for the other.</p>
<p>If we use the PHT only on one spin specices it is called a semi particle-hole transformation (SPHT). This means</p>
<div class="math notranslate nohighlight">
\[\begin{split}c_{j \uparrow}^{\dagger} \xrightarrow{\mathrm{SPHT}} d_{j \uparrow}^{\dagger}\quad\mathrm{and}\quad
c_{j \uparrow} \xrightarrow{\mathrm{SPHT}} d_{j \uparrow}\\
c_{j \downarrow}^{\dagger} \xrightarrow{\mathrm{SPHT}} (-1)^j d_{j \downarrow}\quad\mathrm{and}\quad
c_{j \downarrow} \xrightarrow{\mathrm{SPHT}} (-1)^j d_{j \downarrow}^{\dagger}\,,\end{split}\]</div>
<p>and for the number operators</p>
<div class="math notranslate nohighlight">
\[n_{j \uparrow}\xrightarrow{\mathrm{SPHT}} \tilde{n}_{j \uparrow}
\quad\mathrm{and}\quad
n_{j \downarrow} \xrightarrow{\mathrm{SPHT}} 1-\tilde{n}_{j \downarrow}\,.\]</div>
<p>One can convince themselves, that the kinetic part of the Hubbard model on a square lattice with only nearest neighbor hopping is invariant under a SPHT. The interaction term on the other hand is not and changes sign</p>
<div class="math notranslate nohighlight">
\[\left(n_{j \uparrow}-\frac{1}{2}\right)\left(n_{j \downarrow}-\frac{1}{2}\right) \xrightarrow{\mathrm{SPHT}}
-\left(\tilde{n}_{j \uparrow} - \frac{1}{2}\right)\left(\tilde{n}_{j \downarrow}-\frac{1}{2}\right)\,.\]</div>
<p>Therefore the SPHT maps the repulsive Hubbard model with <span class="math notranslate nohighlight">\(U\)</span> to the attractive one with <span class="math notranslate nohighlight">\(-U\)</span>. Additionally to that, if our Hubbard model is not a half-filling, the chemical potential term is also not invariant under a SPHT</p>
<div class="math notranslate nohighlight">
\[n_{j \uparrow}+n_{j \downarrow} \xrightarrow{\mathrm{SPHT}}
1 + \left(\tilde{n}_{j \uparrow}-\tilde{n}_{j \downarrow}\right)\,,\]</div>
<p>and transforms into a Zeeman term.</p>
<p>To summarize the SPHT maps the Hubbard Hamiltonian with interaction strength <span class="math notranslate nohighlight">\(U\)</span> and chemical potential <span class="math notranslate nohighlight">\(\mu\)</span> to a Hubbard Hamiltonian with interaction strength <span class="math notranslate nohighlight">\(-U\)</span>, a chemical potential of <span class="math notranslate nohighlight">\(0\)</span> and an additional Zeeman term of strength <span class="math notranslate nohighlight">\(\mu\)</span>. If we therefore calculate an observable <span class="math notranslate nohighlight">\(A\)</span> in the attractive Hubbard model we know the observable <span class="math notranslate nohighlight">\(B\xleftarrow{\mathrm{SPHT}}A\)</span> in the repulsive one.</p>
<p>For example, the in-plane antiferromagnetic (AFM) phase of the repulsive model is connected to the superconducting (SC) phase in the attractive one, as can be seen by using the SPHT on the ladder operators of the spin</p>
<div class="math notranslate nohighlight">
\[\begin{split}S^+_j = S^x_j + iS^y_j = c_{j \uparrow}^{\dagger}c_{j \downarrow} \xrightarrow{\mathrm{SPHT}} (-1)^j d_{j \uparrow}^{\dagger}d_{j \downarrow}^{\dagger} = \tilde{\Delta}^{\dagger}\,,\\
S^-_j = S^x_j - iS^y_j = c_{j \downarrow}^{\dagger}c_{j \uparrow} \xrightarrow{\mathrm{SPHT}} (-1)^j d_{j \downarrow}d_{j \uparrow} = \tilde{\Delta}\,.\end{split}\]</div>
<p>The <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>-components of the spin operator are transformed to the complex superconducting oder parameter with a phase factor. This means, that if we find a staggered in-plane spin phase in the repulsive model at some <span class="math notranslate nohighlight">\(U\)</span>, we will see a homogeneous superconducting phase at <span class="math notranslate nohighlight">\(-U\)</span>.</p>
<p>The following plot shows this symmetry in a T-U phase diagram, which was previously calculated <a class="reference external" href="https://github.com/TRIQS/tprf/blob/eliashberg/benchmark/eliashberg/particle_hole_transformation/PHT_Hubbard_Model.ipynb">here</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">SVG</span>

<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;./plots/SPHT_hubbard_phase_diagram.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/user_guide_Linearized_Eliashberg_equation_on_the_attractive_Hubbard_model_6_0.svg" src="../_images/user_guide_Linearized_Eliashberg_equation_on_the_attractive_Hubbard_model_6_0.svg" /></div>
</div>
<p>The right hand side of the phase diagram was calculated using an attractive Hubbard model at half-filling, i.e.&nbsp;<span class="math notranslate nohighlight">\(\mu=0.0\)</span>, with an additional Zeeman term of strength <span class="math notranslate nohighlight">\(\xi\)</span>. The phase boundary was then calculated using the random phase approximation (RPA), i.e.&nbsp;using a frequency independent and local vertex <span class="math notranslate nohighlight">\(U\)</span>, to calculate <span class="math notranslate nohighlight">\(\langle S^xS^x \rangle\)</span> and increasing <span class="math notranslate nohighlight">\(U\)</span> until divergence. For details on how to use TPRF for that see this
<a class="reference internal" href="Square lattice susceptibility.html#Random-phase-approximation-(RPA)"><span class="std std-ref">tutorial</span></a>.</p>
<p>The left hand side of the phase diagram was calculated using an repulsive Hubbard model with <span class="math notranslate nohighlight">\(\mu=\xi\)</span>, i.e.&nbsp;the SPHT mapping of the right hand side model. Then the linearized Eliashberg equation was solved for this model for various interaction strengths until the superconducting phase transition was found.</p>
</div>
</div>
<div class="section" id="Solving-the-linearized-Eliashberg-equation">
<h2>Solving the linearized Eliashberg equation<a class="headerlink" href="#Solving-the-linearized-Eliashberg-equation" title="Permalink to this headline">¶</a></h2>
<p>The linearized Eliashberg equation is given in a very simplified form by</p>
<div class="math notranslate nohighlight">
\[\lambda\Delta = \Lambda \Delta\,,\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta\)</span> is a gap function and <span class="math notranslate nohighlight">\(\lambda\)</span> the largest eigenvalue of the matrix <span class="math notranslate nohighlight">\(\Lambda\)</span>. Here <span class="math notranslate nohighlight">\(\Lambda\)</span> is the product of the particle-particle vertex <span class="math notranslate nohighlight">\(\Gamma\)</span> and the Green’s function <span class="math notranslate nohighlight">\(G\)</span>. If <span class="math notranslate nohighlight">\(\lambda=1\)</span> a phase transition to a superconducting state is found. For further information see the documentation <a class="reference internal" href="../theory/eliashberg.html"><span class="doc">here</span></a>.</p>
<p>To solve it in the same order as the RPA we need the non-interacting Green’s function <span class="math notranslate nohighlight">\(G^{(0)}\)</span> and the (singlet) particle-particle vertex <span class="math notranslate nohighlight">\(\Gamma\)</span> is approximated by a fequency independent and local vertex <span class="math notranslate nohighlight">\(2U\)</span>.</p>
<p>First we setup our model by using previously established <code class="docutils literal notranslate"><span class="pre">ParameterCollection</span></code> <code class="docutils literal notranslate"><span class="pre">hubbard</span></code> as a template and alter it to the parameters of the repulsive Hubbard model. To do this use its method <code class="docutils literal notranslate"><span class="pre">alter</span></code> and supply the parameters that shall be changed as keywords. We set the chemical potential to <span class="math notranslate nohighlight">\(\mu=\xi\)</span> and the interaction strength to <span class="math notranslate nohighlight">\(U=-1.41\)</span>, which is close to the superconducting phase boundary for <span class="math notranslate nohighlight">\(T=1000\,\mathrm{K}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">xi</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">repl_hubbard</span> <span class="o">=</span> <span class="n">hubbard</span><span class="o">.</span><span class="n">alter</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">xi</span><span class="p">,</span> <span class="n">U</span><span class="o">=-</span><span class="mf">1.41</span><span class="p">)</span>
<span class="n">repl_hubbard</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>T = 1000
U = -1.41
mu = 0.1
nk = 32
norb = 1
nw = 50
spin = False
t = 1.0
</pre></div>
</div>
</div>
<p>To construct a representation of the kinetic part of the Hubbard model use the <code class="docutils literal notranslate"><span class="pre">create_square_lattice</span></code> function of the <code class="docutils literal notranslate"><span class="pre">triqs_tprf.tight_binding</span></code> module. Give it as keywords the number of orbitals <code class="docutils literal notranslate"><span class="pre">norb</span></code> and the hopping energy <code class="docutils literal notranslate"><span class="pre">t</span></code>, which can comfortably be accessed from <code class="docutils literal notranslate"><span class="pre">repl_hubbard</span></code>. It returns a <code class="docutils literal notranslate"><span class="pre">TBLattice</span></code> object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">triqs_tprf.tight_binding</span> <span class="kn">import</span> <span class="n">create_square_lattice</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">create_square_lattice</span><span class="p">(</span><span class="n">norb</span><span class="o">=</span><span class="n">repl_hubbard</span><span class="o">.</span><span class="n">norb</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">repl_hubbard</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>triqs_tprf.tight_binding.TBLattice
</pre></div>
</div>
</div>
<p>To get the dispersion relation, use its member function <code class="docutils literal notranslate"><span class="pre">on_mesh_brillouin_zone</span></code> and enter a mesh on the Brillouin zone as a tuple. It returns the dispersion relation stored as a <code class="docutils literal notranslate"><span class="pre">Gf</span></code> object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">e_k</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">on_mesh_brillouin_zone</span><span class="p">(</span><span class="n">n_k</span><span class="o">=</span><span class="p">(</span><span class="n">repl_hubbard</span><span class="o">.</span><span class="n">nk</span><span class="p">,</span> <span class="n">repl_hubbard</span><span class="o">.</span><span class="n">nk</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">type</span><span class="p">(</span><span class="n">e_k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>triqs.gf.gf.Gf
</pre></div>
</div>
</div>
<p>With the dispersion relation we can construct the non-interacting Green’s function. To do this first create a <code class="docutils literal notranslate"><span class="pre">MeshImFreq</span></code> object with a fermionic statistic and the wished inverse temperature <span class="math notranslate nohighlight">\(\beta\)</span> and number of points. Then use the <code class="docutils literal notranslate"><span class="pre">lattice_dyson_g0_wk</span></code> function of the <code class="docutils literal notranslate"><span class="pre">triqs_tprf.lattice</span></code> module and supply it with the dispersion relation, the <code class="docutils literal notranslate"><span class="pre">MeshImFreq</span></code> object and a chemical potential. This yields the non-interacting Green’s function as a <code class="docutils literal notranslate"><span class="pre">Gf</span></code> object. (You can use the
<code class="docutils literal notranslate"><span class="pre">temperature_to_beta</span></code> function of the <code class="docutils literal notranslate"><span class="pre">triqs_tprf.utilities</span></code> to calculate the inverse temperature in <span class="math notranslate nohighlight">\(\mathrm{eV}\)</span> from the temperature in <span class="math notranslate nohighlight">\(\mathrm{Kelvin}\)</span>.)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">triqs_tprf.lattice</span> <span class="kn">import</span> <span class="n">lattice_dyson_g0_wk</span>
<span class="kn">from</span> <span class="nn">triqs.gf</span> <span class="kn">import</span> <span class="n">MeshImFreq</span>
<span class="kn">from</span> <span class="nn">triqs_tprf.utilities</span> <span class="kn">import</span> <span class="n">temperature_to_beta</span>

<span class="n">beta</span> <span class="o">=</span> <span class="n">temperature_to_beta</span><span class="p">(</span><span class="n">repl_hubbard</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">wmesh</span> <span class="o">=</span> <span class="n">MeshImFreq</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="s1">&#39;Fermion&#39;</span><span class="p">,</span> <span class="n">n_max</span><span class="o">=</span><span class="n">repl_hubbard</span><span class="o">.</span><span class="n">nw</span><span class="p">)</span>
<span class="n">g0_wk</span> <span class="o">=</span> <span class="n">lattice_dyson_g0_wk</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="n">repl_hubbard</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="n">e_k</span><span class="o">=</span><span class="n">e_k</span><span class="p">,</span> <span class="n">mesh</span><span class="o">=</span><span class="n">wmesh</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">g0_wk</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>triqs.gf.gf.Gf
</pre></div>
</div>
</div>
<p>The particle-particle vertex <span class="math notranslate nohighlight">\(\Gamma\)</span> in this case must be manually created. To do this first create a <code class="docutils literal notranslate"><span class="pre">MeshImFreq</span></code> in the same manner as before, but this time with a bosonic statistic. Then use this <code class="docutils literal notranslate"><span class="pre">MeshImFreq</span></code> and combine it with the momentum mesh of the non-interacting Green’s function to create a <code class="docutils literal notranslate"><span class="pre">MeshProduct</span></code> object. Use this <code class="docutils literal notranslate"><span class="pre">MeshProduct</span></code> object to create a <code class="docutils literal notranslate"><span class="pre">Gf</span></code> object with a <code class="docutils literal notranslate"><span class="pre">target_shape</span></code> that corresponds to a two-particle object, e.g.&nbsp;<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1)</span></code>. Then
overwrite its data to be constant to <span class="math notranslate nohighlight">\(U\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">triqs.gf</span> <span class="kn">import</span> <span class="n">Gf</span><span class="p">,</span> <span class="n">MeshProduct</span>

<span class="n">wmesh_boson</span> <span class="o">=</span> <span class="n">MeshImFreq</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="n">temperature_to_beta</span><span class="p">(</span><span class="n">repl_hubbard</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">S</span><span class="o">=</span><span class="s1">&#39;Boson&#39;</span><span class="p">,</span> <span class="n">n_max</span><span class="o">=</span><span class="n">repl_hubbard</span><span class="o">.</span><span class="n">nw</span><span class="p">)</span>
<span class="n">wmesh_boson_kmesh</span> <span class="o">=</span> <span class="n">MeshProduct</span><span class="p">(</span><span class="n">wmesh_boson</span><span class="p">,</span> <span class="n">g0_wk</span><span class="o">.</span><span class="n">mesh</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">gamma_pp</span> <span class="o">=</span> <span class="n">Gf</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">wmesh_boson_kmesh</span><span class="p">,</span> <span class="n">target_shape</span><span class="o">=</span><span class="n">g0_wk</span><span class="o">.</span><span class="n">target_shape</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gamma_pp</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">repl_hubbard</span><span class="o">.</span><span class="n">U</span>
</pre></div>
</div>
</div>
<p>With this we have all ingredients for the linearized Eliashberg equation. To solve it use the <code class="docutils literal notranslate"><span class="pre">solve_eliashberg</span></code> function of the <code class="docutils literal notranslate"><span class="pre">triqs_tprf.eliashberg</span></code> module and supply it with the particle-particle vertex and the non-interacting Green’s function. It returns the eigenvalues and eigenvectors, i.e.&nbsp;the gap functions.</p>
<p>The returned maximum eigenvalue is <span class="math notranslate nohighlight">\(\lambda \approx 1\)</span> as expected, because we are close to the phase boundary.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">triqs_tprf.eliashberg</span> <span class="kn">import</span> <span class="n">solve_eliashberg</span>

<span class="n">Es</span><span class="p">,</span> <span class="n">eigen_modes</span> <span class="o">=</span> <span class="n">solve_eliashberg</span><span class="p">(</span><span class="n">gamma_pp</span><span class="p">,</span> <span class="n">g0_wk</span><span class="p">)</span>
<span class="n">Es</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>0.9999705817306739
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="Solving the linearized Eliashberg equation in the random phase approximation limit.html" title="Solving the linearized Eliashberg equation in the random phase approximation limit"
             >next</a> |</li>
        <li class="right" >
          <a href="dmft_susceptibility/dmft_susceptibility.html" title="DMFT lattice susceptibility"
             >previous</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../documentation.html" >Documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, H. U.R. Strand.
    </div>
  </body>
</html>