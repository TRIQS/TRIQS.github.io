
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>(Anti-)Periodicity &#8212; TPRF - Two-Particle Response Function tool box for TRIQS  documentation</title>
    <link rel="stylesheet" href="../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" type="text/javascript" src="https://raw.githubusercontent.com/mathjax/MathJax/2.7.8/MathJax.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linear response from generalized susceptibility" href="linear_response.html" />
    <link rel="prev" title="Derivation: Product relations" href="derivation_index_pairing.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head><body>
<div class="pageheader">
  <ul>
    
    <li><a href="../install.html">Install</a></li>
    
    <li><a href="../documentation.html">Documentation</a></li>
    
    <li><a href="../issues.html">Issues</a></li>
    
    <li><a href="../about.html">About tprf</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../index.html">triqs_tprf</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">An example application using cpp2py and <a class="triqs" style="font-size: 12px" href="https://triqs.github.io">TRIQS</a></span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="linear_response.html" title="Linear response from generalized susceptibility"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="derivation_index_pairing.html" title="Derivation: Product relations"
             accesskey="P">previous</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../documentation.html" accesskey="U">Documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">(Anti-)Periodicity</a><ul>
<li><a class="reference internal" href="#two-particle-green-s-functions">Two-particle Green’s functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#kubo-martin-schwinger-kms-boundary-conditions">Kubo-Martin-Schwinger (KMS) boundary conditions</a></li>
<li><a class="reference internal" href="#generalized-kubo-martin-schwinger-kms-boundary-conditions">Generalized Kubo-Martin-Schwinger (KMS) boundary conditions</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="derivation_index_pairing.html"
                        title="previous chapter">Derivation: Product relations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="linear_response.html"
                        title="next chapter">Linear response from generalized susceptibility</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/theory/boundary_conditions.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="anti-periodicity">
<span id="boundary-conditions"></span><h1>(Anti-)Periodicity<a class="headerlink" href="#anti-periodicity" title="Permalink to this headline">¶</a></h1>
<p>Note that the Heisenberg representation the imaginary time dependence of creation and annihilation operators are not conjugated, i.e. <span class="math notranslate nohighlight">\(c(\tau) \equiv e^{\tau H} c e^{-\tau H}\)</span> and <span class="math notranslate nohighlight">\(c^\dagger(\tau) \equiv e^{\tau H} c^\dagger e^{-\tau H}\)</span></p>
<div class="math notranslate nohighlight">
\[G_{a\bar{b}}(\tau)
\equiv
- \langle \mathcal{T} a(\tau) \bar{b}(0) \rangle
\equiv
- \frac{1}{\mathcal{Z}} \textrm{Tr} \big[
\mathcal{T} e^{-\int_0^\beta d\bar{\tau} \, H(\bar{\tau})} a(\tau) \bar{b}
\big]\]</div>
<p>To derive the boundary conditions we consider two cases. First, for <span class="math notranslate nohighlight">\(\beta &gt; \tau &gt; 0\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}G_{a\bar{b}}(\tau) \Big|_{\beta &gt; \tau &gt; 0}
=
- \langle a(\tau) \bar{b}(0) \rangle
=
- \frac{1}{\mathcal{Z}}
\textrm{Tr} \big[
e^{-\beta H}
e^{\tau H} a e^{-\tau H}
\bar{b}
\big]
\\ =
- \frac{1}{\mathcal{Z}}
\textrm{Tr} \big[
e^{-\beta H}
\bar{b}(0)
e^{(\tau - \beta) H} a e^{-(\tau - \beta) H}
\big]
=
- \langle \bar{b}(0) a(\tau - \beta) \rangle
\\ =
- \xi \langle \mathcal{T} a(\tau - \beta) \bar{b}(0) \rangle
  \Big|_{\beta &gt; \tau &gt; 0}
= \xi G_{a\bar{b}}(\tau - \beta)
  \Big|_{\beta &gt; \tau &gt; 0}\end{split}\]</div>
<p>while for <span class="math notranslate nohighlight">\(0 &gt; \tau &gt; - \beta\)</span> one get</p>
<div class="math notranslate nohighlight">
\[\begin{split}G_{a\bar{b}}(\tau) \Big|_{0 &gt; \tau &gt; -\beta}
=
- \xi \langle \bar{b}(0) a(\tau) \rangle
=
- \frac{\xi}{\mathcal{Z}}
\textrm{Tr} \big[
e^{-\beta H}
\bar{b}
e^{\tau H} a e^{-\tau H}
\big]
\\ =
- \frac{\xi}{\mathcal{Z}}
\textrm{Tr} \big[
e^{-\beta H}
e^{(\tau + \beta) H} a e^{-(\tau + \beta) H}
\bar{b}(0)
\big]
=
- \xi \langle a(\tau + \beta) \bar{b}(0) \rangle
\\ =
- \xi \langle \mathcal{T} a(\tau + \beta) \bar{b}(0) \rangle
  \Big|_{0 &gt; \tau &gt; -\beta}
= \xi G_{a\bar{b}}(\tau + \beta)
  \Big|_{0 &gt; \tau &gt; -\beta}\end{split}\]</div>
<p>Thus we see that the single-particle Green’s function <span class="math notranslate nohighlight">\(G_{a\bar{b}}(\tau)\)</span> is <span class="math notranslate nohighlight">\(\beta\)</span> (anti-)periodic on <span class="math notranslate nohighlight">\(\tau \in [\beta, -\beta]\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}G_{a\bar{b}}(\tau) \Big|_{\beta &gt; \tau &gt; 0}
= \xi G_{a\bar{b}}(\tau - \beta)
  \Big|_{\beta &gt; \tau &gt; 0}
\\
G_{a\bar{b}}(\tau) \Big|_{0 &gt; \tau &gt; -\beta}
= \xi G_{a\bar{b}}(\tau + \beta)
  \Big|_{0 &gt; \tau &gt; -\beta}\end{split}\]</div>
<div class="section" id="two-particle-green-s-functions">
<h2>Two-particle Green’s functions<a class="headerlink" href="#two-particle-green-s-functions" title="Permalink to this headline">¶</a></h2>
<p>The (anti-)periodicity properties can be generalized to two-particle Green’s functions in imaginary time. Consider now <span class="math notranslate nohighlight">\(G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}},\tau_b, \tau_{\bar{c}}, \tau_d=0)\)</span>, the cyclic property of the trace and the time-ordering operator (assuming that all operators are either fermionic or bosonic) then yield in the same way</p>
<div class="math notranslate nohighlight">
\[G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, \tau_{\bar{c}}, \tau_d=0)
\equiv
\langle \mathcal{T}
\bar{a}(\tau_{\bar{a}}) b(\tau_b) \bar{c}(\tau_{\bar{c}}) d(0) \rangle\]</div>
<p>As an example we take the case <span class="math notranslate nohighlight">\(\beta &gt; \tau_{\bar{a}} &gt; \tau_b, \tau_{\bar{c}} &gt; 0\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, \tau_{\bar{c}}, \tau_d=0)
\equiv
\langle
\bar{a}(\tau_{\bar{a}})
\big[ \mathcal{T} b(\tau_b) \bar{c}(\tau_{\bar{c}}) \big]
d(0)
\rangle
\\ =
\langle
\big[ \mathcal{T} b(\tau_b) \bar{c}(\tau_{\bar{c}}) \big]
d(0)
\bar{a}(\tau_{\bar{a}} - \beta)
\rangle
=
\xi \langle
\mathcal{T}
\bar{a}(\tau_{\bar{a}} - \beta)
b(\tau_b) \bar{c}(\tau_{\bar{c}})
d(0)
\rangle
\\ =
\xi G^{(2)}_{\bar{a}b\bar{c}d}( \tau_{\bar{a}} - \beta, \tau_b, \tau_{\bar{c}}, 0)\end{split}\]</div>
<p>In the same way the three periodicity relations read</p>
<div class="math notranslate nohighlight">
\[\begin{split}G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, \tau_{\bar{c}})
\Big|_{\beta &gt; \tau_{\bar{a}} &gt; \tau_b, \tau_{\bar{c}} &gt; 0}
=
\xi G^{(2)}_{\bar{a}b\bar{c}d}( \tau_{\bar{a}} - \beta, \tau_b, \tau_{\bar{c}}, 0)
\\
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, \tau_{\bar{c}})
\Big|_{\beta &gt; \tau_{b} &gt; \tau_{\bar{a}}, \tau_{\bar{c}} &gt; 0}
=
\xi G^{(2)}_{\bar{a}b\bar{c}d}( \tau_{\bar{a}}, \tau_b - \beta, \tau_{\bar{c}}, 0)
\\
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, \tau_{\bar{c}})
\Big|_{\beta &gt; \tau_{\bar{c}} &gt; \tau_{\bar{a}}, \tau_{b} &gt; 0}
=
\xi G^{(2)}_{\bar{a}b\bar{c}d}( \tau_{\bar{a}}, \tau_b, \tau_{\bar{c}} - \beta, 0)\end{split}\]</div>
<p>and the second triple of relations become</p>
<div class="math notranslate nohighlight">
\[\begin{split}G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, \tau_{\bar{c}})
\Big|_{\beta &gt; \tau_b, \tau_{\bar{c}} &gt; 0 &gt; \tau_{\bar{a}} &gt; -\beta}
=
\xi G^{(2)}_{\bar{a}b\bar{c}d}( \tau_{\bar{a}} + \beta, \tau_b, \tau_{\bar{c}}, 0)
\\
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, \tau_{\bar{c}})
\Big|_{\beta &gt; \tau_{\bar{a}}, \tau_{\bar{c}} &gt; 0 &gt; \tau_{b} &gt; -\beta}
=
\xi G^{(2)}_{\bar{a}b\bar{c}d}( \tau_{\bar{a}}, \tau_b + \beta, \tau_{\bar{c}}, 0)
\\
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, \tau_{\bar{c}})
\Big|_{\beta &gt; \tau_{\bar{a}}, \tau_{b} &gt; 0 &gt; \tau_{\bar{c}} &gt; -\beta}
=
\xi G^{(2)}_{\bar{a}b\bar{c}d}( \tau_{\bar{a}}, \tau_b, \tau_{\bar{c}} + \beta, 0)\end{split}\]</div>
</div>
</div>
<div class="section" id="kubo-martin-schwinger-kms-boundary-conditions">
<h1>Kubo-Martin-Schwinger (KMS) boundary conditions<a class="headerlink" href="#kubo-martin-schwinger-kms-boundary-conditions" title="Permalink to this headline">¶</a></h1>
<p>The boundary conditions in imaginary time for the Green’s functions are generated by  the commutation relation <span class="math notranslate nohighlight">\([a, \bar{b}]_{-\xi} = a\bar{b} - \xi \bar{b}a = \delta_{ab}\)</span>, where <span class="math notranslate nohighlight">\(\xi = \pm 1\)</span> for bosons and fermions respectively</p>
<div class="math notranslate nohighlight">
\[\begin{split}G_{a\bar{b}}(0^+) = -\langle \mathcal{T} a(0^+) \bar{b}(0) \rangle
= -\langle a \bar{b} \rangle
\\
G_{a\bar{b}}(0^-) = -\langle \mathcal{T} a(0^-) \bar{b}(0) \rangle
= - \xi \langle \bar{b} a \rangle\end{split}\]</div>
<p>So that the boundary condition at <span class="math notranslate nohighlight">\(\tau = 0^\pm\)</span> is</p>
<div class="math notranslate nohighlight">
\[G_{a\bar{b}}(0^+) - G_{a\bar{b}}(0^-)
= -\langle a \bar{b} - \xi \bar{b} a \rangle
= -\langle [a, \bar{b}]_{-\xi} \rangle
= -\delta_{ab}\]</div>
<p>Using the periodicity relation <span class="math notranslate nohighlight">\(G_{a\bar{b}}(0^-) = \xi G_{a\bar{b}}(\beta^-)\)</span> we finally arrive at the boundary condition restricted to <span class="math notranslate nohighlight">\(\beta &gt; \tau &gt; 0\)</span></p>
<div class="math notranslate nohighlight">
\[G_{a\bar{b}}(0^+) - \xi G_{a\bar{b}}(\beta^-) = - \delta_{ab}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The anomalous Green’s functions has the simpler boundary condition</p>
<div class="math notranslate nohighlight">
\[\begin{split}G_{ab}(0^+) - \xi G_{ab}(\beta^-) = 0
\\
G_{\bar{a}\bar{b}}(0^+) - \xi G_{\bar{a}\bar{b}}(\beta^-) = 0\end{split}\]</div>
<p class="last">since <span class="math notranslate nohighlight">\([a, b]_{-\xi} = 0\)</span> and <span class="math notranslate nohighlight">\([\bar{a}, \bar{b}]_{-\xi} = 0\)</span>.</p>
</div>
</div>
<div class="section" id="generalized-kubo-martin-schwinger-kms-boundary-conditions">
<h1>Generalized Kubo-Martin-Schwinger (KMS) boundary conditions<a class="headerlink" href="#generalized-kubo-martin-schwinger-kms-boundary-conditions" title="Permalink to this headline">¶</a></h1>
<p>For the two-particle Green’s function the KMS boundary conditions generalize to relations incorporating the single particle Green’s function.</p>
<div class="math notranslate nohighlight">
\[\begin{split}G^{(2)}_{\bar{a}b\bar{c}d}(0^+,\tau_b, \tau_{\bar{c}})
- \xi
G^{(2)}_{\bar{a}b\bar{c}d}(\beta^-,\tau_b, \tau_{\bar{c}})
= \xi \delta_{ad} G_{b\bar{c}}(\tau_b - \tau_{\bar{c}})
\\
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, 0^+)
- \xi
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau_b, \beta^-)
= \delta_{cd} G_{b\bar{a}}(\tau_b - \tau_{\bar{a}})
\\
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, 0^+, \tau_{\bar{c}})
- \xi
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \beta^-, \tau_{\bar{c}})
= 0\end{split}\]</div>
<p>Thus the discontinuities at <span class="math notranslate nohighlight">\(\tau_{\bar{a}}=0\)</span> and <span class="math notranslate nohighlight">\(\tau_{\bar{c}}=0\)</span> are non-trivial and given by the single-particle Green’s function.</p>
<p>The two additional discontinuities in <span class="math notranslate nohighlight">\(\tau_{\bar{a}}, \tau_b, \tau_{\bar{c}} \in [\beta, 0]\)</span> are the three equal time planes <span class="math notranslate nohighlight">\(\tau_{\bar{a}} = \tau_b\)</span>, <span class="math notranslate nohighlight">\(\tau_b = \tau_{\bar{c}}\)</span>, and <span class="math notranslate nohighlight">\(\tau_{\bar{a}} = \tau_{\bar{c}}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}G^{(2)}_{\bar{a}b\bar{c}d}(\tau^+, \tau^-, \tau_{\bar{c}})
-
G^{(2)}_{\bar{a}b\bar{c}d}(\tau^-, \tau^+, \tau_{\bar{c}})
= -\delta_{bc} G_{d\bar{a}}(\beta - \tau_{\bar{a}})
\\
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau^+, \tau^-)
-
G^{(2)}_{\bar{a}b\bar{c}d}(\tau_{\bar{a}}, \tau^-, \tau^+)
= - \delta_{bc} G_{d\bar{a}}( \beta - \tau_{\bar{a}} )
\\
G^{(2)}_{\bar{a}b\bar{c}d}(\tau^+, \tau_b, \tau^-)
-
G^{(2)}_{\bar{a}b\bar{c}d}(\tau^-, \tau_b, \tau^+)
= 0\end{split}\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Write test on <cite>pyed</cite> output to explicitly check the boundary conditions.</p>
<p class="last">Figure out how to enforce boundary conditions on stochastically sampled data.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="linear_response.html" title="Linear response from generalized susceptibility"
             >next</a> |</li>
        <li class="right" >
          <a href="derivation_index_pairing.html" title="Derivation: Product relations"
             >previous</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../documentation.html" >Documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, H. U.R. Strand.
    </div>
  </body>
</html>