<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Continuation of matrix-valued functions &mdash; triqs_maxent  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f7f783a0" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../_static/triqs_favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Real-material application: SrVO3" href="srvo3.html" />
    <link rel="prev" title="Continuation of metallic solutions using preblur" href="preblur.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            triqs_maxent
          </a>
              <div class="version">
                3.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install triqs_maxent</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#packaged-versions-of-triqs-maxent">Packaged Versions of TRIQS/maxent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#ubuntu-debian-packages">Ubuntu Debian packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#docker">Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-triqs-maxent-from-source">Compiling triqs_maxent from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#basic-notions">Basic notions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/mathematics.html">Mathematical and Physical Background</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/mathematics.html#mathematical-formulation-of-the-problem">Mathematical Formulation of the Problem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/mathematics.html#entropy-regularization">Entropy Regularization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/mathematics.html#off-diagonal-elements">Off-diagonal elements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/maxentflavors.html">Ways of choosing <span class="math notranslate nohighlight">\(\alpha\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/concepts.html">Conceptual ideas of this package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/concepts.html#flexible-implementation">Flexible implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/concepts.html#different-ways-of-choosing-alpha">Different ways of choosing alpha</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/concepts.html#continuation-of-off-diagonal-elements">Continuation of off-diagonal elements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/concepts.html#quality-control">Quality control</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/shoulders_giants.html">Standing on the shoulders of giants</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../documentation.html#user-guide">User guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tau_maxent.html">Continuation of a 1x1 Green Function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tau_maxent.html#creation-of-a-mock-g-tau">Creation of a mock <span class="math notranslate nohighlight">\(G(\tau)\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="tau_maxent.html#setting-up-and-running-taumaxent">Setting up and running TauMaxEnt</a></li>
<li class="toctree-l4"><a class="reference internal" href="tau_maxent.html#changing-some-of-the-parameters">Changing some of the parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="tau_maxent.html#choosing-the-value-of-the-hyper-parameter">Choosing the value of the hyper-parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="tau_maxent.html#visualizing-and-checking-the-results">Visualizing and checking the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="tau_maxent.html#metallic-model">Metallic Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="visualization.html">Visualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="visualization.html#jupyter-widget">Jupyter Widget</a></li>
<li class="toctree-l4"><a class="reference internal" href="visualization.html#maxentresultdata-gui">MaxEntResultData GUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="visualization.html#plot-methods">plot_* methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="visualization.html#plot-data-by-hand">Plot data by hand</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="preblur.html">Continuation of metallic solutions using preblur</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Continuation of matrix-valued functions </a></li>
<li class="toctree-l3"><a class="reference internal" href="srvo3.html">Real-material application: SrVO<sub>3</sub></a><ul>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#running-taumaxent">Running TauMaxEnt</a></li>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#analyzing-the-result">Analyzing the result</a></li>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#visualization-in-notebook">Visualization in notebook</a></li>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#saving-the-data-to-a-h5-file">Saving the data to a h5-file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="blockgf.html">Continuation of a TRIQS BlockGf</a></li>
<li class="toctree-l3"><a class="reference internal" href="sigma_continuator.html">Continuation of self-energies: Sr<sub>2</sub>RuO<sub>4</sub></a></li>
<li class="toctree-l3"><a class="reference internal" href="program_overview.html">In-depth discussion of the program structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="program_overview.html#structure-of-the-code">Structure of the code</a></li>
<li class="toctree-l4"><a class="reference internal" href="program_overview.html#the-concept-of-caching-the-evaluation">The concept of caching the evaluation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="customization.html">Custom functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#reference-manual">Reference manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../reference/elementwise_maxent.html">ElementwiseMaxEnt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/tau_maxent.html">TauMaxEnt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/maxent_loop.html">MaxEntLoop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cost_functions.html">Cost Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cost_functions.html#maxent-cost-function">MaxEnt cost function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/cost_functions.html#bryan-cost-function">Bryan Cost Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/minimizers/convergence_methods.html">Convergence Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/minimizers/levenberg_minimizer.html">LevenbergMinimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/minimizers/minimizer.html">Minimizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/analyzers/analyzer.html">Analyzer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/analyzers/analyzers.html">Analyzers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/probabilities.html">Probabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/logtaker.html">Logtaker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/functions.html">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/kernels.html">Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/default_models.html">Default Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/default_models.html#triqs_maxent.default_models.BaseDefaultModel"><code class="docutils literal notranslate"><span class="pre">BaseDefaultModel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/default_models.html#triqs_maxent.default_models.FlatDefaultModel"><code class="docutils literal notranslate"><span class="pre">FlatDefaultModel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/default_models.html#triqs_maxent.default_models.DataDefaultModel"><code class="docutils literal notranslate"><span class="pre">DataDefaultModel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/default_models.html#triqs_maxent.default_models.FileDefaultModel"><code class="docutils literal notranslate"><span class="pre">FileDefaultModel</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/omega_meshes.html">Omega Meshes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/alpha_meshes.html">Alpha Meshes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../reference/alpha_meshes.html#triqs_maxent.alpha_meshes.BaseAlphaMesh"><code class="docutils literal notranslate"><span class="pre">BaseAlphaMesh</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/alpha_meshes.html#triqs_maxent.alpha_meshes.DataAlphaMesh"><code class="docutils literal notranslate"><span class="pre">DataAlphaMesh</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/alpha_meshes.html#triqs_maxent.alpha_meshes.LogAlphaMesh"><code class="docutils literal notranslate"><span class="pre">LogAlphaMesh</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../reference/alpha_meshes.html#triqs_maxent.alpha_meshes.LinearAlphaMesh"><code class="docutils literal notranslate"><span class="pre">LinearAlphaMesh</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../reference/maxent_result.html">MaxEntResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/sigma_continuator.html">SigmaContinuator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/maxent_util.html">Maxent Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/preblur.html">Preblur</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reference/plot_utils.html">Plot utilities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#faqs">FAQs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs/faqs.html">Frequently-Asked Questions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#how-can-i-use-this-package-for-a-matrix-valued-green-function">How can I use this package for a matrix-valued Green function?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#what-kernels-are-available">What kernels are available?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#why-is-there-a-at-the-end-of-the-output-line-for-some-alpha">Why is there a ! at the end of the output line for some alpha?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#how-can-i-reduce-the-size-of-the-singular-space">How can I reduce the size of the singular space?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#warning-widget-javascript-not-detected-when-i-use-jupyerplotmaxent">Warning ‘Widget Javascript not detected’ when I use <code class="docutils literal notranslate"><span class="pre">JupyerPlotMaxEnt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#why-is-my-calculation-slow">Why is my calculation slow?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#how-can-i-save-things-to-file">How can I save things to file?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#which-publications-should-i-cite">Which publications should I cite?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-2-0">Version 3.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-1-2-0">Version 1.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#cmake">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#doc">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#jenkins">jenkins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-1-1-1">Version 1.1.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-1-1-0">Version 1.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-1-0-0">Version 1.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-0-9-1">Version 0.9.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-0-9-0">Version 0.9.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About triqs_maxent</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#authors-quotation">Authors &amp; Quotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">triqs_maxent</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../documentation.html">Documentation</a></li>
      <li class="breadcrumb-item active">Continuation of matrix-valued functions </li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/guide/elementwise.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="continuation-of-matrix-valued-functions">
<span id="elementwise"></span><h1>Continuation of matrix-valued functions <a class="footnote-reference brackets" href="#maxent" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a><a class="headerlink" href="#continuation-of-matrix-valued-functions" title="Link to this heading"></a></h1>
<p>In principle one can perform the analytic continuation separately for each matrix element,
using the conventional entropy for diagonal elements and the modified entropy for the off-diagonals.
We term this way of dealing with matrix-valued Green function <code class="xref py py-class docutils literal notranslate"><span class="pre">ElementwiseMaxEnt</span></code>.</p>
<p>Using, e.g., a flat default model for each element reflects the total absence of previous knowledge
on the problem. However, we know that a necessary condition for the positive semi-definiteness of
the resulting spectral function matrix is</p>
<div class="math notranslate nohighlight">
\[| A_{ll'} | \leq \sqrt{A_{ll} A_{l'l'}}.
\label{eq:condition-posdef}\]</div>
<p>For example, for a problem where all diagonal elements of the spectral function are zero at a
certain frequency <span class="math notranslate nohighlight">\(\omega\)</span>, this condition implies that also all off-diagonal elements have
to be zero at this <span class="math notranslate nohighlight">\(\omega\)</span>. Thus, once the diagonal elements have been analytically continued,
this condition constitutes additional knowledge about the problem which can be incorporated by choosing
a default model for the off-diagonal elements <span class="math notranslate nohighlight">\(D_{ll'}(\omega)\)</span> accordingly,</p>
<div class="math notranslate nohighlight">
\[D_{ll'}(\omega) = \sqrt{A_{ll}(\omega)A_{l'l'}(\omega)}+\epsilon.
\label{eq:poor-man-default}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\epsilon\)</span> is a small number to prevent the default model from becoming zero, so that no
division by zero occurs in the entropy term. We call this approach <code class="xref py py-class docutils literal notranslate"><span class="pre">PoormanMaxEnt</span></code>.</p>
<p>The example below shows the continuation of 2x2 model Green function. The special choice of
the default model does indeed improve the results of the off-diagonal elements.
However, for physical systems, the resulting spectral function matrix has to be positive semi-definite
and Hermitian, which is usually not the case when the analytic continuation is carried out separately
for each matrix element. Using the Poorman scheme usually improves the solution, but the only way
to ensure that the obtained spectral function is indeed positive semi-definite and Hermitian is by
treating the spectral function matrix as a whole. We plan to make the <strong>FullMatrixMaxEnt</strong>
public in the future.</p>
<p class="rubric">Example</p>
<p>An example for a 2x2 matrix:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">triqs_maxent</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="c1"># Generate a 2x2 model Green function</span>
<span class="linenos"> 5</span><span class="c1">#####################################</span>
<span class="linenos"> 6</span><span class="c1"># TRIQS Green functions</span>
<span class="linenos"> 7</span><span class="n">G_iw</span> <span class="o">=</span> <span class="n">GfImFreq</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="linenos"> 8</span><span class="n">G_w</span> <span class="o">=</span> <span class="n">GfReFreq</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">n_points</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="c1"># Initialize Green functions with a set of rectangles</span>
<span class="linenos">11</span><span class="n">G_iw</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">Flat</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span> <span class="o">-</span> <span class="n">Flat</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.0</span>
<span class="linenos">12</span><span class="n">G_iw</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">Flat</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Flat</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6.0</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span>
<span class="linenos">13</span>               <span class="p">(</span><span class="n">Flat</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">Flat</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">/</span> <span class="mf">8.0</span><span class="p">))</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.0</span>
<span class="linenos">14</span><span class="n">G_w</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">Flat</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span> <span class="o">-</span> <span class="n">Flat</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.0</span>
<span class="linenos">15</span><span class="n">G_w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">Flat</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span> <span class="o">-</span> <span class="n">Flat</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">6.0</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">+</span>
<span class="linenos">16</span>              <span class="p">(</span><span class="n">Flat</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">Flat</span><span class="p">(</span><span class="mf">0.8</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">10.0</span> <span class="o">/</span> <span class="mf">8.0</span><span class="p">))</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">4.0</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1"># Rotation to generate off-diagonals</span>
<span class="linenos">19</span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">7</span>
<span class="linenos">20</span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]])</span>
<span class="linenos">21</span><span class="n">G_iw_rot</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">G_iw</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">G_iw_rot</span><span class="o">.</span><span class="n">from_L_G_R</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">G_iw</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="linenos">23</span><span class="n">G_w_rot</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">G_w</span><span class="p">)</span>
<span class="linenos">24</span><span class="n">G_w_rot</span><span class="o">.</span><span class="n">from_L_G_R</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="n">G_w</span><span class="p">,</span> <span class="n">R</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="linenos">25</span>
<span class="linenos">26</span><span class="c1"># Calculate G(tau) and add some noise</span>
<span class="linenos">27</span><span class="n">G_tau_rot</span> <span class="o">=</span> <span class="n">GfImTime</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="n">G_iw_rot</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">G_iw_rot</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span>
<span class="linenos">28</span><span class="n">G_tau_rot</span><span class="o">.</span><span class="n">set_from_fourier</span><span class="p">(</span><span class="n">G_iw_rot</span><span class="p">)</span>
<span class="linenos">29</span><span class="n">G_tau_rot</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">G_tau_rot</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">real</span> <span class="o">+</span> <span class="mf">1.e-4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
<span class="linenos">30</span>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">G_tau_rot</span><span class="o">.</span><span class="n">data</span><span class="p">)),</span>
<span class="linenos">31</span>    <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">G_tau_rot</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="c1"># Run Elementwise and Poorman MaxEnt</span>
<span class="linenos">34</span><span class="c1">####################################</span>
<span class="linenos">35</span>
<span class="linenos">36</span><span class="c1"># Elementwise (all elements individually)</span>
<span class="linenos">37</span><span class="n">ew</span> <span class="o">=</span> <span class="n">ElementwiseMaxEnt</span><span class="p">(</span><span class="n">use_hermiticity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">38</span><span class="n">ew</span><span class="o">.</span><span class="n">set_G_tau</span><span class="p">(</span><span class="n">G_tau_rot</span><span class="p">,</span> <span class="n">tau_new</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">G_iw_rot</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="linenos">39</span><span class="n">ew</span><span class="o">.</span><span class="n">set_error</span><span class="p">(</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="linenos">40</span><span class="n">result_ew</span> <span class="o">=</span> <span class="n">ew</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="linenos">41</span>
<span class="linenos">42</span><span class="c1"># Poorman (construct default model for off-diagonals from diagonal solution)</span>
<span class="linenos">43</span><span class="n">pm</span> <span class="o">=</span> <span class="n">PoormanMaxEnt</span><span class="p">(</span><span class="n">use_hermiticity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">44</span><span class="n">pm</span><span class="o">.</span><span class="n">set_G_tau</span><span class="p">(</span><span class="n">G_tau_rot</span><span class="p">,</span> <span class="n">tau_new</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">G_iw_rot</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="linenos">45</span><span class="n">pm</span><span class="o">.</span><span class="n">set_error</span><span class="p">(</span><span class="mf">1.e-4</span><span class="p">)</span>
<span class="linenos">46</span><span class="n">result_pm</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="linenos">47</span>
<span class="linenos">48</span>
<span class="linenos">49</span><span class="c1"># Plot resulting spectra</span>
<span class="linenos">50</span><span class="c1">########################</span>
<span class="linenos">51</span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="linenos">52</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="linenos">53</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
<span class="linenos">54</span><span class="kn">from</span> <span class="nn">triqs.plot.mpl_interface</span> <span class="kn">import</span> <span class="n">oplot</span>
<span class="linenos">55</span>
<span class="linenos">56</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="linenos">57</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">G_iw_rot</span><span class="o">.</span><span class="n">N1</span><span class="p">):</span>
<span class="linenos">58</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">G_iw_rot</span><span class="o">.</span><span class="n">N2</span><span class="p">):</span>
<span class="linenos">59</span>        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos">60</span>        <span class="n">oplot</span><span class="p">(</span><span class="n">G_w_rot</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Model&#39;</span><span class="p">)</span>
<span class="linenos">61</span>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result_ew</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span>
<span class="linenos">62</span>                 <span class="n">result_ew</span><span class="o">.</span><span class="n">get_A_out</span><span class="p">(</span><span class="s1">&#39;LineFitAnalyzer&#39;</span><span class="p">)[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span>
<span class="linenos">63</span>                 <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Elementwise&#39;</span><span class="p">)</span>
<span class="linenos">64</span>        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result_pm</span><span class="o">.</span><span class="n">omega</span><span class="p">,</span>
<span class="linenos">65</span>                 <span class="n">result_pm</span><span class="o">.</span><span class="n">get_A_out</span><span class="p">(</span><span class="s1">&#39;LineFitAnalyzer&#39;</span><span class="p">)[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span>
<span class="linenos">66</span>                 <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Poorman&#39;</span><span class="p">)</span>
<span class="linenos">67</span>        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="linenos">68</span>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;A$_{</span><span class="si">%s%s</span><span class="s1">}$($\omega$)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
<span class="linenos">69</span>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\omega$ (eV)&#39;</span><span class="p">)</span>
<span class="linenos">70</span>        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="linenos">71</span>        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
<span class="linenos">72</span>
<span class="linenos">73</span><span class="c1"># Interactive Visualization in Jupyter Notebook</span>
<span class="linenos">74</span><span class="c1">###############################################</span>
<span class="linenos">75</span>
<span class="linenos">76</span><span class="kn">from</span> <span class="nn">triqs_maxent.plot.jupyter_plot_maxent</span> <span class="kn">import</span> <span class="n">JupyterPlotMaxEnt</span>
<span class="linenos">77</span><span class="n">JupyterPlotMaxEnt</span><span class="p">(</span><span class="n">result_pm</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/elementwise_A.png" class="align-center" src="../_images/elementwise_A.png" />
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model with very sharp edges is a complicated case for the Maximum Entropy method; it tends to smoothen them out considerably.
However, the obtained curves show roughly the quality of the results that can be obtained with MaxEnt.
After all, the analytic continuation is an ill-posed problem. For a given <span class="math notranslate nohighlight">\(G(\tau)\)</span> (with noise) one can find
infinitely many <span class="math notranslate nohighlight">\(A(\omega)\)</span> to satisfy the data within the given error bars.
The comparision of the original (sharp) spectral function to the MaxEnt <span class="math notranslate nohighlight">\(A(\omega)\)</span> demonstrates the accuracy
of analytic continuations:
The overall structure and features are reproduced, but details are smeard out (especially at higher frequencies).
In any case, one <strong>cannot</strong> expect that <span class="math notranslate nohighlight">\(A_i(\omega)\to G(\tau) \to A_c(\omega\)</span>) results in
<span class="math notranslate nohighlight">\(A_i(\omega) = A_c(\omega)\)</span>.</p>
</div>
<p class="rubric">Footnotes</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="maxent" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://link.aps.org/doi/10.1103/PhysRevB.96.155128" rel="noopener noreferrer" target="_blank">G. J. Kraberger, R. Triebl, M. Zingl and M. Aichhorn, Phys. Rev. B 96, 155128 (2017)</a></p>
</aside>
</aside>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="preblur.html" class="btn btn-neutral float-left" title="Continuation of metallic solutions using preblur" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="srvo3.html" class="btn btn-neutral float-right" title="Real-material application: SrVO3" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2021 The Simons Foundation, 2018 G. J. Kraberger, authors: G. J. Kraberger and M. Zingl.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>