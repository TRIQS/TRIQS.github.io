<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TRIQS/triqs_modest: Emebdding operations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TRIQS/triqs_modest<span id="projectnumber">&#160;3.3.0</span>
   </div>
   <div id="projectbrief">Brillouin zone summation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__embedding__ops.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Emebdding operations<div class="ingroups"><a class="el" href="group__embedding.html">Embedding</a></div></div></div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The embedding operations are your interface to adapt and modify any embedding at will. Each operation returns a new Embedding, so you can string ops together or apply them iteratively. The embedding object is interactive, so we encourage "playing" with the ops to modify it's structure until your happy with the embedding description. </p>
<p>The embedding mapping must be flexible and modifable to be able to describe arbitrary DMFT problems. To this end, we provide several operations (ops) that allow you to describe your embedding scenario with a powerful and intuitive syntax. All of these ops change the underlying table inside of embedding: $$ \psi(\alpha, \sigma) \rightarrow (n_{\mathrm{imp}}, \gamma, \tau). $$</p>
<p>Each op will return a new embedding class with an updated embedding table. </p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9cce2637a5574fe9f9e9c7fef1ca50e2" id="r_ga9cce2637a5574fe9f9e9c7fef1ca50e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__embedding__ops.html#ga9cce2637a5574fe9f9e9c7fef1ca50e2">triqs::modest::embedding::drop</a> (long imp_idx) const</td></tr>
<tr class="memdesc:ga9cce2637a5574fe9f9e9c7fef1ca50e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove an impurity from the embedding table ψ  <br /></td></tr>
<tr class="separator:ga9cce2637a5574fe9f9e9c7fef1ca50e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ff3530d785249775af0d8adf2160413" id="r_ga3ff3530d785249775af0d8adf2160413"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__embedding__ops.html#ga3ff3530d785249775af0d8adf2160413">triqs::modest::embedding::flip_spin</a> (long alpha) const</td></tr>
<tr class="memdesc:ga3ff3530d785249775af0d8adf2160413"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flip the spins (σ) for block α. <br  />
  <br /></td></tr>
<tr class="separator:ga3ff3530d785249775af0d8adf2160413"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga29a2615c9580327b273f042ce064687a" id="r_ga29a2615c9580327b273f042ce064687a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__embedding__ops.html#ga29a2615c9580327b273f042ce064687a">triqs::modest::embedding::flip_spin</a> (std::vector&lt; long &gt; alphas) const</td></tr>
<tr class="memdesc:ga29a2615c9580327b273f042ce064687a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flip the spins (σ) for all [α].  <br /></td></tr>
<tr class="separator:ga29a2615c9580327b273f042ce064687a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac873a8e039221a7b5300229e33eef0e3" id="r_gac873a8e039221a7b5300229e33eef0e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__embedding__ops.html#gac873a8e039221a7b5300229e33eef0e3">triqs::modest::embedding::replace</a> (long imp_idx_to_remove, long imp_idx_to_replace_with) const</td></tr>
<tr class="memdesc:gac873a8e039221a7b5300229e33eef0e3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces one impurity in the embedding table ψ.  <br /></td></tr>
<tr class="separator:gac873a8e039221a7b5300229e33eef0e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9041a8165cc6e7ea64e586a90088d378" id="r_ga9041a8165cc6e7ea64e586a90088d378"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__embedding__ops.html#ga9041a8165cc6e7ea64e586a90088d378">triqs::modest::embedding::split</a> (long imp_idx, std::vector&lt; long &gt; const &amp;block_list) const</td></tr>
<tr class="memdesc:ga9041a8165cc6e7ea64e586a90088d378"><td class="mdescLeft">&#160;</td><td class="mdescRight">Split impurity imp_idx based on block_list.  <br /></td></tr>
<tr class="separator:ga9041a8165cc6e7ea64e586a90088d378"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga9cce2637a5574fe9f9e9c7fef1ca50e2" name="ga9cce2637a5574fe9f9e9c7fef1ca50e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9cce2637a5574fe9f9e9c7fef1ca50e2">&#9670;&#160;</a></span>drop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a> triqs::modest::embedding::drop </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>imp_idx</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="embedding_8hpp.html">triqs_modest/embedding.hpp</a>&gt;</code></p>

<p>Remove an impurity from the embedding table ψ </p>
<p>Remove the impurity imp_idx, maps the corresponding α blocks to -1 (i.e. no longer connected to an impurity) and relabel the other impurities with number &gt; imp_idx.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">imp_idx</td><td>Index of the impurity to remove from the table ψ </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New embedding with the updated ψ map. </dd></dl>

<p class="definition">Definition at line <a class="el" href="embedding_8cpp_source.html#l00168">168</a> of file <a class="el" href="embedding_8cpp_source.html">embedding.cpp</a>.</p>

</div>
</div>
<a id="ga3ff3530d785249775af0d8adf2160413" name="ga3ff3530d785249775af0d8adf2160413"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ff3530d785249775af0d8adf2160413">&#9670;&#160;</a></span>flip_spin() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a> triqs::modest::embedding::flip_spin </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>alpha</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="embedding_8hpp.html">triqs_modest/embedding.hpp</a>&gt;</code></p>

<p>Flip the spins (σ) for block α. <br  />
 </p>
<p>For block α transforms (σ,σ') -&gt; (τ, τ') to (σ, σ') -&gt; (τ', τ).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alpha</td><td>the index of the alpha block to flip the spins. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a new embedding with the updated ψ map. </dd></dl>

<p class="definition">Definition at line <a class="el" href="embedding_8cpp_source.html#l00152">152</a> of file <a class="el" href="embedding_8cpp_source.html">embedding.cpp</a>.</p>

</div>
</div>
<a id="ga29a2615c9580327b273f042ce064687a" name="ga29a2615c9580327b273f042ce064687a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga29a2615c9580327b273f042ce064687a">&#9670;&#160;</a></span>flip_spin() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a> triqs::modest::embedding::flip_spin </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; long &gt;&#160;</td>
          <td class="paramname"><em>alphas</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="embedding_8hpp.html">triqs_modest/embedding.hpp</a>&gt;</code></p>

<p>Flip the spins (σ) for all [α]. </p>
<p>For block α transforms (σ,σ') -&gt; (τ, τ') to (σ, σ') -&gt; (τ', τ).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alphas</td><td>a list of alpha blocks to flip the spins. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New embedding with the updated ψ map. </dd></dl>

<p class="definition">Definition at line <a class="el" href="embedding_8cpp_source.html#l00160">160</a> of file <a class="el" href="embedding_8cpp_source.html">embedding.cpp</a>.</p>

</div>
</div>
<a id="gac873a8e039221a7b5300229e33eef0e3" name="gac873a8e039221a7b5300229e33eef0e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac873a8e039221a7b5300229e33eef0e3">&#9670;&#160;</a></span>replace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a> triqs::modest::embedding::replace </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>imp_idx_to_remove</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>imp_idx_to_replace_with</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="embedding_8hpp.html">triqs_modest/embedding.hpp</a>&gt;</code></p>

<p>Replaces one impurity in the embedding table ψ. </p>
<p>Replaces the impurity solver corresponding to imp_idx_to with the impurity solver at imp_idx_from and updates the underlying table ψ.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">imp_idx_to</td><td>the index of the impurity solver to be replaced. </td></tr>
    <tr><td class="paramname">imp_idx_from</td><td>the index of the impurity solver that will replace imp_idx_to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a new embedding with the updated ψ map. </dd></dl>

<p class="definition">Definition at line <a class="el" href="embedding_8cpp_source.html#l00182">182</a> of file <a class="el" href="embedding_8cpp_source.html">embedding.cpp</a>.</p>

</div>
</div>
<a id="ga9041a8165cc6e7ea64e586a90088d378" name="ga9041a8165cc6e7ea64e586a90088d378"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9041a8165cc6e7ea64e586a90088d378">&#9670;&#160;</a></span>split()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classtriqs_1_1modest_1_1embedding.html">embedding</a> triqs::modest::embedding::split </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>imp_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; long &gt; const &amp;&#160;</td>
          <td class="paramname"><em>block_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>#include &lt;<a class="el" href="embedding_8hpp.html">triqs_modest/embedding.hpp</a>&gt;</code></p>

<p>Split impurity imp_idx based on block_list. </p>
<p>For impurity imp_idx, split part of its blocks into a new impurity. The blocks that were split off remain mapped to their original alpha blocks with the updated imp_idx.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">imp_idx</td><td>Impurity number </td></tr>
    <tr><td class="paramname">block_list</td><td>A list of blocks of imp_idx to split off. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New embedding with the updated ψ map. </dd></dl>

<p class="definition">Definition at line <a class="el" href="embedding_8cpp_source.html#l00231">231</a> of file <a class="el" href="embedding_8cpp_source.html">embedding.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
