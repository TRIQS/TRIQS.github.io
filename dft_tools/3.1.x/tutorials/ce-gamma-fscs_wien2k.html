<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DFT+DMFT tutorial: Ce with Hubbard-I approximation &mdash; TRIQS DFTTools  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f7f783a0" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="VASP setup" href="svo_vasp/svo_notebook.html" />
    <link rel="prev" title="DFT (Wien2k) and Wannier orbitals" href="sr2mgoso6_soc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            TRIQS DFTTools
          </a>
              <div class="version">
                3.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#packaged-versions-of-dfttools">Packaged Versions of DFTTools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#ubuntu-debian-packages">Ubuntu Debian packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#anaconda-experimental">Anaconda (experimental)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#docker">Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-dfttools-from-source">Compiling DFTTools from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#important-note-for-fcsc-dft-dmft-calculations">Important note for FCSC DFT+DMFT calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps-for-the-use-with-wien2k-version-14-2-and-older">Installation steps for the use with WIEN2K version 14.2 and older</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../documentation.html">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#basic-notions">Basic notions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/first.html">What you should know</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/first.html#what-is-dfttools">What is <strong class="program">DFTTools</strong>?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/first.html#understand-the-philosophy-of-dfttools">Understand the philosophy of <strong class="program">DFTTools</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/first.html#learn-how-to-use-triqs-and-the-cthyb-solver">Learn how to use <span class="xref std std-ref">TRIQS</span> (and the <span class="xref std std-ref">CTHYB</span> solver)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/first.html#analytic-continuation">Analytic Continuation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/dft_dmft.html">Introduction to DFT+DMFT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/dft_dmft.html#density-functional-theory-in-a-very-small-nutshell">Density-functional theory in a (very small) nutshell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/dft_dmft.html#from-dft-to-dmft">From DFT to DMFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/dft_dmft.html#using-projective-wannier-functions-for-dmft">Using projective Wannier functions for DMFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/dft_dmft.html#full-charge-self-consistency">Full charge self-consistency</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/structure.html">Structure of <strong class="program">DFTTools</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#the-interface-layer">The interface layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#the-dmft-calculation">The DMFT calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#full-charge-self-consistency">Full charge self consistency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#post-processing">Post-processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#executing-your-python-scripts">Executing your python scripts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#construction-of-local-orbitals-from-dft">Construction of local orbitals from DFT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/conversion.html">Supported interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/conv_wien2k.html">Interface with Wien2k</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/conv_vasp.html">Interface with VASP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/conv_elk.html">Interface with Elk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/conv_W90.html">Interface with Wannier90</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/conv_generalhk.html">A general H(k)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/conversion.html#mpi-issues">MPI issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/conversion.html#interfaces-to-other-packages">Interfaces to other packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../h5structure.html">standardized hdf5 structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../h5structure.html#groups-and-their-formats">groups and their formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../h5structure.html#general-and-simple-h-k-converter">General and simple H(k) Converter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#dft-dmft">DFT+DMFT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/dftdmft_singleshot.html">Single-shot DFT+DMFT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/dftdmft_singleshot.html#initialization-of-the-calculation">Initialization of the calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/dftdmft_singleshot.html#setting-up-the-impurity-solver">Setting up the impurity solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/dftdmft_singleshot.html#doing-the-dmft-loop">Doing the DMFT loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/dftdmft_singleshot.html#restarting-a-calculation">Restarting a calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/dftdmft_singleshot.html#mixing">Mixing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/dftdmft_selfcons.html">Full charge self-consistency</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/dftdmft_selfcons.html#wien2k-dmftproj">Wien2k + dmftproj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/dftdmft_selfcons.html#vasp-plovasp">VASP + PLOVasp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/dftdmft_selfcons.html#elk">Elk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/dftdmft_selfcons.html#other-dft-codes">Other DFT codes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#advanced-topics">Advanced Topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/blockstructure.html">Manipulating the Green’s functions block structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/blockstructure.html#creating-a-block-structure-and-green-s-function">Creating a block structure and Green’s function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/blockstructure.html#the-solver-structure">The <em>solver</em> structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/blockstructure.html#picking-orbitals">Picking orbitals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/blockstructure.html#basis-rotations">Basis rotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/blockstructure.html#diagonal-approximation">Diagonal approximation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/BasisRotation.html">Automatic basis rotations in DFT+DMFT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/BasisRotation.html#setting-up-the-initial-solver-structure-from-dft">Setting up the initial solver structure from DFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/BasisRotation.html#finding-the-transformation-matrix">Finding the transformation matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/BasisRotation.html#automatic-transformation-during-the-dmft-loop">Automatic transformation during the DMFT loop</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/soc.html">Spin-orbit coupled calculations (single-shot)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/soc.html#treatment-of-soc-in-dft">Treatment of SOC in DFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/soc.html#treatment-of-soc-in-wien2k">Treatment of SOC in Wien2k</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/soc.html#treatment-of-soc-in-elk">Treatment of SOC in Elk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/soc.html#after-generating-the-projectors">After generating the projectors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#postprocessing">Postprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/analysis.html">Tools for analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/analysis.html#initialisation">Initialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/analysis.html#density-of-states-of-the-wannier-orbitals">Density of states of the Wannier orbitals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/analysis.html#partial-charges">Partial charges</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/analysis.html#correlated-spectral-function-with-real-frequency-self-energy">Correlated spectral function (with real-frequency self energy)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/analysis.html#momentum-resolved-spectral-function-with-real-frequency-self-energy">Momentum resolved spectral function (with real-frequency self energy)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/transport.html">Transport calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/transport.html#formalism">Formalism</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/transport.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/transport.html#wien2k-optics-package">Wien2k optics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/transport.html#using-the-transport-code">Using the transport code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/transport.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#reference-manual">Reference manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.block_structure.html">block_structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.block_structure.BlockStructure.html">triqs_dft_tools.block_structure.BlockStructure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.html">converters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.converter_tools.html">converter_tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.elk.html">elk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.elktools.html">elktools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.hk.html">hk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.plovasp.html">plovasp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.vasp.html">vasp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.wannier90.html">wannier90</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.wien2k.html">wien2k</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.sumk_dft.html">sumk_dft</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.sumk_dft.SumkDFT.html">triqs_dft_tools.sumk_dft.SumkDFT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.sumk_dft_tools.html">sumk_dft_tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.sumk_dft_tools.SumkDFTTools.html">triqs_dft_tools.sumk_dft_tools.SumkDFTTools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.symmetry.html">symmetry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.symmetry.Symmetry.html">triqs_dft_tools.symmetry.Symmetry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.trans_basis.html">trans_basis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.trans_basis.TransBasis.html">triqs_dft_tools.trans_basis.TransBasis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#faqs">FAQs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs/faqs.html">Frequently-Asked Questions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#wien2k-fermi-error-when-running-x-lapw2-almd-band">wien2k: FERMI ERROR when running <cite>x lapw2 -almd -band</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#how-do-i-plot-the-output-of-spaghettis">How do I plot the output of <cite>spaghettis</cite>?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#x-optic-does-not-write-a-case-pmat-file">x optic does not write a case.pmat file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#how-do-i-get-real-frequency-quantities">How do I get real-frequency quantities?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#a-simple-example-srvo3">A simple example: SrVO3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="srvo3.html">DFT (Wien2k) and Wannier orbitals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#dft-setup">DFT setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#wannier-orbitals">Wannier orbitals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="srvo3.html#the-dmft-calculation">The DMFT calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#loading-modules">Loading modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#initializing-sumkdft">Initializing SumkDFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#initializing-the-solver">Initializing the solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#dmft-cycle">DMFT cycle</a></li>
<li class="toctree-l4"><a class="reference internal" href="srvo3.html#tail-fit-parameters">Tail fit parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#basis-rotations-sr2mgoso6-without-soc">Basis rotations: Sr2MgOsO6 without SOC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sr2mgoso6_nosoc.html">DFT (Wien2k) and Wannier orbitals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_nosoc.html#dft-setup">DFT setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_nosoc.html#wannier-orbitals">Wannier orbitals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sr2mgoso6_nosoc.html#the-dmft-calculation">The DMFT calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_nosoc.html#rotating-the-basis">Rotating the basis</a></li>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_nosoc.html#the-interaction-hamiltonian">The interaction Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_nosoc.html#the-dmft-loop-with-automatic-basis-rotations">The DMFT loop with automatic basis rotations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#sr2mgoso6-with-soc-non-magnetic">Sr2MgOsO6 with SOC (non-magnetic)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sr2mgoso6_soc.html">DFT (Wien2k) and Wannier orbitals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_soc.html#dft-setup">DFT setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_soc.html#wannier-orbitals">Wannier orbitals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sr2mgoso6_soc.html#the-dmft-calculation">The DMFT calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_soc.html#rotating-the-basis">Rotating the basis</a></li>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_soc.html#the-interaction-hamiltonian">The interaction Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="sr2mgoso6_soc.html#the-dmft-loop-with-automatic-basis-rotations">The DMFT loop with automatic basis rotations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#full-charge-self-consistency-with-wien2k-gamma-ce">Full charge self consistency with Wien2k: <span class="math notranslate nohighlight">\(\gamma\)</span>-Ce</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">DFT+DMFT tutorial: Ce with Hubbard-I approximation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wien2k-setup">Wien2k setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wannier-orbitals-dmftproj">Wannier orbitals: dmftproj</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dmft-setup-hubbard-i-calculations-in-triqs">DMFT setup: Hubbard-I calculations in TRIQS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fully-charge-self-consistent-dft-dmft-calculation">Fully charge self-consistent DFT+DMFT calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post-processing-and-data-analysis">Post-processing and data analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#vasp-interface-examples">VASP interface examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#simple-converter-example-srvo3">Simple Converter example: SrVO3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="svo_vasp/svo_notebook.html">VASP setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="svo_vasp/svo_notebook.html#PLOVASP">PLOVASP</a></li>
<li class="toctree-l4"><a class="reference internal" href="svo_vasp/svo_notebook.html#Converting-to-hdf5-file">Converting to hdf5 file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#complex-example-nio">Complex example: NiO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nio_csc.html">DFT and projections</a></li>
<li class="toctree-l4"><a class="reference internal" href="nio_csc.html#dmft">DMFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="nio_csc.html#charge-self-consistent-dmft">Charge self-consistent DMFT</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#elk-interface-examples">Elk interface examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#converter-example-srvo3">Converter example: SrVO3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="svo_elk/srvo3.html">Elk to TRIQS</a></li>
<li class="toctree-l4"><a class="reference internal" href="svo_elk/srvo3.html#the-dmft-calculation">The DMFT calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="svo_elk/srvo3.html#triqs-to-elk-fully-charge-self-consistent-dft-dmft">TRIQS to Elk (Fully Charge Self-Consistent DFT+DMFT)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-1-1">Version 3.1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#general">General</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-1-0">Version 3.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#wannier90-converter">Wannier90 Converter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#change-in-gf-struct">Change in gf_struct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#cmake">Cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#other-changes">Other changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-0-0">Version 3.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#restructuring">Restructuring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#dependency-management">Dependency Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id2">Other Changes:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-2-1">Version 2.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-2-0">Version 2.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-1-x-changes-since-1-4">Version 2.1.x (changes since 1.4)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#authors-quotation">Authors &amp; Quotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TRIQS DFTTools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">DFT+DMFT tutorial: Ce with Hubbard-I approximation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/ce-gamma-fscs_wien2k.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dft-dmft-tutorial-ce-with-hubbard-i-approximation">
<span id="dftdmfttutorial"></span><h1>DFT+DMFT tutorial: Ce with Hubbard-I approximation<a class="headerlink" href="#dft-dmft-tutorial-ce-with-hubbard-i-approximation" title="Link to this heading"></a></h1>
<p>In this tutorial we will perform DFT+DMFT Wien2k
calculations from scratch, including all steps described in the
previous sections. As example, we take the high-temperature
<span class="math notranslate nohighlight">\(\gamma\)</span>-phase of Ce employing the Hubbard-I approximation for
its localized <em>4f</em> shell.</p>
<section id="wien2k-setup">
<h2>Wien2k setup<a class="headerlink" href="#wien2k-setup" title="Link to this heading"></a></h2>
<p>First we create the Wien2k <code class="file docutils literal notranslate"><span class="pre">Ce-gamma.struct</span></code> file as described in the
<a class="reference external" href="http://www.wien2k.at/reg_user/textbooks/usersguide.pdf" rel="noopener noreferrer" target="_blank">Wien2k manual</a>
for the <span class="math notranslate nohighlight">\(\gamma\)</span>-Ce fcc structure with lattice parameter of 9.75 a.u.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Title</span>                                                                          
<span class="n">F</span>   <span class="n">LATTICE</span><span class="p">,</span><span class="n">NONEQUIV</span><span class="o">.</span><span class="n">ATOMS</span><span class="p">:</span>  <span class="mi">1225</span><span class="n">_Fm</span><span class="o">-</span><span class="mi">3</span><span class="n">m</span>                                        
<span class="n">MODE</span> <span class="n">OF</span> <span class="n">CALC</span><span class="o">=</span><span class="n">RELA</span> <span class="n">unit</span><span class="o">=</span><span class="n">bohr</span>                                                    
  <span class="mf">9.750000</span>  <span class="mf">9.750000</span>  <span class="mf">9.750000</span> <span class="mf">90.000000</span> <span class="mf">90.000000</span> <span class="mf">90.000000</span>                   
<span class="n">ATOM</span>   <span class="mi">1</span><span class="p">:</span> <span class="n">X</span><span class="o">=</span><span class="mf">0.00000000</span> <span class="n">Y</span><span class="o">=</span><span class="mf">0.00000000</span> <span class="n">Z</span><span class="o">=</span><span class="mf">0.00000000</span>
          <span class="n">MULT</span><span class="o">=</span> <span class="mi">1</span>          <span class="n">ISPLIT</span><span class="o">=</span> <span class="mi">2</span>
<span class="n">Ce</span>         <span class="n">NPT</span><span class="o">=</span>  <span class="mi">781</span>  <span class="n">R0</span><span class="o">=</span><span class="mf">0.00001000</span> <span class="n">RMT</span><span class="o">=</span>    <span class="mf">2.5000</span>   <span class="n">Z</span><span class="p">:</span> <span class="mf">58.0</span>                   
<span class="n">LOCAL</span> <span class="n">ROT</span> <span class="n">MATRIX</span><span class="p">:</span>    <span class="mf">1.0000000</span> <span class="mf">0.0000000</span> <span class="mf">0.0000000</span>
                     <span class="mf">0.0000000</span> <span class="mf">1.0000000</span> <span class="mf">0.0000000</span>
                     <span class="mf">0.0000000</span> <span class="mf">0.0000000</span> <span class="mf">1.0000000</span>
   <span class="mi">0</span>      <span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">SYMMETRY</span> <span class="n">OPERATIONS</span>
</pre></div>
</div>
<p>We initalize non-magnetic Wien2k calculations using the <strong class="program">init</strong> script as
described in the same manual. For this example we specify 3000 <span class="math notranslate nohighlight">\(\mathbf{k}\)</span>-points
in the full Brillouin zone and LDA exchange-correlation potential (<em>vxc=5</em>), other
parameters are defaults. The Ce <em>4f</em> electrons are treated as valence states.
Hence, the initialization script is executed as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">init</span> <span class="o">-</span><span class="n">b</span> <span class="o">-</span><span class="n">vxc</span> <span class="mi">5</span> <span class="o">-</span><span class="n">numk</span> <span class="mi">3000</span>
</pre></div>
</div>
<p>and then LDA calculations of non-magnetic <span class="math notranslate nohighlight">\(\gamma\)</span>-Ce are performed by launching
the Wien2k <strong class="program">run</strong> script. These self-consistent LDA calculations will typically
take a couple of minutes.</p>
</section>
<section id="wannier-orbitals-dmftproj">
<h2>Wannier orbitals: dmftproj<a class="headerlink" href="#wannier-orbitals-dmftproj" title="Link to this heading"></a></h2>
<p>Then we create the <code class="file docutils literal notranslate"><span class="pre">Ce-gamma.indmftpr</span></code> file specifying parameters for construction
of Wannier orbitals representing <em>4f</em> states:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1                ! Nsort
1                ! Mult(Nsort)
3                ! lmax
complex
1 1 1 2          ! l included for each sort
0 0 0 0          ! l included for each sort
0
-.40 0.40         ! Energy window relative to E_f 
</pre></div>
</div>
<p>As we learned in the section <a class="reference internal" href="../guide/conversion.html#conversion"><span class="std std-ref">Supported interfaces</span></a>, the first three lines
give the number of inequivalent sites, their multiplicity (to be in
accordance with the <em>struct</em> file) and the maximum orbital quantum
number <span class="math notranslate nohighlight">\(l_{max}\)</span>. The following four lines describe the treatment of
Ce <em>spdf</em> orbitals by the <strong class="program">dmftproj</strong> program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>complex
1 1 1 2          ! l included for each sort
0 0 0 0          ! l included for each sort
0
</pre></div>
</div>
<p>where <cite>complex</cite> is the choice for the angular basis to be used (spherical complex harmonics),
in the next line we specify, for each orbital quantum number, whether it is treated as correlated (‘2’)
and, hence, the corresponding Wannier orbitals will be generated, or uncorrelated (‘1’). In the latter
case the <strong class="program">dmftproj</strong> program will generate projectors to be used in calculations of
corresponding partial densities of states (see below). In the present case we choose the fourth
(i. e. <em>f</em>) orbitals as correlated. The next line specify the number of irreducible representations
into which a given correlated shell should be split (or ‘0’ if no splitting is desired, as in the
present case). The fourth line specifies whether the spin-orbit interaction should be switched
on (‘1’) or off (‘0’, as in the present case).</p>
<p>Finally, the last line of the file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>-.40 0.40         ! Energy window relative to E_f
</pre></div>
</div>
<p>specifies the energy window for Wannier functions’ construction. For a
more complete description of <strong class="program">dmftproj</strong> options see its manual.</p>
<p>To prepare input data for <strong class="program">dmftproj</strong> we execute lapw2 with the <cite>-almd</cite> option</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="n">lapw2</span> <span class="o">-</span><span class="n">almd</span>
</pre></div>
</div>
<p>Then  <strong class="program">dmftproj</strong> is executed in its default mode (i.e. without
spin-polarization or spin-orbit included)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dmftproj</span>
</pre></div>
</div>
<p>This program produces the following files:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">Ce-gamma.ctqmcout</span></code> and <code class="file docutils literal notranslate"><span class="pre">Ce-gamma.symqmc</span></code> containing projector operators and symmetry
operations for orthonormalized Wannier orbitals, respectively.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">Ce-gamma.parproj</span></code> and <code class="file docutils literal notranslate"><span class="pre">Ce-gamma.sympar</span></code> containing projector operators and symmetry
operations for uncorrelated states, respectively. These files are needed for projected
density-of-states or spectral-function calculations.</p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">Ce-gamma.oubwin</span></code> needed for the charge density recalculation in the case of a fully
self-consistent DFT+DMFT run (see below).</p></li>
</ul>
</div></blockquote>
<p>Now we have all necessary input from Wien2k for running DMFT calculations.</p>
</section>
<section id="dmft-setup-hubbard-i-calculations-in-triqs">
<h2>DMFT setup: Hubbard-I calculations in TRIQS<a class="headerlink" href="#dmft-setup-hubbard-i-calculations-in-triqs" title="Link to this heading"></a></h2>
<p>In order to run DFT+DMFT calculations within Hubbard-I we need the corresponding python script,
<a class="reference internal" href="images_scripts/Ce-gamma_script.html#ce-gamma-script"><span class="std std-ref">Ce-gamma.py</span></a>. It is generally similar to the script for the case of DMFT calculations
with the CT-QMC solver (see <a class="reference internal" href="../guide/dftdmft_singleshot.html#singleshot"><span class="std std-ref">Single-shot DFT+DMFT</span></a>), however there are also some differences. First
difference is that we import the Hubbard-I solver by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">triqs.applications.impurity_solvers.hubbard_I.hubbard_solver</span> <span class="kn">import</span> <span class="n">Solver</span>
</pre></div>
</div>
<p>The Hubbard-I solver is very fast and we do not need to take into account the DFT block structure
or use any approximation for the <em>U</em>-matrix. We load and convert the <strong class="program">dmftproj</strong> output
and initialize the <code class="xref py py-class docutils literal notranslate"><span class="pre">SumkDFT</span></code> class as described in <a class="reference internal" href="../guide/conversion.html#conversion"><span class="std std-ref">Supported interfaces</span></a> and
<a class="reference internal" href="../guide/dftdmft_singleshot.html#singleshot"><span class="std std-ref">Single-shot DFT+DMFT</span></a> and then set up the Hubbard-I solver</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">l</span><span class="p">)</span>
</pre></div>
</div>
<p>where the solver is initialized with the value of <cite>beta</cite>, and the orbital quantum
number <cite>l</cite> (equal to 3 in our case).</p>
<p>The Hubbard-I initialization <cite>Solver</cite> has also optional parameters one may use:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>n_msb</cite>: the number of Matsubara frequencies used. The default is <cite>n_msb=1025</cite>.</p></li>
<li><p><cite>use_spin_orbit</cite>: if set ‘True’ the solver is run with spin-orbit coupling included.
To perform actual DFT+DMFT calculations with spin-orbit one should also run Wien2k and
<strong class="program">dmftproj</strong> in spin-polarized mode and with spin-orbit included. By default,
<cite>use_spin_orbit=False</cite>.</p></li>
<li><p><cite>Nmoments</cite>: the number of moments used to describe high-frequency tails of the Hubbard-I
Green function and self energy. By default <cite>Nmoments = 5</cite></p></li>
</ul>
</div></blockquote>
<p>The <cite>Solver.solve(U_int, J_hund)</cite> statement has two necessary parameters, the Hubbard U
parameter <cite>U_int</cite> and Hund’s rule coupling <cite>J_hund</cite>. Notice that the solver constructs the
full 4-index <cite>U</cite>-matrix by default, and the <cite>U_int</cite> parameter is in fact the Slater <cite>F0</cite> integral.
Other optional parameters are:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>T</cite>: matrix that transforms the interaction matrix from complex spherical harmonics to a symmetry
adapted basis. By default, the complex spherical harmonics basis is used and <cite>T=None</cite>.</p></li>
<li><p><cite>verbosity</cite>: tunes output from the solver. If <cite>verbosity=0</cite> only basic information is printed,
if <cite>verbosity=1</cite> the ground state atomic occupancy and its energy are printed, if <cite>verbosity=2</cite>
additional information is printed for all occupancies that were diagonalized. By default, <cite>verbosity=0</cite>.</p></li>
<li><p><cite>Iteration_Number</cite>: the iteration number of the DMFT loop. Used only for printing. By default <cite>Iteration_Number=1</cite></p></li>
<li><p><cite>Test_Convergence</cite>: convergence criterion. Once the self energy is converged below <cite>Test_Convergence</cite>
the Hubbard-I solver is not called anymore. By default <cite>Test_Convergence=0.0001</cite>.</p></li>
</ul>
</div></blockquote>
<p>We need also to introduce some changes in the DMFT loop with respect that used for CT-QMC calculations
in <a class="reference internal" href="../guide/dftdmft_singleshot.html#singleshot"><span class="std std-ref">Single-shot DFT+DMFT</span></a>. The hybridization function is neglected in the Hubbard-I approximation, and only
non-interacting level positions (<span class="math notranslate nohighlight">\(\hat{\epsilon}=-\mu+\langle H^{ff} \rangle - \Sigma_{DC}\)</span>) are
required. Hence, instead of computing <cite>S.G0</cite> as in <a class="reference internal" href="../guide/dftdmft_singleshot.html#singleshot"><span class="std std-ref">Single-shot DFT+DMFT</span></a> we set the level positions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># set atomic levels:</span>
<span class="n">eal</span> <span class="o">=</span> <span class="n">SK</span><span class="o">.</span><span class="n">eff_atomic_levels</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">S</span><span class="o">.</span><span class="n">set_atomic_levels</span><span class="p">(</span> <span class="n">eal</span> <span class="o">=</span> <span class="n">eal</span> <span class="p">)</span>
</pre></div>
</div>
<p>The part after the solution of the impurity problem remains essentially the same: we mix the self energy and local
Green function and then save them in the hdf5 file.
Then the double counting is recalculated and the correlation energy is computed with the Migdal formula and stored in hdf5.</p>
<p>Finally, we compute the modified charge density and save it as well as correlation correction to the total energy in
<code class="file docutils literal notranslate"><span class="pre">Ce-gamma.qdmft</span></code> file, which is then read by lapw2 in the case of self-consistent DFT+DMFT calculations.</p>
<p>You should try to run your script before setting up the fully charge self-consistent calculation
(see <a class="reference internal" href="../basicnotions/structure.html#runpy"><span class="std std-ref">this</span></a> page).</p>
</section>
<section id="fully-charge-self-consistent-dft-dmft-calculation">
<h2>Fully charge self-consistent DFT+DMFT calculation<a class="headerlink" href="#fully-charge-self-consistent-dft-dmft-calculation" title="Link to this heading"></a></h2>
<p>Instead of doing only one-shot runs we perform in this tutorial a fully
self-consistent DFT+DMFT calculations. We launch such a calculations with</p>
<blockquote>
<div><p><cite>run -qdmft 1</cite></p>
</div></blockquote>
<p>where <cite>-qdmft</cite> flag turns on DFT+DMFT calculations with Wien2k,
and one computing core. We use here the default convergence criterion
in Wien2k (convergence to 0.1 mRy in energy).</p>
<p>After calculations are done we may check the value of correlation (‘Hubbard’) energy correction to the total energy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">grep</span> <span class="n">HUBBARD</span> <span class="n">Ce</span><span class="o">-</span><span class="n">gamma</span><span class="o">.</span><span class="n">scf</span><span class="o">|</span><span class="n">tail</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span>
<span class="n">HUBBARD</span> <span class="n">ENERGY</span><span class="p">(</span><span class="n">included</span> <span class="ow">in</span> <span class="n">SUM</span> <span class="n">OF</span> <span class="n">EIGENVALUES</span><span class="p">):</span>           <span class="o">-</span><span class="mf">0.012866</span>
</pre></div>
</div>
<p>In the case of Ce, with the correlated shell occupancy close to 1 the Hubbard energy is close to 0, while the
DC correction to energy is about J/4 in accordance with the fully-localized-limit formula, hence, giving the
total correction <span class="math notranslate nohighlight">\(\Delta E_{HUB}=E_{HUB}-E_{DC} \approx -J/4\)</span>, which is in our case is equal
to -0.175 eV <span class="math notranslate nohighlight">\(\approx\)</span>-0.013 Ry.</p>
<p>The band (“kinetic”) energy with DMFT correction is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">grep</span> <span class="n">DMFT</span> <span class="n">Ce</span><span class="o">-</span><span class="n">gamma</span><span class="o">.</span><span class="n">scf</span> <span class="o">|</span><span class="n">tail</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1</span>
<span class="n">KINETIC</span> <span class="n">ENERGY</span> <span class="k">with</span> <span class="n">DMFT</span> <span class="n">correction</span><span class="p">:</span>                      <span class="o">-</span><span class="mf">5.370632</span>
</pre></div>
</div>
<p>One may also check the convergence in total energy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">grep</span> <span class="p">:</span><span class="n">ENE</span> <span class="n">Ce</span><span class="o">-</span><span class="n">gamma</span><span class="o">.</span><span class="n">scf</span> <span class="o">|</span><span class="n">tail</span> <span class="o">-</span><span class="n">n</span> <span class="mi">5</span>
<span class="p">:</span><span class="n">ENE</span>  <span class="p">:</span> <span class="o">**********</span> <span class="n">TOTAL</span> <span class="n">ENERGY</span> <span class="n">IN</span> <span class="n">Ry</span> <span class="o">=</span>       <span class="o">-</span><span class="mf">17717.56318334</span>
<span class="p">:</span><span class="n">ENE</span>  <span class="p">:</span> <span class="o">**********</span> <span class="n">TOTAL</span> <span class="n">ENERGY</span> <span class="n">IN</span> <span class="n">Ry</span> <span class="o">=</span>       <span class="o">-</span><span class="mf">17717.56342250</span>
<span class="p">:</span><span class="n">ENE</span>  <span class="p">:</span> <span class="o">**********</span> <span class="n">TOTAL</span> <span class="n">ENERGY</span> <span class="n">IN</span> <span class="n">Ry</span> <span class="o">=</span>       <span class="o">-</span><span class="mf">17717.56271503</span>
<span class="p">:</span><span class="n">ENE</span>  <span class="p">:</span> <span class="o">**********</span> <span class="n">TOTAL</span> <span class="n">ENERGY</span> <span class="n">IN</span> <span class="n">Ry</span> <span class="o">=</span>       <span class="o">-</span><span class="mf">17717.56285812</span>
<span class="p">:</span><span class="n">ENE</span>  <span class="p">:</span> <span class="o">**********</span> <span class="n">TOTAL</span> <span class="n">ENERGY</span> <span class="n">IN</span> <span class="n">Ry</span> <span class="o">=</span>       <span class="o">-</span><span class="mf">17717.56287381</span>
</pre></div>
</div>
</section>
<section id="post-processing-and-data-analysis">
<h2>Post-processing and data analysis<a class="headerlink" href="#post-processing-and-data-analysis" title="Link to this heading"></a></h2>
<p>Within Hubbard-I one may also easily obtain the angle-resolved spectral function
(band structure) and integrated spectral function (density of states or DOS).
In difference with the CT-QMC approach one does not need to do an
analytic continuations to get the real-frequency self energy, as it can be
calculated directly in the Hubbard-I solver.</p>
<p>The corresponding script <a class="reference internal" href="images_scripts/Ce-gamma_DOS_script.html#ce-gamma-dos-script"><span class="std std-ref">Ce-gamma_DOS.py</span></a> contains several new parameters</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ommin</span><span class="o">=-</span><span class="mf">4.0</span>    <span class="c1"># bottom of the energy range for DOS calculations</span>
<span class="n">ommax</span><span class="o">=</span><span class="mf">6.0</span>     <span class="c1"># top  of the energy range for DOS calculations</span>
<span class="n">N_om</span><span class="o">=</span><span class="mi">2001</span>     <span class="c1"># number of points on the real-energy axis mesh</span>
<span class="n">broadening</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># broadening (the imaginary shift of the real-energy mesh)</span>
</pre></div>
</div>
<p>Then one needs to load projectors needed for calculations of
corresponding projected densities of states, as well as corresponding
symmetries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Converter</span><span class="o">.</span><span class="n">convert_parpoj_input</span><span class="p">()</span>
</pre></div>
</div>
<p>To get access to analysing tools we initialize the
<code class="xref py py-class docutils literal notranslate"><span class="pre">SumkDFTTools</span></code> class</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SK</span> <span class="o">=</span> <span class="n">SumkDFTTools</span><span class="p">(</span><span class="n">hdf_file</span><span class="o">=</span><span class="n">dft_filename</span><span class="o">+</span><span class="s1">&#39;.h5&#39;</span><span class="p">,</span> <span class="n">use_dft_blocks</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>After the solver initialization, we load the previously calculated
chemical potential and double-counting correction.  Having set up
atomic levels we then compute the atomic Green function and
self energy on the real axis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">set_atomic_levels</span><span class="p">(</span><span class="n">eal</span><span class="o">=</span><span class="n">eal</span><span class="p">)</span>
<span class="n">S</span><span class="o">.</span><span class="n">GF_realomega</span><span class="p">(</span><span class="n">ommin</span><span class="o">=</span><span class="n">ommin</span><span class="p">,</span> <span class="n">ommax</span><span class="o">=</span><span class="n">ommax</span><span class="p">,</span> <span class="n">N_om</span><span class="o">=</span><span class="n">N_om</span><span class="p">,</span> <span class="n">U_int</span><span class="o">=</span><span class="n">U_int</span><span class="p">,</span> <span class="n">J_hund</span><span class="o">=</span><span class="n">J_hund</span><span class="p">)</span>
</pre></div>
</div>
<p>put it into SK class and then calculated the actual DOS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SK</span><span class="o">.</span><span class="n">dos_parproj_basis</span><span class="p">(</span><span class="n">broadening</span><span class="o">=</span><span class="n">broadening</span><span class="p">)</span>
</pre></div>
</div>
<p>We may first increase the number of <strong>k</strong>-points in BZ to 10000 by executing the Wien2k
program <strong class="program">kgen</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="n">kgen</span>
</pre></div>
</div>
<p>and then by executing the <a class="reference internal" href="images_scripts/Ce-gamma_DOS_script.html#ce-gamma-dos-script"><span class="std std-ref">Ce-gamma_DOS.py</span></a> with <strong class="program">python</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">Ce</span><span class="o">-</span><span class="n">gamma_DOS</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>In result we get the total DOS for spins <cite>up</cite> and <cite>down</cite> (identical in our paramagnetic case)
in <code class="file docutils literal notranslate"><span class="pre">DOScorrup.dat</span></code> and <code class="file docutils literal notranslate"><span class="pre">DOScorrdown.dat</span></code> files, respectively, as well as the projected DOS
written in the corresponding files as described in <a class="reference internal" href="../guide/analysis.html#analysis"><span class="std std-ref">Tools for analysis</span></a>. In our case, for example, the files
<code class="file docutils literal notranslate"><span class="pre">DOScorrup.dat</span></code> and <code class="file docutils literal notranslate"><span class="pre">DOScorrup_proj3.dat</span></code> contain the total DOS for spin <em>up</em> and the
corresponding projected DOS for Ce <em>4f</em> orbital, respectively. They are plotted below.</p>
<a class="reference internal image-reference" href="../_images/Ce_DOS.png"><img alt="../_images/Ce_DOS.png" class="align-center" src="../_images/Ce_DOS.png" style="width: 700px;" /></a>
<p>As one may clearly see, the Ce <em>4f</em> band is split by the local Coulomb interaction into the filled lower
Hubbard band and empty upper Hubbard band (the latter is additionally split into several peaks due to the
Hund’s rule coupling and multiplet effects).</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sr2mgoso6_soc.html" class="btn btn-neutral float-left" title="DFT (Wien2k) and Wannier orbitals" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="svo_vasp/svo_notebook.html" class="btn btn-neutral float-right" title="VASP setup" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2021.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>