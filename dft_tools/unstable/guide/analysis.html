<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tools for analysis &mdash; TRIQS DFTTools  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f7f783a0" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../_static/triqs_favicon.ico"/>
  
        <script src="../_static/jquery.js?v=8dae8fb0"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transport calculations" href="transport.html" />
    <link rel="prev" title="Spin-orbit coupled calculations (single-shot)" href="soc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            TRIQS DFTTools
          </a>
              <div class="version">
                3.3.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#packaged-versions-of-dfttools">Packaged Versions of DFTTools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#ubuntu-debian-packages">Ubuntu Debian packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#anaconda-experimental">Anaconda (experimental)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#docker">Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-dfttools-from-source">Compiling DFTTools from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#important-note-for-fcsc-dft-dmft-calculations">Important note for FCSC DFT+DMFT calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps-for-the-use-with-wien2k-version-14-2-and-older">Installation steps for the use with WIEN2K version 14.2 and older</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#basic-notions">Basic notions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/first.html">What you should know</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/first.html#what-is-dfttools">What is <strong class="program">DFTTools</strong>?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/first.html#understand-the-philosophy-of-dfttools">Understand the philosophy of <strong class="program">DFTTools</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/first.html#learn-how-to-use-triqs-library-and-the-cthyb-solver">Learn how to use TRIQS library (and the CTHYB solver)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/first.html#analytic-continuation">Analytic Continuation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/dft_dmft.html">Introduction to DFT+DMFT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/dft_dmft.html#density-functional-theory-in-a-very-small-nutshell">Density-functional theory in a (very small) nutshell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/dft_dmft.html#from-dft-to-dmft">From DFT to DMFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/dft_dmft.html#using-projective-wannier-functions-for-dmft">Using projective Wannier functions for DMFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/dft_dmft.html#full-charge-self-consistency">Full charge self-consistency</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../basicnotions/structure.html">Structure of <strong class="program">DFTTools</strong></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#the-interface-layer">The interface layer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#the-dmft-calculation">The DMFT calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#full-charge-self-consistency">Full charge self consistency</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#post-processing">Post-processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../basicnotions/structure.html#executing-your-python-scripts">Executing your python scripts</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#construction-of-local-orbitals-from-dft">Construction of local orbitals from DFT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="conversion.html">Supported interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="conv_wien2k.html">Interface with Wien2k</a></li>
<li class="toctree-l4"><a class="reference internal" href="conv_vasp.html">Interface with VASP</a></li>
<li class="toctree-l4"><a class="reference internal" href="conv_elk.html">Interface with Elk</a></li>
<li class="toctree-l4"><a class="reference internal" href="conv_W90.html">Interface with Wannier90</a></li>
<li class="toctree-l4"><a class="reference internal" href="conv_generalhk.html">A general H(k)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="conversion.html#mpi-issues">MPI issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="conversion.html#interfaces-to-other-packages">Interfaces to other packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../h5structure.html">standardized hdf5 structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../h5structure.html#groups-and-their-formats">groups and their formats</a></li>
<li class="toctree-l4"><a class="reference internal" href="../h5structure.html#general-and-simple-h-k-converter">General and simple H(k) Converter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#dft-dmft">DFT+DMFT</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dftdmft_singleshot.html">Single-shot DFT+DMFT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dftdmft_singleshot.html#initialization-of-the-calculation">Initialization of the calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="dftdmft_singleshot.html#setting-up-the-impurity-solver">Setting up the impurity solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="dftdmft_singleshot.html#doing-the-dmft-loop">Doing the DMFT loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="dftdmft_singleshot.html#restarting-a-calculation">Restarting a calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="dftdmft_singleshot.html#mixing">Mixing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dftdmft_selfcons.html">Full charge self-consistency</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dftdmft_selfcons.html#wien2k-dmftproj">Wien2k + dmftproj</a></li>
<li class="toctree-l4"><a class="reference internal" href="dftdmft_selfcons.html#vasp-plovasp">VASP + PLOVasp</a></li>
<li class="toctree-l4"><a class="reference internal" href="dftdmft_selfcons.html#elk">Elk</a></li>
<li class="toctree-l4"><a class="reference internal" href="dftdmft_selfcons.html#other-dft-codes">Other DFT codes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#advanced-topics">Advanced Topics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="blockstructure.html">Manipulating the Green’s functions block structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="blockstructure.html#creating-a-block-structure-and-green-s-function">Creating a block structure and Green’s function</a></li>
<li class="toctree-l4"><a class="reference internal" href="blockstructure.html#the-solver-structure">The <em>solver</em> structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="blockstructure.html#picking-orbitals">Picking orbitals</a></li>
<li class="toctree-l4"><a class="reference internal" href="blockstructure.html#basis-rotations">Basis rotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="blockstructure.html#diagonal-approximation">Diagonal approximation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="BasisRotation.html">Automatic basis rotations in DFT+DMFT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="BasisRotation.html#setting-up-the-initial-solver-structure-from-dft">Setting up the initial solver structure from DFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="BasisRotation.html#finding-the-transformation-matrix">Finding the transformation matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="BasisRotation.html#automatic-transformation-during-the-dmft-loop">Automatic transformation during the DMFT loop</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="soc.html">Spin-orbit coupled calculations (single-shot)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="soc.html#treatment-of-soc-in-dft">Treatment of SOC in DFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="soc.html#treatment-of-soc-in-wien2k">Treatment of SOC in Wien2k</a></li>
<li class="toctree-l4"><a class="reference internal" href="soc.html#treatment-of-soc-in-elk">Treatment of SOC in Elk</a></li>
<li class="toctree-l4"><a class="reference internal" href="soc.html#after-generating-the-projectors">After generating the projectors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../documentation.html#postprocessing">Postprocessing</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Tools for analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#initialisation">Initialisation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#density-of-states">Density of states</a></li>
<li class="toctree-l4"><a class="reference internal" href="#band-resolved-density-matrices">Band resolved density matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#momentum-resolved-spectral-function-with-real-frequency-self-energy">Momentum resolved spectral function (with real-frequency self energy)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#energy-contours-of-the-k-resolved-spectral-function">Energy contours of the k-resolved Spectral function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#partial-charges">Partial charges</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="transport.html">Transport calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="transport.html#formalism">Formalism</a></li>
<li class="toctree-l4"><a class="reference internal" href="transport.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="transport.html#using-the-transport-code">Using the transport code</a></li>
<li class="toctree-l4"><a class="reference internal" href="transport.html#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="transport.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#reference-manual">Reference manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.block_structure.html">block_structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.block_structure.BlockStructure.html">triqs_dft_tools.block_structure.BlockStructure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.html">converters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.converter_tools.html">converter_tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.elk.html">elk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.elktools.html">elktools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.hk.html">hk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.plovasp.html">plovasp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.vasp.html">vasp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.wannier90.html">wannier90</a></li>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.converters.wien2k.html">wien2k</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.sumk_dft.html">sumk_dft</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.sumk_dft.SumkDFT.html">triqs_dft_tools.sumk_dft.SumkDFT</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.sumk_dft_tools.html">sumk_dft_tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.sumk_dft_tools.SumkDFTTools.html">triqs_dft_tools.sumk_dft_tools.SumkDFTTools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.symmetry.html">symmetry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.symmetry.Symmetry.html">triqs_dft_tools.symmetry.Symmetry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.trans_basis.html">trans_basis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.trans_basis.TransBasis.html">triqs_dft_tools.trans_basis.TransBasis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_python_api/triqs_dft_tools.util.html">util</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_python_api/triqs_dft_tools.util.compute_DC_from_density.html">triqs_dft_tools.util.compute_DC_from_density</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#faqs">FAQs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs/faqs.html">Frequently-Asked Questions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#wien2k-fermi-error-when-running-x-lapw2-almd-band">wien2k: FERMI ERROR when running <cite>x lapw2 -almd -band</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#how-do-i-plot-the-output-of-spaghettis">How do I plot the output of <cite>spaghettis</cite>?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#x-optic-does-not-write-a-case-pmat-file">x optic does not write a case.pmat file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs/faqs.html#how-do-i-get-real-frequency-quantities">How do I get real-frequency quantities?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#a-simple-example-srvo3">A simple example: SrVO3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/srvo3.html">DFT (Wien2k) and Wannier orbitals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/srvo3.html#dft-setup">DFT setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/srvo3.html#wannier-orbitals">Wannier orbitals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/srvo3.html#the-dmft-calculation">The DMFT calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/srvo3.html#loading-modules">Loading modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/srvo3.html#initializing-sumkdft">Initializing SumkDFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/srvo3.html#initializing-the-solver">Initializing the solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/srvo3.html#dmft-cycle">DMFT cycle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/srvo3.html#tail-fit-parameters">Tail fit parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#basis-rotations-sr2mgoso6-without-soc">Basis rotations: Sr2MgOsO6 without SOC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/sr2mgoso6_nosoc.html">DFT (Wien2k) and Wannier orbitals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_nosoc.html#dft-setup">DFT setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_nosoc.html#wannier-orbitals">Wannier orbitals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/sr2mgoso6_nosoc.html#the-dmft-calculation">The DMFT calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_nosoc.html#rotating-the-basis">Rotating the basis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_nosoc.html#the-interaction-hamiltonian">The interaction Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_nosoc.html#the-dmft-loop-with-automatic-basis-rotations">The DMFT loop with automatic basis rotations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#sr2mgoso6-with-soc-non-magnetic">Sr2MgOsO6 with SOC (non-magnetic)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/sr2mgoso6_soc.html">DFT (Wien2k) and Wannier orbitals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_soc.html#dft-setup">DFT setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_soc.html#wannier-orbitals">Wannier orbitals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/sr2mgoso6_soc.html#the-dmft-calculation">The DMFT calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_soc.html#rotating-the-basis">Rotating the basis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_soc.html#the-interaction-hamiltonian">The interaction Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/sr2mgoso6_soc.html#the-dmft-loop-with-automatic-basis-rotations">The DMFT loop with automatic basis rotations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#full-charge-self-consistency-with-wien2k-gamma-ce">Full charge self consistency with Wien2k: <span class="math notranslate nohighlight">\(\gamma\)</span>-Ce</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/ce-gamma-fscs_wien2k.html">DFT+DMFT tutorial: Ce with Hubbard-I approximation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/ce-gamma-fscs_wien2k.html#wien2k-setup">Wien2k setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/ce-gamma-fscs_wien2k.html#wannier-orbitals-dmftproj">Wannier orbitals: dmftproj</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/ce-gamma-fscs_wien2k.html#dmft-setup-hubbard-i-calculations-in-triqs">DMFT setup: Hubbard-I calculations in TRIQS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/ce-gamma-fscs_wien2k.html#fully-charge-self-consistent-dft-dmft-calculation">Fully charge self-consistent DFT+DMFT calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/ce-gamma-fscs_wien2k.html#post-processing-and-data-analysis">Post-processing and data analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#vasp-interface-examples">VASP interface examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#simple-converter-example-srvo3">Simple Converter example: SrVO3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/svo_vasp/svo_notebook.html">VASP setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/svo_vasp/svo_notebook.html#PLOVASP">PLOVASP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/svo_vasp/svo_notebook.html#Converting-to-hdf5-file">Converting to hdf5 file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#complex-example-nio">Complex example: NiO</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/nio_csc_vasp/nio_csc.html">DFT and projections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/nio_csc_vasp/nio_csc.html#dmft">DMFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/nio_csc_vasp/nio_csc.html#charge-self-consistent-dmft">Charge self-consistent DMFT</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#elk-interface-examples">Elk interface examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials.html#converter-example-srvo3">Converter example: SrVO3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/svo_elk/srvo3.html">Elk to TRIQS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/svo_elk/srvo3.html#the-dmft-calculation">The DMFT calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tutorials/svo_elk/srvo3.html#triqs-to-elk-fully-charge-self-consistent-dft-dmft">TRIQS to Elk (Fully Charge Self-Consistent DFT+DMFT)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-3-0">Version 3.3.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-2-1">Version 3.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-2-0">Version 3.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#elk">Elk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#vasp">Vasp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#w90-qe">w90 + QE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#clean">clean</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-1-1">Version 3.1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id2">General</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-1-0">Version 3.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#wannier90-converter">Wannier90 Converter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#change-in-gf-struct">Change in gf_struct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#cmake">Cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#other-changes">Other changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-0-0">Version 3.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#restructuring">Restructuring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#dependency-management">Dependency Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id3">Other Changes:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-2-1">Version 2.2.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-2-0">Version 2.2.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-1-x-changes-since-1-4">Version 2.1.x (changes since 1.4)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#authors-quotation">Authors &amp; Quotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TRIQS DFTTools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../documentation.html">Documentation</a></li>
      <li class="breadcrumb-item active">Tools for analysis</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/guide/analysis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="tools-for-analysis">
<span id="analysis"></span><h1>Tools for analysis<a class="headerlink" href="#tools-for-analysis" title="Link to this heading"></a></h1>
<p>This section explains how to use some tools of the package in order to analyse the data. There are certain tools here which are not available for some DFT code interfaces. Please refer to the DFT package interface converter documentation (see <a class="reference internal" href="conversion.html#conversion"><span class="std std-ref">Supported interfaces</span></a>) on how to interface the required DFT outputs into the HDF5 files needed for the tools discussed here. This section will assume that the user has converted the required DFT data.</p>
<p>The following routines require a self energy on the real frequency axis if the user specifies the inputs <cite>with_Sigma</cite> and <cite>with_dc</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">density_of_states</span></code> for the momentum-integrated spectral function including self energy effects and</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">spaghettis</span></code> for the momentum-resolved spectral function (i.e. ARPES)</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">spectral_contours</span></code> for the k-resolved spectral function on a specific k-mesh (i.e., spectral function on a two dimensional k-mesh)</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This package does NOT provide an explicit method to do an <strong>analytic continuation</strong> of
self energies and Green functions from Matsubara frequencies to the real-frequency axis,
but a list of options available within the TRIQS framework is given <a class="reference internal" href="../basicnotions/first.html#ac"><span class="std std-ref">here</span></a>.
Keep in mind that all these methods have to be used very carefully!</p>
</div>
<p>Otherwise, without these options, the spectral functions from the inputs of the interfaced DFT code will be used.</p>
<p>The other routines presented here use the Matsubara self-energy.</p>
<section id="initialisation">
<h2>Initialisation<a class="headerlink" href="#initialisation" title="Link to this heading"></a></h2>
<p>All tools described below are collected in an extension of the <code class="xref py py-class docutils literal notranslate"><span class="pre">SumkDFT</span></code> class and are
loaded by importing the module <code class="xref py py-class docutils literal notranslate"><span class="pre">SumkDFTTools</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">triqs_dft_tools.sumk_dft_tools</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>The initialisation of the class is equivalent to that of the <code class="xref py py-class docutils literal notranslate"><span class="pre">SumkDFT</span></code>
class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SK</span> <span class="o">=</span> <span class="n">SumkDFTTools</span><span class="p">(</span><span class="n">hdf_file</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that all routines available in <code class="xref py py-class docutils literal notranslate"><span class="pre">SumkDFT</span></code> are also available here.</p>
<p>If required, we have to load and initialise the real-frequency self energy. Most conveniently,
you have your self energy already stored as a real-frequency <code class="xref py py-class docutils literal notranslate"><span class="pre">BlockGf</span></code> object
in a hdf5 file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;case.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ar</span><span class="p">:</span>
      <span class="n">SigmaReFreq</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="s1">&#39;dmft_output&#39;</span><span class="p">][</span><span class="s1">&#39;Sigma_w&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>You may also have your self energy stored in text files. For this case the <a class="reference external" href="https://triqs.github.io/triqs/latest/index.html#welcome" rel="noopener noreferrer" target="_blank" title="(in TRIQS v3.2.1)"><span class="xref std std-ref">TRIQS</span></a> library offers
the function <code class="xref py py-meth docutils literal notranslate"><span class="pre">read_gf_from_txt()</span></code>, which is able to load the data from text files of one Green function block
into a real-frequency <code class="xref py py-class docutils literal notranslate"><span class="pre">ReFreqGf</span></code> object. Loading each block separately and
building up a :class:´BlockGf &lt;triqs.gf.BlockGf&gt;´ is done with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">triqs.gf.tools</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c1"># get block names</span>
<span class="n">n_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">nl</span> <span class="ow">in</span> <span class="n">SK</span><span class="o">.</span><span class="n">gf_struct_solver</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()]</span>
<span class="c1"># load sigma for each block - in this example sigma is composed of 1x1 blocks</span>
<span class="n">g_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">read_gf_from_txt</span><span class="p">(</span><span class="n">block_txtfiles</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Sigma_&#39;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;.dat&#39;</span><span class="p">]],</span> <span class="n">block_name</span><span class="o">=</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">n_list</span><span class="p">]</span>
<span class="c1"># put the data into a BlockGf object</span>
<span class="n">SigmaReFreq</span> <span class="o">=</span> <span class="n">BlockGf</span><span class="p">(</span><span class="n">name_list</span><span class="o">=</span><span class="n">n_list</span><span class="p">,</span> <span class="n">block_list</span><span class="o">=</span><span class="n">g_blocks</span><span class="p">,</span> <span class="n">make_copies</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>where:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>block_txtfiles</cite> is a rank 2 square np.array(str) or list[list[str]] holding the file names of one block and</p></li>
<li><p><cite>block_name</cite> is the name of the block.</p></li>
</ul>
</div></blockquote>
<p>It is important that each data file has to contain three columns: the real-frequency mesh, the real part and the imaginary part
of the self energy - exactly in this order! The mesh should be the same for all files read in and non-uniform meshes are not supported.</p>
<p>Finally, we set the self energy into the <cite>SK</cite> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SK</span><span class="o">.</span><span class="n">set_Sigma</span><span class="p">([</span><span class="n">SigmaReFreq</span><span class="p">])</span>
</pre></div>
</div>
<p>and additionally set the chemical potential and the double counting correction from the DMFT calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chemical_potential</span><span class="p">,</span> <span class="n">dc_imp</span><span class="p">,</span> <span class="n">dc_energ</span> <span class="o">=</span> <span class="n">SK</span><span class="o">.</span><span class="n">load</span><span class="p">([</span><span class="s1">&#39;chemical_potential&#39;</span><span class="p">,</span><span class="s1">&#39;dc_imp&#39;</span><span class="p">,</span><span class="s1">&#39;dc_energ&#39;</span><span class="p">])</span>
<span class="n">SK</span><span class="o">.</span><span class="n">set_mu</span><span class="p">(</span><span class="n">chemical_potential</span><span class="p">)</span>
<span class="n">SK</span><span class="o">.</span><span class="n">set_dc</span><span class="p">(</span><span class="n">dc_imp</span><span class="p">,</span><span class="n">dc_energ</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="density-of-states">
<h2>Density of states<a class="headerlink" href="#density-of-states" title="Link to this heading"></a></h2>
<p>For plotting the density of states, you type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SK</span><span class="o">.</span><span class="n">density_of_states</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">with_Sigma</span><span class="p">,</span> <span class="n">with_dc</span><span class="p">,</span> <span class="n">proj_type</span><span class="p">,</span> <span class="n">dosocc</span><span class="p">,</span> <span class="n">save_to_file</span><span class="p">)</span>
</pre></div>
</div>
<p>where a description of all of the inputs are given in <code class="xref py py-meth docutils literal notranslate"><span class="pre">density_of_states</span></code>:</p>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">SumkDFTTools.</span></span><span class="sig-name descname"><span class="pre">density_of_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_Sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_dc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dosocc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_to_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_dft_tools/sumk_dft_tools.html#SumkDFTTools.density_of_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculates the density of states and the projected density of states.
The basis of the projected density of states is specified by proj_type.</p>
<p>The output files (if <cite>save_to_file = True</cite>) have two (three in the orbital-resolved case) columns representing the frequency and real part of the DOS (and imaginary part of the DOS) in that order.</p>
<p>The output files are as follows:</p>
<ul class="simple">
<li><p>DOS_(spn).dat, the total DOS.</p></li>
<li><p>DOS_(proj_type)_(spn)_proj(i).dat, the DOS projected to an orbital with index i which refers to the index given in SK.shells (or SK.corr_shells for proj_type = “wann”).</p></li>
<li><p>DOS_(proj_type)_(sp)_proj(i)_(m)_(n).dat, As above, but printed as orbitally-resolved matrix in indices “m” and “n”. For example, for “d” orbitals, it gives the DOS separately for each orbital (e.g., <cite>d_(xy)</cite>, <cite>d_(x^2-y^2)</cite>, and so on).</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>mu</strong><span class="classifier">double, optional</span></dt><dd><p>Chemical potential, overrides the one stored in the hdf5 archive.
By default, this is automatically set to the chemical potential within the SK object.</p>
</dd>
<dt><strong>broadening</strong><span class="classifier">double, optional</span></dt><dd><p>Lorentzian broadening of the spectra to avoid any numerical artifacts.
If not given, standard value of lattice_gf (0.001 eV) is used.</p>
</dd>
<dt><strong>mesh</strong><span class="classifier">real frequency MeshType, optional</span></dt><dd><p>Omega mesh for the real-frequency Green’s function. 
Given as parameter to lattice_gf.</p>
</dd>
<dt><strong>with_Sigma</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, the self energy is used for the calculation. 
If false, the DOS is calculated without self energy.
Both with_Sigma and with_dc equal to True is needed for DFT+DMFT A(w) calculated. 
Both with_Sigma and with_dc equal to false is needed for DFT A(w) calculated.</p>
</dd>
<dt><strong>with_dc</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True the double counting correction is used.</p>
</dd>
<dt><strong>proj_type</strong><span class="classifier">string, optional</span></dt><dd><blockquote>
<div><p>The type of projection used for the orbital-projected DOS.
These projected spectral functions will be determined alongside the total spectral function.
By default, no projected DOS type will be calculated (the corresponding projected arrays will be empty).
The following options are:</p>
</div></blockquote>
<p>‘None’   - Only total DOS calculated 
‘wann’   - Wannier DOS calculated from the Wannier projectors
‘vasp’   - Vasp orbital-projected DOS only from Vasp inputs
‘wien2k’ - Wien2k orbital-projected DOS from the wien2k theta projectors</p>
</dd>
<dt><strong>dosocc</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, the occupied DOS, DOSproj and DOSproj_orb will be returned.
The prerequisite of this option is to have calculated the band-resolved
density matrices generated by the occupations() routine.</p>
</dd>
<dt><strong>save_to_file</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, text files with the calculated data will be created.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>DOS</strong><span class="classifier">Dict of numpy arrays</span></dt><dd><p>Contains the full density of states with the form of DOS[spn][n_om] where “spn” speficies the spin type of the calculation (“up”, “down”, or combined “ud” which relates to calculations with spin-orbit coupling) and “n_om” is the number of real frequencies as specified by the real frequency MeshType used in the calculation. This array gives the total density of states.</p>
</dd>
<dt><strong>DOSproj</strong><span class="classifier">Dict of numpy arrays</span></dt><dd><p>DOS projected to atom (shell) with the form of DOSproj[n_shells][spn][n_om] where “n_shells” is the total number of correlated or uncorrelated shells (depending on the input “proj_type”). This array gives the trace of the orbital-projected density of states. Empty if proj_type = None</p>
</dd>
<dt><strong>DOSproj_orb</strong><span class="classifier">Dict of numpy arrays</span></dt><dd><p>Orbital-projected DOS projected to atom (shell) and resolved into orbital contributions with the form of DOSproj_orb[n_shells][spn][n_om,dim,dim] where “dim” specifies the orbital dimension of the correlated/uncorrelated shell (depending on the input “proj_type”). 
Empty if proj_type = None</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<a class="reference internal image-reference" href="../_images/DFT_Tools_SVO_DFT_DOS.png"><img alt="../_images/DFT_Tools_SVO_DFT_DOS.png" class="align-center" src="../_images/DFT_Tools_SVO_DFT_DOS.png" style="width: 600px;" /></a>
<p>The figure above shows the DFT SrVO<sub>3</sub> density of states generated from 2925 k-points in the irreducible Brillouin zone with the V t<sub>2g</sub> Wannier projectors generated within a correlated energy window of [-13.6, 13.6] eV. The <cite>broadening</cite> input has been set to the temperature (i.e., 1/Beta). The total, V t<sub>2g</sub> Wannier and occupied total density of states generated from the SK.density_of_states() routine are shown. Note that the noise in the density of states comes from the number of k-points used. This can be removed upon by either using more k-points or using a larger <cite>broadening</cite> value.</p>
</section>
<section id="band-resolved-density-matrices">
<h2>Band resolved density matrices<a class="headerlink" href="#band-resolved-density-matrices" title="Link to this heading"></a></h2>
<p>Calculates the band resolved density matrices (occupations) from the Matsubara frequency self-energy.
This is done by calling the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SK</span><span class="o">.</span><span class="n">occupations</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">with_Sigma</span><span class="p">,</span> <span class="n">with_dc</span><span class="p">,</span> <span class="n">save_occ</span><span class="p">):</span>
</pre></div>
</div>
<p>This is required to generate the occupied DOS in SK.density_of_states() when dosocc is set to True. The <cite>save_occ</cite> optional input (True by default) saves these density matrices to the HDF5 file within the misc_data subgroup. The other variables are the same as defined above. See <code class="xref py py-meth docutils literal notranslate"><span class="pre">occupations</span></code></p>
</section>
<section id="momentum-resolved-spectral-function-with-real-frequency-self-energy">
<h2>Momentum resolved spectral function (with real-frequency self energy)<a class="headerlink" href="#momentum-resolved-spectral-function-with-real-frequency-self-energy" title="Link to this heading"></a></h2>
<p>Another quantity of interest is the calculated momentum-resolved spectral function A(k, <span class="math notranslate nohighlight">\(\omega\)</span>) or (correlated) band structure which can directly be compared to ARPES experiments.
First we have generate the required files from the DFT code of choice and interface them with DFT_Tools, see the guides of the DFT converters (<a class="reference internal" href="conversion.html#conversion"><span class="std std-ref">Supported interfaces</span></a>) on how to do this.</p>
<p>This spectral function is calculated by typing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SK</span><span class="o">.</span><span class="n">spaghettis</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">plot_shift</span><span class="p">,</span> <span class="n">plot_range</span><span class="p">,</span> <span class="n">shell_list</span><span class="p">,</span> <span class="n">with_Sigma</span><span class="p">,</span> <span class="n">with_dc</span><span class="p">,</span> <span class="n">proj_type</span><span class="p">,</span> <span class="n">save_to_file</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">SumkDFTTools.</span></span><span class="sig-name descname"><span class="pre">spaghettis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shell_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_Sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_dc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_to_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_dft_tools/sumk_dft_tools.html#SumkDFTTools.spaghettis"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculates the k-resolved spectral function A(k,w) (band structure)</p>
<p>The output files have three columns representing the k-point index, frequency and A(k,w) (in this order).</p>
<p>The output files are as follows:</p>
<ul class="simple">
<li><p>Akw_(sp).dat, the total A(k,w).</p></li>
<li><p>Akw_(proj_type)_(spn)_proj(i).dat, the A(k,w) projected to shell with index (i).</p></li>
<li><p>Akw_(proj_type)_(spn)_proj(i)_(m)_(n).dat, as above, but for each (m) and (n) orbital contribution.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>mu</strong><span class="classifier">double, optional</span></dt><dd><p>Chemical potential, overrides the one stored in the hdf5 archive.
By default, this is automatically set to the chemical potential within the SK object.</p>
</dd>
<dt><strong>broadening</strong><span class="classifier">double, optional</span></dt><dd><p>Lorentzian broadening of the spectra to avoid any numerical artifacts. 
If not given, standard value of lattice_gf (0.001 eV) is used.</p>
</dd>
<dt><strong>mesh</strong><span class="classifier">real frequency MeshType, optional</span></dt><dd><p>Omega mesh for the real-frequency Green’s function.
Given as parameter to lattice_gf.</p>
</dd>
<dt><strong>plot_shift</strong><span class="classifier">double, optional</span></dt><dd><p>Offset [=(ik-1)*plot_shift, where ik is the index of the k-point] for each A(k,w) for stacked plotting of spectra.</p>
</dd>
<dt><strong>plot_range</strong><span class="classifier">list of double, optional</span></dt><dd><p>Sets the energy window for plotting to (plot_range[0],plot_range[1]).
If not provided, the min and max values of the energy mesh is used.</p>
</dd>
<dt><strong>shell_list</strong><span class="classifier">list of integers, optional</span></dt><dd><p>Contains the indices of the shells of which the projected spectral function
is calculated for.
If shell_list = None and proj_type is not None, then the projected spectral
function is calculated for all shells.
Note for experts: The spectra from Wien2k inputs are not rotated to the local coordinate system used in Wien2k.</p>
</dd>
<dt><strong>with_Sigma</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, the self energy is used for the calculation. 
If false, the DOS is calculated without self energy.
Both with_Sigma and with_dc equal to True is needed for DFT+DMFT A(k,w) calculated. 
Both with_Sigma and with_dc equal to false is needed for DFT A(k,w) calculated.</p>
</dd>
<dt><strong>with_dc</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True the double counting correction is used.</p>
</dd>
<dt><strong>proj_type</strong><span class="classifier">string, optional</span></dt><dd><blockquote>
<div><p>The type of projection used for the orbital-projected DOS.
These projected spectral functions will be determined alongside the total spectral function.
By default, no projected DOS type will be calculated (the corresponding projected arrays will be empty).
The following options are:</p>
</div></blockquote>
<p>‘None’   - Only total DOS calculated 
‘wann’   - Wannier DOS calculated from the Wannier projectors
‘wien2k’ - Wien2k orbital-projected DOS from the wien2k theta projectors</p>
</dd>
<dt><strong>save_to_file</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, text files with the calculated data will be created.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Akw</strong><span class="classifier">Dict of numpy arrays</span></dt><dd><p>(Correlated) k-resolved spectral function.
This dictionary has the form of <cite>Akw[spn][n_k, n_om]</cite> where spn, n_k and n_om are the spin, number of k-points, and number of frequencies used in the calculation.</p>
</dd>
<dt><strong>pAkw</strong><span class="classifier">Dict of numpy arrays</span></dt><dd><p>(Correlated) k-resolved spectral function projected to atoms (i.e., the Trace of the orbital-projected A(k,w)).
This dictionary has the form of pAkw[n_shells][spn][n_k, n_om] where n_shells is the total number of correlated or uncorrelated shells.
Empty if proj_type = None</p>
</dd>
<dt><strong>pAkw_orb</strong><span class="classifier">Dict of numpy arrays</span></dt><dd><p>(Correlated) k-resolved spectral function projected to atoms and
resolved into orbital contributions. 
This dictionary has the form of pAkw[n_shells][spn][n_k, n_om,dim,dim] where dim specifies the orbital dimension of the correlated/uncorrelated shell.
Empty if proj_type = None</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<a class="reference internal image-reference" href="../_images/DFT_Tools_SVO_DFT_spaghettis.png"><img alt="../_images/DFT_Tools_SVO_DFT_spaghettis.png" class="align-center" src="../_images/DFT_Tools_SVO_DFT_spaghettis.png" style="width: 1000px;" /></a>
<p>The figure above shows the DFT SrVO<sub>3</sub> spaghetti plot (generated using V t<sub>2g</sub> Wannier projectors generated within a correlated energy window of [-13.6, 13.6] eV). As before, the broadening input has been set to the temperature (i.e., 1/Beta). The left panel shows the total A(k, <span class="math notranslate nohighlight">\(\omega\)</span>) whereas the right gives the Wannier A(k, <span class="math notranslate nohighlight">\(\omega\)</span>), both generated from this SK.spaghettis().</p>
</section>
<section id="energy-contours-of-the-k-resolved-spectral-function">
<h2>Energy contours of the k-resolved Spectral function<a class="headerlink" href="#energy-contours-of-the-k-resolved-spectral-function" title="Link to this heading"></a></h2>
<p>Currently, this has only been implemented for Elk DFT inputs only.</p>
<p>This routine calculates the k-resolved spectral function evaluated at the Fermi level or several energy contours on the k-mesh defined in the converter stage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SK</span><span class="o">.</span><span class="n">spectral_contours</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">broadening</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">plot_range</span><span class="p">,</span> <span class="n">FS</span><span class="p">,</span> <span class="n">with_Sigma</span><span class="p">,</span> <span class="n">with_dc</span><span class="p">,</span> <span class="n">proj_type</span><span class="p">,</span> <span class="n">save_to_file</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">SumkDFTTools.</span></span><span class="sig-name descname"><span class="pre">spectral_contours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">broadening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_Sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_dc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_to_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/triqs_dft_tools/sumk_dft_tools.html#SumkDFTTools.spectral_contours"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculates the correlated spectral function at the Fermi level (relating to the Fermi
surface) or at specific frequencies.</p>
<p>The output files have three columns representing the k-point index, frequency and A(k,w) in that order. The output files are as follows:</p>
<ul class="simple">
<li><p><cite>Akw_(sp).dat</cite>, the total A(k,w)</p></li>
<li><p><cite>Akw_(proj_type)_(spn)_proj(i).dat</cite>, the A(k,w) projected to shell with index (i).</p></li>
<li><p><cite>Akw_(proj_type)_(spn)_proj(i)_(m)_(n).dat</cite>, as above, but for each (m) and (n) orbital contribution.</p></li>
</ul>
<p>The files are prepended with either of the following: 
For <cite>FS</cite> set to True the output files name include _FS_ and these files contain four columns which are the cartesian reciprocal coordinates (kx, ky, kz) and Akw. 
For <cite>FS</cite> set to False the output files name include _omega_(iom) (with <cite>iom</cite> being the frequency mesh index). These files also contain four columns  as described above along with a comment at the top of the file which gives the frequency value at which the spectral function was evaluated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mu</strong><span class="classifier">double, optional</span></dt><dd><p>Chemical potential, overrides the one stored in the hdf5 archive.
By default, this is automatically set to the chemical potential within the SK object.</p>
</dd>
<dt><strong>broadening</strong><span class="classifier">double, optional</span></dt><dd><p>Lorentzian broadening of the spectra to avoid any numerical artifacts.
If not given, standard value of lattice_gf (0.001 eV) is used.</p>
</dd>
<dt><strong>mesh</strong><span class="classifier">real frequency MeshType, optional</span></dt><dd><p>Omega mesh for the real-frequency Green’s function. 
Given as parameter to lattice_gf.</p>
</dd>
<dt><strong>plot_shift</strong><span class="classifier">double, optional</span></dt><dd><p>Offset [=(ik-1)*plot_shift, where ik is the index of the k-point] for each A(k,w) for stacked plotting of spectra.</p>
</dd>
<dt><strong>plot_range</strong><span class="classifier">list of double, optional</span></dt><dd><p>Sets the energy window for plotting to (plot_range[0],plot_range[1]).
If not provided, the min and max values of the energy mesh is used.</p>
</dd>
<dt><strong>FS</strong><span class="classifier">boolean</span></dt><dd><p>Flag for calculating the spectral function at the Fermi level (omega ~ 0)
If False, the spectral function will be generated for each frequency within 
plot_range.</p>
</dd>
<dt><strong>with_Sigma</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, the self energy is used for the calculation. 
If false, the DOS is calculated without self energy.
Both with_Sigma and with_dc equal to True is needed for DFT+DMFT A(k,w) calculated. 
Both with_Sigma and with_dc equal to false is needed for DFT A(k,w) calculated.</p>
</dd>
<dt><strong>with_dc</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True the double counting correction is used.</p>
</dd>
<dt><strong>proj_type</strong><span class="classifier">string, optional</span></dt><dd><p>The type of projection used for the orbital-projected DOS.
These projected spectral functions will be determined alongside the total spectral function.
By default, no projected DOS type will be calculated (the corresponding projected arrays will be empty).
The following options are:</p>
<ul class="simple">
<li><p><cite>None</cite> Only total DOS calculated</p></li>
<li><p><cite>wann</cite> Wannier DOS calculated from the Wannier projectors</p></li>
</ul>
</dd>
<dt><strong>save_to_file</strong><span class="classifier">boolean, optional</span></dt><dd><p>If True, text files with the calculated data will be created.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Akw</strong><span class="classifier">Dict of numpy arrays</span></dt><dd><p>(Correlated) k-resolved spectral function.
This dictionary has the form of <cite>Akw[spn][n_k, n_om]</cite> where spn, n_k and n_om are the spin, number of k-points, and number of frequencies used in the calculation.</p>
</dd>
<dt><strong>pAkw</strong><span class="classifier">Dict of numpy arrays</span></dt><dd><p>(Correlated) k-resolved spectral function projected to atoms (i.e., the Trace of the orbital-projected A(k,w)).
This dictionary has the form of pAkw[n_shells][spn][n_k, n_om] where n_shells is the total number of correlated or uncorrelated shells. Empty if <cite>proj_type = None</cite></p>
</dd>
<dt><strong>pAkw_orb</strong><span class="classifier">Dict of numpy arrays</span></dt><dd><p>(Correlated) k-resolved spectral function projected to atoms and
resolved into orbital contributions.
This dictionary has the form of pAkw[n_shells][spn][n_k, n_om,dim,dim] where dim specifies the orbital dimension of the correlated/uncorrelated shell. Empty if <cite>proj_type = None</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<a class="reference internal image-reference" href="../_images/DFT_Tools_SVO_DFT_energy_contours.png"><img alt="../_images/DFT_Tools_SVO_DFT_energy_contours.png" class="align-center" src="../_images/DFT_Tools_SVO_DFT_energy_contours.png" style="width: 1000px;" /></a>
<p>The figure above shows the DFT SrVO<sub>3</sub> energy contour plots (again, generated using V t<sub>2g</sub> Wannier projectors generated within a correlated energy window of [-13.6, 13,6] eV and broadening of 1/Beta). Both panels have been generated on a k-mesh within the first Brillouin zone on the k<sub>z</sub>= 0.0 plane centered at the <span class="math notranslate nohighlight">\(\Gamma\)</span> point. Here, each panel generated using the outputs from this SK.spectral_contours_plot() routine shows the A(k, <span class="math notranslate nohighlight">\(\omega\)</span>) evaluated at <span class="math notranslate nohighlight">\(\omega\)</span> = -0.5 eV (left) and the Fermi level, <span class="math notranslate nohighlight">\(\omega\)</span> = 0.0 eV, (right).</p>
</section>
<section id="partial-charges">
<h2>Partial charges<a class="headerlink" href="#partial-charges" title="Link to this heading"></a></h2>
<p>Currently, this has only been implemented for Wien2k DFT inputs only.</p>
<p>Since we can calculate the partial charges directly from the Matsubara Green functions, we also do not need a
real-frequency self energy for this purpose. The calculation is done by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SK</span><span class="o">.</span><span class="n">set_Sigma</span><span class="p">(</span><span class="n">SigmaImFreq</span><span class="p">)</span>
<span class="n">dm</span> <span class="o">=</span> <span class="n">SK</span><span class="o">.</span><span class="n">partial_charges</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">with_Sigma</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">with_dc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>which calculates the partial charges using the self energy, double counting, and chemical potential as set in the
<cite>SK</cite> object. On return, <cite>dm</cite> is a list, where the list items correspond to the density matrices of all shells
defined in the list <cite>SK.shells</cite>. This list is constructed by the Wien2k converter routines and stored automatically
in the hdf5 archive. For the structure of <cite>dm</cite>, see also <code class="xref py py-meth docutils literal notranslate"><span class="pre">partial</span> <span class="pre">charges</span></code>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="soc.html" class="btn btn-neutral float-left" title="Spin-orbit coupled calculations (single-shot)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="transport.html" class="btn btn-neutral float-right" title="Transport calculations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2021.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>