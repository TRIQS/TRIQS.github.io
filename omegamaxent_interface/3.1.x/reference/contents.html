<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Guide &mdash; omegamaxent_interface - An Interface to the OmegaMaxent Code  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f7f783a0" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            omegamaxent_interface - An Interface to the OmegaMaxent Code
          </a>
              <div class="version">
                3.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">User Guide</a><ul>
<li><a class="reference internal" href="#obtain-the-retarded-green-s-function">Obtain the retarded Green’s function</a></li>
<li><a class="reference internal" href="#input-parameters">Input parameters</a></li>
<li><a class="reference internal" href="#return-parameter">Return parameter</a></li>
<li><a class="reference internal" href="#id3">Interactive mode</a></li>
<li><a class="reference internal" href="#setting-errors">Setting errors</a><ul>
<li><a class="reference internal" href="#imaginary-time-data">Imaginary time data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#display-figures">Display figures</a></li>
<li><a class="reference internal" href="#frequency-grids">Frequency grids</a></li>
<li><a class="reference internal" href="#maximum-entropy-method-and-choice-of-entropy-weight-alpha">Maximum entropy method and choice of entropy weight <span class="math notranslate nohighlight">\(\alpha\)</span></a></li>
<li><a class="reference internal" href="#matrix-valued-functions">Matrix-valued functions</a></li>
<li><a class="reference internal" href="#id6">mu and nu</a></li>
<li><a class="reference internal" href="#simple-example-of-usage">Simple example of usage</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">omegamaxent_interface - An Interface to the OmegaMaxent Code</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">User Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reference/contents.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="user-guide">
<span id="userguide-ome-triqs"></span><h1>User Guide<a class="headerlink" href="#user-guide" title="Link to this heading"></a></h1>
<p>This is the user guide for the omegamaxent_interface.
The information presented here is sufficient for many cases, however, for a more advanced use, see the <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> <a class="reference external" href="https://www.physique.usherbrooke.ca/MaxEnt/index.php/User_Guide" rel="noopener noreferrer" target="_blank">user guide</a>.</p>
<p>In the following, we refer to the function to be analytically continued as the <em>“Green’s function”</em>, but it can be also a two-particle correlation function, a self-energy, or any function having a representation of the form</p>
<div class="math notranslate nohighlight" id="id1">
\[\mathbf{G}(i\omega_n)=\int_{-\infty}^{\infty} d\omega \frac{\mathbf{A}(\omega)}{i\omega_n-\omega},\qquad (1)\]</div>
<p>where <span class="math notranslate nohighlight">\(\omega_n\)</span> is a fermionic or bosonic Matsubara frequency, or</p>
<div class="math notranslate nohighlight" id="id2">
\[\mathbf{G}(\tau)=-\int_{-\infty}^{\infty} d\omega \frac{e^{-\omega\tau}\mathbf{A}(\omega)}{1\pm e^{-\beta\omega}},\qquad (2)\]</div>
<p>where the + and - signs apply to the fermionic and bosonic cases, respectively, and <span class="math notranslate nohighlight">\(\mathbf{A}(\omega)\)</span> is a positive semi-definite matrix in the fermionic case or <span class="math notranslate nohighlight">\(\mathbf{A}(\omega)/\omega\)</span> is positive semi-definite in the bosonic case.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code works internally with the imaginary frequency Green’s function. Therefore, if you provide <span class="math notranslate nohighlight">\(\mathbf{G}(\tau)\)</span>, it will be Fourier-transformed by the code before the analytic continuation begins.</p>
</div>
<section id="obtain-the-retarded-green-s-function">
<h2>Obtain the retarded Green’s function<a class="headerlink" href="#obtain-the-retarded-green-s-function" title="Link to this heading"></a></h2>
<p>Whether you have a scalar-, a matrix-valued or a block Green’s function, the real frequency Green’s function is obtained with the function <strong>compute_GfReFreq()</strong>, which takes a TRIQS Matsubara <a class="reference internal" href="#green-s-function">Green’s function</a> as input, and returns the corresponding <a class="reference internal" href="#retarded-green-s-function">retarded Green’s function</a>. The function signature is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GR</span><span class="o">=</span><span class="n">compute_GfReFreq</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">kwa</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="input-parameters">
<h2>Input parameters<a class="headerlink" href="#input-parameters" title="Link to this heading"></a></h2>
<dl id="green-s-function">
<dt><em>G:</em></dt><dd><p>Only mandatory parameter of type <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block.html" rel="noopener noreferrer" target="_blank">Gf</a>, <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block/GfImFreq.html" rel="noopener noreferrer" target="_blank">GfImFreq</a>, <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block/GfImTime.html" rel="noopener noreferrer" target="_blank">GfImTime</a>, or <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/full.html" rel="noopener noreferrer" target="_blank">BlockGf</a> containing objects of one of those types.</p>
<p>Input Matsubara Green’s function.</p>
</dd>
</dl>
<p>The following parameters, to be passed as keyword arguments, are the most common ones. The more advanced parameters are defined in the dictionaries <em>OmegaMaxEnt_input_params</em> and <em>OmegaMaxEnt_other_params</em> (defined in <em>OmegaMaxEnt_parameters.py</em>) and are described in details in the <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> <a class="reference external" href="https://www.physique.usherbrooke.ca/MaxEnt/index.php/User_Guide" rel="noopener noreferrer" target="_blank">user guide</a>:</p>
<dl id="err">
<dt><em>ERR:</em></dt><dd><p>Optional real or complex numpy array.</p>
<p>Standard deviation if <em>G</em> is scalar or has a single element.</p>
<p><em>ERR</em> must have the same shape as <em>G.data</em>.</p>
<p>See section <a class="reference internal" href="#setting-errors">Setting errors</a> for non-diagonal covariance matrix.</p>
</dd>
</dl>
<dl id="output-grid-params">
<dt><em>output_grid_params:</em></dt><dd><p>Optional list of the form <span class="math notranslate nohighlight">\([\omega_{min}, \Delta\omega, \omega_{max}]\)</span>.</p>
<p>Defines the minimum frequency, the frequency step, and the maximum frequency, respectively, of the frequency grid on   which the output Green’s function will be defined.</p>
<p>If not provided, the output grid is set by <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span>. See section <a class="reference internal" href="#frequency-grids">Frequency grids</a> for more details.</p>
<p>Note: this is not the grid used in the calculation, which can be set instead with <a class="reference internal" href="#comp-grid-params">comp_grid_params</a>.</p>
</dd>
<dt><em>name:</em></dt><dd><p>Optional string.</p>
<p>Name parameter of the returned <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block/GfReFreq.html" rel="noopener noreferrer" target="_blank">GfReFreq</a> object.</p>
</dd>
</dl>
<dl id="interactive-mode">
<dt><em>interactive_mode:</em></dt><dd><p>Optional boolean. Default: <em>True</em>.</p>
<p>See section <a class="reference internal" href="#id3">Interactive mode</a> for more details.</p>
</dd>
</dl>
<dl id="save-figures-data">
<dt><em>save_figures_data:</em></dt><dd><p>Optional boolean. Default: <em>True</em>  (scalar <em>G</em>  only).</p>
<p>If <em>G</em> is scalar, <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> saves files that allow to display the output figures after execution with the function <strong>display_figures()</strong>. See section <a class="reference internal" href="#display-figures">Display figures</a> for more details. Always <em>False</em> for non-scalar Green’s functions.</p>
</dd>
<dt><em>save_G:</em></dt><dd><p>Optional boolean. Default: <em>True</em>.</p>
<p>By default, the result is saved in hdf5 format as <em>‘G’</em>  in the file <em>G_Re_Freq.h5</em>.</p>
</dd>
</dl>
<dl id="comp-grid-params">
<dt><em>comp_grid_params:</em></dt><dd><p>Optional list of the form [<span class="math notranslate nohighlight">\(\Delta\omega\)</span>] or [<span class="math notranslate nohighlight">\(\Delta\omega\)</span>, SW] or [<span class="math notranslate nohighlight">\(\Delta\omega\)</span>, SW, SC].</p>
<p>Grid parameters used in the computation.</p>
<p><span class="math notranslate nohighlight">\(\Delta\omega\)</span> is the frequency step used in the main spectral region, namely, the part of the grid where most of the spectral weight is located. It can also be set separately with parameter <em>freq_step</em>.</p>
<p>SW is the width of the main spectral region (should be between 2 and 4 standard deviations typically). It can also be set separately with parameter <em>spectrum_width</em>.</p>
<p>SC is the center of the main spectral region. It can also be set separately with parameter <em>spectrum_center</em>.</p>
<p>See section <a class="reference internal" href="#frequency-grids">Frequency grids</a> for more details.</p>
</dd>
</dl>
<dl id="non-uniform-grid">
<dt><em>non_uniform_grid:</em></dt><dd><p>Optional boolean. Default: <em>False</em>.</p>
<p>Tells <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> to use a non-uniform grid in the main spectral region for the computation.</p>
<p>This accelerates the calculation if the spectrum has a peak at zero frequency that is very narrow compared to the total width of the spectrum. See section <a class="reference internal" href="#frequency-grids">Frequency grids</a> for more details.</p>
</dd>
</dl>
<dl id="inv-sym">
<dt><em>inv_sym:</em></dt><dd><p>Optional boolean. Default: <em>False</em>.</p>
<p>If <em>G</em> is a matrix or a <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/full.html" rel="noopener noreferrer" target="_blank">BlockGf</a>, set <em>inv_sym=True</em> if <span class="math notranslate nohighlight">\(G_{ji}=G_{ij}\)</span>. The calculation time for the off diagonal elements will then be halved.</p>
</dd>
</dl>
<dl id="mu-and-nu">
<dt><em>mu, nu:</em></dt><dd><p>Optional floats. Default: <em>mu=1, nu=1</em>.</p>
<p>Parameters involved in the calculation of off-diagonal elements of matrix-valued Green functions. See section <a class="reference internal" href="#matrix-valued-functions">Matrix-valued functions</a> for more details.</p>
</dd>
<dt><em>inv_sym_time:</em></dt><dd><p>Optional boolean. Default: <em>False</em>.</p>
<p>For <strong>bosonic</strong> Green’s function: if <span class="math notranslate nohighlight">\(G(i\omega_n)=G(-i\omega_n)\)</span>, i.e. <span class="math notranslate nohighlight">\(G(i\omega_n)\)</span> is purely real,
i.e. <span class="math notranslate nohighlight">\(G(\tau)=G(-\tau)\)</span>, i.e. <span class="math notranslate nohighlight">\(G(\beta-\tau)=G(\tau)\)</span>, set <em>inv_sym_time=True</em>. The MaxEnt calculation will then be
performed over positive real frequencies only.</p>
</dd>
</dl>
</section>
<section id="return-parameter">
<h2>Return parameter<a class="headerlink" href="#return-parameter" title="Link to this heading"></a></h2>
<p id="retarded-green-s-function"><em>GR:</em></p>
<blockquote>
<div><p><a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block/GfReFreq.html" rel="noopener noreferrer" target="_blank">GfReFreq</a> object or <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/full.html" rel="noopener noreferrer" target="_blank">BlockGf</a> of <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block/GfReFreq.html" rel="noopener noreferrer" target="_blank">GfReFreq</a> objects.</p>
<p>The retarded Green’s function.</p>
</div></blockquote>
</section>
<section id="id3">
<h2>Interactive mode<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<p>If <a class="reference internal" href="#interactive-mode">interactive_mode</a> <em>=True</em>, <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> displays figures during the execution. Also, if <em>displ_preproc_figs=True</em>, figures are displayed during the preprocessing stage. Otherwise, figures are displayed at the end of the calculation, showing the resulting Green’s function, along with different quantities used as diagnostic tools. Using those tools is very useful to assess, first, if the result is valid and, second, if it is the best result possible given the data. Therefore, when processing a set of data for the first time, it is strongly advised to use the interactive mode. Details about how to interpret the diagnostic quantities are given in the <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> <a class="reference external" href="https://www.physique.usherbrooke.ca/MaxEnt/index.php/User_Guide" rel="noopener noreferrer" target="_blank">user guide</a>.</p>
<p>You can also force the calculation to pause and display the results at different points by setting the minimal value of <a class="reference internal" href="#alpha">alpha</a> with parameter <em>alpha_min</em>, or by setting the maximum number of values of <a class="reference internal" href="#alpha">alpha</a> to be computed with parameter <em>n_alpha_values</em> and look at the results at different stages (i.e. different values of <a class="reference internal" href="#alpha">alpha</a>). If you use the latter option, you can resume the calculation at the point of interuption after closing the figures.</p>
<p>Note that you can change parameters during a pause by modifying the file <strong>OmegaMaxEnt_input_params.dat</strong> and the changes will be applied when execution is resumed at the point of interruption. For example, if you have set <em>alpha_min</em> to a certain value (that parameter will appear as <em>“minimum value of alpha:”</em> in the file), you can modify that value (or remove the corresponding line completely) during the pause occuring when <em>alpha_min</em> is reached, and resume the computation at the next value of <span class="math notranslate nohighlight">\(\alpha\)</span> after having closed the figures. On the other hand, if you would want to add a <em>new</em> parameter during a pause, say <em>new_param</em>, in <strong>OmegaMaxEnt_input_params.dat</strong> you have to define it using the string <em>OmegaMaxEnt_input_params[‘new_param’]</em>. The parameter names are only understood by the python interface.</p>
<p>When the calculation is over and you are satisfied with the result displayed, you can exit the execution by closing all the figures and entering any character other than <em>‘y’</em>  in the terminal. This will resume the execution of the python function <strong>compute_GfReFreq()</strong>.</p>
<p>If <em>interactive_mode=False</em>, <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> will not display any figure and <strong>compute_GfReFreq()</strong> will resume as soon as the calculation is over.</p>
<p>If you find that there are too many figures, instead of completely disable the interactive mode to eliminate all of them, you can reduce the number of figures displayed by setting to <em>False</em> one of the parameters: <em>displ_alpha_opt_figs</em>, <em>displ_alpha_min_figs</em> and <em>displ_alpha_curves</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the continuation of <strong>matrix-valued</strong> Green’s functions, <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> is called  the same number of times as there are elements in the matrix (or in the upper part if <em>inv_sym=True</em>). If you are in interactive mode, figures showing the result will appear each time and, once you have closed them, you have to tell the program <strong>not</strong> to continue execution, to let the analytic continuation of the matrix or block function continue.</p>
</div>
</section>
<section id="setting-errors">
<h2>Setting errors<a class="headerlink" href="#setting-errors" title="Link to this heading"></a></h2>
<p>In the current version, you can provide errors only for a scalar-valued Green’s function. If the covariance matrix is diagonal, you can use parameter <a class="reference internal" href="#err">ERR</a> to provide the standard deviation as a real or complex numpy array having the same shape as <em>G.data</em>. For a non-diagonal covariance, you can provide the name of the files containing the covariance matrix with parameter <em>cov_tau</em> for imaginary time data or <em>cov_re_re</em>, <em>cov_im_im</em> and <em>cov_re_im</em> for imaginary frequency data. The file type must be one of the valid <a class="reference external" href="http://arma.sourceforge.net/docs.html#save_load_mat" rel="noopener noreferrer" target="_blank">armadillo types</a>.</p>
<p>For matrix-valued Green’s function, the error is assumed to be constant. The value of that constant is not relevant since it has no effect on the results.</p>
<section id="imaginary-time-data">
<h3>Imaginary time data<a class="headerlink" href="#imaginary-time-data" title="Link to this heading"></a></h3>
<p>If your data is a scalar <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block/GfImTime.html" rel="noopener noreferrer" target="_blank">GfImTime</a> and you do not have an estimate of the error, or the error is constant, do not provide errors. Otherwise, because <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> works internally in Matsubara frequency, it will Fourier transform the covariance matrix, which takes time, but is not useful in that case because the result will also be a constant diagonal covariance in frequency, while the result does not depend on the absolute value of the error.</p>
<p>On the other hand, if the error depends on <span class="math notranslate nohighlight">\(\tau\)</span> and you <em>do</em> provide errors, either with parameter <em>ERR</em> or <em>cov_tau</em> (file name for a covariance matrix), note that the Fourier transform of the Green function is saved by default as a <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block/GfImFreq.html" rel="noopener noreferrer" target="_blank">GfImFreq</a> object called <em>‘G’</em> in file <em>G_im_freq.h5</em> and the Fourier transform of the covariance matrix is saved in files <em>covar_ReRe.dat</em>, <em>covar_ImIm.dat</em> and <em>covar_ReIm.dat</em> in directory <em>Fourier_transformed_data</em>. This can be useful if you want to perform the continuation again on the same data, without having to wait during the Fourier transform of the covariance matrix, which takes some time if there are many <span class="math notranslate nohighlight">\(\tau\)</span> points. To do so, you pass to <strong>compute_GfReFreq()</strong> the saved <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block/GfImFreq.html" rel="noopener noreferrer" target="_blank">GfImFreq</a> object and the paths to the covariance files with parameters <em>cov_re_re</em>, <em>cov_im_im</em> and <em>cov_re_im</em> instead of the original <a class="reference external" href="https://triqs.github.io/triqs/latest/documentation/manual/triqs/gfs/py/block/GfImTime.html" rel="noopener noreferrer" target="_blank">GfImTime</a> object and the error on <span class="math notranslate nohighlight">\(G(\tau)\)</span> with <em>ERR</em>.</p>
</section>
</section>
<section id="display-figures">
<h2>Display figures<a class="headerlink" href="#display-figures" title="Link to this heading"></a></h2>
<p>For a scalar Green’s function, if <a class="reference internal" href="#save-figures-data">save_figures_data</a> =True, regardless of the value of <em>interactive_mode</em>, you can display the same figures that are displayed in interactive mode by calling the function <strong>display_figures()</strong> after the execution of <strong>compute_GfReFreq()</strong>. For the matrix case, <em>save_figures_data</em> is always <em>False</em>. Details about the output figures are given in the <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> <a class="reference external" href="https://www.physique.usherbrooke.ca/MaxEnt/index.php/User_Guide" rel="noopener noreferrer" target="_blank">user guide</a>.</p>
</section>
<section id="frequency-grids">
<h2>Frequency grids<a class="headerlink" href="#frequency-grids" title="Link to this heading"></a></h2>
<p>There are two different real frequency grids: the <em>output grid</em> and the <em>computational grid</em>.</p>
<p>The output grid is the grid on which the output Green’s function is defined. You can control it with parameter <a class="reference internal" href="#output-grid-params">output_grid_params</a>. This frequency grid has a uniform density and is defined between <span class="math notranslate nohighlight">\(\omega_{min}\)</span> and <span class="math notranslate nohighlight">\(\omega_{max}\)</span> with a step <span class="math notranslate nohighlight">\(\Delta\omega\)</span>. This is an optional parameter. If not provided, <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> generates an output frequency grid that is usually well adapted to the spectrum.</p>
<p>For computational efficiency reasons, the real frequency grid used in the calculation is different from the output grid. In many cases the default computational grid generated by <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> is well suited to the spectrum and there is no need to modify it. It can however happen that the calculation fails (no optimal value of <a class="reference internal" href="#alpha">alpha</a> is found) because the default grid is not appropriate. Even when the calculation terminates successfully, the result might not always be as disired. For those cases you can use the input parameter <a class="reference internal" href="#comp-grid-params">comp_grid_params</a> to control the computational grid in the region where most of the spectral weight is located. Outside that region, a particular non-uniform grid is always used by <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span>. More advanced parameters are also available to control the computational grid in the dictionary <em>OmegaMaxEnt_input_params</em> (section FREQUENCY GRID PARAMETERS in <em>OmegaMaxEnt_parameters.py</em>). See the <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> <a class="reference external" href="https://www.physique.usherbrooke.ca/MaxEnt/index.php/User_Guide" rel="noopener noreferrer" target="_blank">user guide</a> for more details on those parameters.</p>
<p>For a spectrum having a peak centered at zero frequency that is very narrow compared to the total width of the spectrum, a simple way to optimize the computational grid is to set <a class="reference internal" href="#non-uniform-grid">non_uniform_grid</a> =True. <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> will then use a grid with a density that is high in a narrow region around <span class="math notranslate nohighlight">\(\omega=0\)</span> and decreases as <span class="math notranslate nohighlight">\(|\omega|\)</span> increases. The detailed definition of this grid are given in the <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> <a class="reference external" href="https://www.physique.usherbrooke.ca/MaxEnt/index.php/User_Guide" rel="noopener noreferrer" target="_blank">user guide</a>.</p>
</section>
<section id="maximum-entropy-method-and-choice-of-entropy-weight-alpha">
<span id="alpha"></span><h2>Maximum entropy method and choice of entropy weight <span class="math notranslate nohighlight">\(\alpha\)</span><a class="headerlink" href="#maximum-entropy-method-and-choice-of-entropy-weight-alpha" title="Link to this heading"></a></h2>
<p>The maximum entropy method consists in minimizing the functional</p>
<div class="math notranslate nohighlight">
\[Q_\alpha[A]=\chi^2-\alpha S\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\chi^2=\left(G-\mathbf{K}A\right)^T C^{-1}\left(G-\mathbf{K}A\right),\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is the input data vector, <span class="math notranslate nohighlight">\(A\)</span> is a vector containing the spectrum values on a discretized frequency grid, <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is a matrix such that <span class="math notranslate nohighlight">\(\mathbf{K}A\)</span> performs the integral <a class="reference internal" href="#id1">(1)</a> (in <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span>, but also <a class="reference internal" href="#id2">(2)</a> or another representation in general), <span class="math notranslate nohighlight">\(C\)</span> is the data’s covariance matrix, <span class="math notranslate nohighlight">\(\alpha\)</span> is an adjustable parameter, and <span class="math notranslate nohighlight">\(S\)</span> is a differential entropy, defined as</p>
<div class="math notranslate nohighlight">
\[S=-\int d\omega \left [A(\omega) \ln \left(\frac{A(\omega)}{D(\omega)}\right)-A(\omega)+D(\omega)\right],\]</div>
<p>where <span class="math notranslate nohighlight">\(D(\omega)\)</span> is called the <em>default model</em> and is the solution that minimizes <span class="math notranslate nohighlight">\(Q\)</span> if <span class="math notranslate nohighlight">\(\chi^2\)</span> is negligible, i.e., at very large <span class="math notranslate nohighlight">\(\alpha\)</span>. <span class="math notranslate nohighlight">\(D(\omega)\)</span> is defined in a way to include information known in advanced about the spectrum. By default, in <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span>, <span class="math notranslate nohighlight">\(D(\omega)\)</span> is a gaussian with the same norm and first two moments associated with <span class="math notranslate nohighlight">\(A(\omega)\)</span>, which are extracted from the input data.</p>
<p>The weight <span class="math notranslate nohighlight">\(\alpha\)</span> of the entropy term can be chosen in <a class="reference external" href="https://triqs.github.io/maxent/jenkins/basicnotions/maxentflavors.html#maxent-flavors" rel="noopener noreferrer" target="_blank">different ways</a>. In <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span>, the spectra are computed for a large range of <span class="math notranslate nohighlight">\(\alpha\)</span>, starting at large <span class="math notranslate nohighlight">\(\alpha\)</span>, and the optimal value is chosen where the curvature of <span class="math notranslate nohighlight">\(log(\chi^2)\)</span> as a function of <span class="math notranslate nohighlight">\(\gamma log(\alpha)\)</span> is maximal <a class="footnote-reference brackets" href="#ome" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. Here <span class="math notranslate nohighlight">\(\gamma&lt;1\)</span> (parameter name: <em>gamma</em>) reduces the probability of a wrong value of <span class="math notranslate nohighlight">\(\alpha\)</span> to be chosen (default value: <span class="math notranslate nohighlight">\(\gamma=0.2\)</span>). Despite the use of <span class="math notranslate nohighlight">\(\gamma\)</span> and some smoothing of the curve <span class="math notranslate nohighlight">\(log(\chi^2)\)</span> vs <span class="math notranslate nohighlight">\(\gamma log(\alpha)\)</span> in the computation of the curvature, there is still a chance that a wrong value of <span class="math notranslate nohighlight">\(\alpha\)</span> will be selected because of some irregularities in <span class="math notranslate nohighlight">\(log(\chi^2)\)</span> vs <span class="math notranslate nohighlight">\(\gamma log(\alpha)\)</span> that produce parasitic peaks in the curvature. This is one of the reasons why the diagnostic tools are useful.</p>
</section>
<section id="matrix-valued-functions">
<h2>Matrix-valued functions<a class="headerlink" href="#matrix-valued-functions" title="Link to this heading"></a></h2>
<p>If the Green’s function is matrix-valued, the calculation is done using the auxiliary Green’s function approach described in <a class="footnote-reference brackets" href="#auxme" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and also in appendix C of the <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span> <a class="reference external" href="https://www.physique.usherbrooke.ca/MaxEnt/index.php/User_Guide" rel="noopener noreferrer" target="_blank">user guide</a>. In that calculation, the off-diagonal elements of the retarded function are obtained <em>indirectly</em> from the spectral functions of the diagonal elements and auxiliary functions that are linear combinations of diagonal and non-diagonal elements. Those auxiliary functions are constructed to have positive semi-definite spectral functions, so that they can be computed with the standard maximum entropy approach. As for the diagonal elements (of the form <span class="math notranslate nohighlight">\(\langle T_{\tau} c_i(\tau) c_i^\dagger\rangle\)</span>), they always have positive semi-definite spectral functions. Therefore, in that calculation, the retarded functions corresponding to the diagonal and the auxiliary Matsubara functions are first computed with <span class="math notranslate nohighlight">\(\Omega MaxEnt\)</span>, and are then combined at the python level to obtain the retarded off-diagonal elements.</p>
</section>
<section id="id6">
<h2>mu and nu<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<p>For Green or correlation functions of the form <span class="math notranslate nohighlight">\(\langle T_{\tau} o_i(\tau) o_j^\dagger\rangle\)</span>, where <span class="math notranslate nohighlight">\(o_i\)</span> and <span class="math notranslate nohighlight">\(o_j\)</span> are operators corresponding to the same type of excitations, e.g. electronic excitations, the parameters <a class="reference internal" href="#mu-and-nu">mu and nu</a> should be left equal to 1. On the other hand, for a correlation function of the form <span class="math notranslate nohighlight">\(\langle T_{\tau} p(\tau) q^\dagger\rangle\)</span>, where <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> correspond to different types of excitations, different values of <a class="reference internal" href="#mu-and-nu">mu and nu</a> should be tried to find a stable result. See Ref. <a class="footnote-reference brackets" href="#auxme" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> for more details.</p>
<p>If your matrix Green’s function has the symmetry <span class="math notranslate nohighlight">\(G_{ji}=G_{ij}\)</span>, set <a class="reference internal" href="#inv-sym">inv_sym</a> =True. Then, only the upper part of the matrix will actually be computed, which reduces the required computational demand by a factor of two.</p>
</section>
<section id="simple-example-of-usage">
<h2>Simple example of usage<a class="headerlink" href="#simple-example-of-usage" title="Link to this heading"></a></h2>
<p>Suppose you have saved a Matsubara Green’s function as a TRIQS object ‘G’ in a hdf5 file “G.h5”. The quickest way to obtain the corresponding
real frequency Green’s function is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">h5</span> <span class="kn">import</span> <span class="n">HDFArchive</span> <span class="k">as</span> <span class="n">HA</span>
<span class="kn">import</span> <span class="nn">OmegaMaxEnt_TRIQS</span> <span class="k">as</span> <span class="nn">OT</span>

<span class="c1">#load the Matsubara Green&#39;s function</span>
<span class="k">with</span> <span class="n">HA</span><span class="p">(</span><span class="s2">&quot;G.h5&quot;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">A</span><span class="p">:</span>
    <span class="n">G</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="s1">&#39;G&#39;</span><span class="p">]</span>

<span class="c1">#obtain the retarded Green&#39;s function</span>
<span class="n">GR</span><span class="o">=</span><span class="n">OT</span><span class="o">.</span><span class="n">compute_GfReFreq</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionally, if you know that the spectrum has a sharp peak at <span class="math notranslate nohighlight">\(\omega=0\)</span> and that the spectrum is mostly located between <span class="math notranslate nohighlight">\(\omega=-2\)</span> and <span class="math notranslate nohighlight">\(\omega=2\)</span>, you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dw</span><span class="o">=</span><span class="mf">0.001</span>
<span class="n">SW</span><span class="o">=</span><span class="mi">4</span>

<span class="n">GR</span><span class="o">=</span><span class="n">OT</span><span class="o">.</span><span class="n">compute_GfReFreq</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">comp_grid_params</span><span class="o">=</span><span class="p">[</span><span class="n">Dw</span><span class="p">,</span><span class="n">SW</span><span class="p">],</span> <span class="n">non_uniform_grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>For more advanced examples, see the <a class="reference internal" href="../tutorials.html#ome-triqs-tutorials"><span class="std std-ref">tutorials</span></a>.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="ome" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.94.023303" rel="noopener noreferrer" target="_blank">D.Bergeron and A.-M.S. Tremblay. Phys. Rev. E, 94:023303, 2016</a></p>
</aside>
<aside class="footnote brackets" id="auxme" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id5">1</a>,<a role="doc-backlink" href="#id7">2</a>)</span>
<p><a class="reference external" href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.95.121104" rel="noopener noreferrer" target="_blank">A. Reymbaut, A.-M. Gagnon, D. Bergeron, A.-M. S. Tremblay. Phys. Rev. B 95:121104, 2017</a></p>
</aside>
</aside>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2022 The Simons Foundation, authors: N. Wentzell, D. Bergeron.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>