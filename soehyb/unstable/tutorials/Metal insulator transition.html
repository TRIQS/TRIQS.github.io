<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Metal insulator transition &mdash; triqs_soehyb  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f7f783a0" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../_static/triqs_favicon.ico"/>
  
        <script src="../_static/jquery.js?v=8dae8fb0"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reporting issues" href="../issues.html" />
    <link rel="prev" title="Semi-infinite chain" href="Semi%20infinite%20chain.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            triqs_soehyb
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install soehyb</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-soehyb-from-source">Compiling soehyb from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#background">Background</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../background/ppsc.html">A word on the algorithm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#user-guide">User guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/Step%20by%20step.html">Step-by-step guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Step%20by%20step.html#Step-1---Spawn-solver-instance">Step 1 - Spawn solver instance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Step%20by%20step.html#Step-2---Impurity-many-body-Hamiltonian">Step 2 - Impurity many-body Hamiltonian</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../user_guide/Step%20by%20step.html#Examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Step%20by%20step.html#Step-3---Hybridization-function">Step 3 - Hybridization function</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../user_guide/Step%20by%20step.html#id1">Examples</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Step%20by%20step.html#Step-4---Self-consistent-solution">Step 4 - Self-consistent solution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Step%20by%20step.html#Step-5---Single-particle-response-function">Step 5 - Single particle response function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Step%20by%20step.html#Step-6---Store-solver-to-disk">Step 6 - Store solver to disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Step%20by%20step.html#Step-7---Read-result-from-disk">Step 7 - Read result from disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/Step%20by%20step.html#Step-7---Postprocessing-and-visualization">Step 7 - Postprocessing and visualization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../documentation.html#tutorials">Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Semi%20infinite%20chain.html">Semi-infinite chain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Semi%20infinite%20chain.html#Initialization">Initialization</a></li>
<li class="toctree-l4"><a class="reference internal" href="Semi%20infinite%20chain.html#Hybridization-function">Hybridization function</a></li>
<li class="toctree-l4"><a class="reference internal" href="Semi%20infinite%20chain.html#Local-many-body-Hamiltonian">Local many-body Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="Semi%20infinite%20chain.html#Run-solver">Run solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="Semi%20infinite%20chain.html#Visualization">Visualization</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Metal insulator transition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Solver-setup">Solver setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Local-Hubbard-interaction">Local Hubbard interaction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#DMFT-self-consistency">DMFT self-consistency</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Solve-NCA-and-OCA-for-a-sweep-in-U">Solve NCA and OCA for a sweep in <span class="math notranslate nohighlight">\(U\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#Load-result">Load result</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Visualization">Visualization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#python-reference-manual">Python reference manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../documentation.html#triqs_soehyb.triqs_solver.TriqsSolver"><code class="docutils literal notranslate"><span class="pre">TriqsSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation.html#triqs_soehyb.triqs_solver.TriqsSolver.solve"><code class="docutils literal notranslate"><span class="pre">TriqsSolver.solve()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-0-0-1">Version 0.0.1</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">triqs_soehyb</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../documentation.html">Documentation</a></li>
      <li class="breadcrumb-item active">Metal insulator transition</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/Metal insulator transition.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Metal-insulator-transition">
<h1>Metal insulator transition<a class="headerlink" href="#Metal-insulator-transition" title="Link to this heading"></a></h1>
<p>The half-filled Hubbard model undergoes a transition from a metallic state to an (Mott) insulating state when increasing the interaction strength <span class="math notranslate nohighlight">\(U\)</span>. One model where this can be solved exactly is the Hubbard model on the Bethe graph in the limit of infinite connectivity. In this limit Dynamical Mean Field Theory (DMFT) is exact and can be used to study the transition.</p>
<p>The DMFT lattice self-consistency relation on the Bethe graph has the form</p>
<div class="math notranslate nohighlight">
\[\Delta_\sigma(\tau) = t^2 G_\sigma(\tau)\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta_\sigma(\tau)\)</span> is the hybridization function, <span class="math notranslate nohighlight">\(G_\sigma(\tau)\)</span> is the local single particle Green’s function with spin <span class="math notranslate nohighlight">\(\sigma \in \{\uparrow, \downarrow\}\)</span>, and we set the nearest neighbour hoppint <span class="math notranslate nohighlight">\(t\)</span> to unity (<span class="math notranslate nohighlight">\(t=1\)</span>).</p>
<p>At low temperature the transition is first order, but at higher temperatures it turns into a cross over. Here we will study this crossover at inverse temperature <span class="math notranslate nohighlight">\(\beta = 5\)</span>.</p>
<section id="Solver-setup">
<h2>Solver setup<a class="headerlink" href="#Solver-setup" title="Link to this heading"></a></h2>
<p>Since we will be performing self-consistent DMFT calculations we modularize the solver setup using a helper function <code class="docutils literal notranslate"><span class="pre">setup_solver()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">triqs_soehyb</span> <span class="kn">import</span> <span class="n">Solver</span>

<span class="kn">from</span> <span class="nn">triqs.gf</span> <span class="kn">import</span> <span class="n">make_gf_dlr_imtime</span><span class="p">,</span> <span class="n">make_gf_dlr_imfreq</span><span class="p">,</span> <span class="n">SemiCircular</span>

<span class="k">def</span> <span class="nf">setup_solver</span><span class="p">():</span>

    <span class="n">S</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span>
        <span class="n">beta</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="c1"># Inverse temperature</span>
        <span class="n">gf_struct</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;do&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="c1"># Green&#39;s function structure 1st index: name, 2nd index: dimension of subspace</span>
        <span class="n">eps</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="c1"># Accuracy of Discrete Lehmann Representation (DLR) used for imaginary time response functions</span>
        <span class="n">w_max</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="c1"># DLR freqiency cut-off (the spectrum of the model must be in the range [-w_max, +w_max]</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">bidx</span><span class="p">,</span> <span class="n">delta_tau</span> <span class="ow">in</span> <span class="n">S</span><span class="o">.</span><span class="n">Delta_tau</span><span class="p">:</span>
        <span class="n">delta_w</span> <span class="o">=</span> <span class="n">make_gf_dlr_imfreq</span><span class="p">(</span><span class="n">delta_tau</span><span class="p">)</span>
        <span class="n">delta_w</span> <span class="o">&lt;&lt;</span> <span class="n">SemiCircular</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">delta_tau</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">make_gf_dlr_imtime</span><span class="p">(</span><span class="n">delta_w</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">S</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Warning: could not identify MPI environment!
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Starting serial run at: 2025-08-19 17:41:44.159873
</pre></div></div>
</div>
</section>
<section id="Local-Hubbard-interaction">
<h2>Local Hubbard interaction<a class="headerlink" href="#Local-Hubbard-interaction" title="Link to this heading"></a></h2>
<p>The local interaction in the Hubbard model has the form</p>
<div class="math notranslate nohighlight">
\[H_{int} = U n_\uparrow n_\downarrow - \mu ( n_\uparrow + n_\downarrow )\]</div>
<p>where <span class="math notranslate nohighlight">\(U\)</span> is the so called Hubbard-<span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span> is the chemical potential, which at half filling is given by <span class="math notranslate nohighlight">\(\mu = U/2\)</span>. The helper function <code class="docutils literal notranslate"><span class="pre">get_h_int(U)</span></code> constructs the local Hamiltonian using Triqs second-quantization operators.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">triqs.operators</span> <span class="kn">import</span> <span class="n">n</span>

<span class="k">def</span> <span class="nf">get_h_int</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mu</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">U</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">h_int</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;do&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span> <span class="o">*</span> <span class="p">(</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;do&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">h_int</span>

<span class="n">h_int</span> <span class="o">=</span> <span class="n">get_h_int</span><span class="p">(</span><span class="n">U</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;h_int = </span><span class="si">{</span><span class="n">h_int</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
h_int = -2.5*c_dag(&#39;do&#39;,0)*c(&#39;do&#39;,0) + -2.5*c_dag(&#39;up&#39;,0)*c(&#39;up&#39;,0) + 5*c_dag(&#39;do&#39;,0)*c_dag(&#39;up&#39;,0)*c(&#39;up&#39;,0)*c(&#39;do&#39;,0)
</pre></div></div>
</div>
</section>
<section id="DMFT-self-consistency">
<h2>DMFT self-consistency<a class="headerlink" href="#DMFT-self-consistency" title="Link to this heading"></a></h2>
<p>Finally we design a function <code class="docutils literal notranslate"><span class="pre">solve_dmft_self_consistency(S,</span> <span class="pre">h_int,</span> <span class="pre">order,</span> <span class="pre">...)</span></code> that takes a solver <code class="docutils literal notranslate"><span class="pre">S</span></code>, a local Hamiltonian <code class="docutils literal notranslate"><span class="pre">h_int</span></code>, the wanted expansion <code class="docutils literal notranslate"><span class="pre">order</span></code>, and performs the DMFT self-consistency iterations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">solve_dmft_self_consistency</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">h_int</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span>
                                <span class="n">dmft_maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">dmft_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">dmft_iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dmft_maxiter</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>

        <span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">h_int</span><span class="o">=</span><span class="n">h_int</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Delta_tau</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span> <span class="n">S</span><span class="o">.</span><span class="n">G_tau</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DMFT: dmft_iter = </span><span class="si">{</span><span class="n">dmft_iter</span><span class="si">}</span><span class="s1">, diff = </span><span class="si">{</span><span class="n">diff</span><span class="si">:</span><span class="s1">2.2E</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="n">dmft_tol</span><span class="p">:</span> <span class="k">break</span>

        <span class="n">S</span><span class="o">.</span><span class="n">Delta_tau</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">G_tau</span> <span class="c1"># DMFT Bethe lattice self consistency</span>

    <span class="n">S</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">get_expectation_value</span><span class="p">(</span><span class="n">n</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;do&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">real</span>
    <span class="n">S</span><span class="o">.</span><span class="n">n_up</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">get_expectation_value</span><span class="p">(</span><span class="n">n</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">real</span>
    <span class="n">S</span><span class="o">.</span><span class="n">n_do</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">S</span><span class="o">.</span><span class="n">get_expectation_value</span><span class="p">(</span><span class="n">n</span><span class="p">(</span><span class="s1">&#39;do&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">real</span>

    <span class="k">return</span> <span class="n">S</span>
</pre></div>
</div>
</div>
</section>
<section id="Solve-NCA-and-OCA-for-a-sweep-in-U">
<h2>Solve NCA and OCA for a sweep in <span class="math notranslate nohighlight">\(U\)</span><a class="headerlink" href="#Solve-NCA-and-OCA-for-a-sweep-in-U" title="Link to this heading"></a></h2>
<p>To study the metal-insulator cross over we solve the Hubbard model on the Bethe graph for a range of <span class="math notranslate nohighlight">\(U\)</span> values at first and second expansion order (a.k.a. the non-crossing and one-crossing approximation NCA/OCA).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">orders</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">Us</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">orders</span><span class="p">:</span>

    <span class="n">S</span> <span class="o">=</span> <span class="n">setup_solver</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">U</span> <span class="ow">in</span> <span class="n">Us</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; order = </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">, U = </span><span class="si">{</span><span class="n">U</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">S</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="n">U</span>
        <span class="n">h_int</span> <span class="o">=</span> <span class="n">get_h_int</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>

        <span class="n">S</span> <span class="o">=</span> <span class="n">solve_dmft_self_consistency</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">h_int</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>

        <span class="n">filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;data_order_</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">_U_</span><span class="si">{</span><span class="n">U</span><span class="si">:</span><span class="s1">011.8f</span><span class="si">}</span><span class="s1">.h5&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; Storing: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">A</span><span class="p">:</span>
            <span class="n">A</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
  ___      ___    _  ___   _____
 / __| ___| __|__| || \ \ / / _ )
 \__ \/ _ \ _|___| __ |\ V /| _ \
 |___/\___/___|  |_||_| |_| |___/  [github.com/TRIQS/soehyb]

beta = 5.0, lamb = 5.00E+01, eps = 1.00E-12, N_DLR = 27
fundamental_operators = [1*c(&#39;up&#39;,0), 1*c(&#39;do&#39;,0)]
H_mat.shape = (4, 4)
H_loc = 0

--&gt; order = 1, U = 3.0
DMFT: dmft_iter = 1, diff = 1.27E-01
DMFT: dmft_iter = 2, diff = 1.24E-02
DMFT: dmft_iter = 3, diff = 1.58E-03
DMFT: dmft_iter = 4, diff = 3.43E-04
DMFT: dmft_iter = 5, diff = 6.34E-05
DMFT: dmft_iter = 6, diff = 1.24E-05
DMFT: dmft_iter = 7, diff = 2.39E-06
DMFT: dmft_iter = 8, diff = 4.62E-07
--&gt; Storing: data_order_1_U_03.00000000.h5
--&gt; order = 1, U = 4.0
DMFT: dmft_iter = 1, diff = 4.31E-02
DMFT: dmft_iter = 2, diff = 1.11E-02
DMFT: dmft_iter = 3, diff = 3.24E-03
DMFT: dmft_iter = 4, diff = 9.52E-04
DMFT: dmft_iter = 5, diff = 2.83E-04
DMFT: dmft_iter = 6, diff = 8.44E-05
DMFT: dmft_iter = 7, diff = 2.52E-05
DMFT: dmft_iter = 8, diff = 7.50E-06
DMFT: dmft_iter = 9, diff = 2.24E-06
DMFT: dmft_iter = 10, diff = 6.68E-07
--&gt; Storing: data_order_1_U_04.00000000.h5
--&gt; order = 1, U = 5.0
DMFT: dmft_iter = 1, diff = 3.63E-02
DMFT: dmft_iter = 2, diff = 5.84E-03
DMFT: dmft_iter = 3, diff = 1.63E-03
DMFT: dmft_iter = 4, diff = 4.16E-04
DMFT: dmft_iter = 5, diff = 1.06E-04
DMFT: dmft_iter = 6, diff = 2.69E-05
DMFT: dmft_iter = 7, diff = 6.85E-06
DMFT: dmft_iter = 8, diff = 1.74E-06
DMFT: dmft_iter = 9, diff = 4.42E-07
--&gt; Storing: data_order_1_U_05.00000000.h5
--&gt; order = 1, U = 6.0
DMFT: dmft_iter = 1, diff = 3.04E-02
DMFT: dmft_iter = 2, diff = 2.63E-03
DMFT: dmft_iter = 3, diff = 5.08E-04
DMFT: dmft_iter = 4, diff = 1.05E-04
DMFT: dmft_iter = 5, diff = 2.09E-05
DMFT: dmft_iter = 6, diff = 4.09E-06
DMFT: dmft_iter = 7, diff = 8.00E-07
--&gt; Storing: data_order_1_U_06.00000000.h5
  ___      ___    _  ___   _____
 / __| ___| __|__| || \ \ / / _ )
 \__ \/ _ \ _|___| __ |\ V /| _ \
 |___/\___/___|  |_||_| |_| |___/  [github.com/TRIQS/soehyb]

beta = 5.0, lamb = 5.00E+01, eps = 1.00E-12, N_DLR = 27
fundamental_operators = [1*c(&#39;up&#39;,0), 1*c(&#39;do&#39;,0)]
H_mat.shape = (4, 4)
H_loc = 0

--&gt; order = 2, U = 3.0
DMFT: dmft_iter = 1, diff = 8.02E-02
DMFT: dmft_iter = 2, diff = 3.40E-03
DMFT: dmft_iter = 3, diff = 3.65E-04
DMFT: dmft_iter = 4, diff = 5.09E-05
DMFT: dmft_iter = 5, diff = 7.03E-06
DMFT: dmft_iter = 6, diff = 9.69E-07
--&gt; Storing: data_order_2_U_03.00000000.h5
--&gt; order = 2, U = 4.0
DMFT: dmft_iter = 1, diff = 4.58E-02
DMFT: dmft_iter = 2, diff = 1.46E-02
DMFT: dmft_iter = 3, diff = 6.23E-03
DMFT: dmft_iter = 4, diff = 2.71E-03
DMFT: dmft_iter = 5, diff = 1.20E-03
DMFT: dmft_iter = 6, diff = 5.39E-04
DMFT: dmft_iter = 7, diff = 2.42E-04
DMFT: dmft_iter = 8, diff = 1.09E-04
DMFT: dmft_iter = 9, diff = 4.91E-05
DMFT: dmft_iter = 10, diff = 2.22E-05
DMFT: dmft_iter = 11, diff = 9.99E-06
DMFT: dmft_iter = 12, diff = 4.50E-06
DMFT: dmft_iter = 13, diff = 2.03E-06
DMFT: dmft_iter = 14, diff = 9.16E-07
--&gt; Storing: data_order_2_U_04.00000000.h5
--&gt; order = 2, U = 5.0
DMFT: dmft_iter = 1, diff = 4.13E-02
DMFT: dmft_iter = 2, diff = 1.34E-02
DMFT: dmft_iter = 3, diff = 6.27E-03
DMFT: dmft_iter = 4, diff = 2.80E-03
DMFT: dmft_iter = 5, diff = 1.23E-03
DMFT: dmft_iter = 6, diff = 5.41E-04
DMFT: dmft_iter = 7, diff = 2.37E-04
DMFT: dmft_iter = 8, diff = 1.04E-04
DMFT: dmft_iter = 9, diff = 4.56E-05
DMFT: dmft_iter = 10, diff = 2.00E-05
DMFT: dmft_iter = 11, diff = 8.75E-06
DMFT: dmft_iter = 12, diff = 3.84E-06
DMFT: dmft_iter = 13, diff = 1.68E-06
DMFT: dmft_iter = 14, diff = 7.37E-07
--&gt; Storing: data_order_2_U_05.00000000.h5
--&gt; order = 2, U = 6.0
DMFT: dmft_iter = 1, diff = 3.30E-02
DMFT: dmft_iter = 2, diff = 5.61E-03
DMFT: dmft_iter = 3, diff = 1.83E-03
DMFT: dmft_iter = 4, diff = 6.47E-04
DMFT: dmft_iter = 5, diff = 2.18E-04
DMFT: dmft_iter = 6, diff = 7.20E-05
DMFT: dmft_iter = 7, diff = 2.37E-05
DMFT: dmft_iter = 8, diff = 7.77E-06
DMFT: dmft_iter = 9, diff = 2.55E-06
DMFT: dmft_iter = 10, diff = 8.34E-07
--&gt; Storing: data_order_2_U_06.00000000.h5
</pre></div></div>
</div>
</section>
<section id="Load-result">
<h2>Load result<a class="headerlink" href="#Load-result" title="Link to this heading"></a></h2>
<p>To visualize the crossover we load the results from file using a helper function and class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>

<span class="k">class</span> <span class="nc">AttrList</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span> <span class="o">=</span> <span class="n">l</span>
    <span class="k">def</span> <span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span> <span class="p">]</span>


<span class="k">def</span> <span class="nf">load_order</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>

    <span class="n">filenames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;data_order_</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">_U_*.h5&#39;</span><span class="p">))</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;--&gt; Loading: </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">A</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">AttrList</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="n">nca</span> <span class="o">=</span> <span class="n">load_order</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">oca</span> <span class="o">=</span> <span class="n">load_order</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
--&gt; Loading: data_order_1_U_03.00000000.h5
--&gt; Loading: data_order_1_U_04.00000000.h5
--&gt; Loading: data_order_1_U_05.00000000.h5
--&gt; Loading: data_order_1_U_06.00000000.h5
--&gt; Loading: data_order_2_U_03.00000000.h5
--&gt; Loading: data_order_2_U_04.00000000.h5
--&gt; Loading: data_order_2_U_05.00000000.h5
--&gt; Loading: data_order_2_U_06.00000000.h5
</pre></div></div>
</div>
</section>
<section id="Visualization">
<h2>Visualization<a class="headerlink" href="#Visualization" title="Link to this heading"></a></h2>
<p>To visualize the metal insulator cross over we plot the double occupancy <span class="math notranslate nohighlight">\(\langle n_\uparrow n_\downarrow \rangle\)</span> as a function of <span class="math notranslate nohighlight">\(U\)</span> for NCA and OCA.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nca</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">nca</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;NCA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">oca</span><span class="o">.</span><span class="n">U</span><span class="p">,</span> <span class="n">oca</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OCA&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\langle n_{\uparrow} n_{\downarrow} \rangle$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Metal_insulator_transition_13_0.svg" src="../_images/tutorials_Metal_insulator_transition_13_0.svg" /></div>
</div>
<p>This reproduces the results in Fig. 4a in <a class="reference external" href="https://doi.org/10.1103/PhysRevB.82.115115" rel="noopener noreferrer" target="_blank">M. Eckstein, P. Werner, Phys. Rev. B 82, 115115 (2010)</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Semi%20infinite%20chain.html" class="btn btn-neutral float-left" title="Semi-infinite chain" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../issues.html" class="btn btn-neutral float-right" title="Reporting issues" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2025 Z. Huang, H. U.R. Strand, The Simons Foundation, authors: Z. Huang, H. U.R. Strand, J. Kaye, N. Wentzell.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>