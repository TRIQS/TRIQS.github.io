<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monte Carlo moves &mdash; CTSEG - TRIQS segment picture solver  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f7f783a0" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../_static/triqs_favicon.ico"/>
  
        <script src="../_static/jquery.js?v=8dae8fb0"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Measurements" href="measurements.html" />
    <link rel="prev" title="Step-by-step guide" href="step_by_step.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            CTSEG - TRIQS segment picture solver
          </a>
              <div class="version">
                3.3.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install CTSEG</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#packaged-versions-of-ctseg">Packaged Versions of CTSEG</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#ubuntu-debian-packages">Ubuntu Debian packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#anaconda">Anaconda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#docker">Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-ctseg-from-source">Compiling CTSEG from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#algorithm-and-implementation">Algorithm and implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../algorithm_implementation/ctseg.html">The CTSEG double expansion algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/ctseg.html#double-expansion">Double expansion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/ctseg.html#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/ctseg.html#sign">Sign</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../algorithm_implementation/implementation_notes.html">Implementation notes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/implementation_notes.html#solver-core">Solver core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/implementation_notes.html#inputs">Inputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/implementation_notes.html#configuration">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/implementation_notes.html#imaginary-time-points">Imaginary time points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/implementation_notes.html#work-data">Work data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/implementation_notes.html#determinants">Determinants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/implementation_notes.html#miscellaneous">Miscellaneous</a></li>
<li class="toctree-l4"><a class="reference internal" href="../algorithm_implementation/implementation_notes.html#automatic-tests">Automatic tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../documentation.html#user-guide">User guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="step_by_step.html">Step-by-step guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="step_by_step.html#step-1-choose-the-construction-parameters">Step 1 - Choose the construction parameters</a><ul>
<li class="toctree-l5"><a class="reference internal" href="step_by_step.html#green-s-function-structure">Green’s function structure</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="step_by_step.html#step-2-construct-the-solver">Step 2 - Construct the solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="step_by_step.html#step-3-supply-the-solver-inputs">Step 3 - Supply the solver inputs</a><ul>
<li class="toctree-l5"><a class="reference internal" href="step_by_step.html#local-hamiltonian">Local Hamiltonian</a></li>
<li class="toctree-l5"><a class="reference internal" href="step_by_step.html#hybridization-function">Hybridization function</a></li>
<li class="toctree-l5"><a class="reference internal" href="step_by_step.html#dynamical-density-density-interaction">Dynamical density-density interaction</a></li>
<li class="toctree-l5"><a class="reference internal" href="step_by_step.html#spin-spin-interaction">Spin-spin interaction</a></li>
<li class="toctree-l5"><a class="reference internal" href="step_by_step.html#conditions-for-half-filling">Conditions for half-filling</a></li>
<li class="toctree-l5"><a class="reference internal" href="step_by_step.html#solve-parameters">Solve parameters</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="step_by_step.html#step-4-run-the-solver">Step 4 - Run the solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="step_by_step.html#step-5-access-the-results">Step 5 - Access the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="step_by_step.html#step-6-save-the-results">Step 6 - Save the results</a></li>
<li class="toctree-l4"><a class="reference internal" href="step_by_step.html#running-the-solver-in-parallel">Running the solver in parallel</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Monte Carlo moves</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#insert-segment">Insert segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remove-segment">Remove segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#split-segment">Split segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regroup-segment">Regroup segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#move-segment">Move segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#double-insert-segment">Double insert segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#double-remove-segment">Double remove segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#insert-spin-segment">Insert spin segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remove-spin-segment">Remove spin segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#swap-spin-lines">Swap spin lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#split-spin-segment">Split spin segment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#regroup-spin-segment">Regroup spin segment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="measurements.html">Measurements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#imaginary-time-green-s-function">Imaginary time Green’s function</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#self-energy-improved-estimator">Self-energy improved estimator</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#density">Density</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#static-density-correlation-function">Static density correlation function</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#dynamic-density-correlation-function">Dynamic density correlation function</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#two-particle-four-point-correlation-function">Two-particle (four-point) correlation function</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#three-point-correlation-function">Three-point correlation function</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#perpendicular-spin-spin-correlation-function">Perpendicular spin-spin correlation function</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#state-histogram">State histogram</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#average-sign">Average sign</a></li>
<li class="toctree-l4"><a class="reference internal" href="measurements.html#perturbation-order-histograms">Perturbation order histograms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#python-reference-manual">Python reference manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.html">triqs_ctseg.solver.Solver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.html#triqs_ctseg.solver.Solver"><code class="docutils literal notranslate"><span class="pre">Solver</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.solve.html">triqs_ctseg.solver.Solver.solve</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.solve.html#triqs_ctseg.solver.Solver.solve"><code class="docutils literal notranslate"><span class="pre">Solver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.__init__.html">triqs_ctseg.solver.Solver.__init__</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.__init__.html#triqs_ctseg.solver.Solver.__init__"><code class="docutils literal notranslate"><span class="pre">Solver.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.solve.html">triqs_ctseg.solver.Solver.solve</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.solve.html#triqs_ctseg.solver.Solver.solve"><code class="docutils literal notranslate"><span class="pre">Solver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.D0_tau.html">triqs_ctseg.solver.Solver.D0_tau</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.D0_tau.html#triqs_ctseg.solver.Solver.D0_tau"><code class="docutils literal notranslate"><span class="pre">Solver.D0_tau</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.Delta_tau.html">triqs_ctseg.solver.Solver.Delta_tau</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.Delta_tau.html#triqs_ctseg.solver.Solver.Delta_tau"><code class="docutils literal notranslate"><span class="pre">Solver.Delta_tau</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.Jperp_tau.html">triqs_ctseg.solver.Solver.Jperp_tau</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.Jperp_tau.html#triqs_ctseg.solver.Solver.Jperp_tau"><code class="docutils literal notranslate"><span class="pre">Solver.Jperp_tau</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.constr_params.html">triqs_ctseg.solver.Solver.constr_params</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.constr_params.html#triqs_ctseg.solver.Solver.constr_params"><code class="docutils literal notranslate"><span class="pre">Solver.constr_params</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.results.html">triqs_ctseg.solver.Solver.results</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.results.html#triqs_ctseg.solver.Solver.results"><code class="docutils literal notranslate"><span class="pre">Solver.results</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.solve_params.html">triqs_ctseg.solver.Solver.solve_params</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_ctseg.solver.Solver.solve_params.html#triqs_ctseg.solver.Solver.solve_params"><code class="docutils literal notranslate"><span class="pre">Solver.solve_params</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-3-0">Version 3.3.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About CTSEG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html#references">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CTSEG - TRIQS segment picture solver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../documentation.html">Documentation</a></li>
      <li class="breadcrumb-item active">Monte Carlo moves</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/guide/moves.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="monte-carlo-moves">
<span id="moves"></span><h1>Monte Carlo moves<a class="headerlink" href="#monte-carlo-moves" title="Link to this heading"></a></h1>
<p>In CTSEG, a configuration (state of the Markov chain) is a set of time-ordered list of segments (one for every color), and
possibly a list of <span class="math notranslate nohighlight">\(J_{\perp}\)</span> lines (see <a class="reference internal" href="../algorithm_implementation/implementation_notes.html"><span class="doc">Implementation Notes</span></a> for more details).
Below is a list of all possible steps (or “moves”) of the random walk in configuration space.</p>
<section id="insert-segment">
<h2>Insert segment<a class="headerlink" href="#insert-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/insert.png"><img alt="../_images/insert.png" class="align-center" src="../_images/insert.png" style="width: 80%;" /></a>
<p>Randomly choose a color. Randomly choose a segment within that color. Try to insert a randomly chosen new segment in the interval to
the right of that segment. If the color is empty, try to insert a random segment. If the color contains a full line, no insertion is possible.</p>
<p>This move is enabled if there is a non-zero hybridization <span class="math notranslate nohighlight">\(\Delta(\tau)\)</span>.</p>
</section>
<section id="remove-segment">
<h2>Remove segment<a class="headerlink" href="#remove-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/remove.png"><img alt="../_images/remove.png" class="align-center" src="../_images/remove.png" style="width: 80%;" /></a>
<p>Randomly choose a color. Try to remove a randomly chosen segment within that color.</p>
<p>This move is enabled if there is a non-zero hybridization <span class="math notranslate nohighlight">\(\Delta(\tau)\)</span>.</p>
</section>
<section id="split-segment">
<h2>Split segment<a class="headerlink" href="#split-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/split.png"><img alt="../_images/split.png" class="align-center" src="../_images/split.png" style="width: 80%;" /></a>
<p>Randomly choose a color and a segment <span class="math notranslate nohighlight">\([\tau, \tau']\)</span> within that color. Choose two random (but ordered) times <span class="math notranslate nohighlight">\([\tau_1, \tau_1']\)</span>
inside that segment and try replacing <span class="math notranslate nohighlight">\([\tau, \tau']\)</span> with <span class="math notranslate nohighlight">\([\tau, \tau_1]\)</span> and <span class="math notranslate nohighlight">\([\tau_1', \tau']\)</span>.</p>
<p>This move is enabled if there is a non-zero hybridization <span class="math notranslate nohighlight">\(\Delta(\tau)\)</span>.</p>
</section>
<section id="regroup-segment">
<h2>Regroup segment<a class="headerlink" href="#regroup-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/regroup.png"><img alt="../_images/regroup.png" class="align-center" src="../_images/regroup.png" style="width: 80%;" /></a>
<p>Randomly choose a color and a pair of adjacent segments <span class="math notranslate nohighlight">\([\tau, \tau_1]\)</span> and <span class="math notranslate nohighlight">\([\tau_1', \tau']\)</span> within that color.
Try replacing this pair of segments with the “regrouped” segment <span class="math notranslate nohighlight">\([\tau, \tau']\)</span>.</p>
<p>This move is enabled if there is a non-zero hybridization <span class="math notranslate nohighlight">\(\Delta(\tau)\)</span>.</p>
</section>
<section id="move-segment">
<h2>Move segment<a class="headerlink" href="#move-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/move.png"><img alt="../_images/move.png" class="align-center" src="../_images/move.png" style="width: 80%;" /></a>
<p>Randomly choose a color and either a segment or an antisegment within that color (an antisegment is an interval between two segments). Randomly choose another
color and try to insert the chosen segment or antisegment within that color.</p>
<p>This move is enabled if there is a non-zero hybridization <span class="math notranslate nohighlight">\(\Delta(\tau)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The antisegment version of the move is implemented as the segment version
applied to a “flipped” configuration, where all the occupied time intervals become unoccupied, and vice-versa.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The origin color and the destination color must be within the same block of the hybridization matrix.</p>
</div>
</section>
<section id="double-insert-segment">
<h2>Double insert segment<a class="headerlink" href="#double-insert-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/double_insert.png"><img alt="../_images/double_insert.png" class="align-center" src="../_images/double_insert.png" style="width: 80%;" /></a>
<p>Randomly choose two different colors. For each color, perform a single insertion.</p>
</section>
<section id="double-remove-segment">
<h2>Double remove segment<a class="headerlink" href="#double-remove-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/double_remove.png"><img alt="../_images/double_remove.png" class="align-center" src="../_images/double_remove.png" style="width: 80%;" /></a>
<p>Randomly choose two different colors. For each color, perform a single removal.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Double insert</strong> and <strong>Double remove</strong> are for improving ergodicity.</p>
</div>
</section>
<section id="insert-spin-segment">
<h2>Insert spin segment<a class="headerlink" href="#insert-spin-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/insert_spin.png"><img alt="../_images/insert_spin.png" class="align-center" src="../_images/insert_spin.png" style="width: 80%;" /></a>
<p>Randomly choose a color <span class="math notranslate nohighlight">\(i\)</span> (spin up or spin down) and a segment <span class="math notranslate nohighlight">\([\tau, \tau']\)</span> within that color. The other color is denoted <span class="math notranslate nohighlight">\(j\)</span>.
Choose two random (but ordered) times <span class="math notranslate nohighlight">\(\tau_1\)</span> and <span class="math notranslate nohighlight">\(\tau_1'\)</span> within that segment. Try replacing <span class="math notranslate nohighlight">\([\tau, \tau']\)</span> with <span class="math notranslate nohighlight">\([\tau, \tau_1]\)</span>
and <span class="math notranslate nohighlight">\([\tau_1', \tau']\)</span> in color <span class="math notranslate nohighlight">\(i\)</span>, inserting <span class="math notranslate nohighlight">\([\tau_1, \tau_1']\)</span> in color <span class="math notranslate nohighlight">\(j\)</span>, and inserting a <span class="math notranslate nohighlight">\(J_{\perp}\)</span> line
between <span class="math notranslate nohighlight">\(\tau_1\)</span> and <span class="math notranslate nohighlight">\(\tau_1'\)</span>.</p>
<p>This move is enabled if there is a non-zero <span class="math notranslate nohighlight">\(J_{\perp}(\tau)\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This and the following “spin moves” (that explore the configurations resulting from the <span class="math notranslate nohighlight">\(J_{\perp}\)</span> expansion)
are only implemented for the case where the configuration has two colors, spin up and spin down.</p>
</div>
</section>
<section id="remove-spin-segment">
<h2>Remove spin segment<a class="headerlink" href="#remove-spin-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/remove_spin.png"><img alt="../_images/remove_spin.png" class="align-center" src="../_images/remove_spin.png" style="width: 80%;" /></a>
<p>Randomly choose a <span class="math notranslate nohighlight">\(J_{\perp}\)</span> line. If its two endpoints are connected by a segment <span class="math notranslate nohighlight">\([\tau_1, \tau_1']\)</span> in color <span class="math notranslate nohighlight">\(i\)</span>, find the segments
<span class="math notranslate nohighlight">\([\tau, \tau_1]\)</span> and <span class="math notranslate nohighlight">\([\tau_1', \tau']\)</span> that it connects in color <span class="math notranslate nohighlight">\(j\)</span>. Try removing the <span class="math notranslate nohighlight">\(J_{\perp}\)</span> line and segment
<span class="math notranslate nohighlight">\([\tau_1, \tau_1']\)</span> in color <span class="math notranslate nohighlight">\(i\)</span>, and replacing <span class="math notranslate nohighlight">\([\tau, \tau_1]\)</span> and <span class="math notranslate nohighlight">\([\tau_1', \tau']\)</span> in color <span class="math notranslate nohighlight">\(j\)</span> with a single
segment <span class="math notranslate nohighlight">\([\tau, \tau']\)</span>.</p>
<p>This move is enabled if there is a non-zero <span class="math notranslate nohighlight">\(J_{\perp}(\tau)\)</span>.</p>
</section>
<section id="swap-spin-lines">
<h2>Swap spin lines<a class="headerlink" href="#swap-spin-lines" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/swap_spin.png"><img alt="../_images/swap_spin.png" class="align-center" src="../_images/swap_spin.png" style="width: 80%;" /></a>
<p>Randomly choose two <span class="math notranslate nohighlight">\(J_{\perp}\)</span> lines <span class="math notranslate nohighlight">\([\tau_+, \tau_-]\)</span> and <span class="math notranslate nohighlight">\([\tau'_+, \tau'_-]\)</span>. Try replacing them with the
swapped lines <span class="math notranslate nohighlight">\([\tau'_+, \tau_-]\)</span> and <span class="math notranslate nohighlight">\([\tau_+, \tau'_-]\)</span>.</p>
<p>This move is enabled if there is a non-zero <span class="math notranslate nohighlight">\(J_{\perp}(\tau)\)</span>.</p>
</section>
<section id="split-spin-segment">
<h2>Split spin segment<a class="headerlink" href="#split-spin-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/split_spin.png"><img alt="../_images/split_spin.png" class="align-center" src="../_images/split_spin.png" style="width: 80%;" /></a>
<p>Randomly choose a <span class="math notranslate nohighlight">\(J_{\perp}\)</span> line. Try to remove the <span class="math notranslate nohighlight">\(J_{\perp}\)</span> line, and shift the <span class="math notranslate nohighlight">\(c\)</span> operators at
its end points in each of the colors by independent random amounts.</p>
<p>This move is enabled if there is a non-zero <span class="math notranslate nohighlight">\(J_{\perp}(\tau)\)</span> and a non-zero <span class="math notranslate nohighlight">\(\Delta(\tau)\)</span>.</p>
</section>
<section id="regroup-spin-segment">
<h2>Regroup spin segment<a class="headerlink" href="#regroup-spin-segment" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/regroup_spin.png"><img alt="../_images/regroup_spin.png" class="align-center" src="../_images/regroup_spin.png" style="width: 80%;" /></a>
<p>Randomly choose a <span class="math notranslate nohighlight">\(c\)</span> operator in color 0 (spin up) and determine the window <span class="math notranslate nohighlight">\([\tau_0, \tau_0']\)</span> in which this <span class="math notranslate nohighlight">\(c\)</span> operator can be moved.
In color 1 (spin down), find the <span class="math notranslate nohighlight">\(c^{\dagger}\)</span> operators in <span class="math notranslate nohighlight">\([\tau_0, \tau_0']\)</span> and choose one of them at random (denote its time <span class="math notranslate nohighlight">\(\tau_1''\)</span>).
Randomly choose a <span class="math notranslate nohighlight">\(c\)</span> operator in color 1 (spin down) and determine the window <span class="math notranslate nohighlight">\([\tau_1, \tau_1']\)</span> in which this <span class="math notranslate nohighlight">\(c\)</span> operator can be moved.
In color 0 (spin up), find the <span class="math notranslate nohighlight">\(c^{\dagger}\)</span> operators in <span class="math notranslate nohighlight">\([\tau_1, \tau_1']\)</span> and choose one of them at random (denote its time <span class="math notranslate nohighlight">\(\tau_0''\)</span>).
Try to shift the <span class="math notranslate nohighlight">\(c\)</span> operator in color 0 to <span class="math notranslate nohighlight">\(\tau_1''\)</span>, the <span class="math notranslate nohighlight">\(c\)</span> operator in color 1 to <span class="math notranslate nohighlight">\(\tau_0''\)</span>, and create a <span class="math notranslate nohighlight">\(J_{\perp}\)</span> line
between <span class="math notranslate nohighlight">\(\tau_0''\)</span> and <span class="math notranslate nohighlight">\(\tau_1''\)</span>.</p>
<p>This move is enabled if there is a non-zero <span class="math notranslate nohighlight">\(J_{\perp}(\tau)\)</span> and a non-zero <span class="math notranslate nohighlight">\(\Delta(\tau)\)</span>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="step_by_step.html" class="btn btn-neutral float-left" title="Step-by-step guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="measurements.html" class="btn btn-neutral float-right" title="Measurements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022--present The Simons Foundation, Max-Planck-Institut for Polymer Research Mainz.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>