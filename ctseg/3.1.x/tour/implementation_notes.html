<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Implementation notes &mdash; CTSEG - TRIQS Hybridization Expansion Segment Solver  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f7f783a0" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            CTSEG - TRIQS Hybridization Expansion Segment Solver
          </a>
              <div class="version">
                3.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="contents.html">Guided tour</a><ul>
<li class="toctree-l2"><a class="reference internal" href="definitions.html">The Anderson Impurity Model with dynamical interactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="definitions.html#definition">Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="definitions.html#hybridization-expansion-and-segment-picture">Hybridization expansion and segment picture</a></li>
<li class="toctree-l3"><a class="reference internal" href="definitions.html#density-density-dynamical-interactions">Density-density dynamical interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="definitions.html#transverse-spin-spin-dynamical-interactions">Transverse spin-spin dynamical interactions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="solver_core.html">Solver options and accessors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="solver_core.html#c-interface">C++ interface</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="solver_core.html#python-interface">Python interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore"><code class="docutils literal notranslate"><span class="pre">SolverCore</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.D0_iw"><code class="docutils literal notranslate"><span class="pre">SolverCore.D0_iw</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.Delta_tau"><code class="docutils literal notranslate"><span class="pre">SolverCore.Delta_tau</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.F_2w"><code class="docutils literal notranslate"><span class="pre">SolverCore.F_2w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.F_3w"><code class="docutils literal notranslate"><span class="pre">SolverCore.F_3w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.F_iw"><code class="docutils literal notranslate"><span class="pre">SolverCore.F_iw</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.F_l"><code class="docutils literal notranslate"><span class="pre">SolverCore.F_l</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.F_tau"><code class="docutils literal notranslate"><span class="pre">SolverCore.F_tau</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.G0_iw"><code class="docutils literal notranslate"><span class="pre">SolverCore.G0_iw</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.G_2w"><code class="docutils literal notranslate"><span class="pre">SolverCore.G_2w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.G_3w"><code class="docutils literal notranslate"><span class="pre">SolverCore.G_3w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.G_iw"><code class="docutils literal notranslate"><span class="pre">SolverCore.G_iw</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.G_l"><code class="docutils literal notranslate"><span class="pre">SolverCore.G_l</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.G_tau"><code class="docutils literal notranslate"><span class="pre">SolverCore.G_tau</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.Jperp_iw"><code class="docutils literal notranslate"><span class="pre">SolverCore.Jperp_iw</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.Jperp_tau"><code class="docutils literal notranslate"><span class="pre">SolverCore.Jperp_tau</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.K_tau"><code class="docutils literal notranslate"><span class="pre">SolverCore.K_tau</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.Kperpprime_tau"><code class="docutils literal notranslate"><span class="pre">SolverCore.Kperpprime_tau</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.Kprime_tau"><code class="docutils literal notranslate"><span class="pre">SolverCore.Kprime_tau</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.Sigma_iw"><code class="docutils literal notranslate"><span class="pre">SolverCore.Sigma_iw</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.average_sign"><code class="docutils literal notranslate"><span class="pre">SolverCore.average_sign</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.chipm_tau"><code class="docutils literal notranslate"><span class="pre">SolverCore.chipm_tau</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.histogram"><code class="docutils literal notranslate"><span class="pre">SolverCore.histogram</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.histogram_composite"><code class="docutils literal notranslate"><span class="pre">SolverCore.histogram_composite</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.nn"><code class="docutils literal notranslate"><span class="pre">SolverCore.nn</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.nn_iw"><code class="docutils literal notranslate"><span class="pre">SolverCore.nn_iw</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.nn_tau"><code class="docutils literal notranslate"><span class="pre">SolverCore.nn_tau</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.sanity_check"><code class="docutils literal notranslate"><span class="pre">SolverCore.sanity_check()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.solve"><code class="docutils literal notranslate"><span class="pre">SolverCore.solve()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore.state_histogram"><code class="docutils literal notranslate"><span class="pre">SolverCore.state_histogram</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dyn_interactions.html">Example with dynamical charge and spin interactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="definitions.html">The Anderson Impurity Model with dynamical interactions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="definitions.html#definition">Definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="definitions.html#hybridization-expansion-and-segment-picture">Hybridization expansion and segment picture</a></li>
<li class="toctree-l4"><a class="reference internal" href="definitions.html#density-density-dynamical-interactions">Density-density dynamical interactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="definitions.html#transverse-spin-spin-dynamical-interactions">Transverse spin-spin dynamical interactions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="solver_core.html">Solver options and accessors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="solver_core.html#c-interface">C++ interface</a><ul class="simple">
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="solver_core.html#python-interface">Python interface</a><ul>
<li class="toctree-l5"><a class="reference internal" href="solver_core.html#triqs_ctseg.SolverCore"><code class="docutils literal notranslate"><span class="pre">SolverCore</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="measures.html">Measurements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="measures.html#one-variable-correlation-functions">One-variable correlation functions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="measures.html#multivariable-correlation-functions">Multivariable correlation functions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="measures.html#other-measures">Other measures</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="measures.html">Measurements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="measures.html#one-variable-correlation-functions">One-variable correlation functions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="measures.html#multivariable-correlation-functions">Multivariable correlation functions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="measures.html#other-measures">Other measures</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/triqs_ctseg.html">triqs_ctseg</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/triqs_ctseg.html#type-aliases">Type aliases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/triqs_ctseg.html#classes">Classes</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/triqs_ctseg.html#functions">Functions</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install CTSEG</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-ctseg-from-source">Compiling CTSEG from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">Authors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#useful-references">Useful references</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#quotation">Quotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CTSEG - TRIQS Hybridization Expansion Segment Solver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Implementation notes</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tour/implementation_notes.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="implementation-notes">
<h1>Implementation notes<a class="headerlink" href="#implementation-notes" title="Link to this heading"></a></h1>
<section id="how-to-read-the-code">
<h2>How to read the code<a class="headerlink" href="#how-to-read-the-code" title="Link to this heading"></a></h2>
<p>The class containing the solver is called <code class="docutils literal notranslate"><span class="pre">ctqmc_seg</span></code> and is defined in</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">ctqmc_seg.hpp</span></code></p></li>
</ul>
<p>The solver is built on a parameter dictionary. In order to run, it needs moves
and measures, which are defined in the files starting with <code class="file docutils literal notranslate"><span class="pre">move_</span></code> and
<code class="file docutils literal notranslate"><span class="pre">measure_</span></code>, respectively:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">move_insert_segment.hpp</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">move_remove_segment.hpp</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">measure_nn.hpp</span></code></p></li>
</ul>
<p>Note that so far I haven’t added other measures.  The moves and measures act
on, or use, a set of data characterizing the Monte-Carlo process: this set of
data is defined in</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">qmc_data.hpp</span></code></p></li>
</ul>
<p>A <code class="docutils literal notranslate"><span class="pre">qmc_data</span></code> object contains all the data that the moves and measures need, including cached data:</p>
<ul class="simple">
<li><p>input parameters (like the inverse temperature, the interaction matrix U, the chemical potential mu…)</p></li>
<li><p>the configuration (=the segments on their respective lines)</p></li>
<li><p>cached information (like the determinants, the overlap matrix and the sign)</p></li>
</ul>
<p>In principle, the last item could be seen as part of the configuration. A
configuration, however, is entirely <em>defined</em> by the locations of its segments’
start and end points and full/empty line configuration. From this mere
information, one could recompute the determinants, the overlap matrix, the
sign, as well as other observables that one may want to cache to gain speed.</p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h2>
<p>The configuration is defined in</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">configuration.hpp</span></code></p></li>
</ul>
<p>It contains helper methods to manipulate configurations of segments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">insert_segment</span></code>  –&gt; segment insertion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remove_segment</span></code>  –&gt; segment removal</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">find_segment</span></code>    –&gt; find a segment given its index</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">length_overlaps</span></code> –&gt; compute overlaps/length of a segment in a configuration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maximal_length</span></code>  –&gt; compute maximal length of a segment given an time position</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">length</span></code>          –&gt; segment length</p></li>
</ul>
<p>All these methods are used in moves to manipulate the configuration.  The
configuration also contains the internal storage of the segments, which is
defined in</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">operator_maps.hpp</span></code></p></li>
</ul>
<p>This last class contains the low-level methods to add and remove operators in a
configuration. It is never accessed by other classes than the configuration
class. It mainly consists in two maps of operators:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fullopmap</span></code> –&gt; contains all operators from all flavors</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opmaps[flavor]</span></code> –&gt; contains operators of the flavor <em>flavor</em>, pointing to the operators of the fullopmap.</p></li>
</ul>
<p>Iterators on these two maps have been wrapped to simplify access to their members:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">flavored_const_iterator</span></code> is used to iterate on a given flavor’s line</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">const_iterator</span></code> is used to iterate among iterators, irrespective of their flavors.</p></li>
</ul>
<p>Both have a method <code class="docutils literal notranslate"><span class="pre">cyclic_right()</span></code> and <code class="docutils literal notranslate"><span class="pre">cyclic_left()</span></code> which allow to iterator
through operators <strong>with periodicity</strong>. Dereferencing these iterators yield
information about the operator:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">it-&gt;tau</span></code>               –&gt; imaginary time position</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">it-&gt;dagger</span></code>            –&gt; creation/annihilation operator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">it-&gt;flavor</span></code>            –&gt; flavor of the operator</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">it-&gt;right_occupations</span></code> –&gt; occupations of all lines right of the operator</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2018, T. Ayral, H. Hafermann, P.Delange, M. Ferrero, O. Parcollet.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>