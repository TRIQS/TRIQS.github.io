<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Anderson Impurity Model with dynamical interactions &mdash; CTSEG - TRIQS Hybridization Expansion Segment Solver  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Solver options and accessors" href="solver_core.html" />
    <link rel="prev" title="Guided tour" href="contents.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >
            <a href="../index.html" class="icon icon-home"> CTSEG - TRIQS Hybridization Expansion Segment Solver
          </a>
              <div class="version">
                3.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="contents.html">Guided tour</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">The Anderson Impurity Model with dynamical interactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#definition">Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hybridization-expansion-and-segment-picture">Hybridization expansion and segment picture</a></li>
<li class="toctree-l3"><a class="reference internal" href="#density-density-dynamical-interactions">Density-density dynamical interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transverse-spin-spin-dynamical-interactions">Transverse spin-spin dynamical interactions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="solver_core.html">Solver options and accessors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="solver_core.html#c-interface">C++ interface</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="solver_core.html#python-interface">Python interface</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="dyn_interactions.html">Example with dynamical charge and spin interactions</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">The Anderson Impurity Model with dynamical interactions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#definition">Definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hybridization-expansion-and-segment-picture">Hybridization expansion and segment picture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#density-density-dynamical-interactions">Density-density dynamical interactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transverse-spin-spin-dynamical-interactions">Transverse spin-spin dynamical interactions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="solver_core.html">Solver options and accessors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="solver_core.html#c-interface">C++ interface</a><ul class="simple">
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="solver_core.html#python-interface">Python interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="measures.html">Measurements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="measures.html#one-variable-correlation-functions">One-variable correlation functions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="measures.html#multivariable-correlation-functions">Multivariable correlation functions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="measures.html#other-measures">Other measures</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="measures.html">Measurements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="measures.html#one-variable-correlation-functions">One-variable correlation functions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="measures.html#multivariable-correlation-functions">Multivariable correlation functions</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="measures.html#other-measures">Other measures</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/triqs_ctseg.html">triqs_ctseg</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/triqs_ctseg.html#type-aliases">Type aliases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/triqs_ctseg.html#classes">Classes</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/triqs_ctseg.html#functions">Functions</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install CTSEG</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-ctseg-from-source">Compiling CTSEG from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">Authors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#useful-references">Useful references</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#quotation">Quotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CTSEG - TRIQS Hybridization Expansion Segment Solver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="contents.html">Guided tour</a> &raquo;</li>
      <li>The Anderson Impurity Model with dynamical interactions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tour/definitions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<span class="target" id="module-ctseg"></span><div class="section" id="the-anderson-impurity-model-with-dynamical-interactions">
<span id="aim"></span><h1>The Anderson Impurity Model with dynamical interactions<a class="headerlink" href="#the-anderson-impurity-model-with-dynamical-interactions" title="Permalink to this headline"></a></h1>
<div class="section" id="definition">
<h2>Definition<a class="headerlink" href="#definition" title="Permalink to this headline"></a></h2>
<p>The Anderson impurity model (AIM) is defined by the action:</p>
<div class="math notranslate nohighlight">
\[\begin{split}S &amp;= \iint_0^\beta \mathrm{d}\tau \mathrm{d}\tau' \sum_{ab\sigma} c^{*}_{a\sigma}(\tau) \left( - \left[\mathcal{G}^{-1}_0\right]_{ab}^\sigma(\tau-\tau') \right) c_{b\sigma}(\tau')\\ &amp;\;\;+ \frac{1}{2}\iint_{0}^{\beta}\mathrm{d}\tau\mathrm{d}\tau'\sum_{ab}\sum_{\sigma\sigma'}\mathcal{U}_{ab}^{\sigma\sigma'}(\tau-\tau')n_{a\sigma}(\tau)n_{b\sigma'}(\tau') \\ &amp;\;\;+ \frac{1}{2}\iint_{0}^{\beta}\mathrm{d}\tau\mathrm{d}\tau'\sum_{a}\sum_{\xi=x,y,z}s_{a}^{\xi}(\tau)\mathcal{J}_{a}^{\xi}(\tau-\tau')s_{a}^{\xi}(\tau')\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{G}_0\)</span>  is the non-interacting Green’s function, related to the hybridization function <span class="math notranslate nohighlight">\(\Delta\)</span> by the relation :</p>
<div class="math notranslate nohighlight">
\[[\mathcal{G}^{-1}_{0}]_{ab}^\sigma (i \omega_n) = (i \omega_n + \mu_{a\sigma})\delta_{ab} - \Delta_{ab}^\sigma(i \omega_n).\]</div>
<p><span class="math notranslate nohighlight">\(a, b \dots\)</span> are the orbital indices, <span class="math notranslate nohighlight">\(n_{a\sigma}\equiv c^\dagger_{a\sigma}c_{a\sigma}\)</span>, <span class="math notranslate nohighlight">\(s_{a}^{\xi}\equiv\frac{1}{2}\sum_{\sigma\sigma'}c_{a\sigma}^{*}\sigma_{\sigma\sigma'}^{\xi}c_{a\sigma'}\)</span>, <span class="math notranslate nohighlight">\(\mathcal{U}(\tau)\)</span> is the density-density dynamical interaction and <span class="math notranslate nohighlight">\(\mathcal{J}_\perp\)</span> is the transverse part of the dynamical spin interactions. <span class="math notranslate nohighlight">\(\mathcal{U}\)</span> is in general composed of a static part <span class="math notranslate nohighlight">\(U\)</span> and of a retarded part <span class="math notranslate nohighlight">\(\mathcal{D}_0(\tau)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathcal{U}(\tau) = U\delta(\tau) + \mathcal{D}_0(\tau)\]</div>
</div>
<div class="section" id="hybridization-expansion-and-segment-picture">
<h2>Hybridization expansion and segment picture<a class="headerlink" href="#hybridization-expansion-and-segment-picture" title="Permalink to this headline"></a></h2>
<p>Solving the Anderson impurity model amounts to computing its correlation functions like the one-particle Green’s function</p>
<div class="math notranslate nohighlight">
\[G^\sigma_{ab}(\tau) \equiv - \langle T c_{a\sigma}(\tau) c^{\dagger}_{b\sigma}(0) \rangle\]</div>
<p>In order to do so, one can expand one of the terms of the Anderson action and numerically evaluate the corresponding Feynman diagrams. The hybridization expansion consists in expanding the partition function in powers of the hybridization function <span class="math notranslate nohighlight">\(\Delta(\tau)\)</span>. In the case of density-density interactions <span class="math notranslate nohighlight">\(U_{ab} n_{a}(\tau) n_{b}(\tau)\)</span> the diagrams one obtains can be represented by sets of occupied or empty segments, hence the name “segment picture”. This segment picture allows for an analytical formula for and hence fast computation of the trace of the impurity operators :</p>
<div class="math notranslate nohighlight">
\[w_U = \exp\left(-\sum_{a,b,b&lt;a} U_{ab} l^{\mathrm{overlap}}_{ab} + \mu \sum_a l_a\right)\]</div>
</div>
<div class="section" id="density-density-dynamical-interactions">
<h2>Density-density dynamical interactions<a class="headerlink" href="#density-density-dynamical-interactions" title="Permalink to this headline"></a></h2>
<p>Dynamical interactions do not alter the segment picture. The trace can still be computed without great numerical expense. Dynamical interactions just result in a shift of the static <span class="math notranslate nohighlight">\(U_{ab}\)</span> by <span class="math notranslate nohighlight">\(-2 K'_{ab}(0)\)</span> and of the chemical potential <span class="math notranslate nohighlight">\(\mu_a\)</span>  of <span class="math notranslate nohighlight">\(K'_a(0)\)</span> , as well as an additional term in the trace:</p>
<div class="math notranslate nohighlight">
\[w_{\mathcal{D}_0} = \exp\left(\sum_{ab} \sum_{\mathrm{op} i_a,j_b} s_{i_{a}} s_{j_{b}} K_{ab}(\tau_{i_a} - \tau_{j_b}) \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(s_{i_a} = 1\)</span>  if the operator at time <span class="math notranslate nohighlight">\(\tau_{i_a}\)</span> is a creation operator,  <span class="math notranslate nohighlight">\(s_{i_a} = -1\)</span> otherwise.</p>
<p>The kernel <span class="math notranslate nohighlight">\(K(\tau)\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}K''(\tau) = \mathcal{D}_0(\tau) \\
K(0) = K(\beta) = 0\end{split}\]</div>
<p>It is obtained from the retarded interaction <span class="math notranslate nohighlight">\(\mathcal{D}_0(\tau)\)</span> through the expression:</p>
<div class="math notranslate nohighlight">
\[K(\tau) = \frac{2}{\beta} \sum_{n&gt;0} \frac{\mathcal{D}_0(i\nu_n)-\mathcal{D}_0(0)}{\nu_n^2} \left(  1-\cos(\nu_n \tau) \right)\]</div>
<p><span class="math notranslate nohighlight">\(\mathcal{D}_0(i\nu_n)\)</span> is set in the solver using the accessor <cite>D0_iw</cite>.</p>
</div>
<div class="section" id="transverse-spin-spin-dynamical-interactions">
<h2>Transverse spin-spin dynamical interactions<a class="headerlink" href="#transverse-spin-spin-dynamical-interactions" title="Permalink to this headline"></a></h2>
<p>Contrary to density-density dynamical interactions, transverse spin-spin dynamical interaction (terms <span class="math notranslate nohighlight">\(\xi=x,y\)</span> of the AIM action above) necessitate an additional expansion in powers of <span class="math notranslate nohighlight">\(\mathcal{J}_\perp\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\mathcal{J}_\perp(i\nu_n)\)</span> is set in the solver using the accessor <cite>Jperp_iw</cite>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this implementation, transverse spin-spin dynamical interactions are limited to the one-band case</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="contents.html" class="btn btn-neutral float-left" title="Guided tour" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="solver_core.html" class="btn btn-neutral float-right" title="Solver options and accessors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2018, T. Ayral, H. Hafermann, P.Delange, M. Ferrero, O. Parcollet.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>