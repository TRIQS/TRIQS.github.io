
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Additional remarks &#8212; w2dynamics_interface  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/triqs.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head><body>
<div class="pageheader">
  <ul>
    
    <li><a href="../install.html">Install</a></li>
    
    <li><a href="../documentation.html">Documentation</a></li>
    
    <li><a href="../tutorials.html">Tutorials</a></li>
    
    <li><a href="../issues.html">Issues</a></li>
    
    <li><a href="../about.html">About w2dynamics_interface</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../index.html">w2dynamics_interface</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">Interface to the w2dynamics impurity solver</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
    <li><a href="../index.html">Home</a> &raquo;</li>

        <li class="nav-item nav-item-this"><a href="">Additional remarks</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Additional remarks</a><ul>
<li><a class="reference internal" href="#remark-1-defining-the-impurity">Remark 1 - Defining the impurity</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#remark-2-kramers-degeneracy">Remark 2 - Kramers degeneracy</a></li>
<li><a class="reference internal" href="#remark-3-the-hybridization-function">Remark 3 - The hybridization function</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/guide/additional_remarks.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="additional-remarks">
<h1>Additional remarks<a class="headerlink" href="#additional-remarks" title="Permalink to this headline">¶</a></h1>
<p>To the parameters of the preceding section, when using w2dynamics
with the interface, the following additional parameters or comments may be
considered.</p>
<div class="section" id="remark-1-defining-the-impurity">
<h2>Remark 1 - Defining the impurity<a class="headerlink" href="#remark-1-defining-the-impurity" title="Permalink to this headline">¶</a></h2>
<p>There are two ways available to define the properties of the impurity, by supplying</p>
<ul class="simple">
<li><p>the noninteracting Greens function <span class="math notranslate nohighlight">\(G_0\)</span> and the interaction matrix <span class="math notranslate nohighlight">\(U_{\alpha\beta\gamma\delta}\)</span></p></li>
<li><p>the hybridisation function <span class="math notranslate nohighlight">\(\Delta_{\alpha\beta} (i \omega_n) = \sum_k \frac{V_{k,\alpha} V^*_{k,\beta}}{i \omega_n - \epsilon_{k,\alpha}}\)</span>,  the interaction matrix <span class="math notranslate nohighlight">\(U_{\alpha\beta\gamma\delta}\)</span> and the hopping matrix <span class="math notranslate nohighlight">\(t_{\alpha\beta}\)</span>.</p></li>
</ul>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>We define the properties of the impurity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spin_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="s1">&#39;dn&#39;</span><span class="p">]</span>
<span class="n">orb_names</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">gf_struct</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="n">s</span><span class="p">,</span> <span class="n">orb_names</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spin_names</span> <span class="p">]</span>

<span class="c1"># ==== Local Hamiltonian ====</span>
<span class="n">h_0</span> <span class="o">=</span> <span class="o">-</span> <span class="n">mu</span><span class="o">*</span><span class="p">(</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;dn&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="n">h</span><span class="o">*</span><span class="p">(</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;dn&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="n">h_int</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span><span class="p">(</span><span class="s1">&#39;dn&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># ==== Hybridization Function ====</span>
<span class="n">n_iw</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">iw_mesh</span> <span class="o">=</span> <span class="n">MeshImFreq</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="s1">&#39;Fermion&#39;</span><span class="p">,</span> <span class="n">n_iw</span><span class="p">)</span>
<span class="n">Delta</span> <span class="o">=</span> <span class="n">BlockGf</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">iw_mesh</span><span class="p">,</span> <span class="n">gf_struct</span><span class="o">=</span><span class="n">gf_struct</span><span class="p">)</span>
<span class="n">Delta</span> <span class="o">&lt;&lt;</span> <span class="nb">sum</span><span class="p">([</span><span class="n">V_i</span><span class="o">*</span><span class="n">V_i</span> <span class="o">*</span> <span class="n">inverse</span><span class="p">(</span><span class="n">iOmega_n</span> <span class="o">-</span> <span class="n">E_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">V_i</span><span class="p">,</span><span class="n">E_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">E</span><span class="p">)]);</span>

<span class="c1"># ==== Non-Interacting Impurity Green function  ====</span>
<span class="n">G0_iw</span> <span class="o">=</span> <span class="n">BlockGf</span><span class="p">(</span><span class="n">mesh</span><span class="o">=</span><span class="n">iw_mesh</span><span class="p">,</span> <span class="n">gf_struct</span><span class="o">=</span><span class="n">gf_struct</span><span class="p">)</span>
<span class="n">G0_iw</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">inverse</span><span class="p">(</span><span class="n">iOmega_n</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">h</span> <span class="o">-</span> <span class="n">Delta</span><span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">])</span>
<span class="n">G0_iw</span><span class="p">[</span><span class="s1">&#39;dn&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">inverse</span><span class="p">(</span><span class="n">iOmega_n</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">h</span> <span class="o">-</span> <span class="n">Delta</span><span class="p">[</span><span class="s1">&#39;dn&#39;</span><span class="p">])</span>
</pre></div>
</div>
<ul>
<li><p>Now the solver is initialized the following way using the G0 interface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==== Construct the CTHYB solver using the G0 + h_int Interface ====</span>
<span class="n">constr_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;beta&#39;</span> <span class="p">:</span> <span class="n">beta</span><span class="p">,</span>
        <span class="s1">&#39;gf_struct&#39;</span> <span class="p">:</span> <span class="n">gf_struct</span><span class="p">,</span>
        <span class="s1">&#39;n_iw&#39;</span> <span class="p">:</span> <span class="n">n_iw</span><span class="p">,</span>
        <span class="s1">&#39;n_tau&#39;</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="s1">&#39;delta_interface&#39;</span> <span class="p">:</span> <span class="kc">False</span> <span class="c1"># this line can also be omitted, since False is default</span>
        <span class="p">}</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span><span class="o">**</span><span class="n">constr_params</span><span class="p">)</span>

<span class="c1"># --------- Initialize G0_iw ----------</span>
<span class="n">S</span><span class="o">.</span><span class="n">G0_iw</span> <span class="o">&lt;&lt;</span> <span class="n">G0_iw</span>

<span class="c1"># --------- Solve! ----------</span>
<span class="n">solve_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;h_int&#39;</span> <span class="p">:</span> <span class="n">h_int</span><span class="p">,</span>
        <span class="s1">&#39;n_warmup_cycles&#39;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s1">&#39;n_cycles&#39;</span> <span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
        <span class="s1">&#39;length_cycle&#39;</span> <span class="p">:</span> <span class="mi">100</span>
        <span class="p">}</span>
<span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="o">**</span><span class="n">solve_params</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>And the following way unsing the Delta interface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==== Construct the CTHYB solver using the G0 + h_int Interface ====</span>
<span class="n">constr_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;beta&#39;</span> <span class="p">:</span> <span class="n">beta</span><span class="p">,</span>
        <span class="s1">&#39;gf_struct&#39;</span> <span class="p">:</span> <span class="n">gf_struct</span><span class="p">,</span>
        <span class="s1">&#39;n_iw&#39;</span> <span class="p">:</span> <span class="n">n_iw</span><span class="p">,</span>
        <span class="s1">&#39;n_tau&#39;</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="s1">&#39;delta_interface&#39;</span> <span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span><span class="o">**</span><span class="n">constr_params</span><span class="p">)</span>

<span class="c1"># --------- Initialize Delta ----------</span>
<span class="n">S</span><span class="o">.</span><span class="n">Delta_tau</span> <span class="o">&lt;&lt;</span> <span class="n">Fourier</span><span class="p">(</span><span class="n">Delta</span><span class="p">)</span>

<span class="c1"># --------- Solve! ----------</span>
<span class="n">solve_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;h_int&#39;</span> <span class="p">:</span> <span class="n">h_int</span><span class="p">,</span>
        <span class="s1">&#39;n_warmup_cycles&#39;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s1">&#39;n_cycles&#39;</span> <span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
        <span class="s1">&#39;length_cycle&#39;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s1">&#39;h_0&#39;</span> <span class="p">:</span> <span class="n">h_0</span>
        <span class="p">}</span>
<span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="o">**</span><span class="n">solve_params</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="remark-2-kramers-degeneracy">
<h2>Remark 2 - Kramers degeneracy<a class="headerlink" href="#remark-2-kramers-degeneracy" title="Permalink to this headline">¶</a></h2>
<p>In systems where Kramers theorem applies,
the one particle eigenstates are (at least) double degenerate.
To have this deneneracy also fulfilled in the interacting result,
special global moves are necessary.
That means that these updates are performed on the right states,
the order of the states has e.g. in paramagnetic cases with spin
to be written:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gf_struct</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;dn&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;dn&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
</pre></div>
</div>
<dl class="simple">
<dt>or::</dt><dd><p>gf_struct = [[‘up’, [0, 1]], [‘dn’, [0, 1]]]</p>
</dd>
</dl>
<p>That means, first write all spin up, then all spin down, that the spin-flip move
will be executed the right way.
Also systems with have spontanuous symmetry breaking of this degeneracy, e.g. here ferromagnetism, in order for the random walker to overcome the phase barrier between up- and down-polarisation, a spin flip move is necessary.</p>
<p>One more example, in a J Jz basis, where without order (J=1/2, Jz=1/2) and (J=1/2, Jz=-1/2),
as well as (J=3/2, Jz=1/2) and (J=3/2, Jz=-1/2) are degenerate,
and (J=3/2, Jz=3/2) and (J=3/2, Jz=-3/2) also,
the structure should be the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Jz</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Jz</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Jz</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Jz</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Jz</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="o">=</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Jz</span><span class="o">=-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>This may be fixed in later versions.</p>
</div>
<div class="section" id="remark-3-the-hybridization-function">
<h2>Remark 3 - The hybridization function<a class="headerlink" href="#remark-3-the-hybridization-function" title="Permalink to this headline">¶</a></h2>
<p>The hybridization function <span class="math notranslate nohighlight">\(\Delta\)</span> between the bath and the impurity
has to be given in the particle picture, even though in cthyb the hole
propagator ist needed.</p>
<div class="math notranslate nohighlight">
\[\Delta_{\alpha\beta} (i \omega_n) = \sum_k \frac{V_{k,\alpha} V^*_{k,\beta}}{i \omega_n - \epsilon_{k,\alpha}},\]</div>
<p>With this, the non-interacting Green’s function of the impurity is:</p>
<div class="math notranslate nohighlight">
\[\hat{G}^{-1}_0 (i \omega_n) = i \omega_n + \mu - \hat h - \hat{\Delta}(i \omega_n).\]</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
    <li><a href="../index.html">Home</a> &raquo;</li>

        <li class="nav-item nav-item-this"><a href="">Additional remarks</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Simons Foundation.
    </div>
  </body>
</html>