<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Block Structure &mdash; TRIQS DFTTools 1.4.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.4.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/MathJax/MathJax.js?config=default"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="TRIQS DFTTools 1.4.0 documentation" href="../contents.html" />
    <link rel="up" title="Documentation" href="../documentation.html" />
    <link rel="next" title="Frequently-Asked Questions" href="../faqs/faqs.html" />
    <link rel="prev" title="TransBasis" href="transbasis.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    
    <li><a href="../install.html">Install</a></li>
    
    <li><a href="../documentation.html">Documentation</a></li>
    
    <li><a href="../issues.html">Issues</a></li>
    
    <li><a href="../about.html">About DFTTools</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../index.html">dft tools</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">connecting <a class="triqs" style="font-size: 12px" href="http://triqs.ipht.cnrs.fr/1.x">TRIQS</a> to DFT packages</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../faqs/faqs.html" title="Frequently-Asked Questions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="transbasis.html" title="TransBasis"
             accesskey="P">previous</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../documentation.html" accesskey="U">Documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="transbasis.html"
                        title="previous chapter">TransBasis</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../faqs/faqs.html"
                        title="next chapter">Frequently-Asked Questions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/block_structure.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="block-structure">
<h1>Block Structure<a class="headerlink" href="#block-structure" title="Permalink to this headline">¶</a></h1>
<p>The <cite>BlockStructure</cite> class allows to change and manipulate
Green&#8217;s functions structures and mappings from sumk to solver.</p>
<p>The block structure can also be written to and read from HDF files.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Do not write the individual elements of this class to a HDF file,
as they belong together and changing one without the other can
result in unexpected results. Always write the BlockStructure
object as a whole.</p>
<p class="last">Writing the sumk_to_solver and solver_to_sumk elements
individually is not implemented.</p>
</div>
<dl class="class">
<dt id="dft.block_structure.BlockStructure">
<em class="property">class </em><code class="descclassname">dft.block_structure.</code><code class="descname">BlockStructure</code><span class="sig-paren">(</span><em>gf_struct_sumk=None</em>, <em>gf_struct_solver=None</em>, <em>solver_to_sumk=None</em>, <em>sumk_to_solver=None</em>, <em>solver_to_sumk_block=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dft/block_structure.html#BlockStructure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dft.block_structure.BlockStructure" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Contains information about the Green function structure.</p>
<p>This class contains information about the structure of the solver 
and sumk Green functions and the mapping between them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>gf_struct_sumk</strong> : list of list of tuple</p>
<blockquote>
<div><p>gf_struct_sumk[ish][idx] = (block_name,list of indices in block)</p>
<p>for correlated shell ish; idx is just a counter in the list</p>
</div></blockquote>
<p><strong>gf_struct_solver</strong> : list of dict</p>
<blockquote>
<div><p>gf_struct_solver[ish][block] = list of indices in that block</p>
<p>for <em>inequivalent</em> correlated shell ish</p>
</div></blockquote>
<p><strong>solver_to_sumk</strong> : list of dict</p>
<blockquote>
<div><p>solver_to_sumk[ish][(from_block,from_idx)] = (to_block,to_idx)</p>
<p>maps from the solver block and index to the sumk block and index
for <em>inequivalent</em> correlated shell ish</p>
</div></blockquote>
<p><strong>sumk_to_solver</strong> : list of dict</p>
<blockquote>
<div><p>sumk_to_solver[ish][(from_block,from_idx)] = (to_block,to_idx)</p>
<p>maps from the sumk block and index to the solver block and index
for <em>inequivalent</em> correlated shell ish</p>
</div></blockquote>
<p><strong>solver_to_sumk_block</strong> : list of dict</p>
<blockquote class="last">
<div><p>solver_to_sumk_block[ish][from_block] = to_block</p>
<p>maps from the solver block to the sumk block 
for <em>inequivalent</em> correlated shell ish</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="dft.block_structure.BlockStructure.approximate_as_diagonal">
<code class="descname">approximate_as_diagonal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dft/block_structure.html#BlockStructure.approximate_as_diagonal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dft.block_structure.BlockStructure.approximate_as_diagonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a structure for a GF with zero off-diagonal elements.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In general, this will throw away non-zero elements of the
Green&#8217;s function. Be sure to verify whether this approximation
is justified.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="dft.block_structure.BlockStructure.convert_gf">
<code class="descname">convert_gf</code><span class="sig-paren">(</span><em>G</em>, <em>G_struct</em>, <em>ish=0</em>, <em>show_warnings=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dft/block_structure.html#BlockStructure.convert_gf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dft.block_structure.BlockStructure.convert_gf" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert BlockGf from its structure to this structure.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Elements that are zero in the new structure due to
the new block structure will be just ignored, thus 
approximated to zero.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>G</strong> : BlockGf</p>
<blockquote>
<div><p>the Gf that should be converted</p>
</div></blockquote>
<p><strong>G_struct</strong> : GfStructure</p>
<blockquote>
<div><p>the structure ofthat G</p>
</div></blockquote>
<p><strong>ish</strong> : int</p>
<blockquote>
<div><p>shell index</p>
</div></blockquote>
<p><strong>show_warnings</strong> : bool</p>
<blockquote>
<div><p>whether to show warnings when elements of the Green&#8217;s 
function get thrown away</p>
</div></blockquote>
<p><strong>**kwargs :</strong> :</p>
<blockquote class="last">
<div><p>options passed to the constructor for the new Gf</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dft.block_structure.BlockStructure.create_gf">
<code class="descname">create_gf</code><span class="sig-paren">(</span><em>ish=0</em>, <em>gf_function=&lt;type 'pytriqs.gf.local.gf.GfImFreq'&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dft/block_structure.html#BlockStructure.create_gf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dft.block_structure.BlockStructure.create_gf" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a zero BlockGf having the gf_struct_solver structure.</p>
<p>When using GfImFreq as gf_function, typically you have to 
supply beta as keyword argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ish</strong> : int</p>
<blockquote>
<div><p>shell index</p>
</div></blockquote>
<p><strong>gf_function</strong> : constructor</p>
<blockquote>
<div><p>function used to construct the Gf objects constituting the
individual blocks; default: GfImFreq</p>
</div></blockquote>
<p><strong>**kwargs :</strong> :</p>
<blockquote class="last">
<div><p>options passed on to the Gf constructor for the individual
blocks</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="dft.block_structure.BlockStructure.full_structure">
<em class="property">classmethod </em><code class="descname">full_structure</code><span class="sig-paren">(</span><em>gf_struct</em>, <em>corr_to_inequiv</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dft/block_structure.html#BlockStructure.full_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dft.block_structure.BlockStructure.full_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct structure that maps to itself.</p>
<p>This has the same structure for sumk and solver, and the
mapping solver_to_sumk and sumk_to_solver is one-to-one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>gf_struct</strong> : list of dict</p>
<blockquote>
<div><p>gf_struct[ish][block] = list of indices in that block</p>
<p>for (inequivalent) correlated shell ish</p>
</div></blockquote>
<p><strong>corr_to_inequiv</strong> : list</p>
<blockquote class="last">
<div><p>gives the mapping from correlated shell csh to inequivalent
correlated shell icsh, so that corr_to_inequiv[csh]=icsh
e.g. SumkDFT.corr_to_inequiv</p>
<p>if None, each inequivalent correlated shell is supposed to
be correspond to just one correlated shell with the same
index; there is not default, None has to be set explicitly!</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dft.block_structure.BlockStructure.map_gf_struct_solver">
<code class="descname">map_gf_struct_solver</code><span class="sig-paren">(</span><em>mapping</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dft/block_structure.html#BlockStructure.map_gf_struct_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dft.block_structure.BlockStructure.map_gf_struct_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Map the Green function structure from one struct to another.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mapping</strong> : list of dict</p>
<blockquote class="last">
<div><p>the dict consists of elements 
(from_block,from_index) : (to_block,to_index)
that maps from one structure to the other</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dft.block_structure.BlockStructure.pick_gf_struct_solver">
<code class="descname">pick_gf_struct_solver</code><span class="sig-paren">(</span><em>new_gf_struct</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dft/block_structure.html#BlockStructure.pick_gf_struct_solver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dft.block_structure.BlockStructure.pick_gf_struct_solver" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick selected orbitals within blocks.</p>
<p>This throws away parts of the Green&#8217;s function that (for some
reason - be sure that you know what you&#8217;re doing) shouldn&#8217;t be 
included in the calculation.</p>
<p>To drop an entire block, just don&#8217;t include it.
To drop a certain index within a block, just don&#8217;t include it.</p>
<p>If it was before:</p>
<p>[{&#8216;up&#8217;:[0,1],&#8217;down&#8217;:[0,1],&#8217;left&#8217;:[0,1]}]</p>
<p>to choose the 0th index of the up block and the 1st index of
the down block and drop the left block, the new_gf_struct would
have to be</p>
<p>[{&#8216;up&#8217;:[0],&#8217;down&#8217;:[1]}]</p>
<p>Note that the indices will be renamed to be a 0-based
sequence of integers, i.e. the new structure will actually
be  [{&#8216;up&#8217;:[0],&#8217;down&#8217;:[0]}].</p>
<p>For dropped indices, sumk_to_solver will map to (None,None).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>new_gf_struct</strong> : list of dict</p>
<blockquote class="last">
<div><p>formatted the same as gf_struct_solver:</p>
<p>new_gf_struct[ish][block]=list of indices in that block.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="dft.block_structure.BlockStructure.pick_gf_struct_sumk">
<code class="descname">pick_gf_struct_sumk</code><span class="sig-paren">(</span><em>new_gf_struct</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dft/block_structure.html#BlockStructure.pick_gf_struct_sumk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dft.block_structure.BlockStructure.pick_gf_struct_sumk" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick selected orbitals within blocks.</p>
<p>This throws away parts of the Green&#8217;s function that (for some
reason - be sure that you know what you&#8217;re doing) shouldn&#8217;t be 
included in the calculation.</p>
<p>To drop an entire block, just don&#8217;t include it.
To drop a certain index within a block, just don&#8217;t include it.</p>
<p>If it was before:</p>
<p>[{&#8216;up&#8217;:[0,1],&#8217;down&#8217;:[0,1],&#8217;left&#8217;:[0,1]}]</p>
<p>to choose the 0th index of the up block and the 1st index of
the down block and drop the left block, the new_gf_struct would
have to be</p>
<p>[{&#8216;up&#8217;:[0],&#8217;down&#8217;:[1]}]</p>
<p>Note that the indices will be renamed to be a 0-based
sequence of integers.</p>
<p>For dropped indices, sumk_to_solver will map to (None,None).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>new_gf_struct</strong> : list of dict</p>
<blockquote class="last">
<div><p>formatted the same as gf_struct_solver:</p>
<p>new_gf_struct[ish][block]=list of indices in that block.</p>
<p>However, the indices are not according to the solver Gf 
but the sumk Gf.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../faqs/faqs.html" title="Frequently-Asked Questions"
             >next</a> |</li>
        <li class="right" >
          <a href="transbasis.html" title="TransBasis"
             >previous</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../documentation.html" >Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2013, M. Aichhorn, L. Pourovskii, V. Vildosola, C. Martins.
    </div>
  </body>
</html>