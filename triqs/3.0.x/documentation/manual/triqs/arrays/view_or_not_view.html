
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Regular type vs view type &#8212; TRIQS 3.0.2 documentation</title>
    <link rel="stylesheet" href="../../../../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=default"></script>
    <link rel="author" title="About these documents" href="../../../../about.html" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Interaction with CLEF expressions" href="lazy.html" />
    <link rel="prev" title="Shape &amp; dimensions" href="shape.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../../../../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../../../../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head><body>
<div class="pageheader">
  <ul>
    
    <li><a href="../../../../install.html">Install</a></li>
    
    <li><a href="../../../../documentation.html">Documentation</a></li>
    
    <li><a href="../../../../userguide.html">User guide</a></li>
    
    <li><a href="../../../../applications.html">Applications</a></li>
    
    <li><a href="../../../../contributing.html">Contributing</a></li>
    
    <li><a href="../../../../about.html">About TRIQS</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../../../../index.html">triqs</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">a Toolbox for Research on Interacting Quantum Systems</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lazy.html" title="Interaction with CLEF expressions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="shape.html" title="Shape &amp; dimensions"
             accesskey="P">previous</a> |</li>
    <li><a href="../../../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../../documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../contents.html" >&lt;no title&gt;</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="contents.html" accesskey="U"><strong>[triqs/arrays]</strong> Multidimensional arrays</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Regular type vs view type</a><ul>
<li><a class="reference internal" href="#behaviour-comparison-table-between-regular-and-view-types">Behaviour comparison table between regular and view types</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="shape.html"
                        title="previous chapter">Shape &amp; dimensions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="lazy.html"
                        title="next chapter">Interaction with CLEF expressions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/documentation/manual/triqs/arrays/view_or_not_view.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="regular-type-vs-view-type">
<span id="view-vs-regular"></span><h1>Regular type vs view type<a class="headerlink" href="#regular-type-vs-view-type" title="Permalink to this headline">¶</a></h1>
<p>A fundamental distinction in TRIQS is the difference between the <cite>regular type</cite>
and the corresponding <cite>view types</cite>.</p>
<ul>
<li><p class="first">The <strong>regular types</strong></p>
<ul>
<li><p class="first">Following the definition of A. Stepanov, a regular type is a <em>value</em>, much like an int, a double,
or a std::vector. Cf http://www.stepanovpapers.com/DeSt98.pdf (I added move semantics to the definition).</p>
</li>
<li><p class="first">It has <cite>value semantics</cite>, more precisely</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="n">a</span><span class="p">;</span>               <span class="c1">// default constructible</span>
<span class="n">T</span> <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> <span class="n">T</span> <span class="nf">a</span> <span class="p">(</span><span class="n">b</span><span class="p">);</span>  <span class="c1">// copy constructible</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>             <span class="c1">// assignment</span>
<span class="n">a</span> <span class="o">==</span> <span class="n">b</span><span class="p">;</span> <span class="n">a</span> <span class="o">!=</span> <span class="n">b</span><span class="p">;</span>    <span class="c1">// Equality.</span>
</pre></div>
</div>
<p>with the following properties</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span> <span class="n">assert</span><span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="n">b</span><span class="p">);</span>
<span class="n">T</span> <span class="n">a</span><span class="p">;</span> <span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">;</span> <span class="n">is</span> <span class="n">equivalent</span> <span class="n">to</span>  <span class="n">T</span> <span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">;</span>
<span class="n">T</span> <span class="n">a</span><span class="o">=</span><span class="n">c</span><span class="p">;</span> <span class="n">T</span> <span class="n">b</span><span class="o">=</span><span class="n">c</span><span class="p">;</span> <span class="n">a</span><span class="o">=</span><span class="n">d</span><span class="p">;</span> <span class="n">assert</span><span class="p">(</span><span class="n">b</span><span class="o">==</span><span class="n">c</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p class="first">When copied, assigned, it makes deep copy of the data and resizes itself if necessary (like e.g.  std::vector).</p>
</li>
<li><p class="first">Examples:</p>
<ul class="simple">
<li>std::vector&lt;T&gt;</li>
<li>triqs::arrays::array&lt;T,R&gt;, triqs::arrays::matrix&lt;T&gt;, triqs::arrays::vector&lt;T&gt;</li>
</ul>
</li>
</ul>
</li>
<li><p class="first">The <strong>view types</strong></p>
<ul class="simple">
<li>They have a <cite>documentation/manual/triqs semantics</cite>.</li>
<li>They are just partial or complete views of the corresponding regular type.</li>
<li>They never make deep copy, either in copying, constructing, transforming to python,</li>
<li>They cannot be resized.</li>
<li>They are useful to work on arrays, matrices, or on some part thereof, without making copies
(e.g. on a slice of an array, a column of a matrix).</li>
<li>Examples:<ul>
<li>triqs::arrays::array_view&lt;T,R&gt;, triqs::arrays::matrix_view, triqs::arrays::vector_view&lt;T&gt;</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Many triqs containers (array, matrix, green functions)
is therefore provided in two flavors, and it is crucial for the user
to learn and understand their difference in order to use them appropriately.</p>
<div class="section" id="behaviour-comparison-table-between-regular-and-view-types">
<h2>Behaviour comparison table between regular and view types<a class="headerlink" href="#behaviour-comparison-table-between-regular-and-view-types" title="Permalink to this headline">¶</a></h2>
<p>A detailed comparison of the behaviour of the two type of types is provided in the following table.</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="40%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Topics</th>
<th class="head">regular type (e.g. array, matrix, vector)</th>
<th class="head">view type (e.g. array_view, matrix_view, vector_view)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Contructors</td>
<td><ul class="first last simple">
<li>Constructors create a new fresh memory block.</li>
</ul>
</td>
<td><ul class="first last simple">
<li>Constructors only make another view of the data.</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>Default Contructor</td>
<td><ul class="first last simple">
<li>Default constructor creates an empty array</li>
</ul>
</td>
<td><ul class="first last simple">
<li>No default constructor (what would it view ?).</li>
</ul>
</td>
</tr>
<tr class="row-even"><td>Copy contructors</td>
<td><ul class="first last simple">
<li>Create a new fresh memory block.</li>
<li>Make a <em>true</em> copy of the data.</li>
</ul>
</td>
<td><ul class="first last simple">
<li>Make another view of the data (shallow copy).</li>
<li><em>Never</em> copy data, so they are quite quick.</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>Assignment (=)</td>
<td><ul class="first last simple">
<li>The assignment operator creates a new datablock if size mismatchs.</li>
<li>Hence, assignment never fail for size reason
(unless there is a memory allocation exception of course)</li>
</ul>
</td>
<td><ul class="first last simple">
<li>The assignment operator just copy data into the view.
Behaviour is undefined if the size of the view is too small.
(it throws if the array has option <cite>Tag::BoundCheck</cite> or if
<cite>TRIQS_ARRAYS_ENFORCE_BOUNDCHECK</cite> is defined, Cf below).</li>
</ul>
</td>
</tr>
<tr class="row-even"><td>Resizing</td>
<td><ul class="first last simple">
<li>Can be resized, invalidating all documentation/manual/triqss/pointers</li>
</ul>
</td>
<td>to the data.     - Can be not be resized.</td>
</tr>
<tr class="row-odd"><td>Invalidation</td>
<td><ul class="first last simple">
<li>References/pointers to the data may become invalid after resize,
or assignment.</li>
</ul>
</td>
<td><ul class="first last simple">
<li>References/pointers to the data  are still valid after assignment.</li>
</ul>
</td>
</tr>
<tr class="row-even"><td>Data Contiguity</td>
<td><ul class="first last simple">
<li>The data are contiguous in memory.</li>
</ul>
</td>
<td><ul class="first last simple">
<li>The data may not be contiguous in memory  (e.g. a slice).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="lazy.html" title="Interaction with CLEF expressions"
             >next</a> |</li>
        <li class="right" >
          <a href="shape.html" title="Shape &amp; dimensions"
             >previous</a> |</li>
    <li><a href="../../../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../../../documentation.html" >Documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../contents.html" >&lt;no title&gt;</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="contents.html" ><strong>[triqs/arrays]</strong> Multidimensional arrays</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011-2017, The TRIQS collaboration.
    </div>
  </body>
</html>