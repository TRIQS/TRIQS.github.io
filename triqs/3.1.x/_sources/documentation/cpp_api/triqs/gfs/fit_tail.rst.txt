..
   Generated automatically by cpp2rst

.. highlight:: c
.. role:: red
.. role:: green
.. role:: param


.. _triqs__gfs__fit_tail:

triqs::gfs::fit_tail
====================

*#include <triqs/gfs.hpp>*



**Synopsis**

 .. rst-class:: cppsynopsis

    1. | :green:`template<int N, typename G, typename A = typenameG::const_view_type::>`
       | std::pair<typename A::regular_type, double> :red:`fit_tail` (G const & :param:`g`, A const & :param:`known_moments` = {})

    2. | :green:`template<int N, typename BG, typename BA = std::vector<typenameBG::g_t::data_t::regular_type>`
       | std::pair<std::vector<typename BG::g_t::data_t::regular_type>, double> :red:`fit_tail` (BG const & :param:`bg`,
       |           BA const & :param:`known_moments` = {})

Documentation



 **1)**   Fit the tail of a Green function using a least-squares fitting procedure



 **2)**   Fit the tail of a Block Green function using a least-squares fitting procedure





Template parameters
^^^^^^^^^^^^^^^^^^^

 * :param:`N` The position of the frequency mesh in case of a product mesh [default: 0]

 * :param:`G` The type of the Green function (gf, gf_view, gf_const_view)

 * :param:`A` The type of the high-frequency moment array (array, array_view, array_const_view)

 * :param:`BG` The type of the Block Green function (block_gf, block_gf_view, block_gf_const_view)

 * :param:`AG` The type of the high-frequecy moments for Block Green functions (e.g. std::vector<array>)


Parameters
^^^^^^^^^^

 * :param:`g` The Green function object to fit the tail for

 * :param:`known_moments` The object containing the known high-frequency moments

 * :param:`bg` The Block Green function object to fit the tail for


Returns
^^^^^^^

A pair of the tail object and the fitting error

Example
^^^^^^^

..
   Included automatically from /src/triqs/doc/documentation/examples/triqs/gfs/fit_tail.cpp

.. code-block:: cpp

    #include <triqs/gfs.hpp>
    #include <triqs/mesh.hpp>
    #include <iomanip>

    using namespace triqs::gfs;
    using namespace triqs::mesh;
    nda::clef::placeholder<0> iw_;

    int main() {
      double beta = 1.0;
      int n_iw    = 100;
      auto g      = gf<imfreq>{{beta, Fermion, n_iw}, {1, 1}};
      g[iw_] << 1.0 / iw_;
      auto [tail, err] = fit_tail(g);
      std::cout << std::setprecision(2) << "Error: " << err << "\nTail:  " << tail;
    }


*Output*

.. code-block:: text

    Error: 2.9e-19
    Tail:  [(-4.1e-17,7.6e-17),(1,-2.3e-16),(-4.3e-11,3.8e-11),(-3e-09,-3.5e-10),(-1.4e-05,2.1e-05),(-0.00029,-7.5e-05),(-1.5,0)]