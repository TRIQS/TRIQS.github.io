
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>[triqs/hilbert_space] Many-body states and Hilbert spaces &#8212; TRIQS  documentation</title>
    <link rel="stylesheet" href="../../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=default"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="fundamental_operator_set" href="../../cpp2rst_generated/triqs/hilbert_space/fundamental_operator_set.html" />
    <link rel="prev" title="Coefficient extraction" href="../operators/util/extractors.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head>
  <body>
<div class="pageheader">
  <ul>
    
    <li><a href="../../install.html">Install</a></li>
    
    <li><a href="../../reference.html">Reference</a></li>
    
    <li><a href="../../tutorials.html">Tutorials</a></li>
    
    <li><a href="../../applications.html">Applications</a></li>
    
    <li><a href="../../issues.html">Issues</a></li>
    
    <li><a href="../../about.html">About TRIQS</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../../index.html">triqs</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">a Toolbox for Research on Interacting Quantum Systems</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../cpp2rst_generated/triqs/hilbert_space/fundamental_operator_set.html" title="fundamental_operator_set"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../operators/util/extractors.html" title="Coefficient extraction"
             accesskey="P">previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../reference.html" accesskey="U">Reference</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><strong>[triqs/hilbert_space]</strong> Many-body states and Hilbert spaces</a><ul>
<li><a class="reference internal" href="#example-of-use">Example of use</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../operators/util/extractors.html"
                        title="previous chapter">Coefficient extraction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../cpp2rst_generated/triqs/hilbert_space/fundamental_operator_set.html"
                        title="next chapter">fundamental_operator_set</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/reference/hilbert_space/contents.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="triqs-hilbert-space-many-body-states-and-hilbert-spaces">
<span id="hilbert-space-contents"></span><span id="index-0"></span><h1><strong>[triqs/hilbert_space]</strong> Many-body states and Hilbert spaces<a class="headerlink" href="#triqs-hilbert-space-many-body-states-and-hilbert-spaces" title="Permalink to this headline">¶</a></h1>
<p><cite>hilbert_space</cite> toolbox provides the user with a small set of abstractions, useful
for doing calculations in the Hamiltonian picture for finite fermionic systems.
Among these abstarctions are Hilbert spaces, their subspaces, states and operators acting on them.
There is also an efficient implementation of the automatic partitioning algorithm
that allows to split a Hilbert space into a number of subspaces, each invariant
under action of a given operator.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/fundamental_operator_set.html">[fundamental_operator_set] Fundamental operator set</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/fundamental_operator_set.html#member-types">Member types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/fundamental_operator_set.html#member-functions">Member functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/fundamental_operator_set.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/hilbert_space.html">[hilbert_space] Full Hilbert space</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/hilbert_space.html#member-functions">Member functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/hilbert_space.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/sub_hilbert_space.html">[sub_hilbert_space] Hilbert subspace</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/sub_hilbert_space.html#member-functions">Member functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/sub_hilbert_space.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/state.html">[state] Many-body state</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/state.html#member-types">Member types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/state.html#member-functions">Member functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/state.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/imperative_operator.html">[imperative_operator] Imperative operator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/imperative_operator.html#template-parameters">Template parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/imperative_operator.html#member-functions">Member functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/space_partition.html">[autopartition] Automatic partitioning algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/space_partition.html#template-parameters">Template parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/space_partition.html#member-types">Member types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/space_partition.html#member-functions">Member functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp2rst_generated/triqs/hilbert_space/space_partition.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="example-of-use">
<h2>Example of use<a class="headerlink" href="#example-of-use" title="Permalink to this headline">¶</a></h2>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;bitset&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;triqs/operators/many_body_operator.hpp&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;triqs/hilbert_space/fundamental_operator_set.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;triqs/hilbert_space/hilbert_space.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;triqs/hilbert_space/state.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;triqs/hilbert_space/imperative_operator.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;triqs/hilbert_space/space_partition.hpp&gt;</span><span class="cp"></span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">triqs</span><span class="o">::</span><span class="n">operators</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">triqs</span><span class="o">::</span><span class="n">hilbert_space</span><span class="p">;</span>
<span class="n">using</span> <span class="n">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="c1">// Model system: half-filled Hubbard dimer</span>

  <span class="c1">// Parameters</span>
  <span class="kt">double</span> <span class="n">U</span>  <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>   <span class="c1">// Coulomb repulsion</span>
  <span class="kt">double</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">U</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// Chemical potential</span>
  <span class="kt">double</span> <span class="n">t</span>  <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span>   <span class="c1">// Hopping amplitude</span>

  <span class="c1">// Set of fundamental operators</span>
  <span class="c1">// Every fundamental operator carries two indices, one atom index and one spin projection</span>
  <span class="n">fundamental_operator_set</span> <span class="n">fops</span><span class="p">;</span>
  <span class="n">fops</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;up&quot;</span><span class="p">);</span>
  <span class="n">fops</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;down&quot;</span><span class="p">);</span>
  <span class="n">fops</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;up&quot;</span><span class="p">);</span>
  <span class="n">fops</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;down&quot;</span><span class="p">);</span>

  <span class="c1">// Full Hilbert space of the dimer</span>
  <span class="n">hilbert_space</span> <span class="n">hs</span><span class="p">(</span><span class="n">fops</span><span class="p">);</span>

  <span class="c1">// Hamiltonian</span>
  <span class="k">auto</span> <span class="n">H</span> <span class="o">=</span> <span class="n">U</span> <span class="o">*</span> <span class="n">n</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;up&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;down&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">U</span> <span class="o">*</span> <span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;up&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;down&quot;</span><span class="p">);</span>
  <span class="n">H</span> <span class="o">+=</span> <span class="o">-</span><span class="n">mu</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;up&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;down&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;up&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;down&quot;</span><span class="p">));</span>

  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">s</span> <span class="p">:</span> <span class="p">{</span><span class="s">&quot;up&quot;</span><span class="p">,</span> <span class="s">&quot;down&quot;</span><span class="p">})</span> <span class="n">H</span> <span class="o">+=</span> <span class="o">-</span><span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">c_dag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">+</span> <span class="n">c_dag</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">));</span>

  <span class="c1">// Imperative form of the Hamiltonian acting on the full Hilbert space</span>
  <span class="n">using</span> <span class="n">full_hs_operator_t</span> <span class="o">=</span> <span class="n">imperative_operator</span><span class="o">&lt;</span><span class="n">hilbert_space</span><span class="p">,</span> <span class="kt">double</span><span class="p">,</span> <span class="nb">false</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="n">full_hs_operator_t</span> <span class="n">hamiltonian</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">fops</span><span class="p">);</span>

  <span class="c1">// Many-body state in the full Hilbert space</span>
  <span class="n">using</span> <span class="n">state_t</span> <span class="o">=</span> <span class="n">state</span><span class="o">&lt;</span><span class="n">hilbert_space</span><span class="p">,</span> <span class="kt">double</span><span class="p">,</span> <span class="nb">true</span> <span class="cm">/* using sparse storage */</span><span class="o">&gt;</span><span class="p">;</span>
  <span class="n">state_t</span> <span class="n">st</span><span class="p">(</span><span class="n">hs</span><span class="p">);</span>

  <span class="c1">// Partition the Hilbert space</span>
  <span class="n">space_partition</span><span class="o">&lt;</span><span class="n">state_t</span><span class="p">,</span> <span class="n">full_hs_operator_t</span><span class="o">&gt;</span> <span class="n">partition</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">);</span>

  <span class="c1">// Preallocate a container for the invariant subspaces of H</span>
  <span class="n">vector</span><span class="o">&lt;</span><span class="n">sub_hilbert_space</span><span class="o">&gt;</span> <span class="n">inv_subspaces</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">partition</span><span class="p">.</span><span class="n">n_subspaces</span><span class="p">();</span> <span class="o">++</span><span class="n">n</span><span class="p">)</span> <span class="n">inv_subspaces</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>

  <span class="c1">// Fill the subspaces with Fock spaces</span>
  <span class="n">foreach</span> <span class="p">(</span><span class="n">partition</span><span class="p">,</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">spn</span><span class="p">)</span> <span class="p">{</span> <span class="n">inv_subspaces</span><span class="p">[</span><span class="n">spn</span><span class="p">].</span><span class="n">add_fock_state</span><span class="p">(</span><span class="n">hs</span><span class="p">.</span><span class="n">get_fock_state</span><span class="p">(</span><span class="n">s</span><span class="p">));</span> <span class="p">})</span>
    <span class="p">;</span>

  <span class="c1">// Observables: N_up and N_dn</span>
  <span class="k">auto</span> <span class="n">N_up</span> <span class="o">=</span> <span class="n">n</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;up&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;up&quot;</span><span class="p">),</span> <span class="n">N_down</span> <span class="o">=</span> <span class="n">n</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;down&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">n</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s">&quot;down&quot;</span><span class="p">);</span>

  <span class="c1">// Subspace connections generated by the observables</span>
  <span class="k">auto</span> <span class="n">N_up_conn</span>   <span class="o">=</span> <span class="n">partition</span><span class="p">.</span><span class="n">find_mappings</span><span class="p">(</span><span class="n">full_hs_operator_t</span><span class="p">(</span><span class="n">N_up</span><span class="p">,</span> <span class="n">fops</span><span class="p">));</span>
  <span class="k">auto</span> <span class="n">N_down_conn</span> <span class="o">=</span> <span class="n">partition</span><span class="p">.</span><span class="n">find_mappings</span><span class="p">(</span><span class="n">full_hs_operator_t</span><span class="p">(</span><span class="n">N_down</span><span class="p">,</span> <span class="n">fops</span><span class="p">));</span>

  <span class="c1">// Imperative versions of N_up and N_down acting between subspaces</span>
  <span class="n">using</span> <span class="n">sub_hs_operator_t</span> <span class="o">=</span> <span class="n">imperative_operator</span><span class="o">&lt;</span><span class="n">sub_hilbert_space</span><span class="p">,</span> <span class="kt">double</span><span class="p">,</span> <span class="nb">true</span><span class="o">&gt;</span><span class="p">;</span>

  <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">N_up_hilbert_map</span><span class="p">(</span><span class="n">inv_subspaces</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="k">const</span> <span class="o">&amp;</span><span class="nl">conn</span> <span class="p">:</span> <span class="n">N_up_conn</span><span class="p">)</span> <span class="n">N_up_hilbert_map</span><span class="p">[</span><span class="n">conn</span><span class="p">.</span><span class="n">first</span><span class="p">]</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
  <span class="n">sub_hs_operator_t</span> <span class="n">N_up_op</span><span class="p">(</span><span class="n">N_up</span><span class="p">,</span> <span class="n">fops</span><span class="p">,</span> <span class="n">N_up_hilbert_map</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_subspaces</span><span class="p">);</span>

  <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">N_down_hilbert_map</span><span class="p">(</span><span class="n">inv_subspaces</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="k">const</span> <span class="o">&amp;</span><span class="nl">conn</span> <span class="p">:</span> <span class="n">N_down_conn</span><span class="p">)</span> <span class="n">N_down_hilbert_map</span><span class="p">[</span><span class="n">conn</span><span class="p">.</span><span class="n">first</span><span class="p">]</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="n">second</span><span class="p">;</span>
  <span class="n">sub_hs_operator_t</span> <span class="n">N_down_op</span><span class="p">(</span><span class="n">N_down</span><span class="p">,</span> <span class="n">fops</span><span class="p">,</span> <span class="n">N_down_hilbert_map</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_subspaces</span><span class="p">);</span>

  <span class="c1">// Calculate and print expectation values of N_up and N_down</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">spn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">spn</span> <span class="o">&lt;</span> <span class="n">inv_subspaces</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">spn</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Iterate over invariant subspaces</span>
    <span class="k">auto</span> <span class="k">const</span> <span class="o">&amp;</span><span class="n">subspace</span> <span class="o">=</span> <span class="n">inv_subspaces</span><span class="p">[</span><span class="n">spn</span><span class="p">];</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Invariant subspace &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">spn</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;====================&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;State    N_up   N_dn&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;====================&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

    <span class="c1">// Iterate over basis Fock states in the selected subspace</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">subspace</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// Many-body state defined on the subspace</span>
      <span class="n">state</span><span class="o">&lt;</span><span class="n">sub_hilbert_space</span><span class="p">,</span> <span class="kt">double</span><span class="p">,</span> <span class="nb">false</span><span class="o">&gt;</span> <span class="n">ket</span><span class="p">(</span><span class="n">subspace</span><span class="p">);</span>
      <span class="n">ket</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

      <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;|&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">bitset</span><span class="o">&lt;</span><span class="mi">4</span><span class="o">&gt;</span><span class="p">(</span><span class="n">subspace</span><span class="p">.</span><span class="n">get_fock_state</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;&gt;   &quot;</span><span class="p">;</span>
      <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">N_up_hilbert_map</span><span class="p">[</span><span class="n">spn</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="n">dot_product</span><span class="p">(</span><span class="n">ket</span><span class="p">,</span> <span class="n">N_up_op</span><span class="p">(</span><span class="n">ket</span><span class="p">))</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;      &quot;</span><span class="p">;</span>
      <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">N_down_hilbert_map</span><span class="p">[</span><span class="n">spn</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="n">dot_product</span><span class="p">(</span><span class="n">ket</span><span class="p">,</span> <span class="n">N_down_op</span><span class="p">(</span><span class="n">ket</span><span class="p">))</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">----------</span> <span class="n">Result</span> <span class="n">is</span> <span class="o">-------</span>
<span class="n">Invariant</span> <span class="n">subspace</span> <span class="mi">0</span>
<span class="o">====================</span>
<span class="n">State</span>    <span class="n">N_up</span>   <span class="n">N_dn</span>
<span class="o">====================</span>
<span class="o">|</span><span class="mo">0000</span><span class="o">&gt;</span>   <span class="mi">0</span>      <span class="mi">0</span>
<span class="n">Invariant</span> <span class="n">subspace</span> <span class="mi">1</span>
<span class="o">====================</span>
<span class="n">State</span>    <span class="n">N_up</span>   <span class="n">N_dn</span>
<span class="o">====================</span>
<span class="o">|</span><span class="mo">0001</span><span class="o">&gt;</span>   <span class="mi">0</span>      <span class="mi">1</span>
<span class="o">|</span><span class="mo">0100</span><span class="o">&gt;</span>   <span class="mi">0</span>      <span class="mi">1</span>
<span class="n">Invariant</span> <span class="n">subspace</span> <span class="mi">2</span>
<span class="o">====================</span>
<span class="n">State</span>    <span class="n">N_up</span>   <span class="n">N_dn</span>
<span class="o">====================</span>
<span class="o">|</span><span class="mo">0010</span><span class="o">&gt;</span>   <span class="mi">1</span>      <span class="mi">0</span>
<span class="o">|</span><span class="mi">1000</span><span class="o">&gt;</span>   <span class="mi">1</span>      <span class="mi">0</span>
<span class="n">Invariant</span> <span class="n">subspace</span> <span class="mi">3</span>
<span class="o">====================</span>
<span class="n">State</span>    <span class="n">N_up</span>   <span class="n">N_dn</span>
<span class="o">====================</span>
<span class="o">|</span><span class="mo">0011</span><span class="o">&gt;</span>   <span class="mi">1</span>      <span class="mi">1</span>
<span class="o">|</span><span class="mo">0110</span><span class="o">&gt;</span>   <span class="mi">1</span>      <span class="mi">1</span>
<span class="o">|</span><span class="mi">1001</span><span class="o">&gt;</span>   <span class="mi">1</span>      <span class="mi">1</span>
<span class="o">|</span><span class="mi">1100</span><span class="o">&gt;</span>   <span class="mi">1</span>      <span class="mi">1</span>
<span class="n">Invariant</span> <span class="n">subspace</span> <span class="mi">4</span>
<span class="o">====================</span>
<span class="n">State</span>    <span class="n">N_up</span>   <span class="n">N_dn</span>
<span class="o">====================</span>
<span class="o">|</span><span class="mo">0101</span><span class="o">&gt;</span>   <span class="mi">0</span>      <span class="mi">2</span>
<span class="n">Invariant</span> <span class="n">subspace</span> <span class="mi">5</span>
<span class="o">====================</span>
<span class="n">State</span>    <span class="n">N_up</span>   <span class="n">N_dn</span>
<span class="o">====================</span>
<span class="o">|</span><span class="mo">0111</span><span class="o">&gt;</span>   <span class="mi">1</span>      <span class="mi">2</span>
<span class="o">|</span><span class="mi">1101</span><span class="o">&gt;</span>   <span class="mi">1</span>      <span class="mi">2</span>
<span class="n">Invariant</span> <span class="n">subspace</span> <span class="mi">6</span>
<span class="o">====================</span>
<span class="n">State</span>    <span class="n">N_up</span>   <span class="n">N_dn</span>
<span class="o">====================</span>
<span class="o">|</span><span class="mi">1010</span><span class="o">&gt;</span>   <span class="mi">2</span>      <span class="mi">0</span>
<span class="n">Invariant</span> <span class="n">subspace</span> <span class="mi">7</span>
<span class="o">====================</span>
<span class="n">State</span>    <span class="n">N_up</span>   <span class="n">N_dn</span>
<span class="o">====================</span>
<span class="o">|</span><span class="mi">1011</span><span class="o">&gt;</span>   <span class="mi">2</span>      <span class="mi">1</span>
<span class="o">|</span><span class="mi">1110</span><span class="o">&gt;</span>   <span class="mi">2</span>      <span class="mi">1</span>
<span class="n">Invariant</span> <span class="n">subspace</span> <span class="mi">8</span>
<span class="o">====================</span>
<span class="n">State</span>    <span class="n">N_up</span>   <span class="n">N_dn</span>
<span class="o">====================</span>
<span class="o">|</span><span class="mi">1111</span><span class="o">&gt;</span>   <span class="mi">2</span>      <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../cpp2rst_generated/triqs/hilbert_space/fundamental_operator_set.html" title="fundamental_operator_set"
             >next</a> |</li>
        <li class="right" >
          <a href="../operators/util/extractors.html" title="Coefficient extraction"
             >previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../reference.html" >Reference</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011-2017, The TRIQS collaboration.
    </div>
  </body>
</html>