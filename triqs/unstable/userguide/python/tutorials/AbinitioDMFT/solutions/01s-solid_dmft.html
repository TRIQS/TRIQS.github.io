<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TRIQS / solid_dmft tutorial &mdash; TRIQS 3.1.1 documentation</title>
      <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../_static/plot_directive.css" type="text/css" />
    <link rel="shortcut icon" href="../../../../../_static/triqs_favicon.ico"/>
  
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=default"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../../../../about.html" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >


<a href="index.html">
  <img src="../../../../../_static/Triqs_Logo_RGB_White.png" class="logo" alt="Logo"/>
</a>




  <div class="version">
    3.1.1
  </div>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../index.html">Welcome</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../index.html#triqs-applications">TRIQS applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../index.html#python-c">Python &amp; C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../index.html#where-to-start">Where to start?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../install.html#packaged-versions-of-triqs">Packaged Versions of TRIQS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../install.html#ubuntu-debian-packages">Ubuntu Debian packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../install.html#anaconda">Anaconda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../install.html#docker">Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../install.html#singularity">Singularity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../install.html#binder">Binder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../install.html#compiling-triqs-from-source-using-easybuild">Compiling TRIQS from source using EasyBuild</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../install.html#compiling-triqs-from-source-advanced">Compiling TRIQS from source (Advanced)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../install.html#prerequisites">Prerequisites</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../installation/requirements.html">A complete list of requirements</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/requirements.html#c-compilers">C++ compilers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/requirements.html#tools-and-libraries">Tools and Libraries</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/requirements.html#building-the-triqs-documentation">Building the TRIQS documentation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../installation/ubuntu.html">Installing required libraries on Ubuntu</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/ubuntu.html#issues">Issues</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../installation/osx_install.html">Prerequisites for the TRIQS Compilation on Mac OS X</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/osx_install.html#disclaimer">Disclaimer</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/osx_install.html#installation-of-the-dependencies">Installation of the dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../install.html#environment-setup">Environment setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../install.html#further-reading">Further reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../installation/install_options.html">Customizing your installation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/install_options.html#cmake-options">cmake options</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../installation/environment_vars.html">Unix environment variables</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/environment_vars.html#common-environment-variables">Common environment variables</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/environment_vars.html#environment-variables-for-software-developement">Environment variables for software developement</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/environment_vars.html#environment-variables-affecting-openmp">Environment variables affecting OpenMP</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../installation/python_virtualenv.html">Python Virtual Environments</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/python_virtualenv.html#usage">Usage</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/python_virtualenv.html#compiling-a-package-from-source">Compiling a package from source</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../installation/clang.html">Using the clang compiler</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/clang.html#get-and-install-clang-on-linux">Get and install clang on linux</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/clang.html#usage">Usage</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../installation/clang.html#libclang">libclang</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../documentation.html">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../documentation.html#manual">Manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/atom_diag/contents.html"><strong>[triqs/atom_diag]</strong> Lightweight exact diagonalization solver and tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atom_diag.html"> [atom_diag] Exact diagonalization of an atomic problem</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atom_diag.html#template-parameters">Template parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atom_diag.html#member-types">Member types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atom_diag.html#member-functions">Member functions</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/atom_diag/functions.html"> [atom_diag_functions] Utility functions for atom_diag</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/partition_function.html">triqs::atom_diag::partition_function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_density_matrix.html">triqs::atom_diag::atomic_density_matrix</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/trace_rho_op.html">triqs::atom_diag::trace_rho_op</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/act.html">triqs::atom_diag::act</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/quantum_number_eigenvalues.html">triqs::atom_diag::quantum_number_eigenvalues</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/quantum_number_eigenvalues_checked.html">triqs::atom_diag::quantum_number_eigenvalues_checked</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_iw.html">triqs::atom_diag::atomic_g_iw</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_l.html">triqs::atom_diag::atomic_g_l</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_lehmann.html">triqs::atom_diag::atomic_g_lehmann</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_tau.html">triqs::atom_diag::atomic_g_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_w.html">triqs::atom_diag::atomic_g_w</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/atom_diag/contents.html#example-of-use-python">Example of use: Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/atom_diag/contents.html#example-of-use-c">Example of use: C++</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/contents.html"><strong>[triqs/clef]</strong> Clef: Compile-time lazy expressions and functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/introduction.html">Motivation: a little tour of CLEF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/expressions_form.html">Forming CLEF expressions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/expressions_form.html#placeholders">Placeholders</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/expressions_form.html#forming-an-expression">Forming an expression</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/expressions_form.html#storage-of-expressions-advanced">Storage of expressions [advanced]</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/expressions_eval.html">Evaluating CLEF expressions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/expressions_eval.html#complete-evaluation">Complete evaluation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/expressions_eval.html#partial-evaluation">Partial evaluation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/assign.html">Automatic assignment of containers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/overload.html">Overloading functions and methods for CLEF arguments</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/overload.html#overloading-functions">Overloading functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/overload.html#overloading-operator-and-other-methods">Overloading operator() and other methods</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/function.html">Transform CLEF expressions into functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/function.html#make-function">make_function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/function.html#clef-function">clef::function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/function.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/examples/contents.html">More complex examples</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/clef/examples/lazy_sum.html">A lazy sum</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/contents.html">Manipulations of determinants</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/det_manip.html">The det_manip class</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/det_manip.html#parameter-construction">Parameter &amp; construction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/det_manip.html#public-types">Public types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/det_manip.html#public-member-functions">Public member functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/det_manip.html#synopsis">Synopsis</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/det_manip.html#under-the-hood">Under the hood …</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/det_manip.html#full-documentation-manual-triqs">Full documentation/manual/triqs</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/det_manip.html#example">Example</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/implementation_notes.html">How does it work ?</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/implementation_notes.html#cofactors">Cofactors</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/implementation_notes.html#the-sherman-morrison-formula">The Sherman-Morrison formula</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/implementation_notes.html#addition-of-a-line-and-a-column-or-more">Addition of a line and a column, or more</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/implementation_notes.html#removal-of-a-line-and-a-column-or-more">Removal of a line and a column, or more</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/implementation_notes.html#change-of-a-column">Change of a column</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/implementation_notes.html#change-of-a-line">Change of a line</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/det_manip/implementation_notes.html#change-of-a-line-and-a-column">Change of a line and a column</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/contents.html">Green’s functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/concepts.html">Concepts</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/concepts.html#domain">Domain</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/concepts.html#purefunctionondomain">PureFunctionOnDomain</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/concepts.html#mesh">Mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/concepts.html#meshpoint">MeshPoint</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/basic_notions/contents.html">Basic notions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/basic_notions/contents.html#types-of-green-s-functions">Types of Green’s functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/basic_notions/contents.html#fourier-and-legendre-transforms">Fourier and Legendre transforms</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/basic_notions/contents.html#high-frequency-tail">High-frequency tail</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/contents.html">c++</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/gf_and_view.html">gf and views</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/gf_special.html">Specializations</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/clef.html">Interaction with CLEF expressions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/fourier.html">Fourier transforms</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/tail.html">High-Frequency moments of the Green’s function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/concepts.html">Concepts</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/c%2B%2B/implementation_notes.html">Implementation notes</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/py/contents.html">py</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/py/block.html">The blocks: matrix-valued Green’s functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/py/full.html"><strong>BlockGf</strong>: The complete Green’s function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/py/transforms.html">Fourier and Legendre to Matsubara transforms</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/py/tail.html">High-Frequency moments of the Green’s function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/gfs/py/tools.html">Tools for GFs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/hilbert_space/contents.html"><strong>[triqs/hilbert_space]</strong> Many-body states and Hilbert spaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/fundamental_operator_set.html">[fundamental_operator_set] Fundamental operator set</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/fundamental_operator_set.html#member-types">Member types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/fundamental_operator_set.html#member-functions">Member functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/fundamental_operator_set.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/hilbert_space.html">[hilbert_space] Full Hilbert space</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/hilbert_space.html#member-functions">Member functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/hilbert_space.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/sub_hilbert_space.html">[sub_hilbert_space] Hilbert subspace</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/sub_hilbert_space.html#member-functions">Member functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/sub_hilbert_space.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/state.html">[state] Many-body state</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/state.html#template-parameters">Template parameters</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/imperative_operator.html">[imperative_operator] Imperative operator</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/imperative_operator.html#template-parameters">Template parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/imperative_operator.html#member-functions">Member functions</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/space_partition.html">[autopartition] Automatic partitioning algorithm</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/space_partition.html#template-parameters">Template parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/space_partition.html#member-types">Member types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/space_partition.html#member-functions">Member functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/space_partition.html#non-member-functions">Non Member functions</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/hilbert_space/contents.html#example-of-use">Example of use</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/lattice_tools/contents.html"><strong>[triqs/lattice]</strong> Lattice tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/lattice_tools/contents.html#introductory-example">Introductory example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/lattice_tools/contents.html#reference-documentation-manual">Reference documentation/manual</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/lattice_tools/bravais.html">Bravais Lattice</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/lattice_tools/tightbinding_and_example.html">The BravaisLattice and TightBinding classes: definitions and example</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/lattice_tools/dos.html">Density of state and related tools</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/lattice_tools/hilbert.html">Hilbert Transform</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/lattice_tools/sumk.html">Sums over Brillouin zone</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/contents.html">Tools for Monte Carlo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/loop.html">Introduction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/loop.html#the-monte-carlo-loop">The Monte Carlo loop</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/loop.html#c-variable-names">C++ variable names</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/loop.html#monte-carlo-loop-and-connection-with-moves-and-measures">Monte Carlo loop and connection with moves and measures</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html">Tutorial</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html#the-c-code-for-this-problem">The C++ code for this problem</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html#initializing-the-mpi">Initializing the MPI</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html#constructing-the-monte-carlo-simulation">Constructing the Monte Carlo simulation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html#moves-and-measures">Moves and measures</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html#the-move">The move</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html#the-measure">The measure</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html#starting-the-monte-carlo-simulation">Starting the Monte Carlo simulation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html#end-of-the-simulation-gathering-results">End of the simulation - gathering results</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/tutorial.html#writing-your-own-monte-carlo-simulation">Writing your own Monte Carlo simulation</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/concepts.html">Concepts</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/concepts.html#introduction-motivations">Introduction &amp; Motivations</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/concepts.html#the-move-concept">The Move concept</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/concepts.html#the-measure-concept">The Measure concept</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/full_ref.html">Full documentation/manual/triqs</a><ul class="simple">
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/random.html">Random number generator</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/random.html#generic-use">Generic use</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/random.html#getting-a-list-of-random-number-generators">Getting a list of random number generators</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/random.html#accessing-the-random-number-generator-from-the-monte-carlo-class">Accessing the random number generator from the Monte Carlo class</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/ising.html">Example: the Ising chain in a magnetic field</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/ising.html#the-configuration">The configuration</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/ising.html#the-move">The move</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/ising.html#measure">Measure</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/mc_tools/ising.html#main-program">Main program</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/contents.html"><strong>[triqs/operators]</strong> Second-quantization operators and many-body Hamiltonians</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html">Second-quantization operators</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html#template-parameters">Template parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html#construction-factories">Construction/factories</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html#overloaded-operations">Overloaded operations</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html#member-types">Member types</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html#methods">Methods</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html#free-functions">Free functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html#iteration-over-monomials">Iteration over monomials</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html#serialization-hdf5">Serialization &amp; HDF5</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/operators.html#python">Python</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/util/hamiltonians.html">Hamiltonians</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/util/U_matrix.html">U matrix construction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/util/observables.html">Observables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/util/op_struct.html">Helper functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/util/extractors.html">Coefficient extraction</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/util/extractors.html#c">C++</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/operators/util/extractors.html#python">Python</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/plotting_protocols/contents.html">Plotting protocols</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/plotting_protocols/plotting/plotting.html">Plotting TRIQS objects</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/plotting_protocols/plotting/plotting.html#a-thin-layer-above-matplotlib">A thin layer above matplotlib</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/plotting_protocols/plotting/plotting.html#multiple-panels-figures">Multiple panels figures</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/plotting_protocols/plotting/plotting.html#plot-protocol-advanced">Plot protocol [Advanced]</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/plotting_protocols/fit/fit.html">Fitting data</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/plotting_protocols/fit/fit.html#a-simple-example">A simple example</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/plotting_protocols/fit/fit.html#reference">Reference</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/provenance/contents.html">Reproducibility, provenance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/provenance/contents.html#triqs-code-version">TRIQS code version</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/provenance/contents.html#saving-the-script-in-the-data-archive">Saving the script in the data archive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/provenance/contents.html#from-the-data-to-the-figures">From the data to the figures</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/random_generator/contents.html">Random number generators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/random_generator/contents.html#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/random_generator/contents.html#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/random_generator/contents.html#complete-documentation-manual-triqs">Complete documentation/manual/triqs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/stat/contents.html"><strong>[triqs/stat]</strong> Statistical Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/stat/contents.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/stat/contents.html#processing-correlated-data">Processing Correlated Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/stat/contents.html#averages-and-standard-errors">Averages and Standard Errors</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/contents.html"><strong>[triqs/utility]</strong> Utilities: exceptions, tuple-tools, etc.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/exceptions.html">1. Exceptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/tupletools.html">2. Tuple tools</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/tupletools.html#apply">2.1. apply</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/tupletools.html#for-each">2.2. for_each</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/tupletools.html#for-each-zip">2.3. for_each_zip</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/tupletools.html#map">2.4. map</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/tupletools.html#fold">2.5. fold</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/tupletools.html#reverse">2.6. reverse</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/tupletools.html#called-on-tuple">2.7. called_on_tuple</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/utilities/python_include_mess.html">3. Python include warnings</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/triqs/conventions.html">Notations and documentation conventions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/conventions.html#notation">Notation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/conventions.html#documentation-conventions-for-c-code">Documentation conventions for C++ code</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/triqs/conventions.html#add">add</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/conventions.html#template-parameters">Template parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/conventions.html#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/triqs/conventions.html#return-value">Return value</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/hdf5/contents.html"><strong>[triqs/h5]</strong> The HDF5 format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/hdf5/ref.html">Reference documentation/manual</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/hdf5/ref.html#hdfarchive">HDFArchive</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/hdf5/ref.html#hdfarchivegroup">HDFArchiveGroup</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/hdf5/ref.html#hdfarchiveinert">HDFArchiveInert</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/hdf5/ref.html#hdf-compliant-objects">Hdf-compliant objects</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/hdf5/tutorial.html">Green’s function and HDF5 files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/02-Archiving_your_data.html">HDF5 Archives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/02-Archiving_your_data.html#Writing-to-an-archive">Writing to an archive</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/02-Archiving_your_data.html#Reading-from-an-archive">Reading from an archive</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/mpi/contents.html">triqs/MPI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/mpi/contents.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/mpi/contents.html#mpi-documentation-manual-triqs">MPI documentation/manual/triqs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/mpi/contents.html#supported-functions-and-types">Supported functions and types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/mpi/contents.html#basic-usage">Basic usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/mpi/contents.html#headers">Headers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/mpi/contents.html#mpi-example">MPI example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/manual/cpp2py/contents.html">Cpp2Py: a C++/Python interfacing tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/cpp2py/convert.html">Convertion  vs wrapping</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/cpp2py/convert.html#wrapping-classes-from-c-to-python">Wrapping classes from C++ to Python</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/cpp2py/convert.html#convertion">Convertion</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/cpp2py/principle.html">General Principle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/manual/cpp2py/reference.html">Python API of the desc file</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/cpp2py/module.html">The module_ class</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/cpp2py/cfunction.html">The cfunction class</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/manual/cpp2py/class.html">The class_ class</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../documentation.html#c-api">C++ API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs.html">triqs::gfs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs.html#type-aliases">Type aliases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs.html#classes">Classes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/gf.html">triqs::gfs::gf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/gf_view.html">triqs::gfs::gf_view</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/gf_const_view.html">triqs::gfs::gf_const_view</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/impl_tag.html">triqs::gfs::impl_tag</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/block_gf.html">triqs::gfs::block_gf</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs.html#functions">Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/evaluate.html">triqs::gfs::evaluate</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/h5_read_gf_struct.html">triqs::gfs::h5_read_gf_struct</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/mpi_reduce.html">triqs::gfs::mpi_reduce</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/make_block_gf.html">triqs::gfs::make_block_gf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/make_block_gf_view.html">triqs::gfs::make_block_gf_view</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/make_block2_gf.html">triqs::gfs::make_block2_gf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/inverse.html">triqs::gfs::inverse</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/reinterpret_scalar_valued_gf_as_matrix_valued.html">triqs::gfs::reinterpret_scalar_valued_gf_as_matrix_valued</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/make_gf_from_fourier.html">triqs::gfs::make_gf_from_fourier</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/make_gf_from_inverse_fourier.html">triqs::gfs::make_gf_from_inverse_fourier</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/fit_tail.html">triqs::gfs::fit_tail</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/fit_hermitian_tail.html">triqs::gfs::fit_hermitian_tail</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/make_zero_tail.html">triqs::gfs::make_zero_tail</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/is_gf_real.html">triqs::gfs::is_gf_real</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/real.html">triqs::gfs::real</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/imag.html">triqs::gfs::imag</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/make_gf_from_real_gf.html">triqs::gfs::make_gf_from_real_gf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/positive_freq_view.html">triqs::gfs::positive_freq_view</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/is_gf_hermitian.html">triqs::gfs::is_gf_hermitian</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/is_gf_real_in_tau.html">triqs::gfs::is_gf_real_in_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/make_hermitian.html">triqs::gfs::make_hermitian</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/make_real_in_tau.html">triqs::gfs::make_real_in_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/density.html">triqs::gfs::density</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/gfs/flatten_2d.html">triqs::gfs::flatten_2d</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/det_manip.html">triqs::det_manip</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/det_manip.html#classes">Classes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/det_manip/det_manip.html">triqs::det_manip::det_manip</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/mc_tools.html">triqs::mc_tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/mc_tools.html#classes">Classes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/mc_tools/random_generator.html">triqs::mc_tools::random_generator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/mc_tools/move_set.html">triqs::mc_tools::move_set</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/mc_tools/mc_generic.html">triqs::mc_tools::mc_generic</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/mc_tools.html#functions">Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/mc_tools/random_generator_names.html">triqs::mc_tools::random_generator_names</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space.html">triqs::hilbert_space</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space.html#type-aliases">Type aliases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space.html#classes">Classes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/fundamental_operator_set.html">triqs::hilbert_space::fundamental_operator_set</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/hilbert_space.html">triqs::hilbert_space::hilbert_space</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/sub_hilbert_space.html">triqs::hilbert_space::sub_hilbert_space</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/state.html">triqs::hilbert_space::state</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/stateLTHilbertSpace%2CScalarType%2CtrueGT.html">triqs::hilbert_space::state&lt;HilbertSpace,ScalarType,true&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/stateLTHilbertSpace%2CScalarType%2CfalseGT.html">triqs::hilbert_space::state&lt;HilbertSpace,ScalarType,false&gt;</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/imperative_operator.html">triqs::hilbert_space::imperative_operator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/space_partition.html">triqs::hilbert_space::space_partition</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space.html#functions">Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/hilbert_space/make_zero_state.html">triqs::hilbert_space::make_zero_state</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag.html">triqs::atom_diag</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag.html#type-aliases">Type aliases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag.html#classes">Classes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atom_diag.html">triqs::atom_diag::atom_diag</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag.html#functions">Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/partition_function.html">triqs::atom_diag::partition_function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_density_matrix.html">triqs::atom_diag::atomic_density_matrix</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/trace_rho_op.html">triqs::atom_diag::trace_rho_op</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/act.html">triqs::atom_diag::act</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/quantum_number_eigenvalues.html">triqs::atom_diag::quantum_number_eigenvalues</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/quantum_number_eigenvalues_checked.html">triqs::atom_diag::quantum_number_eigenvalues_checked</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_lehmann.html">triqs::atom_diag::atomic_g_lehmann</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_tau.html">triqs::atom_diag::atomic_g_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_iw.html">triqs::atom_diag::atomic_g_iw</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_l.html">triqs::atom_diag::atomic_g_l</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/atom_diag/atomic_g_w.html">triqs::atom_diag::atomic_g_w</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat.html">triqs::stat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat.html#classes">Classes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/accumulator.html">triqs::stat::accumulator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/histogram.html">triqs::stat::histogram</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat.html#functions">Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/mean.html">triqs::stat::mean</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/mean_mpi.html">triqs::stat::mean_mpi</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/mean_and_err.html">triqs::stat::mean_and_err</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/mean_and_err_mpi.html">triqs::stat::mean_and_err_mpi</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/tau_estimate_from_errors.html">triqs::stat::tau_estimate_from_errors</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/jackknife.html">triqs::stat::jackknife</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/jackknife_mpi.html">triqs::stat::jackknife_mpi</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/pdf.html">triqs::stat::pdf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/triqs/stat/cdf.html">triqs::stat::cdf</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi.html">mpi</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi.html#classes">Classes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi/environment.html">mpi::environment</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi/communicator.html">mpi::communicator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi/monitor.html">mpi::monitor</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi.html#functions">Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi/is_initialized.html">mpi::is_initialized</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi/broadcast.html">mpi::broadcast</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi/map_C_function.html">mpi::map_C_function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi/map_add.html">mpi::map_add</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/mpi/chunk.html">mpi::chunk</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools.html">itertools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools.html#classes">Classes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/range.html">itertools::range</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools.html#functions">Functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/transform.html">itertools::transform</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/enumerate.html">itertools::enumerate</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/zip.html">itertools::zip</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/zip_with.html">itertools::zip_with</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/product.html">itertools::product</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/slice.html">itertools::slice</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/stride.html">itertools::stride</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/product_range.html">itertools::product_range</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/chunk_range.html">itertools::chunk_range</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/cpp_api/itertools/foreach.html">itertools::foreach</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../documentation.html#python-api">Python API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.html">triqs.atom_diag</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.AtomDiag.html">triqs.atom_diag.AtomDiag</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.html">triqs.atom_diag.atom_diag</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.act.html">triqs.atom_diag.atom_diag.act</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.atomic_density_matrix.html">triqs.atom_diag.atom_diag.atomic_density_matrix</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.atomic_g_iw.html">triqs.atom_diag.atom_diag.atomic_g_iw</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.atomic_g_l.html">triqs.atom_diag.atom_diag.atomic_g_l</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.atomic_g_tau.html">triqs.atom_diag.atom_diag.atomic_g_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.atomic_g_w.html">triqs.atom_diag.atom_diag.atomic_g_w</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.partition_function.html">triqs.atom_diag.atom_diag.partition_function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.quantum_number_eigenvalues.html">triqs.atom_diag.atom_diag.quantum_number_eigenvalues</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.quantum_number_eigenvalues_checked.html">triqs.atom_diag.atom_diag.quantum_number_eigenvalues_checked</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.trace_rho_op.html">triqs.atom_diag.atom_diag.trace_rho_op</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.AtomDiagComplex.html">triqs.atom_diag.atom_diag.AtomDiagComplex</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag.AtomDiagReal.html">triqs.atom_diag.atom_diag.AtomDiagReal</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.atom_diag.atom_diag_desc.html">triqs.atom_diag.atom_diag_desc</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.dos.html">triqs.dos</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.dos.dos.html">triqs.dos.dos</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.dos.dos.dos_from_file.html">triqs.dos.dos.dos_from_file</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.dos.dos.DOS.html">triqs.dos.dos.DOS</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.dos.dos.DOSFromFunction.html">triqs.dos.dos.DOSFromFunction</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.dos.hilbert_transform.html">triqs.dos.hilbert_transform</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.dos.hilbert_transform.HilbertTransform.html">triqs.dos.hilbert_transform.HilbertTransform</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.fit.html">triqs.fit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.fit.fit.html">triqs.fit.fit</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.fit.fit.Fit.html">triqs.fit.fit.Fit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.html">triqs.gf</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.backwd_compat.html">triqs.gf.backwd_compat</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.backwd_compat.gf_imfreq.html">triqs.gf.backwd_compat.gf_imfreq</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.backwd_compat.gf_imtime.html">triqs.gf.backwd_compat.gf_imtime</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.backwd_compat.gf_legendre.html">triqs.gf.backwd_compat.gf_legendre</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.backwd_compat.gf_refreq.html">triqs.gf.backwd_compat.gf_refreq</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.backwd_compat.gf_retime.html">triqs.gf.backwd_compat.gf_retime</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.block2_gf.html">triqs.gf.block2_gf</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.block2_gf.Block2Gf.html">triqs.gf.block2_gf.Block2Gf</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.block_gf.html">triqs.gf.block_gf</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.block_gf.call_factory_from_dict.html">triqs.gf.block_gf.call_factory_from_dict</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.block_gf.fix_gf_struct_type.html">triqs.gf.block_gf.fix_gf_struct_type</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.block_gf.BlockGf.html">triqs.gf.block_gf.BlockGf</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.html">triqs.gf.descriptor_base</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.convert_scalar_to_const.html">triqs.gf.descriptor_base.convert_scalar_to_const</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.is_lazy.html">triqs.gf.descriptor_base.is_lazy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.is_scalar.html">triqs.gf.descriptor_base.is_scalar</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.Base.html">triqs.gf.descriptor_base.Base</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.BaseBlock.html">triqs.gf.descriptor_base.BaseBlock</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.Const.html">triqs.gf.descriptor_base.Const</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.Function.html">triqs.gf.descriptor_base.Function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.LazyCTX.html">triqs.gf.descriptor_base.LazyCTX</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptor_base.Omega_.html">triqs.gf.descriptor_base.Omega_</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptors.html">triqs.gf.descriptors</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptors.semi.html">triqs.gf.descriptors.semi</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptors.Flat.html">triqs.gf.descriptors.Flat</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptors.Fourier.html">triqs.gf.descriptors.Fourier</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptors.LegendreToMatsubara.html">triqs.gf.descriptors.LegendreToMatsubara</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptors.MatsubaraToLegendre.html">triqs.gf.descriptors.MatsubaraToLegendre</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptors.OneFermionInTime.html">triqs.gf.descriptors.OneFermionInTime</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptors.SemiCircular.html">triqs.gf.descriptors.SemiCircular</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.descriptors.Wilson.html">triqs.gf.descriptors.Wilson</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf.html">triqs.gf.gf</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf.add_method_helper.html">triqs.gf.gf.add_method_helper</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf.bckwd.html">triqs.gf.gf.bckwd</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf.call_factory_from_dict.html">triqs.gf.gf.call_factory_from_dict</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf.AddMethod.html">triqs.gf.gf.AddMethod</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf.CallProxyNone.html">triqs.gf.gf.CallProxyNone</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf.Gf.html">triqs.gf.gf.Gf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf.Idx.html">triqs.gf.gf.Idx</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_factories.html">triqs.gf.gf_factories</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_factories.make_gf_from_fourier.html">triqs.gf.gf_factories.make_gf_from_fourier</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_factories.make_hermitian.html">triqs.gf.gf_factories.make_hermitian</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_factories.make_real_in_tau.html">triqs.gf.gf_factories.make_real_in_tau</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_factories_desc.html">triqs.gf.gf_factories_desc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.html">triqs.gf.gf_fnt</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.density.html">triqs.gf.gf_fnt.density</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.enforce_discontinuity.html">triqs.gf.gf_fnt.enforce_discontinuity</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.fit_hermitian_tail.html">triqs.gf.gf_fnt.fit_hermitian_tail</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.fit_hermitian_tail_on_window.html">triqs.gf.gf_fnt.fit_hermitian_tail_on_window</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.fit_tail.html">triqs.gf.gf_fnt.fit_tail</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.fit_tail_on_window.html">triqs.gf.gf_fnt.fit_tail_on_window</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.is_gf_hermitian.html">triqs.gf.gf_fnt.is_gf_hermitian</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.is_gf_real_in_tau.html">triqs.gf.gf_fnt.is_gf_real_in_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.rebinning_tau.html">triqs.gf.gf_fnt.rebinning_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.replace_by_tail.html">triqs.gf.gf_fnt.replace_by_tail</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.replace_by_tail_in_fit_window.html">triqs.gf.gf_fnt.replace_by_tail_in_fit_window</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.set_from_fourier.html">triqs.gf.gf_fnt.set_from_fourier</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.set_from_imfreq.html">triqs.gf.gf_fnt.set_from_imfreq</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.set_from_imtime.html">triqs.gf.gf_fnt.set_from_imtime</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.set_from_legendre.html">triqs.gf.gf_fnt.set_from_legendre</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.set_from_pade.html">triqs.gf.gf_fnt.set_from_pade</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt.GfIndices.html">triqs.gf.gf_fnt.GfIndices</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.gf_fnt_desc.html">triqs.gf.gf_fnt_desc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.lazy_expressions.html">triqs.gf.lazy_expressions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.lazy_expressions.all_terminals.html">triqs.gf.lazy_expressions.all_terminals</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.lazy_expressions.eval_expr.html">triqs.gf.lazy_expressions.eval_expr</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.lazy_expressions.eval_expr_with_context.html">triqs.gf.lazy_expressions.eval_expr_with_context</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.lazy_expressions.lazy_function.html">triqs.gf.lazy_expressions.lazy_function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.lazy_expressions.make_lazy.html">triqs.gf.lazy_expressions.make_lazy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.lazy_expressions.transform.html">triqs.gf.lazy_expressions.transform</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.lazy_expressions.LazyExpr.html">triqs.gf.lazy_expressions.LazyExpr</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.lazy_expressions.LazyExprTerminal.html">triqs.gf.lazy_expressions.LazyExprTerminal</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.map_block.html">triqs.gf.map_block</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.mesh_point.html">triqs.gf.mesh_point</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.mesh_point.MeshPoint.html">triqs.gf.mesh_point.MeshPoint</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.mesh_point.MeshValueGenerator.html">triqs.gf.mesh_point.MeshValueGenerator</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.mesh_product.html">triqs.gf.mesh_product</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.mesh_product.call_factory_from_dict.html">triqs.gf.mesh_product.call_factory_from_dict</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.mesh_product.MeshProduct.html">triqs.gf.mesh_product.MeshProduct</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.html">triqs.gf.meshes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.make_adjoint_mesh.html">triqs.gf.meshes.make_adjoint_mesh</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.GfLegendreDomain.html">triqs.gf.meshes.GfLegendreDomain</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.MeshBrZone.html">triqs.gf.meshes.MeshBrZone</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.MeshCycLat.html">triqs.gf.meshes.MeshCycLat</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.MeshImFreq.html">triqs.gf.meshes.MeshImFreq</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.MeshImTime.html">triqs.gf.meshes.MeshImTime</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.MeshLegendre.html">triqs.gf.meshes.MeshLegendre</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.MeshReFreq.html">triqs.gf.meshes.MeshReFreq</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes.MeshReTime.html">triqs.gf.meshes.MeshReTime</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes_desc.html">triqs.gf.meshes_desc</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.meshes_desc.make_mesh.html">triqs.gf.meshes_desc.make_mesh</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.plot.html">triqs.gf.plot</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.plot.dispatcher.html">triqs.gf.plot.dispatcher</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.plot.bz.html">triqs.gf.plot.bz</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.plot.bz_x_x.html">triqs.gf.plot.bz_x_x</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.plot.one_var.html">triqs.gf.plot.one_var</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.plot.plot_base.html">triqs.gf.plot.plot_base</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.plot.select_indices.html">triqs.gf.plot.select_indices</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.html">triqs.gf.tools</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.conjugate.html">triqs.gf.tools.conjugate</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.delta.html">triqs.gf.tools.delta</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.discretize_bath.html">triqs.gf.tools.discretize_bath</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.dyson.html">triqs.gf.tools.dyson</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.fit_legendre.html">triqs.gf.tools.fit_legendre</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.inverse.html">triqs.gf.tools.inverse</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.make_delta.html">triqs.gf.tools.make_delta</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.make_zero_tail.html">triqs.gf.tools.make_zero_tail</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.read_gf_from_txt.html">triqs.gf.tools.read_gf_from_txt</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.transpose.html">triqs.gf.tools.transpose</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.tools.write_gf_to_txt.html">triqs.gf.tools.write_gf_to_txt</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.html">triqs.gf.wrapped_aux</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.set_from_gf_data_mul_LR.html">triqs.gf.wrapped_aux.set_from_gf_data_mul_LR</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyBrZone_0.html">triqs.gf.wrapped_aux.CallProxyBrZone_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyBrZone_2.html">triqs.gf.wrapped_aux.CallProxyBrZone_2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyBrZone_3.html">triqs.gf.wrapped_aux.CallProxyBrZone_3</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyBrZone_4.html">triqs.gf.wrapped_aux.CallProxyBrZone_4</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyBrZone_x_ImFreq_0.html">triqs.gf.wrapped_aux.CallProxyBrZone_x_ImFreq_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyBrZone_x_ImTime_0.html">triqs.gf.wrapped_aux.CallProxyBrZone_x_ImTime_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyBrZone_x_ReFreq_0.html">triqs.gf.wrapped_aux.CallProxyBrZone_x_ReFreq_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyBrZone_x_ReTime_0.html">triqs.gf.wrapped_aux.CallProxyBrZone_x_ReTime_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyCycLat_0.html">triqs.gf.wrapped_aux.CallProxyCycLat_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyCycLat_2.html">triqs.gf.wrapped_aux.CallProxyCycLat_2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyCycLat_3.html">triqs.gf.wrapped_aux.CallProxyCycLat_3</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyCycLat_4.html">triqs.gf.wrapped_aux.CallProxyCycLat_4</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyCycLat_x_ImFreq_0.html">triqs.gf.wrapped_aux.CallProxyCycLat_x_ImFreq_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyCycLat_x_ImTime_0.html">triqs.gf.wrapped_aux.CallProxyCycLat_x_ImTime_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyCycLat_x_ReFreq_0.html">triqs.gf.wrapped_aux.CallProxyCycLat_x_ReFreq_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyCycLat_x_ReTime_0.html">triqs.gf.wrapped_aux.CallProxyCycLat_x_ReTime_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyImFreq_0.html">triqs.gf.wrapped_aux.CallProxyImFreq_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyImFreq_2.html">triqs.gf.wrapped_aux.CallProxyImFreq_2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyImFreq_3.html">triqs.gf.wrapped_aux.CallProxyImFreq_3</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyImFreq_4.html">triqs.gf.wrapped_aux.CallProxyImFreq_4</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyImTime_0.html">triqs.gf.wrapped_aux.CallProxyImTime_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyImTime_2.html">triqs.gf.wrapped_aux.CallProxyImTime_2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyImTime_3.html">triqs.gf.wrapped_aux.CallProxyImTime_3</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyImTime_4.html">triqs.gf.wrapped_aux.CallProxyImTime_4</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyReFreq_0.html">triqs.gf.wrapped_aux.CallProxyReFreq_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyReFreq_2.html">triqs.gf.wrapped_aux.CallProxyReFreq_2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyReFreq_3.html">triqs.gf.wrapped_aux.CallProxyReFreq_3</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyReFreq_4.html">triqs.gf.wrapped_aux.CallProxyReFreq_4</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyReTime_0.html">triqs.gf.wrapped_aux.CallProxyReTime_0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyReTime_2.html">triqs.gf.wrapped_aux.CallProxyReTime_2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyReTime_3.html">triqs.gf.wrapped_aux.CallProxyReTime_3</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux.CallProxyReTime_4.html">triqs.gf.wrapped_aux.CallProxyReTime_4</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux_desc.html">triqs.gf.wrapped_aux_desc</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.gf.wrapped_aux_desc.all_calls.html">triqs.gf.wrapped_aux_desc.all_calls</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.html">triqs.lattice</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.bz_patch.html">triqs.lattice.bz_patch</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.bz_patch.BZPatch.html">triqs.lattice.bz_patch.BZPatch</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.html">triqs.lattice.lattice_tools</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.dos.html">triqs.lattice.lattice_tools.dos</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.dos_patch.html">triqs.lattice.lattice_tools.dos_patch</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.energies_on_bz_grid.html">triqs.lattice.lattice_tools.energies_on_bz_grid</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.energies_on_bz_path.html">triqs.lattice.lattice_tools.energies_on_bz_path</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.energy_matrix_on_bz_path.html">triqs.lattice.lattice_tools.energy_matrix_on_bz_path</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.hopping_stack.html">triqs.lattice.lattice_tools.hopping_stack</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.BravaisLattice.html">triqs.lattice.lattice_tools.BravaisLattice</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.BrillouinZone.html">triqs.lattice.lattice_tools.BrillouinZone</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools.TightBinding.html">triqs.lattice.lattice_tools.TightBinding</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.lattice_tools_desc.html">triqs.lattice.lattice_tools_desc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.super_lattice.html">triqs.lattice.super_lattice</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.super_lattice.TBSuperLattice.html">triqs.lattice.super_lattice.TBSuperLattice</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.tight_binding.html">triqs.lattice.tight_binding</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.tight_binding.dos.html">triqs.lattice.tight_binding.dos</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.tight_binding.dos_patch.html">triqs.lattice.tight_binding.dos_patch</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.tight_binding.TBLattice.html">triqs.lattice.tight_binding.TBLattice</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.utils.html">triqs.lattice.utils</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.utils.TB_from_pythTB.html">triqs.lattice.utils.TB_from_pythTB</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.utils.TB_from_wannier90.html">triqs.lattice.utils.TB_from_wannier90</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.utils.extend_wannier90_to_spin.html">triqs.lattice.utils.extend_wannier90_to_spin</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.utils.k_space_path.html">triqs.lattice.utils.k_space_path</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.utils.parse_hopping_from_wannier90_hr_dat.html">triqs.lattice.utils.parse_hopping_from_wannier90_hr_dat</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.lattice.utils.parse_lattice_vectors_from_wannier90_wout.html">triqs.lattice.utils.parse_lattice_vectors_from_wannier90_wout</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.html">triqs.operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.operators.html">triqs.operators.operators</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.operators.c.html">triqs.operators.operators.c</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.operators.c_dag.html">triqs.operators.operators.c_dag</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.operators.dagger.html">triqs.operators.operators.dagger</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.operators.n.html">triqs.operators.operators.n</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.operators.Operator.html">triqs.operators.operators.Operator</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.operators_desc.html">triqs.operators.operators_desc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.util.html">triqs.operators.util</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.util.U_matrix.html">triqs.operators.util.U_matrix</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.util.extractors.html">triqs.operators.util.extractors</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.util.extractors_desc.html">triqs.operators.util.extractors_desc</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.util.hamiltonians.html">triqs.operators.util.hamiltonians</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.util.observables.html">triqs.operators.util.observables</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.operators.util.op_struct.html">triqs.operators.util.op_struct</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.plot.html">triqs.plot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.plot.mpl_interface.html">triqs.plot.mpl_interface</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.plot.mpl_interface.oplot.html">triqs.plot.mpl_interface.oplot</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.plot.mpl_interface.oploti.html">triqs.plot.mpl_interface.oploti</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.plot.mpl_interface.oplotr.html">triqs.plot.mpl_interface.oplotr</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.plot.mpl_interface.use_amsmath.html">triqs.plot.mpl_interface.use_amsmath</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.plot.protocol.html">triqs.plot.protocol</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.plot.protocol.clip_array.html">triqs.plot.protocol.clip_array</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.plot.protocol.plot_protocol_apply.html">triqs.plot.protocol.plot_protocol_apply</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.random_generator.html">triqs.random_generator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.random_generator.RandomGenerator.html">triqs.random_generator.RandomGenerator</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.random_generator.RandomGenerator.__init__.html">triqs.random_generator.RandomGenerator.__init__</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.random_generator.random_generator.html">triqs.random_generator.random_generator</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.random_generator.random_generator.random_generator_names_list.html">triqs.random_generator.random_generator.random_generator_names_list</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.random_generator.random_generator_desc.html">triqs.random_generator.random_generator_desc</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.stat.html">triqs.stat</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.stat.histogram.html">triqs.stat.histogram</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.stat.histogram.plot.html">triqs.stat.histogram.plot</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.stat.histograms.html">triqs.stat.histograms</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.stat.histograms.cdf.html">triqs.stat.histograms.cdf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.stat.histograms.pdf.html">triqs.stat.histograms.pdf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.stat.histograms.Histogram.html">triqs.stat.histograms.Histogram</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.stat.histograms_desc.html">triqs.stat.histograms_desc</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.sumk.html">triqs.sumk</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.sumk.sumk_discrete.html">triqs.sumk.sumk_discrete</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.sumk.sumk_discrete.SumkDiscrete.html">triqs.sumk.sumk_discrete.SumkDiscrete</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.sumk.sumk_discrete_from_lattice.html">triqs.sumk.sumk_discrete_from_lattice</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.sumk.sumk_discrete_from_lattice.SumkDiscreteFromLattice.html">triqs.sumk.sumk_discrete_from_lattice.SumkDiscreteFromLattice</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.html">triqs.utility</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.bound_and_bisect.html">triqs.utility.bound_and_bisect</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.bound_and_bisect.bound_and_bisect.html">triqs.utility.bound_and_bisect.bound_and_bisect</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.bound_and_bisect.determine_bounds.html">triqs.utility.bound_and_bisect.determine_bounds</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.capture_stdout.html">triqs.utility.capture_stdout</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.comparison_tests.html">triqs.utility.comparison_tests</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.comparison_tests.assert_array_close_to_scalar.html">triqs.utility.comparison_tests.assert_array_close_to_scalar</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.comparison_tests.assert_arrays_are_close.html">triqs.utility.comparison_tests.assert_arrays_are_close</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.comparison_tests.assert_block2_gfs_are_close.html">triqs.utility.comparison_tests.assert_block2_gfs_are_close</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.comparison_tests.assert_block_gfs_are_close.html">triqs.utility.comparison_tests.assert_block_gfs_are_close</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.comparison_tests.assert_gfs_are_close.html">triqs.utility.comparison_tests.assert_gfs_are_close</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.dichotomy.html">triqs.utility.dichotomy</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.dichotomy.dichotomy.html">triqs.utility.dichotomy.dichotomy</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.dist_on_nodes.html">triqs.utility.dist_on_nodes</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.dist_on_nodes.DistributionOnNodes.html">triqs.utility.dist_on_nodes.DistributionOnNodes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.dist_on_nodes.DistributionOnNodesOneStack.html">triqs.utility.dist_on_nodes.DistributionOnNodesOneStack</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.dist_on_nodes.DistributionOnNodesTest.html">triqs.utility.dist_on_nodes.DistributionOnNodesTest</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.h5diff.html">triqs.utility.h5diff</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.h5diff.compare.html">triqs.utility.h5diff.compare</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.h5diff.h5diff.html">triqs.utility.h5diff.h5diff</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi.html">triqs.utility.mpi</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi.check_for_mpi.html">triqs.utility.mpi.check_for_mpi</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.html">triqs.utility.mpi_mpi4py</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.all_reduce.html">triqs.utility.mpi_mpi4py.all_reduce</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.barrier.html">triqs.utility.mpi_mpi4py.barrier</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.bcast.html">triqs.utility.mpi_mpi4py.bcast</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.is_master_node.html">triqs.utility.mpi_mpi4py.is_master_node</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.master_gets_host_names.html">triqs.utility.mpi_mpi4py.master_gets_host_names</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.myprint_err.html">triqs.utility.mpi_mpi4py.myprint_err</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.myprint_out.html">triqs.utility.mpi_mpi4py.myprint_out</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.recv.html">triqs.utility.mpi_mpi4py.recv</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.report.html">triqs.utility.mpi_mpi4py.report</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.send.html">triqs.utility.mpi_mpi4py.send</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.slice_array.html">triqs.utility.mpi_mpi4py.slice_array</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.slice_inf.html">triqs.utility.mpi_mpi4py.slice_inf</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_mpi4py.slice_sup.html">triqs.utility.mpi_mpi4py.slice_sup</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.html">triqs.utility.mpi_nompi</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.all_reduce.html">triqs.utility.mpi_nompi.all_reduce</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.barrier.html">triqs.utility.mpi_nompi.barrier</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.bcast.html">triqs.utility.mpi_nompi.bcast</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.is_master_node.html">triqs.utility.mpi_nompi.is_master_node</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.master_gets_host_names.html">triqs.utility.mpi_nompi.master_gets_host_names</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.myprint_err.html">triqs.utility.mpi_nompi.myprint_err</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.myprint_out.html">triqs.utility.mpi_nompi.myprint_out</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.recv.html">triqs.utility.mpi_nompi.recv</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.report.html">triqs.utility.mpi_nompi.report</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.send.html">triqs.utility.mpi_nompi.send</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.mpi_nompi.slice_array.html">triqs.utility.mpi_nompi.slice_array</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.redirect.html">triqs.utility.redirect</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.redirect.start_redirect.html">triqs.utility.redirect.start_redirect</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.redirect.stop_redirect.html">triqs.utility.redirect.stop_redirect</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../../documentation/python_api/triqs.utility.redirect.T.html">triqs.utility.redirect.T</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../userguide.html">User guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../userguide.html#why-use-triqs">Why use TRIQS?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../dmft_one_page.html">Dynamical mean-field theory on a Bethe lattice</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../userguide.html#python-tutorials">Python Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../basics.html">Basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html">Introducing python and the ipython notebook</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#Script-mode">Script mode</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#Interactive-shell-mode">Interactive shell mode</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#The-ipython-notebook">The ipython notebook</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#A-very-short-introduction-to-python">A very short introduction to python</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#Calculating">Calculating</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#Simple-loops-/-indentation">Simple loops / indentation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#If-statements">If statements</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#Defining-a-function">Defining a function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#Importing-modules">Importing modules</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#Lists">Lists</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#The-numpy-library">The numpy library</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#Defining-a-new-class">Defining a new class</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00a-Introducing_the_ipython_notebook.html#Getting-help">Getting help</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/00b-Matplotlib_Examples.html">Matplotlib Examples</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00b-Matplotlib_Examples.html#Goal-of-this-tutorial">Goal of this tutorial</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00b-Matplotlib_Examples.html#Inline-plots">Inline plots</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00b-Matplotlib_Examples.html#Making-the-plot-prettier">Making the plot prettier</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00b-Matplotlib_Examples.html#Subplots">Subplots</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00b-Matplotlib_Examples.html#Histograms-and-text">Histograms and text</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00b-Matplotlib_Examples.html#Python-like-approach-to-matplotlib">Python-like approach to matplotlib</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/00b-Matplotlib_Examples.html#More-examples">More examples</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html">TRIQS Green’s functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html#Matrix-Valued-Green-functions">Matrix-Valued Green functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html#Block-Green-functions">Block Green functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html#Additional-Initialization-Descriptors">Additional Initialization Descriptors</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html#Imaginary-frequency-Green’s-functions">Imaginary-frequency Green’s functions</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html#Arithmetic-Operations">Arithmetic Operations</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html#Obtaining-the-density">Obtaining the density</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html#Fourier-transforms">Fourier transforms</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html#Pade-analytical-continuation">Pade analytical continuation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/solutions/01s-Greens_functions.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/02-Archiving_your_data.html">HDF5 Archives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/02-Archiving_your_data.html#Writing-to-an-archive">Writing to an archive</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/02-Archiving_your_data.html#Reading-from-an-archive">Reading from an archive</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/03-Operators.html">Manipulating fermionic operators</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/03-Operators.html#Fundamental-operators">Fundamental operators</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/03-Operators.html#Number-operator">Number operator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/03-Operators.html#Operations-with-operators">Operations with operators</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/03-Operators.html#Exact-Diagonalization">Exact Diagonalization</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../Basics/04-Multivariable_Green_functions.html">Introduction to multivariable Green functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/04-Multivariable_Green_functions.html#Imports-and-parameters">Imports and parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/04-Multivariable_Green_functions.html#Constructing-and-Initializing-a-Lattice-Green-function">Constructing and Initializing a Lattice Green function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/04-Multivariable_Green_functions.html#Numpy-Broadcasting">Numpy Broadcasting</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/04-Multivariable_Green_functions.html#Evaluate-the-Green-function">Evaluate the Green function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/04-Multivariable_Green_functions.html#Partial-evaluation">Partial evaluation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../Basics/04-Multivariable_Green_functions.html#Defining-a-Tight-Binding-Hamiltonian">Defining a Tight-Binding Hamiltonian</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../model_dmft.html">Model DMFT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../ModelDMFT/solutions/01s-IPT_and_DMFT.html">A first DMFT calculation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/01s-IPT_and_DMFT.html#The-iterated-perturbation-theory">The iterated perturbation theory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/01s-IPT_and_DMFT.html#Dynamical-mean-field-theory">Dynamical mean-field theory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/01s-IPT_and_DMFT.html#Bethe-lattice-DMFT">Bethe lattice DMFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/01s-IPT_and_DMFT.html#Visualizing-the-Mott-transition">Visualizing the Mott transition</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/01s-IPT_and_DMFT.html#Comparison-with-the-literature">Comparison with the literature</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../ModelDMFT/02-Introduction_to_the_CTHYB_solver.html">General reminder: Anderson impurity model and CTHYB solver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ModelDMFT/02-Introduction_to_the_CTHYB_solver.html#The-TRIQS/CTHYB-impurity-solver">The TRIQS/CTHYB impurity solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/02-Introduction_to_the_CTHYB_solver.html#Setting-up-the-impurity-solver">Setting up the impurity solver</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/02-Introduction_to_the_CTHYB_solver.html#Visualizing-the-Matsubara-frequency-results">Visualizing the Matsubara-frequency results</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../ModelDMFT/solutions/03s-Single-orbital_Hubbard_with_CTQMC.html">Single-orbital Hubbard model</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/03s-Single-orbital_Hubbard_with_CTQMC.html#Solution-1">Solution 1</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/03s-Single-orbital_Hubbard_with_CTQMC.html#Solution-2">Solution 2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/03s-Single-orbital_Hubbard_with_CTQMC.html#Solution-3">Solution 3</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/03s-Single-orbital_Hubbard_with_CTQMC.html#Solution-4">Solution 4</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/03s-Single-orbital_Hubbard_with_CTQMC.html#Solution-5">Solution 5</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/03s-Single-orbital_Hubbard_with_CTQMC.html#Solution-6">Solution 6</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../ModelDMFT/solutions/04s-Two-orbital_Hubbard_with_CTQMC.html">Two-orbital Hubbard model</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/04s-Two-orbital_Hubbard_with_CTQMC.html#Solution-1">Solution 1</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/04s-Two-orbital_Hubbard_with_CTQMC.html#Solution-2">Solution 2</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/04s-Two-orbital_Hubbard_with_CTQMC.html#Solution-of-exercise-3">Solution of exercise 3</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../ModelDMFT/solutions/05s-VBDMFT_Hubbard.html">Valence-Bond DMFT solution of the Hubbard model</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../ModelDMFT/solutions/05s-VBDMFT_Hubbard.html#Analyzing-the-precomputed-results">Analyzing the precomputed results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../two_particle_response.html">Two-particle Response</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../TwoParticleResponse/solutions/01s-Fermi_surface_nesting.html">Square lattice &amp; perfect nesting</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/01s-Fermi_surface_nesting.html#Lattice-non-interacting-Green-function">Lattice non-interacting Green function</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/01s-Fermi_surface_nesting.html#For-nearest-neighbor-model,-the-Fermi-surface-is-nested">For nearest-neighbor model, the Fermi surface is nested</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../TwoParticleResponse/solutions/02s-Lindhard.html">Lindhard susceptibility <span class="math notranslate nohighlight">\(\chi_0\)</span> for a non interacting electron gas</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/02s-Lindhard.html#Computing-\chi_0-in-C++">Computing <span class="math notranslate nohighlight">\(\chi_0\)</span> in C++</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/02s-Lindhard.html#Compute-the-Lindhard-susceptibility-\chi_0(\mathbf{q},-i\omega_n)">Compute the Lindhard susceptibility <span class="math notranslate nohighlight">\(\chi_0(\mathbf{q}, i\omega_n)\)</span></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/02s-Lindhard.html#Static-Lindhard-susceptibility-\chi_0(\mathbf{q},-\omega=0)">Static Lindhard susceptibility <span class="math notranslate nohighlight">\(\chi_0(\mathbf{q}, \omega=0)\)</span></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/02s-Lindhard.html#Plot-the-susceptibility">Plot the susceptibility</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../TwoParticleResponse/solutions/03s-RPA.html">The random phase approximation (RPA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../TwoParticleResponse/solutions/04s-TPSC.html">Two-particle self consistency (TPSC)</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/04s-TPSC.html#Behaviour-of-U_{sp}-and-U_{ch}">Behaviour of <span class="math notranslate nohighlight">\(U_{sp}\)</span> and <span class="math notranslate nohighlight">\(U_{ch}\)</span></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html">TPSC and the Mermin-Wagner theorem</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html#Introduction">Introduction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html#Code-from-previous-notebooks">Code from previous notebooks</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html#Fast-\chi_0-calculator">Fast <span class="math notranslate nohighlight">\(\chi_0\)</span> calculator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html#Parameters">Parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html#RPA-spin-structure-factor-S_{RPA}-as-a-function-of-temperature-T">RPA spin structure factor <span class="math notranslate nohighlight">\(S_{RPA}\)</span> as a function of temperature <span class="math notranslate nohighlight">\(T\)</span></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html#TPSC-spin-structure-factor-S_{TPSC}-as-a-function-of-temperature">TPSC spin structure factor <span class="math notranslate nohighlight">\(S_{TPSC}\)</span> as a function of temperature</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html#Question">Question</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html#Answer">Answer</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../TwoParticleResponse/solutions/05s-TPSC_MerminWagner.html#Remarks">Remarks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../external_resources.html">Learn more about Python, ipython and the notebook</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../userguide.html#a-quick-tour-in-c">A quick tour in C++</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../c%2B%2B/gfs/tutorial.html">Green’s functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/gfs/tutorial.html#matsubara-green-s-functions">Matsubara Green’s functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../c%2B%2B/gfs/tutorial.html#creation-of-a-simple-green-s-function-g-i-omega">Creation of a simple Green’s function <span class="math notranslate nohighlight">\(G(i\omega)\)</span></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../c%2B%2B/gfs/tutorial.html#two-frequency-green-s-function-g-i-omega-i-nu">Two-frequency Green’s function <span class="math notranslate nohighlight">\(G(i\omega,i\nu)\)</span></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/gfs/tutorial.html#imaginary-time-green-s-functions-g-tau">Imaginary-time Green’s functions <span class="math notranslate nohighlight">\(G(\tau)\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/gfs/tutorial.html#real-time-green-s-functions-g-t">Real-time Green’s functions <span class="math notranslate nohighlight">\(G(t)\)</span></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../c%2B%2B/gfs/tutorial.html#creation-of-a-two-real-time-gf-g-t-t">Creation of a two real time GF <span class="math notranslate nohighlight">\(G(t,t')\)</span></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../c%2B%2B/gfs/tutorial.html#how-to-fill-a-gf-with-placeholders">How to fill a GF with placeholders</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../c%2B%2B/gfs/tutorial.html#how-to-interpolate-the-gf-value-at-a-point-of-the-domain">How to interpolate the GF value at a point of the domain</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../c%2B%2B/arrays/tutorial.html">Multidimensional arrays</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/arrays/tutorial.html#declaring-and-printing-an-array">Declaring and printing an array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/arrays/tutorial.html#simple-operations">Simple operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/arrays/tutorial.html#hdf5-archiving">HDF5 Archiving</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/arrays/tutorial.html#views-ranges-and-slices">Views: ranges and slices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/arrays/tutorial.html#matrices-and-vectors">Matrices and vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/arrays/tutorial.html#defining-through-a-lazy-expression">Defining through a lazy expression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/arrays/tutorial.html#linear-algebra">Linear algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/arrays/tutorial.html#map-and-fold">Map and fold</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html">det_manip: Determinant manipulations for CTQMC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html#creation-of-an-empty-det-manip-class">Creation of an empty det_manip class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html#creation-of-a-non-empty-det-manip-class">Creation of a non empty det_manip class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html#get-information-about-a-det-manip-class">Get information about a det_manip class</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html#add-a-line-and-a-column">Add a line and a column</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html#remove-a-line-and-a-column">Remove a line and a column</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html#add-two-lines-and-two-columns">Add two lines and two columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html#remove-two-lines-and-two-columns">Remove two lines and two columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html#remove-add-the-one-two-last-lines-and-columns">Remove/add the one/two last lines and columns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/det_manip/tutorial.html#replace-one-line-and-column">Replace one line and column</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../c%2B%2B/hdf5/tutorial.html">Green’s function and HDF5 files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../c%2B%2B/using_the_lib/contents.html">Using TRIQS in your own C++ project</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/using_the_lib/triqs_library.html">Writing you own C++ code with TRIQS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/using_the_lib/triqs_library.html#a-simple-c-project-with-its-tests-and-documentation">A simple C++ project, with its tests and documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/using_the_lib/triqs_library.html#a-mixed-c-python-project">A mixed C++/Python project</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../c%2B%2B/using_the_lib/application_structure.html">Conventions for TRIQS applications</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../../c%2B%2B/using_the_lib/application_structure.html#source-structure">Source structure</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../c%2B%2B/using_the_lib/application_structure.html#install-structure">Install structure</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../../c%2B%2B/using_the_lib/application_structure.html#build-structure">Build structure</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../applications.html"><strong>Applications based on TRIQS</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../applications.html#impurity-solvers"><strong>Impurity Solvers</strong></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#hybridization-expansion-solver"><strong>Hybridization-expansion solver</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#hubbard-i-solver"><strong>Hubbard I solver</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#hartree-fock-solver"><strong>Hartree Fock solver</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#pyed-exact-diagonalization-for-finite-quantum-systems-external"><strong>PYED - Exact diagonalization for finite quantum systems (external)</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#interface-to-the-pomerol-exact-diagonalization-solver-external"><strong>Interface to the pomerol exact diagonalization solver (external)</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#interface-to-the-w2dynamics-impurity-solver"><strong>Interface to the w2dynamics impurity solver</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#interface-to-the-nrg-ljubljana-impurity-solver"><strong>Interface to the NRG Ljubljana impurity solver</strong></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../applications.html#ab-initio-tools"><strong>Ab-Initio Tools</strong></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#dft-tools-toolbox-for-ab-initio-calculations-of-correlated-materials"><strong>DFT tools - Toolbox for ab initio calculations of correlated materials</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#solid-dmft-python-wrapper-to-perform-dft-dmft-calculations-using-triqs"><strong>solid_dmft - Python wrapper to perform DFT+DMFT calculations using TRIQS</strong></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../applications.html#analytic-continuation"><strong>Analytic Continuation</strong></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#maxent"><strong>Maxent</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#som-stochastic-optimization-method-for-analytic-continuation-external"><strong>SOM - Stochastic Optimization Method for Analytic Continuation (external)</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#interface-to-omegamaxent"><strong>Interface to Omegamaxent</strong></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../applications.html#other-applications"><strong>Other Applications</strong></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#tprf-the-two-particle-response-function-tool-box"><strong>TPRF - The Two-Particle Response Function tool box</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#triqs-solver-benchmarks"><strong>TRIQS Solver benchmarks</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#app4triqs-application-skeleton"><strong>App4Triqs Application Skeleton</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../applications.html#cpp2py"><strong>Cpp2Py</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../versions.html">Version compatibility</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../versions.html#triqs-version-numbering">TRIQS version numbering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../versions.html#triqs-applications-version-numbering">TRIQS applications version numbering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../versions.html#how-to-determine-the-version-of-the-installed-triqs-library">How to determine the version of the installed TRIQS library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-3-1-1">Version 3.1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#cmake">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#doc">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#gf">gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#meshes">Meshes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-3-1-0">Version 3.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#porting-script">Porting Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#deprecate-use-of-string-indices-for-green-functions">Deprecate use of string indices for Green functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#change-in-gf-struct-objects">Change in gf_struct objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#green-function-meshes-c">Green function meshes (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#move-multi-array-into-triqs-nda-library">Move multi-array into TRIQS/nda library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#triqs-stat-rework">triqs::stat Rework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#bath-discretization-function">Bath discretization function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#jenkins-sanitizer-checks">Jenkins Sanitizer Checks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#new-website-theme">New website theme</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#tightbinding-and-tblattice-improvements">TightBinding and TBLattice improvements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#require-c-20-capable-compiler">Require C++20 capable compiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#atom-diag">atom_diag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id2">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#cpp2py">cpp2py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id3">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id4">gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#jenkins">jenkins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#lattice">lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#mc-generic">mc_generic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#mesh">mesh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#mpi">mpi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#nda">nda</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-3-0-2">Version 3.0.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id5">atom_diag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id6">gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id7">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#python-3-10">Python 3.10</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#c-20">c++20</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-3-0-1">Version 3.0.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#issue-819-atom-diag">Issue 819 - Atom Diag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id8">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#array">array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id9">Gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id10">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id11">jenkins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id12">doc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-3-0-0">Version 3.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#renamings">Renamings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#dependency-management">Dependency Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#h5py-dependency">h5py dependency</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#removal-of-deprecated-api">Removal of deprecated API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id13">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id14">atom_diag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id15">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#detmanip">detmanip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id16">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id17">gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id18">jenkins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#operators">operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#packaging">packaging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-2-2-3">Version 2.2.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id19">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id20">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id21">cpp2py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id22">gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id23">jenkins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-2-2-2">Version 2.2.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id24">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id25">gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id26">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id27">General</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-2-2-1">Version 2.2.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id28">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id29">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id30">General</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-2-2-0">Version 2.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#make-range-and-itertools-functionality-standalone">Make range and itertools functionality standalone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#make-mpi-functionality-standalone-and-change-namespace">Make mpi functionality standalone and change namespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#non-owning-views-c">Non-owning views (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#dynamic-analyzer-checks-asan-ubsan">Dynamic Analyzer Checks (ASAN, UBSAN)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#no-longer-install-googletest">No longer install googletest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#app4triqs">app4triqs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#arrays">arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id31">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id32">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#fourier">fourier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id33">gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#h5">h5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#itertools">itertools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id34">jenkins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id35">mc_generic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id36">mpi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id37">lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id38">operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id39">packaging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#pytriqs">pytriqs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id40">General</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-2-1-1">Version 2.1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id41">jenkins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id42">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id43">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id44">General</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-2-1-0">Version 2.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id45">gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id46">array</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#clef">clef</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#blockgf">BlockGf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id47">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#lapack">lapack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id48">lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#tail">tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#det-manip">det_manip</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id49">atom_diag</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#mc-tools">mc_tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id50">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id51">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id52">pytriqs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id53">fourier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-2-0-0">Version 2.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#fourier-tail">fourier,tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id54">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#hdf5">hdf5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id55">arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id56">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#gf-py">gf/py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#py">py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id57">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#travis">travis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id58">gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id59">tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id60">pytriqs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#pytriqs-gf">pytriqs/gf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#test">test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#tail-fourier">tail,fourier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-1-5">Version 1.5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#api-changes">API changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-1-4">Version 1.4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#many-body-operators">Many-body operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#greens-functions">Green’s functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#tests">Tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-1-3">Version 1.3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id61">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#green-functions">Green functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id62">Many-body operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#monte-carlo-tools">Monte-Carlo tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#determinant-manipulation">Determinant manipulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id63">HDF5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#c-2py">c++2py</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id64">Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../ChangeLog.html#version-1-2">Version 1.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#c">C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#python">Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#id65">Green Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#version-1-1">Version 1.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#version-1-0">Version 1.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#python-classes">Python classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../ChangeLog.html#archives">Archives</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../contributing.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../contributing.html#issues-and-feature-requests">Issues and feature requests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../contributing.html#contributing-to-code-and-documentation">Contributing to code and documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../contributing/pull_request.html">How to make a pull request?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../contributing/pull_request.html#setting-up-your-fork-repository">Setting up your fork repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../contributing/pull_request.html#making-your-pull-request">Making your pull request</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../contributing/documentation.html">How to contribute to documentation?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../../contributing/documentation.html#who-should-write-documentation">Who should write documentation?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../contributing/documentation.html#building-the-documentation">Building the documentation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../contributing/documentation.html#editing-the-documentation">Editing the documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../contributing.html#github-discussions">Github discussions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../about.html">About TRIQS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../about.html#authors-contributors">Authors &amp; contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../about.html#citation">Citation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../about.html#disclaimer">Disclaimer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../about.html#logo-files">Logo files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../faqs.html">Frequently-asked questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../faqs.html#q-how-do-i-write-my-gf-data-to-text-files-e-g-to-plot-using-other-plotting-tools">Q: How do I write my GF data to text files, e.g. to plot using other plotting tools?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../faqs.html#q-how-do-i-save-the-triqs-hash-and-script-for-debugging-purposes">Q: How do I save the triqs hash and script for debugging purposes?</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../contents.html">TRIQS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../contents.html" class="icon icon-home"></a> &raquo;</li>
      <li>TRIQS / solid_dmft tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/userguide/python/tutorials/AbinitioDMFT/solutions/01s-solid_dmft.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">scipy</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">h5</span> <span class="kn">import</span> <span class="n">HDFArchive</span>
<span class="kn">from</span> <span class="nn">triqs.gf</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">triqs.gf.descriptors</span> <span class="kn">import</span> <span class="n">Fourier</span><span class="p">,</span> <span class="n">Omega</span>
<span class="kn">from</span> <span class="nn">triqs.plot.mpl_interface</span> <span class="kn">import</span> <span class="n">plt</span><span class="p">,</span><span class="n">oplot</span>
<span class="kn">from</span> <span class="nn">triqs.lattice.utils</span> <span class="kn">import</span> <span class="n">TB_from_wannier90</span><span class="p">,</span> <span class="n">k_space_path</span>

<span class="kn">import</span> <span class="nn">solid_dmft.postprocessing.plot_correlated_bands</span> <span class="k">as</span> <span class="nn">pcb</span>
<span class="kn">import</span> <span class="nn">solid_dmft.postprocessing.maxent_sigma</span> <span class="k">as</span> <span class="nn">sigma_maxent</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Warning: could not identify MPI environment!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Starting serial run at: 2022-06-22 18:10:56.550737
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
Input <span class="ansi-green-fg">In [1]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 19&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">     16</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">triqs</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">lattice</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">utils</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> TB_from_wannier90, k_space_path
<span class="ansi-green-intense-fg ansi-bold">     18</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">solid_dmft</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">postprocessing</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">plot_correlated_bands</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> <span class="ansi-bold" style="color: rgb(0,0,255)">pcb</span>
<span class="ansi-green-fg">---&gt; 19</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">solid_dmft</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">postprocessing</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">maxent_sigma</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> <span class="ansi-bold" style="color: rgb(0,0,255)">sigma_maxent</span>

File <span class="ansi-green-fg">~/opt/triqs/lib/python3.9/site-packages/solid_dmft/postprocessing/maxent_sigma.py:41</span>, in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">numpy</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> <span class="ansi-bold" style="color: rgb(0,0,255)">np</span>
<span class="ansi-green-intense-fg ansi-bold">     40</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">triqs</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">utility</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> mpi
<span class="ansi-green-fg">---&gt; 41</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">triqs_maxent</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">sigma_continuator</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> InversionSigmaContinuator, DirectSigmaContinuator
<span class="ansi-green-intense-fg ansi-bold">     42</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">triqs_maxent</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">elementwise_maxent</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> PoormanMaxEnt
<span class="ansi-green-intense-fg ansi-bold">     43</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">triqs_maxent</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">omega_meshes</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> HyperbolicOmegaMesh

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;triqs_maxent&#39;
</pre></div></div>
</div>
<div class="section" id="TRIQS-/-solid_dmft-tutorial">
<h1>TRIQS / solid_dmft tutorial<a class="headerlink" href="#TRIQS-/-solid_dmft-tutorial" title="Permalink to this headline"></a></h1>
<p>La2CuO4 is one of the high Tc superconductors and can be relatively well described by a 2D Hubbard model on a square lattice which connects the Cu ions. Further below, we will discuss why this material is well suited for DMFT and that the mapping to a low-energy description is straightforward. For a theoretical overview over DFT+DMFT for La2CuO4 you may be interested in this paper by P. Werner: <a class="reference external" href="https://doi.org/10.1103/PhysRevB.91.125142" rel="noopener noreferrer" target="_blank">doi.org/10.1103/PhysRevB.91.125142</a>.</p>
<p>This tutorial should give you an introduction to ab-initio DMFT calculations. It will introduce the important observables / results that are obtained, and how to understand them. Furthermore, you will learn the basic workflows of using TRIQS as a library. One of the key aspects of <code class="docutils literal notranslate"><span class="pre">solid_dmft</span></code> is that everything is written in modular functions in the triqs spirit, but can be run as a grayboxed code with mpirun.</p>
<p>During the tutorial we marked specific tasks with the icon that we recommend you do to deepen your understanding of DMFT, the Green’s function formalism, and the usage of TRIQS. All tasks can be done directly in this jupyter notebook.</p>
<p>more information about the DFT+DMFT formalism and the utilized codes can be found here: * DFT+DMFT implementation using Quantum Espresso + Wannier90 + TRIQS: <a class="reference external" href="https://doi.org/10.1088/1361-648X/ac5d1c" rel="noopener noreferrer" target="_blank">doi.org/10.1088/1361-648X/ac5d1c</a> * TRIQS documentation: <a class="reference external" href="https://triqs.github.io/triqs/latest" rel="noopener noreferrer" target="_blank">triqs.github.io</a> * solid_dmft documentation: <a class="reference external" href="https://flatironinstitute.github.io/solid_dmft" rel="noopener noreferrer" target="_blank">flatironinstitute.github.io/solid_dmft</a> * solid_dmft input parameter reference:
<a class="reference external" href="https://flatironinstitute.github.io/solid_dmft/_autosummary/read_config.html" rel="noopener noreferrer" target="_blank">flatironinstitute.github.io/solid_dmft/_autosummary/read_config</a> * more TRIQS tutorials: <a class="reference external" href="https://github.com/TRIQS/tutorials/tree/3.0.x/TRIQSTutorialsPython" rel="noopener noreferrer" target="_blank">github.com/TRIQS/tutorials</a></p>
<div class="section" id="0.-Performing-a-DFT-Quantum-Espresso-calculation-and-creating-a-Wannier-Hamiltonian">
<h2>0. Performing a DFT Quantum Espresso calculation and creating a Wannier Hamiltonian<a class="headerlink" href="#0.-Performing-a-DFT-Quantum-Espresso-calculation-and-creating-a-Wannier-Hamiltonian" title="Permalink to this headline"></a></h2>
<p>(This step is a recap of running DFT and creating Wannier function. Due to the lack of time we provide all the output here, but feel free to repeat the steps.)</p>
<p>The aim is to perform a SCF DFT calculation with Quantum Espresso (QE), to identify a correlated subspace (here: Cu <span class="math notranslate nohighlight">\(d_{x^2-y^2}\)</span> orbital), and to create a Wannier Hamiltonian for this orbital. The results will be converted to a TRIQS-readable h5 format, via the <a class="reference external" href="https://triqs.github.io/dft_tools/latest/" rel="noopener noreferrer" target="_blank">triqs.github.io/dft_tools</a> package. The input for the QE SCF calculation can be found in the folder <code class="docutils literal notranslate"><span class="pre">data/scf/lco.scf.in</span></code> , and consecutively a NSCF calculation has to be performed
to obtain the input for Wannier90 (W90) <code class="docutils literal notranslate"><span class="pre">data/mlwf</span></code>. We also perform a bandstructure calculation <code class="docutils literal notranslate"><span class="pre">data/bands/lco.bnd.in</span></code> to compare our Wannier fit with the DFT bands. Last, we construct a Wannier Hamiltonian using W90 (<code class="docutils literal notranslate"><span class="pre">data/mlwf</span></code>). In this specific case we construct one Wannier function for the Cu <span class="math notranslate nohighlight">\(d_{x^2-y^2}\)</span> orbital with disentanglement. The input for W90 looks like (<code class="docutils literal notranslate"><span class="pre">data/mlwf/lco.win</span></code>):</p>
<p>The W90 input contains the following important parameters:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>num_wann = 1
num_bands = 2
mp_grid 7 7 7

exclude_bands : 1-31,34-40

dis_win_min = 10.5
dis_win_max = 16.0
dis_froz_min = 12.3
dis_froz_max = 16.0
</pre></div>
</div>
<p>The latter is necessary to properly disentangle the target WF from the other bands.</p>
<p>The bands in QE and W90 will be plotted along the following path (green line) in the BZ:</p>
<ul class="simple">
<li>G: [ 0.00, 0.00, 0.00]</li>
<li>S’: [ 0.25, -0.25, 0.25]</li>
<li>X: [ 0.00, 0.00, 0.50]</li>
<li>Z: [ 0.25, 0.25, -0.25]</li>
</ul>
<p><img alt="Screenshot_20220503_125745.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAc0AAAD5CAIAAADKu/lFAAAACXBIWXMAABJ0AAASdAHeZh94AAAc3UlEQVR4Xu3dfahmR30H8O/ZzWaTCtElL5sQY5SkLTYhG7f1j2izvpSqpCYsUrSYUEgjWQ2FtlZbtEEkmNq0BCohhlUsWlAUJeSfohtoi2KlhQayim1SaSmBlhp8IYbamOzm9I9z79zfMzNnnjlzZs6Zl++HoLvneTsz8/t9n7nnPntv1/c9iIgomX36ASIiioo5S0SUFnOWiCgt5iwRUVrn6AeIaLqu67Qj/A4zKR2rgWgSM1Ld2GLEnCWym5qnPthubWLOUuti5alqpa7r+r53Py37rim8PkutcAefP8+IlLG7ecvGQc9no6IxZ6k21lwLECsBGbjEnKWCWZNrqsUCjoHbLOYsFcAaTFPlk1/yTMyhMXDrw5yljJihE6aghHJscuWRgkZEJuYsrcDMlDA1pY8jcOXBmobcDuYsJWSNjABNhQsDtz78/CzFYQ2Fqaqpxq6L2VnuuY34QpQI97M0jbvnPTEaJuEOt3TMWbKztnQANn9EcjLNBWLgZos52zqzXcOwtxfm2OTKI1yXHDBnW2F2Yxj2bW4cgSsPcuFWxJytjbXZArAti8PAzRZztmDWdpqKXVcfBm5umLMFsHbLVGyqBjFwM8GczYi1GQKwbUgjS8IsMwZuaszZFZiFHoZdQQEcm1x5hNUVEXM2IbOOw7DiKQVH4MqDLL/5mLNxWCt1KhY0rYKBmxpzdhprIU7FeqU8MXATYc7aWessACuSSsTAjav1nLWWUQAWHFVJFrbZLAxcT63krFkiYVhP1CzHJlceYY+Yqs1ZsxQmYa0QjXEErjzIJlKqzVlPLAWiYAxcTzF/6ns+rKsuVTlqykoX9VcqlMLdeg1OyKDy/Wzf99aF5zstUQrc4VpV+JY7dkneuvBKffNA62pzP2vlaL1GpqjCUtj6nulYdYw/imgS5qyp2dar/LqBlXuTO7YdJqKZmr2qUNtbbvBSWRdemfpslLMOJ+Rfe5yUf42F+1kfjfRdbaUQnLNKIwvfLC1kBymiljk7Sd19V1UpzA9Zqe6Fb5M1ZAfRo5Y5G6bKvmvx+qwntaLWhY+b6UQ0kA1ltl6hfVdPzppLEovnwqO0tSfKnGOvU1bf1ZOzStJJdyy8PJj0HIhaU3rfVZKz1tlPqvSFp6S6ruv7fvhf/TaaodC+q6QOcphf68IrK54YSdZvhSX6JhhzdgFF9F0NdSAnOofhuBceeZxky1J/flbGK6N2Me6+W3cVaiiCHDazY3Je+5apqI0esmDOZsDRd6ssR/FFkNtmdoxj4ZH3mdcn6X5WC1bm7Loy6btKvg+GBacsjNzgbN6ycTDzUdBUPa/SriqTvtunH6DE+l36DQCAbpd+AyVj/c5YGC5cttbtu7L3s4u9HaWgztm6uvJgiaPLVsRUtbIuVsctbTY8+y7uepWds3WQK7rk2tMy+pFf6kHrWjJwC75uEHciMtHv0m8AkP6rm2ZF2eRy01oQ1UrLdBP3s5la8s22HVHyNMCwpeViLc/aPpNEWbhS97Pzp68U3OEuY2YER+lGCqYaQaPfz4O748IUv5+NOx05kyM1C0geaWdOytIxi2czKz/MwgtR5MIzUxR32TU+OQ5x/z3YsApbZ5s5689d2P7mTHjEnCl7Pztz8BVQM2CtS3WQE5UaZziAtWjDpJj/Pt4HRcrL2VgjrwwDN39D3za4BNaaDFPo7JWXs0qhM56aZ+CCExhJm9FpZS25MJlMqdrSzlzlwnI24kJWT5aFdd64yaUw1nIK00jtFZazSiPLE4vnJpezOtXUbc6wP5r0kBVZqyVAKeN1m7NwpeYshWHgkslaDAGqLBt16WCOknKWKRARA3e+sA3OWlta60KHWf7kS1dSzlIKnoELdlchrOsYhis+UFva4DfIYnKWO6zU5MRae5VLIFmnaEkRT4ALmloxOUtL8tzkNt6fwcOfdOnAugRhPF+RHPwXTiojZyOWGk3CwF2MdYbDcDmiU5cOwpSRswoLaC0MXClsUzNQc2WdSX/BJ0DLKyBnZ5YjxSXb21waeaTxIDAnJ0zj05gPtaUNeJeNlrOTimriSe6YOjZKrc1Nrmwz68DDVDZLJEXL2aFI4lUdlcSdOxUErjYu6zA9aV8QlDsnLZu6cNFydtD3jNqmlR641tMOk+0YKZi6dDDVtFT253Mynq+cf3OSg7su11pT91lNMmcIw2nMeQZaWFgcpcpZ+EWtNHYiYQOjDLnTLcX6ul/Rn9ynxz3P6E9IScmK8l+4yNcNpOEctDqXJ6bdJP/qff5UEplWm7dsHPQvX8X6hAHcL81MpD7o0sHu77t9EZ/8NZz7Gnzn7MbN0lfehXOP4PQZ/biboyz7fuM/qev2/gPGn4LK1O/SbwAAdLvGjpu0e27X3zn8p87EcT5J9UF9S2WZ8HvFL78CBy7DZfv141uZMWo1lrnDjUC/G7tUD3fAzQ1T8fwa/X4eOm5mCcC2L8us9Jw1H/f8KVxzLd79fnz9aRz4Gb50D97xOhz7GCbua63pOUoErn5GcqvrPUzK3ZwERNQ8JYpuM2cP4B/vw/WX4dzzcPWb8NnvAMCZS3HrcVz0LD73MJ75Bj7/BK48huNHjfzzEFr2HdCNbXWZuZVxp6S8VdLvF1vSzWzPSwfF8ly4je+DnXkcf3YYH/k0LvwxPnk33nMzLj2Ntx3Bh4/gyQfxxUdxy2F89yX40MdxideTx6QKXVa7Nkb512RNQStIl3Funl1ErZn61rj5eYPz8dHP4rYLAeCGA7jqVvzVKbztnXjuMdz2x3jV3fjsUVz/drzn9XjkduOKwxq07pMD1yZhpT6lMoz1jMr3sTvEMvTtWm8nlNpGzu6/Ar/00p0/v/Q1+Pn9+Pfv4Sxw3rW4/xPoj+PQITz0AA7fnEXImrjVJbe9uOzvlEe2BtwyObjAS1Asakvrs2qb+9kXxUeoXkSP3YuwB3Hsjp3DN51Q98gat7otG9t+7u1PsVPHWztkGSru1ZlncmIUxcbG9OxTOP3DnT//6J/xb2dx1S9g+ue4ctSPf2is43fSitWN6Efoj8/JcHrqVOVw9LtSZrau0eZ+9nnc89vo34uLn8GDf4L/fQXueOvG7XWQ7cbLC0UYq+Mlo3PIvsVeUb2QjNrFXp18DCWhH7XZyNlX3YVPXowPnMATP8GVN+AzD+AtF8jbK6TVLS8vrGusauPmi7pokAl3fMubGLiFci1wDmTjLXyqIy0PMHNjsEbqMpmyd3EWJzdv2c6diWECnjPd5NBUPmuR8OfIlI5b3SiseQpnUTYlIGQhZs+nyWl1zFlfsoy16JB/bbbamaerMANXHqQlOd4ymbMhPDMXNcZu43naR/1uWMSnks/DTe6ShpLQj25izs6lVbIjdsuq+bHSYevmz9zkctXWlXXOjrV6zjy3uvmU/dgkszNTi7iZHVN94FqLd8Uhjq1p1jmr+OzMM+TY6i5/eWFsAq1lQQ5xLx0swwxcebAyI5WesMu2BlQZOVuHxba6Y0tea1+VaGyNUpOBW8Emt/f+BdvrDpE5u44oW92xXi23bQoyf0s78+EzyVcvN3BHOmBDDmNizmbBc6uLzZ+uXlxXVGPr14lucx6bgnlVIc/Smjpt+QyCOZsRW/tplbL313xqiALkGWRZBa6lGwz9yHWD9c7arpicHXYQK656RLY8BTxqOuzyAqVQU0GazMCVB6MbaQid5+t73m1Jef7A7koM32ow9SP0xxt6/nTH8g0FoB/NlSxOVcD6nSaSteqoWFnt1po3ffmdOHAdTk/9HbGzbZ0T5mwcqgSlvQTdpD84iKMEfYo4c12h510vWcCqwvU72aRLVWl4yOVX4MBluCy/n5ldzHWDTIzVVqz0DCZfXztH+de1T3Oy1SfWYUicSWc49f55UkNQ7SCODP/vEncC+h7Pn8I11+LIW3DdD3DgZ/jSPfj7U/jBTfi7u3MJOO5n7dQ7tka8qW/QH78qtSMY/pN8dhZEProOQD/856gorRrn9Mr/fRu/dxzXXImXHMRFV+OOk/hJDwBnLsWtx3HRs/jcw3jmG/j8E7jyGI4f3fx0zqoyifvVdNbSyHsbNZUcSk1b3eIM79P60UKMNIpp737RB3vwZXjZ1fij23HVhTj9EP7gd3Hpr+DeX8bPHcGHj+DJB/HFR3HLYXz3JfjQx3GJ7wkvIeuFVyE4nOScMm0hT6camRIgg8zVlj6uOT/n2+Rflv73XJ2jNiTHaGTHpRj1mcdx9LV4+Un8ze+gA557DDe+AfvuxteO4vq348hJPHL7cl+tbx1sbftZ5qk/bUrkzGmzyMmbL+eQHWmaDVPPXQ421rvm09/ER+7FqcfwPz9B3+OFszj8ws5N512L+z+B/jgOHcJDD+DwzcuFrI9Sc5Z5Gp2cOV5emCTnDNWM9I0u7mjU5MwJ3Bf/E7f9Bh57Db7wLbzpKuw7jaOvFTcfxLE7dv54U16//g3IOWetS2I9SNFxq+uv9/g3uFvvkI7PKy+2iGbgyoNuL3wb//Qsfv19eOvVAPDT/8b3X8Rh/V6ZyjdnrTyXhOLiVne+ZUo3q1R1kIHruXnafyVeeQ4e/yr+5Y04+D386YfxI9fd85LVRQwqQD/+AZ2u1Q+Nube0jpvm2zrncr2sq7auXhgyd2y6zrkOJ+/DBadw5OV4/V244mP4/V/U75OtfK8rme9yXTlXwdo00iDA9D2UufoRxf28wcBRnI6bpnLMsBLppdaUdPWj094YrOdc2HUDypksMC0R5F9tdUh2W4O1ysmUWyvtSP6sb6vMWUpCqzSZF1p2GDVZpOHLXrPBrAfHtJmqDmbgyoMFKSZnJ9Ur5YZbXSsGqycZuCVucgvIWTWtjNo6+G91S6dV7NbRsbq32pzPYgK3gJyVCppZ8mTb6qpA6lU25b/gtksHe+dvlf+gcmZeVcg2FgrLWSX/maUAw2Jasyn/ywtdB3ew5nnaFcg/cPP9SlybMnkh3CrbgdBU1m5xrP+klVcf6hrM+WiX45QGk06MIpJxkToZzGgyX7GknDXftayyHRF5suas5Fj/kUfs0EJ24Bm1jhcdDC89FKpxAYHWsUDgmnFkvlC+1eDIWckcpGR9CGVua85qHCUgn8AasgMzah3PqVjPjjmbral15cmMIPP5860Gz5xVzNFK7sdSVub0w2gV9KMhu6PTo1bjfy7D+QecPC1jToFp5FM5nrbU74OZ1NisgeuYAqqJtry2WvA1p1JYZjkzsyL1etWTs4o5idJiM0s5UItsKYVNLIcGWbMiRTJUmLOKdRIVBm6erIu1gBQ/XIZKIUMgRTKUkbPdtouzbtZJtB6Z8yoU3cx1D8PAbZy5P5tfhGXkbETmJEoRZ5YCWBdlLQzcxplZERwLK+wXPMmxJd3XuHs73euSyboWM5dg7+Nc3Unrpw5kjDo++wXvwE1arrQi82tfLabkTVK+BbFYzirWJlcWOAHyrFp/GyE72Izaseh0By7GHwjmbAPMrHBXbL4FsXzOKuYkapY8mXZoZeqoWh8bQSlC1pGPY9yZaz7hwuVKK7Jmhbn6+RbEijkrWedRWeusqjSWs+qIJz0WN3eyZiz605950/DMK9YqLU+LKfXnvXsAYM76Y+AmZa1R60EHew4OOTs7ZCX7C+2K9SqUP+ZsKgzcFKw1aj24leWKwe412egJyMBtmVafjnLNKL80WpxleJ4M3FjkTGrz5qhdh534i3fFYCt34CLxq9Mq/HM238/PDttY/WhO1Gxaz9ORHTQm5kSNfMAgERWjXdehv3PzRkAEMQO3QfnuZ+F8f8iWNXOVggayGPcbUkANdDhhDdllAq4T17jcm9xlzofS8d/PMmdTYeB62rrKW++g2Zv4/kSPk0PYLRZqMmf3DjJwK2K2NnN2feaqSEUPbT73ZnYwqQz2NrPio7IdQj42G8aaswoDtyzu5lWYsxlxr1kdY5zKZ4l9snhgDdmFuXNWcQcumLnLcvfmVr3zQ11gzq7Fva71jddqQoB6VIK8LDt+r+Q8c1ZyZy4DNyJ33/kzN7DuEp1cE0tyn3od3Atf8cAxZX233jOTkEVQzioM3FjcbeXPvZTM2fK4K6PKGfBfXzk51jur2203LmpOzioMXE/urvEXtmTM2YK5S6eaqZi6uI7753BZVomSs8qcwF34gxZJuZvCX8SlAXO2Dltrq+hpmbq4Y/fPKmQRO2cVd+DClqfqIeZNOdta9j5SLIGJOVsbd/EVNz9hK2s+KsOQxcRBBXBnrvw0m3kwH+6S9pR6qt2Ys9VyV2cpExW2stqj8vnel5JoMzvGHbimVdLWXbH+lpxYT8zZ+rnLN+cZk2c+6Tw3htzfmVvIYvGcVfwDN13UugvS3yoTGIY52xB3fWc4dXOWVQx297F5XDEYrJWzik/gWi8syONu7nrzt+5ExWLOhnVcK5eF25yGbJC55JocpjF4MzvQczankEUGOav4BK5JTubWcvKUyYQkYs6Sdbz79ANUrF7QbwMAdLv0G9YwdpLeutxCtgIdTgQXiSw/Sb9fk5izdXJXeXAvzRThFcWPdmXIjhndzHafQvcp/eBEIkI36PcjId+f801RqAawZpw6uHCfhL3c7gcM5iZFu2w/gHxM2BqRVRk522Vz2atcqweu9XWn2fmAQQ90aLsqRnesszU7pUllnbN99r+6pkSykczplUcStVzY04pvgJ2Afta1SRejAPrdn31O0Y3Vdu47ggX2WQRb4EpRJn/OUmr/7mvOUyXlv8VOmnQ+V66tJ+DzQJK0xhlbfd+yWMsC2yuSEgXunGTUQnbn4IwnTEfmrDXIouk+hdljD/v8LEmV5Cxy7ajqxQ3c4EXcC1lAPjT4CSNaIEkHK46R3JizFMf8wA1ewbGQxeZZTX1aT4vFqJJoIJROPTmLGY1KcYVlbvDy7b3a5i9V3L15J6qmPq2yfJIOgk+YcuOZs1l/3oByo8rIGrjWPLXec4wRfBuXZY1btwt4yATjSaqMNR41pbCc7by/n0tJBQTu1oWzZGJ/Atj+OaSu6yZ9An8CjyQd9H3P4qQxxVSGtXUpH9bAldwL507SUSoHw3LWO0YVxyiYsw3idQNalHuHO1Z/yU1P0sFqJ0w1KukdmFva4sjMda9a4H4W4Uk6cJ/VJNzPNoj7WVpfn82/nB5rAKIFFJmz3Dg0xfKJLsW2mWVt0GI8dxKFBRYvHRRn5qWDsX8MunPn2R+hncnssbXOhNbiU+HMWUrOZ9V27tJP+xf3Ps8chZmnA/N1FzslyoTPiheWs/AbFWVl65KpEBu53W7r0wbwz9OtfLY5VAGfOizy+iyVpd+9htXZLqyHhexMEfN0jHqqrut8WpEqVnDOWpuWyhIcsmNBqRm725KVI1+Lgdum8nJWbY6oRNZ3R+PABMOzjZWE+Vrrkptc7QhVrLycpRJZ3x2HA/45Yz6DOlhcWjFwm1J2zlo3R1QEW2busObpQNu9VrD6ZuDKg1SHInPWujmizKlV67oOUDliWck2U0aOuqY3EkKhOUtlMaJ0Jzv6fu/P/lrIIHOTW/Fgi2bUtl2pOSs3RyzBTIzV3GZqyJClLRi4pXCvS6k5Syvamqdj+r7ffai8dDBBs3FjBq48SKsYawRTDTnLLW0iY2UUPNsiZCmQDNxm33Vys3X+C85ZdemA5nDM4dbqmUR7nYB3R8epNkjOHgM3cwXnLE0yFlLLdKZ68b7XAzfAMudcEPOqAqcotUlTXXbOqi1twOaoVuvmqZUM2c3jE1ZtbFwkMXDzVHbOtmwsd7LtK3Ve6t0xTLYDzIoZuPIgzTT1bayenJ20OSrIWCSVMtjh9As52QrJwJ2aDhRL8Tk7c3OUj7FRFN0SI2Pa4/nuyICYT04d53OOsVZ1KD5ny+JYofoqXo3VHFk1746FMq8q1Fd+C/CftBpyVjWt5+ZoAY4QyeQMU3OE7FSOyaSZGLhThVVjDTm7orFJb7xYfUI24N3R824UwAxceZBMkyantpz1b9pJmKcBoszN2MxTIjJwucnVBFdjJTmrNkczjT0J68zfMIWTJszn3XHrHSguOeEMXM3UeagkZ6dinkbUdXupOjKvdrHeHSk186pCg50yp1YrzFm5ORqbmgarJKkhatVkx5rdlrs6T9bOam11Asa7/eu1gpipWtPo8mRM+eSQdYSp4ybKRDuBO6caK9zPSu0UQSYizvGcsqbFyNWpeMlmDq2qnLV+UaPMnCkymdM8HAmbYHnBh0pkNiAXdFB5ZVsDV6l77AtwzO6kqTXbkl+I1MFc2RLNH0VV+1mTtW+V+dNHVhGnk0tTNGsDNrimle9nTdbAVVqbjTnGJjJsCuV7XuM9WbfiFjfKCVe+nzXJmTIzlzvcOaLPGVehPtYGLGKh55xkc/tZKzNwJU6RyZywmZNkXQLOfCOyDdwom1kwZzXWblc4V4qcp1izok0+Z7tBuQVurPNp7rqBm5pNa+DGmvSacCYoImsDrtVu1hAIw/3sFu65bnP2himJPnTuZ8m0YuBG3FcxZ30xcJVO/OCYuCJWNtVnyfKIm++8buBLzrWZuUtWwOoaGCLlyLyqsEC7RXkJ5mwIc72VuG+DRGQyGzDzXuN1gzjMwJU4yZ5KaRvKTdz9TfQ65H42DvMNVoq+bEQkWS/r5dNu3M+mYg1chdNulWGHULnCyinsUW7cz6bCHS7RusweXKvd9ukHKLZe0G8Dul36Dev5yrtw7hGcPqMfJyqUakDVbmMdN3Z8Ju5nF6Wi1lxOecSayIu5/AoceAaX7dePE5VONqDqOGu7WQ8G4352HeoNVr8BwEqb3OdP4Zpr8e734+tP48DP8KV78I7X4djHwH0t1Uc1YO+xyZ2PObsytdj6DQCSBu4LePQ+vOnVuOB8HLocxz6A7x/Grcdx0bP43MN45hv4/BO48hiOH0WC1x6l5iHJkKl5e4Eq6HeKvZkF+HmD/FgXXom1Xl//Q7z1L3H9HXjfm/H8U3jqFfjob2E/8OSDuPHPccNhfPc6fOvTuMR1Lkmo4ccaKTXI3URbRa895my+3LUyZ+H6H+M3X4m/fSOefASHxYs89xhufAP23Y2vHcX1b8eRk3jk9qW/5GHOkj93j/hLXWz8Pli+5Nqb9TQnj87+B574KV79q7ho81nPuxb3fwL9cRw6hIcewOGblw5ZIiuz/sMENEsUzNkyOC5cyiOTyqjbZ1x7PYhjd+z88aYTG7cQLcAs7zCTGmEB3K8Upt+l3wBAXObXb9i0/5W46iD+9R/wQ/vTECWnalXS77SNageNfr+18fps8dzVaV/fHl99L275DG64C3e9GXga33wGf/FBnK/fbwVqOPYzp9K469NT6cXAnK2Hu6D1hX4Oj9yLe/8a3/kvnHMx3vxBfPn9OLhxj3UwZwvlLj9/Va47c7ZC7orPfMWZs5lzV5e/ptaX3werkKxgsysYZOTDrJwwLDMwZ6unqtxsG3mEzdAyszYCsIQcmLOtcASuPMhuqZh16adihQRgzjaHgVs968oGYA3EwpxtFwO3dNaFC8AlTo05Swzc3FnXJQBXcC3MWdoj+9DsbQZuauach+EC5YY5S3aOTa48wpYOY85qAE5+KZiztIUjcOVB9ryVddKm4tyWjv8ejCZzZ8f8iioxu91z4q+gIZM/7mdpspZ3uNYhB6hycmgMc5bCVRy41hEFKHHsFB1zliKQaWImVOaBa55wgDyHRplgzlJkjk2uPLJ8MJnnE2D506YKMGcpFUfgyoPRk8v6cgGinxg1izlLySUKXOuzBZj6ukRT8XNdtALPiByK0/POW7HUaS3MWVpTrAyVWNKUG+Ys5WJq5rJ0qRTMWcqOGbisUioac5aIKK19+gEiIoqKOUtElBZzlogoLeYsEVFazFkiorT+H1fEVgHfUk9KAAAAAElFTkSuQmCC" /></p>
</div>
</div>
<div class="section" id="1.-Creating-a-low-energy-description-of-La_2CuO_4">
<h1>1. Creating a low-energy description of La<span class="math notranslate nohighlight">\(_2\)</span>CuO<span class="math notranslate nohighlight">\(_4\)</span><a class="headerlink" href="#1.-Creating-a-low-energy-description-of-La_2CuO_4" title="Permalink to this headline"></a></h1>
<p>In this section we will discuss the process of constructing a low-energy model of the material.</p>
<p>Let us first take a look at the density of states to identify the character of the states close to the Fermi level:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># read partial DOS from QE</span>
<span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;./data/scf/dos/&#39;</span>
<span class="n">seedname</span> <span class="o">=</span> <span class="s1">&#39;lco&#39;</span>
<span class="n">fermi</span> <span class="o">=</span> <span class="mf">12.7367</span>

<span class="n">dos_data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">elems</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;La&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;Cu&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)}</span>
<span class="n">char_table</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;La&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;f&#39;</span><span class="p">},</span>
              <span class="s1">&#39;Cu&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;p&#39;</span><span class="p">},</span>
              <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;p&#39;</span><span class="p">}}</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">loc</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">seedname</span><span class="si">}</span><span class="s1">.pdos_tot&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">dos_data</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ct</span><span class="p">,</span> <span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">n_atom</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">elems</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">n_char</span> <span class="o">=</span> <span class="n">char_table</span><span class="p">[</span><span class="n">el</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="n">n_atom</span><span class="p">,</span> <span class="n">n_char</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">loc</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">seedname</span><span class="si">}</span><span class="s1">.pdos_atm#</span><span class="si">{</span><span class="n">atom</span><span class="si">}</span><span class="s1">(</span><span class="si">{</span><span class="n">el</span><span class="si">}</span><span class="s1">)_wfc#</span><span class="si">{</span><span class="n">char</span><span class="si">}</span><span class="s1">(</span><span class="si">{</span><span class="n">char_table</span><span class="p">[</span><span class="n">el</span><span class="p">][</span><span class="n">char</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">dos_data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">el</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">atom</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">char</span><span class="si">}{</span><span class="n">char_table</span><span class="p">[</span><span class="n">el</span><span class="p">][</span><span class="n">char</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># read the w90 DOS for comparison</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./data/mlwf/lco-dos.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">w90_dos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># plot total density of states</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">dos_data</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">fermi</span><span class="p">,</span> <span class="n">dos_data</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;total&#39;</span><span class="p">)</span>

<span class="c1"># plot partial DOS. The entry number corresponds to the orbital order in data:</span>
<span class="c1"># 0 col is the energy, then the summed partial DOS, the columns are dz2, dxz, dyz, dx2-y2, dxy</span>
<span class="n">Cu_dx2y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">dos_data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Cu-3-3d&#39;</span><span class="p">][:,</span><span class="mi">5</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dos_data</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">fermi</span><span class="p">,</span> <span class="n">Cu_dx2y2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Cu-$d_{x^2-y^2}$&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">Cu_dz2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">dos_data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Cu-3-3d&#39;</span><span class="p">][:,</span><span class="mi">2</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dos_data</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">fermi</span><span class="p">,</span> <span class="n">Cu_dz2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Cu-$d_{z^2}$&#39;</span><span class="p">)</span>

<span class="n">O</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">dos_data</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;O-</span><span class="si">{</span><span class="n">atom</span><span class="si">}</span><span class="s1">-2p&#39;</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">elems</span><span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dos_data</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">fermi</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;O-$p$&#39;</span><span class="p">)</span>

<span class="c1"># plot the w90 DOS</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w90_dos</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">fermi</span><span class="p">,</span> <span class="n">w90_dos</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;w90 DOS&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mf">2.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;DOS&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\omega$ (eV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_4_0.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_4_0.png" />
</div>
</div>
<p>It can be observed that the states right at the Fermi level are dominantly of Cu <span class="math notranslate nohighlight">\(d_{x^2-y^2}\)</span> (blue) character hybridized with O <span class="math notranslate nohighlight">\(p\)</span> states (green). The W90 DOS matches exactly the total DOS in the window given by the Cu <span class="math notranslate nohighlight">\(d_{x^2-y^2}\)</span> states, capturing the nature of the bonding orbitals as well. This means that this is the best compromise of having a localized Cu <span class="math notranslate nohighlight">\(d_{x^2-y^2}\)</span>-character-like state, but still describing properly the electronic states corresponding to the
band close to the Fermi level.</p>
<p>&nbsp; What is the reason for the contributions to the DOS of the Cu <span class="math notranslate nohighlight">\(d_{x^2-y^2}\)</span> (blue) states at low energies between -8 and -5 eV?</p>
<blockquote>
<div>These are the bonding / antiboding orbitals of the <span class="math notranslate nohighlight">\(d_{x^2-y^2}\)</span> orbital.</div></blockquote>
<p>To check more carefully whether the tight-binding Hamiltonian describes the DFT bands close to the Fermi level correctly, we now plot the QE and the W90 bands on top of each other. To plot the W90 bands we will make use of the solid_dmft postprocessing module <a class="reference external" href="https://flatironinstitute.github.io/solid_dmft/_autosummary/postprocessing.html" rel="noopener noreferrer" target="_blank">plot_correlated_bands</a> (<code class="docutils literal notranslate"><span class="pre">pcb</span></code>). This utility reads the real space Wannier Hamiltonian, and then leverages Wannier interpolation to construct <span class="math notranslate nohighlight">\(H(k)\)</span>
on any given <span class="math notranslate nohighlight">\(k\)</span> point mesh.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># w90 information</span>
<span class="n">w90_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;w90_path&#39;</span><span class="p">:</span> <span class="s1">&#39;./data/mlwf/&#39;</span><span class="p">,</span>
            <span class="s1">&#39;w90_seed&#39;</span><span class="p">:</span> <span class="s1">&#39;lco&#39;</span><span class="p">,</span>
            <span class="s1">&#39;add_spin&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;add_lambda&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;n_orb&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="n">fermi</span><span class="p">,</span>
            <span class="s1">&#39;orbital_order_w90&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]}</span>

<span class="c1"># plotting options</span>
<span class="n">plot_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;colorscheme_bands&#39;</span><span class="p">:</span> <span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="s1">&#39;colorscheme_kslice&#39;</span><span class="p">:</span> <span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="s1">&#39;proj_on_orb&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>

<span class="c1"># tight-binding-like bands we want to plot from the given W90 Hamiltonian</span>
<span class="n">tb_bands</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bands_path&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;S</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;S</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">)],</span> <span class="s1">&#39;n_k&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
            <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span> <span class="s1">&#39;S</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">0.5</span> <span class="p">],</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span>  <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">]</span> <span class="p">}</span>

<span class="c1"># get_dmft_bands extracts H(k) from the above specified path</span>
<span class="n">tb_bands_data</span><span class="p">,</span> <span class="n">alatt_k_w_path</span><span class="p">,</span> <span class="n">freq_dict</span><span class="p">,</span> <span class="n">dft_mu</span> <span class="o">=</span> <span class="n">pcb</span><span class="o">.</span><span class="n">get_dmft_bands</span><span class="p">(</span><span class="n">orbital_order_to</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">w90_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">tb_bands</span><span class="p">)</span>

<span class="c1"># also load the bands.dat.gnu file for a comparison</span>
<span class="n">band_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;./data/bands/lco_bands.dat.gnu&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
H(R=0):
      0.1589
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># since every code uses a different scale for a k-path we have to scale the QE bands</span>
<span class="n">factor</span> <span class="o">=</span> <span class="n">tb_bands_data</span><span class="p">[</span><span class="s1">&#39;k_mesh&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">band_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># plot QE bands</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">band_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">factor</span><span class="p">,</span> <span class="n">band_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fermi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>

<span class="c1"># plot W90 bands using the plot_bands function of pcb</span>
<span class="n">pcb</span><span class="o">.</span><span class="n">plot_bands</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">alatt_k_w_path</span><span class="p">,</span> <span class="n">tb_bands_data</span><span class="p">,</span> <span class="n">freq_dict</span><span class="p">,</span> <span class="n">n_orb</span><span class="o">=</span><span class="n">w90_dict</span><span class="p">[</span><span class="s1">&#39;n_orb&#39;</span><span class="p">],</span> <span class="n">dft_mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alatt</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_dict</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_9_0.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_9_0.png" />
</div>
</div>
<p>Now, we will convert the W90 output to a TRIQS readable format using the Wannier90Converter of <a class="reference external" href="https://triqs.github.io/dft_tools/latest/" rel="noopener noreferrer" target="_blank">triqs/dft_tools</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">triqs_dft_tools.converters.wannier90</span> <span class="kn">import</span> <span class="n">Wannier90Converter</span>
</pre></div>
</div>
</div>
<p>The wannier90 converter input <code class="docutils literal notranslate"><span class="pre">lco.inp</span></code> contains the following information:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>0   7 7 7              # specification of the k-mesh
1.0                    # electron density
1                      # number of atoms
0  0  2  1  0  0       # atom, sort, l, dim, SO, irep for each atom
</pre></div>
</div>
<p>Now we run the converter in the according sub-directory producing an h5 archive <code class="docutils literal notranslate"><span class="pre">lco_wannier.h5</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">cd</span> &quot;data/mlwf&quot;
<span class="n">Converter</span> <span class="o">=</span> <span class="n">Wannier90Converter</span><span class="p">(</span><span class="n">seedname</span><span class="o">=</span><span class="s1">&#39;lco&#39;</span><span class="p">,</span> <span class="n">hdf_filename</span><span class="o">=</span><span class="s1">&#39;lco_wannier.h5&#39;</span><span class="p">)</span>
<span class="n">Converter</span><span class="o">.</span><span class="n">convert_dft_input</span><span class="p">()</span>
<span class="o">%</span><span class="k">cd</span> &quot;../../solutions&quot;
<span class="c1"># and copy the h5 archive in the cwd</span>
<span class="o">!</span>cp data/mlwf/lco_wannier.h5 ./
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/Users/nwentzell/Dropbox (Simons Foundation)/Coding/tutorials/AbinitioDMFT/data/mlwf

Reading input from lco.inp...
Total number of WFs expected in the correlated shells: 1
Number of inequivalent shells: 1
Shell representatives: [0]
Mapping: [0]

The Hamiltonian in MLWF basis is extracted from lco files...
reading lco_hr.dat          ... written on  3May2022 at 14:04:18

... done: 397 R vectors, 1 WFs found
Number of WFs equal to number of correlated orbitals
The k-point grid has dimensions: 7, 7, 7
Subtracting 0.00000 eV from the Fermi level.
/Users/nwentzell/Dropbox (Simons Foundation)/Coding/tutorials/AbinitioDMFT/solutions
</pre></div></div>
</div>
<p>An h5 archive is a standardized storage format similar to a zip archive, but for directly storing arrays, strings etc. and is interfaced to many different programming languanges, which immensely simplifies data transfer across different codes. TRIQS provides its own h5 interface layer build on top of h5py making reading / writing very easy. After opening an h5 archive, you can access the object as if it were a dictionary.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;lco_wannier.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">h5</span><span class="p">[</span><span class="s1">&#39;dft_input&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
HDFArchive with the following content:
  SO : data
  SP : data
  T : subgroup
  bz_weights : data
  charge_below : data
  corr_shells : subgroup
  corr_to_inequiv : subgroup
  density_required : data
  dim_reps : subgroup
  energy_unit : data
  hopping : data
  inequiv_to_corr : subgroup
  k_dep_projection : data
  kpt_weights : data
  kpts : data
  n_corr_shells : data
  n_inequiv_shells : data
  n_k : data
  n_orbitals : data
  n_reps : subgroup
  n_shells : data
  proj_mat : data
  rot_mat : subgroup
  rot_mat_time_inv : subgroup
  shells : subgroup
  symm_op : data
  use_rotations : data
</pre></div></div>
</div>
<p>As we can see, the Wannier90Cconverter calculated <span class="math notranslate nohighlight">\(H(k)\)</span> on a predefined k-mesh and stored it with additional information in the archive. The information stored is standardized for all DFT codes in TRIQS (see <a class="reference external" href="https://triqs.github.io/dft_tools/3.1.x/h5structure.html" rel="noopener noreferrer" target="_blank">triqs.github.io/dft_tools/3.1.x/h5structure</a>) and interfaces to other codes exist. This is very practical, since we can then run solid_dmft starting from any compatible DFT code.</p>
<div class="section" id="2.-Run-a-one-shot-DMFT-calculation-using-solid_dmft">
<h2>2. Run a one-shot DMFT calculation using solid_dmft<a class="headerlink" href="#2.-Run-a-one-shot-DMFT-calculation-using-solid_dmft" title="Permalink to this headline"></a></h2>
<p>Now that we have finished all preparations, we are able to run the one-shot DMFT calculation. We will use the <a class="reference external" href="https://triqs.github.io/cthyb/latest/" rel="noopener noreferrer" target="_blank">triqs/cthyb impurity solver</a> to solve the impurity problem within the DMFT loop. This is a Monte Carlo solver, sampling the impurity Green’s function <span class="math notranslate nohighlight">\(G^{imp}(\tau)\)</span> in imaginary time <span class="math notranslate nohighlight">\(\tau=i t\)</span> at finite temperature <span class="math notranslate nohighlight">\(T\)</span> by expanding the impurity Hamiltonian in the hybridization function, which couples the bath with the
impurity. We will perform our calculations at inverse temperature <code class="docutils literal notranslate"><span class="pre">beta</span> <span class="pre">=</span> <span class="pre">10</span></code>, which corresponds to <span class="math notranslate nohighlight">\(T \approx 1160\)</span> K, where <span class="math notranslate nohighlight">\(\beta = \frac{1}{k_B T}\)</span>. Higher temperatures are numerically easier. The solver is fully MPI parallelized, and written in C++.</p>
<p>The accuracy of the solver is ultimately determined by the total number of Monte Carlo (MC) moves it performs and how many successive measurements of <span class="math notranslate nohighlight">\(G^{imp}(\tau)\)</span> are made. This is controlled in the <code class="docutils literal notranslate"><span class="pre">[solver]</span></code> section of the solid_dmft input file with the following parameters:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>n_warmup_cycles = 5000
n_cycles_tot = 2e+6
length_cycle = 40
</pre></div>
</div>
<p>The first parameter <code class="docutils literal notranslate"><span class="pre">n_warmup_cycles</span></code> is important to thermalize the system before any measurement is performed. This task is performed on every MC “walker”, i.e.&nbsp;on every MPI rank, and the number strongly depends on the problem at hand. For simple problems at higher temperatures a value between 5000-10000 is usually enough. The next parameter, <code class="docutils literal notranslate"><span class="pre">n_cycles_tot</span></code> determines the number of measurements performed. The number is absolute for all MC walkers, and the workload of performing the
measurements is divided among the MPI ranks. The last parameter <code class="docutils literal notranslate"><span class="pre">length_cycle</span></code> is equally crucial for accuracy. This is the number of MC moves performed between two measurements. So the number of total moves will be <code class="docutils literal notranslate"><span class="pre">n_cycles_tot</span> <span class="pre">*</span> <span class="pre">length_cycle</span></code>. The length of a cycle is important to decorrelate two measurements. If the length is not large enough, measurements will depend on each other and general accuracy will go down.</p>
<p>Since we have a limited amount of resources we will first perform 6 DMFT iterations with <span class="math notranslate nohighlight">\(2 \times 10^6\)</span> measurements to pre-converge our results. The cycle length is optimized for this temperature and problem. No need to modify.</p>
<p>solid_dmft is controlled via a single configuration file. This file is usually called <code class="docutils literal notranslate"><span class="pre">dmft_config.ini</span></code> but can be named differently when the name is passed as argument to solid_dmft. The file is divided into sections: <code class="docutils literal notranslate"><span class="pre">general</span></code>, <code class="docutils literal notranslate"><span class="pre">solver</span></code>, and <code class="docutils literal notranslate"><span class="pre">advanced</span></code>. Let’s have a look at the config file we provide:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cat dmft_config.ini
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[general]
seedname = lco_wannier
jobname = b10-U3.6

solver_type = cthyb
beta = 10
n_l = 21
n_iw = 251
n_tau = 5001
n_iter_dmft = 6

prec_mu = 0.0001
dft_mu = 12.8

h_int_type = kanamori
U = 3.6
J = 0.0

dc_type = 0
dc_dmft = False

h5_save_freq = 1

[solver]
store_solver = True
length_cycle = 40
n_warmup_cycles = 5000
n_cycles_tot = 2e+6
imag_threshold = 1e-6
legendre_fit = True
measure_density_matrix = True
</pre></div></div>
</div>
<p>Most important parameters not yet introduced are <code class="docutils literal notranslate"><span class="pre">U</span></code> (similar to DFT+U), the choice of solver <code class="docutils literal notranslate"><span class="pre">solver_type</span></code> (cthyb in our case as introduced above), the number of DMFT iterations <code class="docutils literal notranslate"><span class="pre">n_iter_dmft</span></code>, the jobname where the calculation is performed in <code class="docutils literal notranslate"><span class="pre">jobname</span></code>, and the choice of double counting <code class="docutils literal notranslate"><span class="pre">dc_type</span></code> (similar to DFT+U). For now you can leave all parameters as is.</p>
<p>The reference for these parameters can be found here <a class="reference external" href="https://flatironinstitute.github.io/solid_dmft/_autosummary/read_config.html" rel="noopener noreferrer" target="_blank">flatironinstitute.github.io/solid_dmft/_autosummary/read_config</a> . Let us know if you have any questions.</p>
<p>Now go to the terminal, navigate to the directory of the tutorial and start the run either interactively (the calculation will take 3-4 min on 4 cores):</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">mpirun</span> <span class="pre">solid_dmft</span> <span class="pre">&gt;</span> <span class="pre">lco.dmft.out</span> <span class="pre">2&gt;&amp;1</span> <span class="pre">&amp;</span></code></p>
<p>or via the job file we prepared</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">sbatch</span> <span class="pre">job_solid_dmft.sh</span></code></p>
<p>and inspect the output with</p>
<p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span> <span class="pre">less</span> <span class="pre">lco.dmft.out</span></code></p>
<p>The calculation will create a directory <code class="docutils literal notranslate"><span class="pre">b10-U3.6</span></code>, where everything will be stored into the h5 archive and text files. Take a look around and see if you can identify the important steps of a DMFT calculation. Take special attention to the impurity density matrix printed before and after the solver is running. This is a good indicator for how well the calculation is going. In- and output density matrix should be the same at convergence.</p>
<p>During the calculation you can also monitor the <code class="docutils literal notranslate"><span class="pre">observables_imp0.dat</span></code> file, which is stored in the <code class="docutils literal notranslate"><span class="pre">jobname</span></code> directory. This file summarizes important observables in each iteration. Make sure that the chemical potential <code class="docutils literal notranslate"><span class="pre">mu</span></code> converges to a fixed value while the calculation is running.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">!</span>cat b10-U3.6/observables_imp0.dat
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 it |         mu | G(beta/2) per orbital |  orbital occs up+down |      impurity occ
  0 |   12.80000 |              -0.32494 |               1.00307 |           1.00307
  1 |   12.79717 |              -0.14812 |               0.98461 |           0.98461
  2 |   12.87496 |              -0.12729 |               0.99357 |           0.99357
  3 |   12.89458 |              -0.11730 |               0.99988 |           0.99988
  4 |   12.89592 |              -0.11138 |               0.99941 |           0.99941
  5 |   12.89818 |              -0.10786 |               1.00154 |           1.00154
  6 |   12.89443 |              -0.10531 |               0.99959 |           0.99959
  7 |   12.89588 |              -0.10412 |               1.00131 |           1.00131
  8 |   12.89243 |              -0.10364 |               1.00265 |           1.00265
  9 |   12.88569 |              -0.10322 |               0.99954 |           0.99954
 10 |   12.88738 |              -0.10295 |               0.99883 |           0.99883
</pre></div></div>
</div>
</div>
<div class="section" id="3.-Check-convergence">
<h2>3. Check convergence<a class="headerlink" href="#3.-Check-convergence" title="Permalink to this headline"></a></h2>
<p>After the calculation is finished we can take a look at the results (this step also works while the calculation is still running) and plot the results. First, we load the results from the h5 archive in the <code class="docutils literal notranslate"><span class="pre">jobname</span></code> directory:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;b10-U3.6/lco_wannier.h5&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">h5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
HDFArchive (partial view) with the following content:
  DMFT_input : subgroup
  DMFT_results : subgroup
  dft_input : subgroup
  dft_misc_input : subgroup
</pre></div></div>
</div>
<p>The h5 archive now has additional <code class="docutils literal notranslate"><span class="pre">groups</span></code> for the in / output of the calculation. You can print each sub-group to view how the data is stored. The organized folder-like structure allows us to later read the calculation again and continue where we left off. Let us now load the results of our calculation at the current stage:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;b10-U3.6/lco_wannier.h5&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5</span><span class="p">:</span>
    <span class="c1"># the next two lines load all directly measured observables and the convergence metrics per iteration</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;DMFT_results/observables&#39;</span><span class="p">]</span>
    <span class="n">conv_obs</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;DMFT_results/convergence_obs&#39;</span><span class="p">]</span>
    <span class="c1"># The next lines load the last iteration impurity Green function and self-energies</span>
    <span class="n">Sigma_imp_iw</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;DMFT_results/last_iter/Sigma_freq_0&#39;</span><span class="p">]</span>
    <span class="n">G_imp_iw</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;DMFT_results/last_iter/Gimp_freq_0&#39;</span><span class="p">]</span>
    <span class="n">G_imp_tau_mc</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;DMFT_results/last_iter/G_time_orig_0&#39;</span><span class="p">]</span>
    <span class="n">G_imp_tau</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;DMFT_results/last_iter/Gimp_time_0&#39;</span><span class="p">]</span>
    <span class="n">G_imp_leg</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;DMFT_results/last_iter/Gimp_l_0&#39;</span><span class="p">]</span>
    <span class="c1"># last, the chemical potential and double counting potential</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;DMFT_results&#39;</span><span class="p">][</span><span class="s1">&#39;last_iter&#39;</span><span class="p">][</span><span class="s1">&#39;chemical_potential_post&#39;</span><span class="p">]</span>
    <span class="n">dc</span> <span class="o">=</span> <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;DMFT_results&#39;</span><span class="p">][</span><span class="s1">&#39;last_iter&#39;</span><span class="p">][</span><span class="s1">&#39;DC_pot&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>We now plot the data and take a look at the most important observables to gauge if the calculation is converged: * the chemical potential * the impurity occupation * the spectral weight at the Fermi level, which is directly accessible on the imaginary axis, without analytical continuation (see also <a class="reference external" href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.83.235113" rel="noopener noreferrer" target="_blank">ref</a>):</p>
<div class="math notranslate nohighlight">
\[\bar{A}(\omega=0)=-\frac{\beta}{\pi} G(\tau=\frac{\beta}{2})\]</div>
<ul class="simple">
<li>the quasiparticle weight Z, i.e.&nbsp;renormalization of the DFT bands:</li>
</ul>
<div class="math notranslate nohighlight">
\[Z^{-1}=\left[ 1 - \frac{\partial \text{Im} \Sigma(i \omega_n)}{\partial \omega} \big|_{\omega \rightarrow 0^+} \right]\]</div>
<ul class="simple">
<li>the convergence of the Weiss field <span class="math notranslate nohighlight">\(\mathcal{G}^0(i \omega_n)\)</span></li>
<li>the convergence of the DMFT self-consistency condidation <span class="math notranslate nohighlight">\(|| G^{loc} - G^{imp} ||\)</span></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># chemical potential</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">],</span> <span class="n">obs</span><span class="p">[</span><span class="s1">&#39;mu&#39;</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mu$ (eV)&#39;</span><span class="p">)</span>

<span class="c1"># imp occupation</span>
<span class="n">imp_occ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;imp_occ&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;up&#39;</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;imp_occ&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;down&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">],</span> <span class="n">imp_occ</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span><span class="mf">1.02</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Imp. occupation&#39;</span><span class="p">)</span>

<span class="c1"># A(w=0)</span>
<span class="n">Aw0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;imp_gb2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;up&#39;</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;imp_gb2&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;down&#39;</span><span class="p">]))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">],</span> <span class="n">Aw0</span> <span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\bar</span><span class="si">{A}</span><span class="s1">(\omega=0$)&#39;</span><span class="p">)</span>

<span class="c1"># Z</span>
<span class="n">Z</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;orb_Z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;up&#39;</span><span class="p">])</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;orb_Z&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;down&#39;</span><span class="p">]))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">],</span> <span class="n">Z</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;QP weight Z&#39;</span><span class="p">)</span>

<span class="c1"># convergence of Weiss field</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">conv_obs</span><span class="p">[</span><span class="s1">&#39;d_G0&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C4&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;dG$_0$&#39;</span><span class="p">)</span>

<span class="c1"># convergence of DMFT self-consistency condition Gimp-Gloc</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">conv_obs</span><span class="p">[</span><span class="s1">&#39;d_Gimp&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C5&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;|G$_</span><span class="si">{imp}</span><span class="s1">$-G$_</span><span class="si">{loc}</span><span class="s1">$|&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="s1">&#39;iteration&#39;</span><span class="p">])))</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Iterations&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_29_0.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_29_0.png" />
</div>
</div>
<p>All metrics seem to indicate good convergence in the first few iterations. However, for the small number of measurements performed some metrics like the impurity occupations show room for improvement. The last two plots show overall accuracy of the calculation. Note that the Weiss field <span class="math notranslate nohighlight">\(\mathcal{G}^0(i \omega_n)\)</span> generally converges first, and only after a few extra iterations the convergence of <span class="math notranslate nohighlight">\(|| G^{loc} - G^{imp} ||\)</span> will follow.</p>
<div class="section" id="Reminder:-The-TRIQS-BlockGf-object">
<h3>Reminder: The TRIQS BlockGf object<a class="headerlink" href="#Reminder:-The-TRIQS-BlockGf-object" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Sigma_imp_iw</span></code> loaded from the h5 archive is a TRIQS Block Green’s function object (<a class="reference external" href="https://triqs.github.io/triqs/unstable/documentation/manual/triqs/gfs/py/full.html" rel="noopener noreferrer" target="_blank">see doc here</a>). This is a structured container holding not only the raw data of the Green’ function like a numpy array, but also information about the mesh, and its block (i.e.&nbsp;spin/orbital) structure. So when accessing a Block Green’s function object you only get back information:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">Sigma_imp_iw</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Green Function Sigma_freq_0 composed of 2 blocks:
 Greens Function Sigma_freq_0_up_0 with mesh Matsubara Freq Mesh of size 502, Domain: Matsubara domain with beta = 10, statistic = Fermion, positive_only : 0 and target_shape (1, 1):

 Greens Function Sigma_freq_0_down_0 with mesh Matsubara Freq Mesh of size 502, Domain: Matsubara domain with beta = 10, statistic = Fermion, positive_only : 0 and target_shape (1, 1):


</pre></div></div>
</div>
<p>we see that <code class="docutils literal notranslate"><span class="pre">Sigma_imp_iw</span></code> consists of two blocks. Each block has a name and is printed as separate line. The block names itself can be accessed via the <code class="docutils literal notranslate"><span class="pre">indices</span></code> property:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">list</span><span class="p">(</span><span class="n">Sigma_imp_iw</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;up_0&#39;, &#39;down_0&#39;]
</pre></div></div>
</div>
<p>We have one block for each spin index. Since we are running a paramagnetic calculation both blocks hold the same data. <code class="docutils literal notranslate"><span class="pre">solid_dmft</span></code> averaged both blocks for us to ensure a paramagnetic solution. To get an overview over all accessible attributes and functions of the Block Green’s function, take a look <a class="reference external" href="https://triqs.github.io/triqs/unstable/documentation/python_api/triqs.gf.block_gf.BlockGf.html" rel="noopener noreferrer" target="_blank">here</a>.</p>
<p>If we access one block we get back a view on the underlying Green function in memory:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">Sigma_imp_iw</span><span class="p">[</span><span class="s1">&#39;up_0&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Greens Function Sigma_freq_0_up_0 with mesh Matsubara Freq Mesh of size 502, Domain: Matsubara domain with beta = 10, statistic = Fermion, positive_only : 0 and target_shape (1, 1):

</pre></div></div>
</div>
<p>Every Green’s function in TRIQS is defined on a mesh which can be accessed via <code class="docutils literal notranslate"><span class="pre">Sigma_imp_iw.mesh</span></code>. Also note that triqs implements many useful linear algebra operations that run directly in C++, like multiplication, addition, inversion etc. This leverages fast pre-compiled C++ functionality. We will later learn more how to use these operations.</p>
</div>
<div class="section" id="Plot-of-the-self-energy-Σ">
<h3>Plot of the self-energy Σ<a class="headerlink" href="#Plot-of-the-self-energy-Σ" title="Permalink to this headline"></a></h3>
<p>Let us now take a look at the impurity self-energy. It is the central output of DMFT calculation, which determines the corrections to the non-interacting DFT input Hamiltonian. Here we calculated Σ on the imaginary axis. Hence, in general features are not easily transferable to the real frequency axis. However, at <span class="math notranslate nohighlight">\(i \omega_n \rightarrow 0\)</span> both the real and imaginary axis meet and we can directly interpret physical properties. Note that Σ itself like any other Green’s function is
complex-valued. Around <span class="math notranslate nohighlight">\(i \omega_n \approx 0\)</span> we can read off quasiparticle properties. As long as the imaginary part of Σ goes to 0 for small Matsubara frequencies, the material has quasiparticle-like features. If the imaginary part of Σ diverges at 0, the material is Mott insulating. The slope around 0 determines the band renormalization, indicating the strength of correlations of the material. Let us plot the imaginary part of Σ via the TRIQS <code class="docutils literal notranslate"><span class="pre">oplot</span></code> plotting layer on top of
matplotlib. This uses directly the <code class="docutils literal notranslate"><span class="pre">mesh</span></code> information to directly plot the Green’s function object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># plot self energy</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">oplot</span><span class="p">(</span><span class="n">Sigma_imp_iw</span><span class="p">[</span><span class="s1">&#39;up_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;d$_{x^2-y^2}$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Im $\Sigma (i \omega)$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_39_0.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_39_0.png" />
</div>
</div>
<p>We see that the self-energy is quite close to divergence around 0, but the first Matsubara goes back towards 0 indicating a metallic solution, but with strong renormalization. You should always make sure that the high frequency tail of the self-energy convergens smoothly to 0 on the imaginary axis, and to a constant value on the real axis.</p>
<p>&nbsp; check the convergence of the real part of Σ</p>
<blockquote>
<div>copy the plotting code in the cell above and change the plot command to <code class="docutils literal notranslate"><span class="pre">ax.oplot(Sigma_imp_iw['up_0'].real,</span> <span class="pre">'-o',</span> <span class="pre">c='C0',</span> <span class="pre">label='d$_{x^2-y^2}$')</span></code></div></blockquote>
<p>&nbsp; now we want to converge the calculation better, by performing 4 additional iterations with better sampling, that are appended to the previous iterations. To do so, open the <code class="docutils literal notranslate"><span class="pre">dmft_config.ini</span></code> file in the main directory (not in the job folder) and change first the number of dmft iterations to 4, and then increase the number of MC measurements to <span class="math notranslate nohighlight">\(10 \times 10^6\)</span>. Then just run solid_dmft again with the same command, but storing the output log file to <code class="docutils literal notranslate"><span class="pre">lco.dmft-hd.out</span></code>. Check that
solid_dmft in the beginning notices that there is already a calculation folder with that name and continues the calculation starting from your current self-energy instead of starting a new one. After this is finished you can just rerun the above cells to load the new results.</p>
<blockquote>
<div>the results are shown above</div></blockquote>
<p>&nbsp; while you wait for this to finish, plot the impurity Green function in <span class="math notranslate nohighlight">\(\tau\)</span>, this time the real part, which we loaded as <code class="docutils literal notranslate"><span class="pre">G_imp_tau</span></code>. You will see that it is a very smooth function. But how can this be, being sampled via MC? Indeed, <code class="docutils literal notranslate"><span class="pre">G_imp_tau</span></code> is already post-processed before computing the self-energy. The original MC data (loaded as <code class="docutils literal notranslate"><span class="pre">G_imp_tau_mc</span></code>) would be much too noisy for this. Plot both Green’s functions and inspect the difference.</p>
<blockquote>
<div>solution:</div></blockquote>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># plot self energy</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">oplot</span><span class="p">(</span><span class="n">G_imp_tau_mc</span><span class="p">[</span><span class="s1">&#39;up_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;raw MC data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">oplot</span><span class="p">(</span><span class="n">G_imp_tau</span><span class="p">[</span><span class="s1">&#39;up_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Legendre interpolated&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;G$ (\tau)$&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_41_0.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_41_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="4.-Analytic-continuation-of-the-self-energy">
<h2>4. Analytic continuation of the self-energy<a class="headerlink" href="#4.-Analytic-continuation-of-the-self-energy" title="Permalink to this headline"></a></h2>
<p>Since we are interested in the real frequency properties of the material we have to perform an analytic continuation. We do this using the TRIQS application <a class="reference external" href="https://triqs.github.io/maxent/latest/" rel="noopener noreferrer" target="_blank">triqs.github.io/maxent</a>. This is a stochastic method, which also performs quite well on noisy QMC data. We wrapped the functionality in <a class="reference external" href="https://flatironinstitute.github.io/solid_dmft/_autosummary/postprocessing.maxent_sigma.html" rel="noopener noreferrer" target="_blank">solid_dmft/maxent</a> to automatically load a result from a DMFT
calculation with all necessary input.</p>
<p>Disclaimer: The analytic continuation of a self-energy is delicate and should be done with great care. Always check if the results are physically sound and avoid overinterpreting specific features of a MaxEnt-continued Green’s function.</p>
<p>We use now the <code class="docutils literal notranslate"><span class="pre">sigma_maxent</span></code> module of <code class="docutils literal notranslate"><span class="pre">solid_dmft</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># use pcb maxent script to continue sigma</span>
<span class="n">Sigma_real_freq</span> <span class="o">=</span> <span class="n">sigma_maxent</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">external_path</span><span class="o">=</span><span class="s1">&#39;b10-U3.6/lco_wannier.h5&#39;</span><span class="p">,</span>
                                     <span class="n">omega_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="n">omega_max</span><span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                                     <span class="n">maxent_error</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                     <span class="n">n_points_maxent</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span>
                                     <span class="n">continuator_type</span><span class="o">=</span><span class="s1">&#39;inversion_sigmainf&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Input <span class="ansi-green-fg">In [19]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 2&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(95,135,135)"># use pcb maxent script to continue sigma</span>
<span class="ansi-green-fg">----&gt; 2</span> Sigma_real_freq <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">sigma_maxent</span><span style="color: rgb(98,98,98)">.</span>main(external_path<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">b10-U3.6/lco_wannier.h5</span><span style="color: rgb(175,0,0)">&#39;</span>,
<span class="ansi-green-intense-fg ansi-bold">      3</span>                                      omega_min <span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">10</span>, omega_max<span style="color: rgb(98,98,98)">=</span> <span style="color: rgb(98,98,98)">10</span>,
<span class="ansi-green-intense-fg ansi-bold">      4</span>                                      maxent_error<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">0.03</span>, iteration<span style="color: rgb(98,98,98)">=</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>,
<span class="ansi-green-intense-fg ansi-bold">      5</span>                                      n_points_maxent<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">101</span>,
<span class="ansi-green-intense-fg ansi-bold">      6</span>                                      continuator_type<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">inversion_sigmainf</span><span style="color: rgb(175,0,0)">&#39;</span>)[<span style="color: rgb(98,98,98)">0</span>][<span style="color: rgb(98,98,98)">0</span>]

<span class="ansi-red-fg">NameError</span>: name &#39;sigma_maxent&#39; is not defined
</pre></div></div>
</div>
<p>This takes just a few seconds in the current setup. You can play around using another, better converged iteration from the DMFT calculation from the h5 archive, or with the <code class="docutils literal notranslate"><span class="pre">n_points_maxent</span></code> (number of freq. points for the continuation). The function also stores the result consistently in the same h5 archive.</p>
<p>Let us plot the result:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="c1"># plot real part of the self-energy and subtract constant offset at 0.0 (Hartree shift)</span>
<span class="c1"># Sigma_real_freq[&#39;up_0&#39;](0.0) evaluates the self-energy at w=0.0</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">oplot</span><span class="p">((</span><span class="n">Sigma_real_freq</span><span class="p">[</span><span class="s1">&#39;up_0&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">Sigma_real_freq</span><span class="p">[</span><span class="s1">&#39;up_0&#39;</span><span class="p">](</span><span class="mf">0.0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Re&#39;</span><span class="p">)</span>
<span class="c1"># plot imaginary part of the self-energy</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">oplot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">Sigma_real_freq</span><span class="p">[</span><span class="s1">&#39;up_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Im&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Re $\Sigma (\omega)$ (eV)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;-Im $\Sigma (\omega)$ (eV)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Input <span class="ansi-green-fg">In [20]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 5&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> fig, ax <span style="color: rgb(98,98,98)">=</span> plt<span style="color: rgb(98,98,98)">.</span>subplots(<span style="color: rgb(98,98,98)">1</span>,<span style="color: rgb(98,98,98)">2</span>, sharex<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">True</span>, dpi<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">150</span>, figsize<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(98,98,98)">10</span>,<span style="color: rgb(98,98,98)">4</span>))
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(95,135,135)"># plot real part of the self-energy and subtract constant offset at 0.0 (Hartree shift)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(95,135,135)"># Sigma_real_freq[&#39;up_0&#39;](0.0) evaluates the self-energy at w=0.0</span>
<span class="ansi-green-fg">----&gt; 5</span> ax[<span style="color: rgb(98,98,98)">0</span>]<span style="color: rgb(98,98,98)">.</span>oplot((<span class="ansi-yellow-bg">Sigma_real_freq</span>[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">up_0</span><span style="color: rgb(175,0,0)">&#39;</span>] <span style="color: rgb(98,98,98)">-</span> Sigma_real_freq[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">up_0</span><span style="color: rgb(175,0,0)">&#39;</span>](<span style="color: rgb(98,98,98)">0.0</span>)[<span style="color: rgb(98,98,98)">0</span>,<span style="color: rgb(98,98,98)">0</span>])<span style="color: rgb(98,98,98)">.</span>real, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">-</span><span style="color: rgb(175,0,0)">&#39;</span>, c<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">C0</span><span style="color: rgb(175,0,0)">&#39;</span>, label<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">Re</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      6</span> <span style="color: rgb(95,135,135)"># plot imaginary part of the self-energy</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span> ax[<span style="color: rgb(98,98,98)">1</span>]<span style="color: rgb(98,98,98)">.</span>oplot(<span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">1</span><span style="color: rgb(98,98,98)">*</span>Sigma_real_freq[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">up_0</span><span style="color: rgb(175,0,0)">&#39;</span>]<span style="color: rgb(98,98,98)">.</span>imag, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">-</span><span style="color: rgb(175,0,0)">&#39;</span>, c<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">C0</span><span style="color: rgb(175,0,0)">&#39;</span>, label<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">Im</span><span style="color: rgb(175,0,0)">&#39;</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;Sigma_real_freq&#39; is not defined
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_45_1.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_45_1.png" />
</div>
</div>
<p>&nbsp; how can the quasiparticle properties be read of the real frequency Σ?</p>
<blockquote>
<div>the quasiparticle weight: <span class="math notranslate nohighlight">\(Z = [1-\frac{\partial Re \Sigma(0)}{\partial \omega}]^{-1} = \frac{m}{m^*}\)</span></div></blockquote>
<blockquote>
<div><p>the quasiparticle scattering rate: <span class="math notranslate nohighlight">\(\Gamma = - Z Im \Sigma (0)\)</span></p>
<p>renormalized dispersion: <span class="math notranslate nohighlight">\(\epsilon^*_{\mathbf{k}} = Z(\epsilon_{\mathbf{k}} + Re \Sigma(0))\)</span></p>
</div></blockquote>
</div>
<div class="section" id="5.-Plot-Spectral-Function">
<h2>5. Plot Spectral Function<a class="headerlink" href="#5.-Plot-Spectral-Function" title="Permalink to this headline"></a></h2>
<p>The spectral function, which can be compared to photoemission experiments, is obtained by constructing first the lattice Green’s functions:</p>
<div class="math notranslate nohighlight">
\[\hat G(k,\omega) = \left[ \omega + \mu -\hat{\epsilon}(k)-\left( \hat\Sigma(\omega)^{imp}-\hat\Sigma^{dc} \right) \right]^{-1}\]</div>
<p>using the DMFT analytically continued self-energy from above, the Wannier Hamiltonian <span class="math notranslate nohighlight">\(\epsilon(k)\)</span> and the obtained chemical potential. The spectral function is then calculated as:</p>
<div class="math notranslate nohighlight">
\[A(k,\omega) = - \frac{1}{\pi} \text{Im} \ G(k, \omega)\]</div>
<p>which is done by the function <code class="docutils literal notranslate"><span class="pre">get_dmft_bands</span></code> from solid_dmft postprocessing routines of <code class="docutils literal notranslate"><span class="pre">plot_correlated_bands.py</span></code>. By passing the option <code class="docutils literal notranslate"><span class="pre">with_Sigma='calc'</span></code> the self-energy from MaxEnt is loaded directly from the h5 file.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># we have to specify the mesh of the spectral function and pass a new keywargs object sigma_dict</span>
<span class="n">w_mesh</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span> <span class="s1">&#39;n_w&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mi">501</span><span class="p">)}</span>
<span class="n">sigma_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dmft_path&#39;</span><span class="p">:</span> <span class="s1">&#39;b10-U3.6/lco_wannier.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;it&#39;</span><span class="p">:</span> <span class="s1">&#39;last_iter&#39;</span><span class="p">,</span> <span class="s1">&#39;orbital_order_dmft&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;spin&#39;</span><span class="p">:</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;block&#39;</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">,</span><span class="s1">&#39;w_mesh&#39;</span><span class="p">:</span> <span class="n">w_mesh</span><span class="p">,</span> <span class="s1">&#39;linearize&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

<span class="n">tb_bands_data</span><span class="p">,</span> <span class="n">alatt_k_w_path</span><span class="p">,</span> <span class="n">freq_dict</span><span class="p">,</span> <span class="n">dft_mu</span> <span class="o">=</span> <span class="n">pcb</span><span class="o">.</span><span class="n">get_dmft_bands</span><span class="p">(</span><span class="n">orbital_order_to</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">with_sigma</span><span class="o">=</span><span class="s1">&#39;calc&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">w90_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">tb_bands</span><span class="p">,</span> <span class="o">**</span><span class="n">sigma_dict</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">pcb</span><span class="o">.</span><span class="n">plot_bands</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">alatt_k_w_path</span><span class="p">,</span> <span class="n">tb_bands_data</span><span class="p">,</span> <span class="n">freq_dict</span><span class="p">,</span> <span class="n">n_orb</span><span class="o">=</span><span class="n">w90_dict</span><span class="p">[</span><span class="s1">&#39;n_orb&#39;</span><span class="p">],</span> <span class="n">dft_mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alatt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
H(R=0):
      0.1589
Setting Sigma from b10-U3.6/lco_wannier.h5
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_49_1.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_49_1.png" />
</div>
</div>
<p>The original W90 band is plotted in red and the spectral function is shown as intensity plot. The quasiparticle band is the strongly renormalized white “band”-like structure around <span class="math notranslate nohighlight">\(\omega=0\)</span>. The strong intensities at larger energies are Hubbard sattelite features forming the Hubbard bands. To visualize this effect better we now want to calculate the k-summed spectral function <span class="math notranslate nohighlight">\(A(\omega)\)</span>, which we can compare with the DOS from W90.</p>
<p>We first construct the full lattice Green’s function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># triqs function to load a w90 hamiltonian as tight binding object</span>
<span class="n">TB</span> <span class="o">=</span> <span class="n">TB_from_wannier90</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="s1">&#39;lco&#39;</span> <span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;./data/mlwf/&#39;</span><span class="p">)</span>

<span class="c1"># calculate epsilon(k) on a given mesh</span>
<span class="c1"># since La2CuO4 is mostly 2D, we use a 2D mesh to speed things up</span>
<span class="n">k_dim</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">k_mesh</span> <span class="o">=</span> <span class="n">TB</span><span class="o">.</span><span class="n">get_kmesh</span><span class="p">(</span><span class="n">n_k</span> <span class="o">=</span> <span class="p">(</span><span class="n">k_dim</span><span class="p">,</span> <span class="n">k_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">n_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">k_mesh</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
<span class="n">e_k</span> <span class="o">=</span> <span class="n">TB</span><span class="o">.</span><span class="n">fourier</span><span class="p">(</span><span class="n">k_mesh</span><span class="p">)</span>

<span class="c1"># create a Mesh product of k and omega mesh:</span>
<span class="n">mesh_k_w</span> <span class="o">=</span> <span class="n">MeshProduct</span><span class="p">(</span><span class="n">k_mesh</span><span class="p">,</span> <span class="n">Sigma_real_freq</span><span class="o">.</span><span class="n">mesh</span><span class="p">)</span>

<span class="c1"># create a triqs Gf on a combined k and omega mesh:</span>
<span class="n">G_k_w</span> <span class="o">=</span> <span class="n">Gf</span><span class="p">(</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">mesh_k_w</span><span class="p">,</span> <span class="n">target_shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># create here first a Gf called G_loc_w for the k summation</span>
<span class="n">G_loc_w</span> <span class="o">=</span> <span class="n">Gf</span><span class="p">(</span><span class="n">mesh</span> <span class="o">=</span> <span class="n">Sigma_real_freq</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span> <span class="n">target_shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># now we loop over k-points</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">G_k_w</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">components</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="c1"># use equation above to set at each k point the lattice Gf</span>
    <span class="n">G_k_w</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span> <span class="o">&lt;&lt;</span> <span class="n">inverse</span><span class="p">(</span><span class="n">Omega</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">e_k</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">Sigma_real_freq</span><span class="p">[</span><span class="s1">&#39;up_0&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;up&#39;</span><span class="p">])</span> <span class="p">)</span>

    <span class="c1"># do the summation for G_loc_w  / the factor 2 is to account for both spin channels, and we divide by the weight 1/n_k</span>
    <span class="n">G_loc_w</span> <span class="o">&lt;&lt;</span> <span class="n">G_loc_w</span> <span class="o">+</span> <span class="mi">2</span><span class="o">/</span><span class="n">n_k</span> <span class="o">*</span> <span class="n">inverse</span><span class="p">(</span><span class="n">Omega</span> <span class="o">+</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">e_k</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">Sigma_real_freq</span><span class="p">[</span><span class="s1">&#39;up_0&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;up&#39;</span><span class="p">])</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Input <span class="ansi-green-fg">In [22]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 12&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span> e_k <span style="color: rgb(98,98,98)">=</span> TB<span style="color: rgb(98,98,98)">.</span>fourier(k_mesh)
<span class="ansi-green-intense-fg ansi-bold">     11</span> <span style="color: rgb(95,135,135)"># create a Mesh product of k and omega mesh:</span>
<span class="ansi-green-fg">---&gt; 12</span> mesh_k_w <span style="color: rgb(98,98,98)">=</span> MeshProduct(k_mesh, <span class="ansi-yellow-bg">Sigma_real_freq</span><span style="color: rgb(98,98,98)">.</span>mesh)
<span class="ansi-green-intense-fg ansi-bold">     14</span> <span style="color: rgb(95,135,135)"># create a triqs Gf on a combined k and omega mesh:</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span> G_k_w <span style="color: rgb(98,98,98)">=</span> Gf(mesh <span style="color: rgb(98,98,98)">=</span> mesh_k_w, target_shape <span style="color: rgb(98,98,98)">=</span> [<span style="color: rgb(98,98,98)">1</span>,<span style="color: rgb(98,98,98)">1</span>])

<span class="ansi-red-fg">NameError</span>: name &#39;Sigma_real_freq&#39; is not defined
</pre></div></div>
</div>
<p>&nbsp; adapt the cell above to obtain the local real frequency Green’s function <code class="docutils literal notranslate"><span class="pre">G_loc_w</span></code> defined in line 16. Think about how it should be normalized and also check <a class="reference external" href="https://triqs.github.io/triqs/unstable/documentation/manual/triqs/gfs/py/block.html#operations" rel="noopener noreferrer" target="_blank">triqs.github.io/triqs/unstable/documentation/manual/triqs/gfs/py/block.html#operations</a> for how to perform basic operations on Gf objects.</p>
<blockquote>
<div>inserted code above</div></blockquote>
<p>If everything went fine we can plot the result (hint: after it looks roughly correct increase <code class="docutils literal notranslate"><span class="pre">k_dim</span></code>):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">oplot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">G_loc_w</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;A($\omega$) U=3.6 eV&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w90_dos</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">fermi</span><span class="p">,</span><span class="n">w90_dos</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;w90 DOS&#39;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;A($\omega$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\omega$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Input <span class="ansi-green-fg">In [23]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 3&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> fig, ax <span style="color: rgb(98,98,98)">=</span> plt<span style="color: rgb(98,98,98)">.</span>subplots(<span style="color: rgb(98,98,98)">1</span>,dpi<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">150</span>,figsize<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(98,98,98)">6</span>,<span style="color: rgb(98,98,98)">3</span>))
<span class="ansi-green-fg">----&gt; 3</span> ax<span style="color: rgb(98,98,98)">.</span>oplot(<span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">1</span><span style="color: rgb(98,98,98)">/</span>np<span style="color: rgb(98,98,98)">.</span>pi<span style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">G_loc_w</span><span style="color: rgb(98,98,98)">.</span>imag, label<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">r</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">A($</span><span style="color: rgb(175,0,0)">\</span><span style="color: rgb(175,0,0)">omega$) U=3.6 eV</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      5</span> ax<span style="color: rgb(98,98,98)">.</span>plot(w90_dos[:,<span style="color: rgb(98,98,98)">0</span>]<span style="color: rgb(98,98,98)">-</span>fermi,w90_dos[:,<span style="color: rgb(98,98,98)">1</span>], label<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">w90 DOS</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      8</span> ax<span style="color: rgb(98,98,98)">.</span>set_ylabel(<span style="color: rgb(175,0,0)">r</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">A($</span><span style="color: rgb(175,0,0)">\</span><span style="color: rgb(175,0,0)">omega$)</span><span style="color: rgb(175,0,0)">&#39;</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;G_loc_w&#39; is not defined
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_53_1.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_53_1.png" />
</div>
</div>
<div class="section" id="Analytically-continue-the-impurity-Green’s-function">
<h3>Analytically continue the impurity Green’s function<a class="headerlink" href="#Analytically-continue-the-impurity-Green’s-function" title="Permalink to this headline"></a></h3>
<p>Instead of the self-energy we can also continue the impurity Green’s function to the real frequency axis by running MaxEnt directly on <code class="docutils literal notranslate"><span class="pre">G_imp_tau</span></code> from the solution. use the according function from solid_dmft (see below) to run MaxEnt on the impurity Green’s function and plot the spectral function from it in comparison with that obtained from the lattice Green’s function with the continued self-energy.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">solid_dmft.postprocessing.maxent_gf_imp</span> <span class="k">as</span> <span class="nn">gf_imp_maxent</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
Input <span class="ansi-green-fg">In [24]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">solid_dmft</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">postprocessing</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">maxent_gf_imp</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> <span class="ansi-bold" style="color: rgb(0,0,255)">gf_imp_maxent</span>

File <span class="ansi-green-fg">~/opt/triqs/lib/python3.9/site-packages/solid_dmft/postprocessing/maxent_gf_imp.py:41</span>, in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     38</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">functools</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> partial
<span class="ansi-green-intense-fg ansi-bold">     39</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> <span class="ansi-bold" style="color: rgb(0,0,255)">numpy</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> <span class="ansi-bold" style="color: rgb(0,0,255)">np</span>
<span class="ansi-green-fg">---&gt; 41</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">triqs_maxent</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">elementwise_maxent</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> PoormanMaxEnt
<span class="ansi-green-intense-fg ansi-bold">     42</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">triqs_maxent</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">omega_meshes</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> HyperbolicOmegaMesh
<span class="ansi-green-intense-fg ansi-bold">     43</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> <span class="ansi-bold" style="color: rgb(0,0,255)">triqs_maxent</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">alpha_meshes</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span> LogAlphaMesh

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;triqs_maxent&#39;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># solution:</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">gf_imp_maxent</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">external_path</span><span class="o">=</span><span class="s1">&#39;b10-U3.6/lco_wannier.h5&#39;</span><span class="p">,</span>
                             <span class="n">sum_spins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">maxent_error</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>
                             <span class="n">omega_min</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">omega_max</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;mesh&#39;</span><span class="p">]</span>
<span class="n">A_imp_w</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Aimp_w_line_fit&#39;</span><span class="p">][</span><span class="s1">&#39;total_0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Input <span class="ansi-green-fg">In [25]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 2&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(95,135,135)"># solution:</span>
<span class="ansi-green-fg">----&gt; 2</span> results <span style="color: rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">gf_imp_maxent</span><span style="color: rgb(98,98,98)">.</span>main(external_path<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">b10-U3.6/lco_wannier.h5</span><span style="color: rgb(175,0,0)">&#39;</span>,
<span class="ansi-green-intense-fg ansi-bold">      3</span>                              sum_spins<span style="color: rgb(98,98,98)">=</span><span class="ansi-bold" style="color: rgb(0,135,0)">True</span>, maxent_error<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">0.04</span>,
<span class="ansi-green-intense-fg ansi-bold">      4</span>                              omega_min<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">10</span>, omega_max<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">10</span>)[<span style="color: rgb(98,98,98)">0</span>]
<span class="ansi-green-intense-fg ansi-bold">      5</span> mesh <span style="color: rgb(98,98,98)">=</span> results[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">mesh</span><span style="color: rgb(175,0,0)">&#39;</span>]
<span class="ansi-green-intense-fg ansi-bold">      6</span> A_imp_w <span style="color: rgb(98,98,98)">=</span> results[<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">Aimp_w_line_fit</span><span style="color: rgb(175,0,0)">&#39;</span>][<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">total_0</span><span style="color: rgb(175,0,0)">&#39;</span>]

<span class="ansi-red-fg">NameError</span>: name &#39;gf_imp_maxent&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">oplot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">G_loc_w</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;A($\omega$) $\Sigma$ maxent&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">A_imp_w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">real</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;A($\omega$) $G_</span><span class="si">{imp}</span><span class="s1">$ maxent&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w90_dos</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">fermi</span><span class="p">,</span><span class="n">w90_dos</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;w90 DOS&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;A($\omega$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\omega$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Input <span class="ansi-green-fg">In [26]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 3&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> fig, ax <span style="color: rgb(98,98,98)">=</span> plt<span style="color: rgb(98,98,98)">.</span>subplots(<span style="color: rgb(98,98,98)">1</span>,dpi<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(98,98,98)">150</span>,figsize<span style="color: rgb(98,98,98)">=</span>(<span style="color: rgb(98,98,98)">6</span>,<span style="color: rgb(98,98,98)">3</span>))
<span class="ansi-green-fg">----&gt; 3</span> ax<span style="color: rgb(98,98,98)">.</span>oplot(<span style="color: rgb(98,98,98)">-</span><span style="color: rgb(98,98,98)">1</span><span style="color: rgb(98,98,98)">/</span>np<span style="color: rgb(98,98,98)">.</span>pi<span style="color: rgb(98,98,98)">*</span><span class="ansi-yellow-bg">G_loc_w</span><span style="color: rgb(98,98,98)">.</span>imag, label<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">r</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">A($</span><span style="color: rgb(175,0,0)">\</span><span style="color: rgb(175,0,0)">omega$) $</span><span style="color: rgb(175,0,0)">\</span><span style="color: rgb(175,0,0)">Sigma$ maxent</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      4</span> ax<span style="color: rgb(98,98,98)">.</span>plot(mesh, A_imp_w[<span style="color: rgb(98,98,98)">0</span>,<span style="color: rgb(98,98,98)">0</span>,:]<span style="color: rgb(98,98,98)">.</span>real , label<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">r</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">A($</span><span style="color: rgb(175,0,0)">\</span><span style="color: rgb(175,0,0)">omega$) $G_</span><span class="ansi-bold" style="color: rgb(175,95,135)">{imp}</span><span style="color: rgb(175,0,0)">$ maxent</span><span style="color: rgb(175,0,0)">&#39;</span>)
<span class="ansi-green-intense-fg ansi-bold">      5</span> ax<span style="color: rgb(98,98,98)">.</span>plot(w90_dos[:,<span style="color: rgb(98,98,98)">0</span>]<span style="color: rgb(98,98,98)">-</span>fermi,w90_dos[:,<span style="color: rgb(98,98,98)">1</span>], label<span style="color: rgb(98,98,98)">=</span><span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">w90 DOS</span><span style="color: rgb(175,0,0)">&#39;</span>)

<span class="ansi-red-fg">NameError</span>: name &#39;G_loc_w&#39; is not defined
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_57_1.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_57_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="6.-Plot-the-Fermi-slice-at-k_z-=-0.0-using-the-solid_dmft-post-processing-tool">
<h2>6. Plot the Fermi slice at <span class="math notranslate nohighlight">\(k_z = 0.0\)</span> using the solid_dmft post-processing tool<a class="headerlink" href="#6.-Plot-the-Fermi-slice-at-k_z-=-0.0-using-the-solid_dmft-post-processing-tool" title="Permalink to this headline"></a></h2>
<p>We can also look at in-plane Fermi slices:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tb_kslice</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">tb_bands</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">tb_bands</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">isupper</span><span class="p">()}</span>
<span class="n">kslice_update</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bands_path&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;S</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">),(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">)],</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.25</span><span class="p">]),</span> <span class="s1">&#39;n_k&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;kz&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}</span>
<span class="n">tb_kslice</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kslice_update</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># we have to specify the mesh of the spectral function and pass a new keywargs object sigma_dict</span>
<span class="n">w_mesh</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="s1">&#39;n_w&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e6</span><span class="p">)}</span>
<span class="n">sigma_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dmft_path&#39;</span><span class="p">:</span> <span class="s1">&#39;b10-U3.6/lco_wannier.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;it&#39;</span><span class="p">:</span> <span class="s1">&#39;last_iter&#39;</span><span class="p">,</span> <span class="s1">&#39;orbital_order_dmft&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;spin&#39;</span><span class="p">:</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span> <span class="s1">&#39;eta&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;block&#39;</span> <span class="p">:</span> <span class="mi">0</span> <span class="p">,</span><span class="s1">&#39;w_mesh&#39;</span><span class="p">:</span> <span class="n">w_mesh</span><span class="p">,</span> <span class="s1">&#39;linearize&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

<span class="n">tb_bands_data</span><span class="p">,</span> <span class="n">alatt_k_w_path</span><span class="p">,</span> <span class="n">freq_dict</span><span class="p">,</span> <span class="n">dft_mu</span> <span class="o">=</span> <span class="n">pcb</span><span class="o">.</span><span class="n">get_dmft_bands</span><span class="p">(</span><span class="n">fermi_slice</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">orbital_order_to</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">with_sigma</span><span class="o">=</span><span class="s1">&#39;calc&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">w90_dict</span><span class="p">,</span> <span class="o">**</span><span class="n">tb_kslice</span><span class="p">,</span> <span class="o">**</span><span class="n">sigma_dict</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">pcb</span><span class="o">.</span><span class="n">plot_kslice</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">alatt_k_w_path</span><span class="p">,</span> <span class="n">tb_bands_data</span><span class="p">,</span> <span class="n">freq_dict</span><span class="p">,</span> <span class="n">n_orb</span><span class="o">=</span><span class="n">w90_dict</span><span class="p">[</span><span class="s1">&#39;n_orb&#39;</span><span class="p">],</span> <span class="n">tb_dict</span><span class="o">=</span><span class="n">tb_kslice</span><span class="p">,</span> <span class="n">dft_mu</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alatt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">quarter</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="o">**</span><span class="n">plot_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
H(R=0):
      0.1589
Setting Sigma from b10-U3.6/lco_wannier.h5
Zero-frequency Sigma:
      0.0755
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:xlabel=&#39;$k_x\\pi/a$&#39;, ylabel=&#39;$k_y\\pi/b$&#39;&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_61_2.png" src="../../../../../_images/userguide_python_tutorials_AbinitioDMFT_solutions_01s-solid_dmft_61_2.png" />
</div>
</div>
<p>We will now prepare our calculated self-energy on the real axis to be read by the FermiSee tool later:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># prepare self-energy for FermiSee</span>
<span class="n">w_mesh</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">Sigma_real_freq</span><span class="o">.</span><span class="n">mesh</span><span class="p">]</span>
<span class="c1"># store to FermiSee readable format</span>
<span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;sigma_fermisee.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5</span><span class="p">:</span>
    <span class="n">h5</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;self_energy&#39;</span><span class="p">)</span>
    <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;self_energy&#39;</span><span class="p">][</span><span class="s1">&#39;Sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Sigma_real_freq</span>
    <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;self_energy&#39;</span><span class="p">][</span><span class="s1">&#39;w_mesh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">w_mesh</span>
    <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;self_energy&#39;</span><span class="p">][</span><span class="s1">&#39;n_w&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">w_mesh</span><span class="p">)</span>
    <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;self_energy&#39;</span><span class="p">][</span><span class="s1">&#39;n_orb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;self_energy&#39;</span><span class="p">][</span><span class="s1">&#39;dc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;up&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;self_energy&#39;</span><span class="p">][</span><span class="s1">&#39;dmft_mu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mu</span>
    <span class="n">h5</span><span class="p">[</span><span class="s1">&#39;self_energy&#39;</span><span class="p">][</span><span class="s1">&#39;orbital_order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
Input <span class="ansi-green-fg">In [29]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 2&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span style="color: rgb(95,135,135)"># prepare self-energy for FermiSee</span>
<span class="ansi-green-fg">----&gt; 2</span> w_mesh <span style="color: rgb(98,98,98)">=</span> [w<span style="color: rgb(98,98,98)">.</span>value <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> w <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> <span class="ansi-yellow-bg">Sigma_real_freq</span><span style="color: rgb(98,98,98)">.</span>mesh]
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span style="color: rgb(95,135,135)"># store to FermiSee readable format</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> HDFArchive(<span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">sigma_fermisee.h5</span><span style="color: rgb(175,0,0)">&#39;</span>, <span style="color: rgb(175,0,0)">&#39;</span><span style="color: rgb(175,0,0)">w</span><span style="color: rgb(175,0,0)">&#39;</span>) <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> h5:

<span class="ansi-red-fg">NameError</span>: name &#39;Sigma_real_freq&#39; is not defined
</pre></div></div>
</div>
</div>
<div class="section" id="This-concludes-the-first-tutorial.-You-may-now-continue-with-tutorial-02-FermiSee.">
<h2>This concludes the first tutorial. You may now continue with tutorial 02-FermiSee.<a class="headerlink" href="#This-concludes-the-first-tutorial.-You-may-now-continue-with-tutorial-02-FermiSee." title="Permalink to this headline"></a></h2>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2011-2022, The TRIQS collaboration.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>