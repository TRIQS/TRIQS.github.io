{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "1a5d86f1-d30e-42ce-a163-87c3320d1485",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-22T22:10:51.380960Z",
     "iopub.status.busy": "2022-06-22T22:10:51.380648Z",
     "iopub.status.idle": "2022-06-22T22:10:52.967604Z",
     "shell.execute_reply": "2022-06-22T22:10:52.966929Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Warning: could not identify MPI environment!\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Starting serial run at: 2022-06-22 18:10:52.469989\n"
     ]
    },
    {
     "ename": "ModuleNotFoundError",
     "evalue": "No module named 'triqs_maxent'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)",
      "Input \u001b[0;32mIn [1]\u001b[0m, in \u001b[0;36m<cell line: 19>\u001b[0;34m()\u001b[0m\n\u001b[1;32m     16\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mtriqs\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mlattice\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mutils\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m TB_from_wannier90, k_space_path\n\u001b[1;32m     18\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01msolid_dmft\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mpostprocessing\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mplot_correlated_bands\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01mpcb\u001b[39;00m\n\u001b[0;32m---> 19\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01msolid_dmft\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mpostprocessing\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mmaxent_sigma\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01msigma_maxent\u001b[39;00m\n",
      "File \u001b[0;32m~/opt/triqs/lib/python3.9/site-packages/solid_dmft/postprocessing/maxent_sigma.py:41\u001b[0m, in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     38\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mnumpy\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01mnp\u001b[39;00m\n\u001b[1;32m     40\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mtriqs\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mutility\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m mpi\n\u001b[0;32m---> 41\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mtriqs_maxent\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01msigma_continuator\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m InversionSigmaContinuator, DirectSigmaContinuator\n\u001b[1;32m     42\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mtriqs_maxent\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01melementwise_maxent\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m PoormanMaxEnt\n\u001b[1;32m     43\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mtriqs_maxent\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01momega_meshes\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m HyperbolicOmegaMesh\n",
      "\u001b[0;31mModuleNotFoundError\u001b[0m: No module named 'triqs_maxent'"
     ]
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "\n",
    "import os\n",
    "import sys\n",
    "from itertools import product\n",
    "import numpy as np\n",
    "np.set_printoptions(precision=4,suppress=True, linewidth=140)\n",
    "import scipy\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "from h5 import HDFArchive\n",
    "from triqs.gf import *\n",
    "from triqs.gf.descriptors import Fourier, Omega\n",
    "from triqs.plot.mpl_interface import plt,oplot\n",
    "from triqs.lattice.utils import TB_from_wannier90, k_space_path\n",
    "\n",
    "import solid_dmft.postprocessing.plot_correlated_bands as pcb\n",
    "import solid_dmft.postprocessing.maxent_sigma as sigma_maxent"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "8d8313bd-be9f-4537-b08e-2f76b5361214",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-22T22:10:52.970480Z",
     "iopub.status.busy": "2022-06-22T22:10:52.970253Z",
     "iopub.status.idle": "2022-06-22T22:10:52.974390Z",
     "shell.execute_reply": "2022-06-22T22:10:52.973897Z"
    }
   },
   "outputs": [],
   "source": [
    "fermi = 12.7367\n",
    "# w90 information\n",
    "w90_dict = {'w90_path': './data/mlwf/',\n",
    "            'w90_seed': 'lco',\n",
    "            'add_spin': False, 'add_lambda': None,\n",
    "            'n_orb': 1,\n",
    "            'mu': fermi,\n",
    "            'orbital_order_w90': [0]}\n",
    "\n",
    "# plotting options\n",
    "plot_dict = {'colorscheme_bands': 'coolwarm', 'colorscheme_kslice': 'coolwarm', 'proj_on_orb': None, 'vmin': 0.0}\n",
    "\n",
    "tb_bands = {'bands_path': [('G', 'S\\''), ('S\\'', 'X'), ('X', 'G'), ('G', 'Z')], 'n_k': 50,\n",
    "            'G': [ 0.0,  0.0,  0.0], 'S\\'': [0.25, -0.25, 0.25], 'X': [0.0,  0.0,  0.5 ], 'Z': [0.25,  0.25, -0.25] }"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ae071b9e-68bc-4a12-8a8d-cc4c96637dd5",
   "metadata": {},
   "source": [
    "# Comparison to Hubbard-I solution\n",
    "\n",
    "One feature of `solid_dmft` is the ability to seamlessly switch between different DMFT impurity solver. In this notebook we will compare the cthyb results with results of the [HubbardI solver](https://triqs.github.io/hubbardI). The `hubbardI` solver is much lighter that the cthyb solver, but numerically not exact. It neglects the coupling to the bath to calculate the self-energy, and solves the local Hamiltonian via exact diagonalization.\n",
    "\n",
    "To use the solver we prepared a second input file called `dmft_config_hubbardI.ini`. Take a look at the file: "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "be2d78b9-10c9-4ef9-9465-8258522b0fe4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-22T22:10:52.977176Z",
     "iopub.status.busy": "2022-06-22T22:10:52.976847Z",
     "iopub.status.idle": "2022-06-22T22:10:53.101649Z",
     "shell.execute_reply": "2022-06-22T22:10:53.100711Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[general]\r\n",
      "seedname = lco_wannier\r\n",
      "jobname = b10-U3.6-hubbardI\r\n",
      "\r\n",
      "solver_type = hubbardI\r\n",
      "beta = 10\r\n",
      "eta = 0.001\r\n",
      "n_iw = 251\r\n",
      "n_tau = 5001\r\n",
      "n_iter_dmft = 5\r\n",
      "\r\n",
      "prec_mu = 0.0001\r\n",
      "dft_mu = 12.8\r\n",
      "\r\n",
      "h_int_type = kanamori\r\n",
      "U = 3.6\r\n",
      "J = 0.0\r\n",
      "\r\n",
      "dc_type = 0\r\n",
      "dc_dmft = False\r\n",
      "\r\n",
      "h5_save_freq = 1\r\n",
      "\r\n",
      "[solver]\r\n",
      "measure_density_matrix = True\r\n"
     ]
    }
   ],
   "source": [
    "!cat dmft_config_hubbardI.ini"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bdc2d8ed-fc68-449e-8e99-cc39f0e9fde6",
   "metadata": {},
   "source": [
    "The only necessary change is to switch the `solver_type` flag to `hubbardI`, and remove some unecessary flags in the `[solver]` section that are specific to Quantum Monte Carlo solvers. Run `solid_dmft` with this input file by passing the name of the config file as parameter: \n",
    "\n",
    "`>>> mpirun solid_dmft dmft_config_hubbardI.ini`\n",
    "\n",
    "After the solver is finished (should be done in a minute or so) we load the results:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "1b3d1487-e8e2-4dd3-9942-b9704c2752c5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-22T22:10:53.105468Z",
     "iopub.status.busy": "2022-06-22T22:10:53.105146Z",
     "iopub.status.idle": "2022-06-22T22:10:53.230717Z",
     "shell.execute_reply": "2022-06-22T22:10:53.230115Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cannot open the HDF file b10-U3.6-hubbardI/lco_wannier.h5\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDF5-DIAG: Error detected in HDF5 (1.12.2) thread 0:\n",
      "  #000: H5F.c line 620 in H5Fopen(): unable to open file\n",
      "    major: File accessibility\n",
      "    minor: Unable to open file\n",
      "  #001: H5VLcallback.c line 3502 in H5VL_file_open(): failed to iterate over available VOL connector plugins\n",
      "    major: Virtual Object Layer\n",
      "    minor: Iteration failed\n",
      "  #002: H5PLpath.c line 579 in H5PL__path_table_iterate(): can't iterate over plugins in plugin path '(null)'\n",
      "    major: Plugin for dynamically loaded library\n",
      "    minor: Iteration failed\n",
      "  #003: H5PLpath.c line 620 in H5PL__path_table_iterate_process_path(): can't open directory: /usr/local/hdf5/lib/plugin\n",
      "    major: Plugin for dynamically loaded library\n",
      "    minor: Can't open directory or file\n",
      "  #004: H5VLcallback.c line 3351 in H5VL__file_open(): open failed\n",
      "    major: Virtual Object Layer\n",
      "    minor: Can't open object\n",
      "  #005: H5VLnative_file.c line 97 in H5VL__native_file_open(): unable to open file\n",
      "    major: File accessibility\n",
      "    minor: Unable to open file\n",
      "  #006: H5Fint.c line 1835 in H5F_open(): unable to open file: name = 'b10-U3.6-hubbardI/lco_wannier.h5', tent_flags = 0\n",
      "    major: File accessibility\n",
      "    minor: Unable to open file\n",
      "  #007: H5FD.c line 723 in H5FD_open(): open failed\n",
      "    major: Virtual File Layer\n",
      "    minor: Unable to initialize object\n",
      "  #008: H5FDsec2.c line 355 in H5FD__sec2_open(): unable to open file: name = 'b10-U3.6-hubbardI/lco_wannier.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0\n",
      "    major: File accessibility\n",
      "    minor: Unable to open file\n"
     ]
    },
    {
     "ename": "RuntimeError",
     "evalue": ".. Error occurred at Wed Jun 22 18:10:53 2022\n\n.. Error .. in calling C++ overload of constructor :\n.. (no C++ name)(std::string name, char mode) -> \n.. C++ error was : \nHDF5 : cannot openfile : b10-U3.6-hubbardI/lco_wannier.h5",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mRuntimeError\u001b[0m                              Traceback (most recent call last)",
      "Input \u001b[0;32mIn [4]\u001b[0m, in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[43mHDFArchive\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mb10-U3.6-hubbardI/lco_wannier.h5\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mr\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m)\u001b[49m \u001b[38;5;28;01mas\u001b[39;00m h5:\n\u001b[1;32m      2\u001b[0m     \u001b[38;5;28mprint\u001b[39m(h5[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mDMFT_results\u001b[39m\u001b[38;5;124m'\u001b[39m][\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlast_iter\u001b[39m\u001b[38;5;124m'\u001b[39m])\n\u001b[1;32m      3\u001b[0m     \u001b[38;5;66;03m# the next two lines load all directly measured observables and the convergence metrics per iteration\u001b[39;00m\n",
      "File \u001b[0;32m~/opt/triqs/lib/python3.9/site-packages/h5/archive.py:383\u001b[0m, in \u001b[0;36mHDFArchive.__init__\u001b[0;34m(self, descriptor, open_flag, key_as_string_only, reconstruct_python_object, init)\u001b[0m\n\u001b[1;32m    380\u001b[0m         \u001b[38;5;28;01mtry\u001b[39;00m: os\u001b[38;5;241m.\u001b[39mremove(os\u001b[38;5;241m.\u001b[39mpath\u001b[38;5;241m.\u001b[39mabspath(LocalFileName))\n\u001b[1;32m    381\u001b[0m         \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mOSError\u001b[39;00m: \u001b[38;5;28;01mpass\u001b[39;00m\n\u001b[0;32m--> 383\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_init_root\u001b[49m\u001b[43m(\u001b[49m\u001b[43mLocalFileName\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mopen_flag\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    385\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39moptions \u001b[38;5;241m=\u001b[39m {\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mkey_as_string_only\u001b[39m\u001b[38;5;124m'\u001b[39m : key_as_string_only,\n\u001b[1;32m    386\u001b[0m                 \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdo_not_overwrite_entries\u001b[39m\u001b[38;5;124m'\u001b[39m : \u001b[38;5;28;01mFalse\u001b[39;00m,\n\u001b[1;32m    387\u001b[0m                 \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreconstruct_python_object\u001b[39m\u001b[38;5;124m'\u001b[39m: reconstruct_python_object,\n\u001b[1;32m    388\u001b[0m                 \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mUseAlpsNotationForComplex\u001b[39m\u001b[38;5;124m'\u001b[39m  : \u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[1;32m    389\u001b[0m                 }\n\u001b[1;32m    390\u001b[0m HDFArchiveGroup\u001b[38;5;241m.\u001b[39m\u001b[38;5;21m__init__\u001b[39m(\u001b[38;5;28mself\u001b[39m,\u001b[38;5;28mself\u001b[39m,\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[0;32m~/opt/triqs/lib/python3.9/site-packages/h5/archive_basic_layer.py:46\u001b[0m, in \u001b[0;36mHDFArchiveGroupBasicLayer._init_root\u001b[0;34m(self, descriptor, open_flag)\u001b[0m\n\u001b[1;32m     44\u001b[0m \u001b[38;5;28;01massert\u001b[39;00m(\u001b[38;5;28misinstance\u001b[39m(descriptor, \u001b[38;5;28mstr\u001b[39m))\n\u001b[1;32m     45\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m :\n\u001b[0;32m---> 46\u001b[0m     fich \u001b[38;5;241m=\u001b[39m \u001b[43mh5\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mFile\u001b[49m\u001b[43m(\u001b[49m\u001b[43mdescriptor\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mopen_flag\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     47\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m :\n\u001b[1;32m     48\u001b[0m     \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mCannot open the HDF file \u001b[39m\u001b[38;5;132;01m%s\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;241m%\u001b[39mdescriptor)\n",
      "\u001b[0;31mRuntimeError\u001b[0m: .. Error occurred at Wed Jun 22 18:10:53 2022\n\n.. Error .. in calling C++ overload of constructor :\n.. (no C++ name)(std::string name, char mode) -> \n.. C++ error was : \nHDF5 : cannot openfile : b10-U3.6-hubbardI/lco_wannier.h5"
     ]
    }
   ],
   "source": [
    "with HDFArchive('b10-U3.6-hubbardI/lco_wannier.h5','r') as h5:\n",
    "    print(h5['DMFT_results']['last_iter'])\n",
    "    # the next two lines load all directly measured observables and the convergence metrics per iteration\n",
    "    obs = h5['DMFT_results/observables']\n",
    "    conv_obs = h5['DMFT_results/convergence_obs']\n",
    "    # The next lines load the last iteration impurity Green function and self-energies\n",
    "    Sigma_real_freq_hI = h5['DMFT_results/last_iter/Sigma_Refreq_0']\n",
    "    G_atomic_w = h5['DMFT_results/last_iter/Gimp_Refreq_0']\n",
    "    G_atomic_tau = h5['DMFT_results/last_iter/Gimp_time_0']\n",
    "    # last, the chemical potential and double counting potential\n",
    "    mu_hI = h5['DMFT_results']['last_iter']['chemical_potential_post']\n",
    "    dc_hI = h5['DMFT_results']['last_iter']['DC_pot']"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c1eb3527-de02-4742-b17d-7a915f55779f",
   "metadata": {},
   "source": [
    "We can now directly load the real frequency self-energy as `Sigma_real_freq_hI`, since the ED solvers can calculate the impurity Green function directly on real frequency axis via the Lehman spectral representation, and solve the Dyson equation on the real axis. "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8e30cfe3-7fa7-4d6d-9fe9-c81763a2159d",
   "metadata": {},
   "source": [
    "<i class=\"fa fa-gear fa-2x\" style=\"color: #186391\"></i>&nbsp; compare the convergence with results from cthyb using the code fragments of the first notebook"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "52b76fd7-25d0-4768-b2b8-92e9ca8055c0",
   "metadata": {},
   "source": [
    "<i class=\"fa fa-gear fa-2x\" style=\"color: #186391\"></i>&nbsp; compare the self-energy with the analytically continued self-energies for the metallic and the insulating cthyb results. Compare the shapes."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "df05bc32-38ce-4efd-bdcf-c589ce23e4c9",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-22T22:10:53.233839Z",
     "iopub.status.busy": "2022-06-22T22:10:53.233605Z",
     "iopub.status.idle": "2022-06-22T22:10:53.265392Z",
     "shell.execute_reply": "2022-06-22T22:10:53.264449Z"
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Cannot open the HDF file b10-U3.6/lco_wannier.h5\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "HDF5-DIAG: Error detected in HDF5 (1.12.2) thread 0:\n",
      "  #000: H5F.c line 620 in H5Fopen(): unable to open file\n",
      "    major: File accessibility\n",
      "    minor: Unable to open file\n",
      "  #001: H5VLcallback.c line 3502 in H5VL_file_open(): failed to iterate over available VOL connector plugins\n",
      "    major: Virtual Object Layer\n",
      "    minor: Iteration failed\n",
      "  #002: H5PLpath.c line 579 in H5PL__path_table_iterate(): can't iterate over plugins in plugin path '(null)'\n",
      "    major: Plugin for dynamically loaded library\n",
      "    minor: Iteration failed\n",
      "  #003: H5PLpath.c line 620 in H5PL__path_table_iterate_process_path(): can't open directory: /usr/local/hdf5/lib/plugin\n",
      "    major: Plugin for dynamically loaded library\n",
      "    minor: Can't open directory or file\n",
      "  #004: H5VLcallback.c line 3351 in H5VL__file_open(): open failed\n",
      "    major: Virtual Object Layer\n",
      "    minor: Can't open object\n",
      "  #005: H5VLnative_file.c line 97 in H5VL__native_file_open(): unable to open file\n",
      "    major: File accessibility\n",
      "    minor: Unable to open file\n",
      "  #006: H5Fint.c line 1835 in H5F_open(): unable to open file: name = 'b10-U3.6/lco_wannier.h5', tent_flags = 0\n",
      "    major: File accessibility\n",
      "    minor: Unable to open file\n",
      "  #007: H5FD.c line 723 in H5FD_open(): open failed\n",
      "    major: Virtual File Layer\n",
      "    minor: Unable to initialize object\n",
      "  #008: H5FDsec2.c line 355 in H5FD__sec2_open(): unable to open file: name = 'b10-U3.6/lco_wannier.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0\n",
      "    major: File accessibility\n",
      "    minor: Unable to open file\n"
     ]
    },
    {
     "ename": "RuntimeError",
     "evalue": ".. Error occurred at Wed Jun 22 18:10:53 2022\n\n.. Error .. in calling C++ overload of constructor :\n.. (no C++ name)(std::string name, char mode) -> \n.. C++ error was : \nHDF5 : cannot openfile : b10-U3.6/lco_wannier.h5",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mRuntimeError\u001b[0m                              Traceback (most recent call last)",
      "Input \u001b[0;32mIn [5]\u001b[0m, in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[43mHDFArchive\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mb10-U3.6/lco_wannier.h5\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mr\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m)\u001b[49m \u001b[38;5;28;01mas\u001b[39;00m h5:\n\u001b[1;32m      2\u001b[0m     Sigma_real_freq_cthyb \u001b[38;5;241m=\u001b[39m h5[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mDMFT_results/last_iter\u001b[39m\u001b[38;5;124m'\u001b[39m][\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mSigma_maxent_0\u001b[39m\u001b[38;5;124m'\u001b[39m]\n\u001b[1;32m      3\u001b[0m     mu \u001b[38;5;241m=\u001b[39m h5[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mDMFT_results\u001b[39m\u001b[38;5;124m'\u001b[39m][\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlast_iter\u001b[39m\u001b[38;5;124m'\u001b[39m][\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mchemical_potential_post\u001b[39m\u001b[38;5;124m'\u001b[39m]\n",
      "File \u001b[0;32m~/opt/triqs/lib/python3.9/site-packages/h5/archive.py:383\u001b[0m, in \u001b[0;36mHDFArchive.__init__\u001b[0;34m(self, descriptor, open_flag, key_as_string_only, reconstruct_python_object, init)\u001b[0m\n\u001b[1;32m    380\u001b[0m         \u001b[38;5;28;01mtry\u001b[39;00m: os\u001b[38;5;241m.\u001b[39mremove(os\u001b[38;5;241m.\u001b[39mpath\u001b[38;5;241m.\u001b[39mabspath(LocalFileName))\n\u001b[1;32m    381\u001b[0m         \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mOSError\u001b[39;00m: \u001b[38;5;28;01mpass\u001b[39;00m\n\u001b[0;32m--> 383\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_init_root\u001b[49m\u001b[43m(\u001b[49m\u001b[43mLocalFileName\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mopen_flag\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    385\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39moptions \u001b[38;5;241m=\u001b[39m {\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mkey_as_string_only\u001b[39m\u001b[38;5;124m'\u001b[39m : key_as_string_only,\n\u001b[1;32m    386\u001b[0m                 \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdo_not_overwrite_entries\u001b[39m\u001b[38;5;124m'\u001b[39m : \u001b[38;5;28;01mFalse\u001b[39;00m,\n\u001b[1;32m    387\u001b[0m                 \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mreconstruct_python_object\u001b[39m\u001b[38;5;124m'\u001b[39m: reconstruct_python_object,\n\u001b[1;32m    388\u001b[0m                 \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mUseAlpsNotationForComplex\u001b[39m\u001b[38;5;124m'\u001b[39m  : \u001b[38;5;28;01mTrue\u001b[39;00m\n\u001b[1;32m    389\u001b[0m                 }\n\u001b[1;32m    390\u001b[0m HDFArchiveGroup\u001b[38;5;241m.\u001b[39m\u001b[38;5;21m__init__\u001b[39m(\u001b[38;5;28mself\u001b[39m,\u001b[38;5;28mself\u001b[39m,\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n",
      "File \u001b[0;32m~/opt/triqs/lib/python3.9/site-packages/h5/archive_basic_layer.py:46\u001b[0m, in \u001b[0;36mHDFArchiveGroupBasicLayer._init_root\u001b[0;34m(self, descriptor, open_flag)\u001b[0m\n\u001b[1;32m     44\u001b[0m \u001b[38;5;28;01massert\u001b[39;00m(\u001b[38;5;28misinstance\u001b[39m(descriptor, \u001b[38;5;28mstr\u001b[39m))\n\u001b[1;32m     45\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m :\n\u001b[0;32m---> 46\u001b[0m     fich \u001b[38;5;241m=\u001b[39m \u001b[43mh5\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mFile\u001b[49m\u001b[43m(\u001b[49m\u001b[43mdescriptor\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mopen_flag\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     47\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m :\n\u001b[1;32m     48\u001b[0m     \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mCannot open the HDF file \u001b[39m\u001b[38;5;132;01m%s\u001b[39;00m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;241m%\u001b[39mdescriptor)\n",
      "\u001b[0;31mRuntimeError\u001b[0m: .. Error occurred at Wed Jun 22 18:10:53 2022\n\n.. Error .. in calling C++ overload of constructor :\n.. (no C++ name)(std::string name, char mode) -> \n.. C++ error was : \nHDF5 : cannot openfile : b10-U3.6/lco_wannier.h5"
     ]
    }
   ],
   "source": [
    "with HDFArchive('b10-U3.6/lco_wannier.h5','r') as h5:\n",
    "    Sigma_real_freq_cthyb = h5['DMFT_results/last_iter']['Sigma_maxent_0']\n",
    "    mu = h5['DMFT_results']['last_iter']['chemical_potential_post']\n",
    "    dc = h5['DMFT_results']['last_iter']['DC_pot']\n",
    "    \n",
    "# replace XXX with your U value   \n",
    "with HDFArchive('b10-XXXX/lco_wannier.h5','r') as h5:\n",
    "    Sigma_real_freq_cthyb_ins = h5['DMFT_results/last_iter']['Sigma_maxent_0']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "944b74e2-ebef-46f6-a877-2a9ea0a098b4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-22T22:10:53.268727Z",
     "iopub.status.busy": "2022-06-22T22:10:53.268337Z",
     "iopub.status.idle": "2022-06-22T22:10:53.487367Z",
     "shell.execute_reply": "2022-06-22T22:10:53.486605Z"
    }
   },
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'Sigma_real_freq_cthyb' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Input \u001b[0;32mIn [6]\u001b[0m, in \u001b[0;36m<cell line: 5>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m fig, ax \u001b[38;5;241m=\u001b[39m plt\u001b[38;5;241m.\u001b[39msubplots(\u001b[38;5;241m1\u001b[39m,\u001b[38;5;241m2\u001b[39m, sharex\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m, dpi\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m150\u001b[39m, figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m10\u001b[39m,\u001b[38;5;241m4\u001b[39m))\n\u001b[1;32m      3\u001b[0m \u001b[38;5;66;03m# plot real part of the self-energy and subtract constant offset at 0.0 (Hartree shift)\u001b[39;00m\n\u001b[1;32m      4\u001b[0m \u001b[38;5;66;03m# Sigma_real_freq['up_0'](0.0) evaluates the self-energy at w=0.0\u001b[39;00m\n\u001b[0;32m----> 5\u001b[0m ax[\u001b[38;5;241m0\u001b[39m]\u001b[38;5;241m.\u001b[39moplot((\u001b[43mSigma_real_freq_cthyb\u001b[49m[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mup_0\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m-\u001b[39m Sigma_real_freq_cthyb[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mup_0\u001b[39m\u001b[38;5;124m'\u001b[39m](\u001b[38;5;241m0.0\u001b[39m)[\u001b[38;5;241m0\u001b[39m,\u001b[38;5;241m0\u001b[39m])\u001b[38;5;241m.\u001b[39mreal, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m-\u001b[39m\u001b[38;5;124m'\u001b[39m, c\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mC0\u001b[39m\u001b[38;5;124m'\u001b[39m, label\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcthyb met U=3.6\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m      7\u001b[0m \u001b[38;5;66;03m# plot imaginary part of the self-energy\u001b[39;00m\n\u001b[1;32m      8\u001b[0m ax[\u001b[38;5;241m1\u001b[39m]\u001b[38;5;241m.\u001b[39moplot(\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m\u001b[38;5;241m*\u001b[39mSigma_real_freq_cthyb[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mup_0\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mimag, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124m-\u001b[39m\u001b[38;5;124m'\u001b[39m, c\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mC0\u001b[39m\u001b[38;5;124m'\u001b[39m, label\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mcthyb met  U=3.6\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "\u001b[0;31mNameError\u001b[0m: name 'Sigma_real_freq_cthyb' is not defined"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 1500x600 with 2 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, ax = plt.subplots(1,2, sharex=True, dpi=150, figsize=(10,4))\n",
    "\n",
    "# plot real part of the self-energy and subtract constant offset at 0.0 (Hartree shift)\n",
    "# Sigma_real_freq['up_0'](0.0) evaluates the self-energy at w=0.0\n",
    "ax[0].oplot((Sigma_real_freq_cthyb['up_0'] - Sigma_real_freq_cthyb['up_0'](0.0)[0,0]).real, '-', c='C0', label='cthyb met U=3.6')\n",
    "\n",
    "# plot imaginary part of the self-energy\n",
    "ax[1].oplot(-1*Sigma_real_freq_cthyb['up_0'].imag, '-', c='C0', label='cthyb met  U=3.6')\n",
    "\n",
    "ax[0].set_ylabel(r\"Re $\\Sigma (\\omega)$ (eV)\")\n",
    "ax[1].set_ylabel(r\"-Im $\\Sigma (\\omega)$ (eV)\")\n",
    "ax[0].set_ylim(-10,10)\n",
    "ax[1].set_ylim(0,10)\n",
    "ax[-1].set_xlim(-2.5,2.5)\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "76cc507d-7d89-4109-9e00-7c60663b6310",
   "metadata": {},
   "source": [
    "Now we can plot and compare the k-dependent spectral function:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "eae46929-9075-4d92-8e1c-bdfe33cd9825",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-22T22:10:53.490811Z",
     "iopub.status.busy": "2022-06-22T22:10:53.490560Z",
     "iopub.status.idle": "2022-06-22T22:10:53.494004Z",
     "shell.execute_reply": "2022-06-22T22:10:53.493240Z"
    }
   },
   "outputs": [],
   "source": [
    "try:\n",
    "    dc_hI[0]['down_0'] = dc_hI[0].pop('down')\n",
    "    dc_hI[0]['up_0'] = dc_hI[0].pop('up')\n",
    "except: \n",
    "    pass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "e8ddbe62-552c-4d86-a24c-6c7465323dbd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-22T22:10:53.497018Z",
     "iopub.status.busy": "2022-06-22T22:10:53.496787Z",
     "iopub.status.idle": "2022-06-22T22:10:53.520728Z",
     "shell.execute_reply": "2022-06-22T22:10:53.519241Z"
    }
   },
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'dc_hI' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Input \u001b[0;32mIn [8]\u001b[0m, in \u001b[0;36m<cell line: 3>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;66;03m# we have to specify the mesh of the spectral function and pass a new keywargs object sigma_dict\u001b[39;00m\n\u001b[1;32m      2\u001b[0m w_mesh \u001b[38;5;241m=\u001b[39m {\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mwindow\u001b[39m\u001b[38;5;124m'\u001b[39m: [\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m4.0\u001b[39m, \u001b[38;5;241m4.0\u001b[39m], \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mn_w\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;28mint\u001b[39m(\u001b[38;5;241m501\u001b[39m)}\n\u001b[1;32m      3\u001b[0m sigma_dict \u001b[38;5;241m=\u001b[39m {\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdmft_path\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mb10-U3.6-hubbardI/lco_wannier.h5\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mit\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlast_iter\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124morbital_order_dmft\u001b[39m\u001b[38;5;124m'\u001b[39m: [\u001b[38;5;241m0\u001b[39m], \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mspin\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mup_0\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124meta\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;241m0.1\u001b[39m,\n\u001b[0;32m----> 4\u001b[0m               \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mblock\u001b[39m\u001b[38;5;124m'\u001b[39m : \u001b[38;5;241m0\u001b[39m ,\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mw_mesh\u001b[39m\u001b[38;5;124m'\u001b[39m: w_mesh, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlinearize\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[38;5;28;01mFalse\u001b[39;00m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdc\u001b[39m\u001b[38;5;124m'\u001b[39m: \u001b[43mdc_hI\u001b[49m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mdmft_mu\u001b[39m\u001b[38;5;124m'\u001b[39m: mu_hI\u001b[38;5;241m-\u001b[39mobs[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mmu\u001b[39m\u001b[38;5;124m'\u001b[39m][\u001b[38;5;241m0\u001b[39m]}\n\u001b[1;32m      6\u001b[0m tb_bands_data, alatt_k_w_path, freq_dict, dft_mu \u001b[38;5;241m=\u001b[39m pcb\u001b[38;5;241m.\u001b[39mget_dmft_bands(orbital_order_to \u001b[38;5;241m=\u001b[39m [\u001b[38;5;241m0\u001b[39m], with_sigma\u001b[38;5;241m=\u001b[39mSigma_real_freq_hI, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mw90_dict, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mtb_bands, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39msigma_dict)\n\u001b[1;32m      8\u001b[0m fig, ax \u001b[38;5;241m=\u001b[39m plt\u001b[38;5;241m.\u001b[39msubplots(\u001b[38;5;241m1\u001b[39m,dpi\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m150\u001b[39m,figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m7\u001b[39m,\u001b[38;5;241m4\u001b[39m))\n",
      "\u001b[0;31mNameError\u001b[0m: name 'dc_hI' is not defined"
     ]
    }
   ],
   "source": [
    "# we have to specify the mesh of the spectral function and pass a new keywargs object sigma_dict\n",
    "w_mesh = {'window': [-4.0, 4.0], 'n_w': int(501)}\n",
    "sigma_dict = {'dmft_path': 'b10-U3.6-hubbardI/lco_wannier.h5', 'it': 'last_iter', 'orbital_order_dmft': [0], 'spin': 'up_0', 'eta': 0.1,\n",
    "              'block' : 0 ,'w_mesh': w_mesh, 'linearize': False, 'dc': dc_hI, 'dmft_mu': mu_hI-obs['mu'][0]}\n",
    "\n",
    "tb_bands_data, alatt_k_w_path, freq_dict, dft_mu = pcb.get_dmft_bands(orbital_order_to = [0], with_sigma=Sigma_real_freq_hI, **w90_dict, **tb_bands, **sigma_dict)\n",
    "\n",
    "fig, ax = plt.subplots(1,dpi=150,figsize=(7,4))\n",
    "pcb.plot_bands(fig, ax, alatt_k_w_path, tb_bands_data, freq_dict, n_orb=w90_dict['n_orb'], dft_mu=0.0, tb=True, alatt=True, **plot_dict)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2dadf011-fdee-41f9-b3d7-4e5bbab673f6",
   "metadata": {},
   "source": [
    "<i class=\"fa fa-gear fa-2x\" style=\"color: #186391\"></i>&nbsp; calculate / plot once again the k-integrated spectral function for hubbardI and compare with your previous cthyb result. Plot also the atomic Green's function of the hubbardI solver `G_atomic_w`, which is already on the real frequency axis. Try to answer the following questions:\n",
    "1) Why do the spectra of the atomic Green's function and the k-integrated lattice Green's function differ?\n",
    "2) Which features of the spectral function are captured correctly for the same U value?\n",
    "3) For which kind of systems does the hubbardI approximation deliver reasonable results?\n",
    "\n",
    "Tip: When summing the lattice Green's functions for the hubbardI self-energy you have to introduce an extra broadening. Add something like `0.4j`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "23cf676e-58cf-44ec-b39a-0d7c413eb867",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2022-06-22T22:10:53.523987Z",
     "iopub.status.busy": "2022-06-22T22:10:53.523722Z",
     "iopub.status.idle": "2022-06-22T22:10:53.647103Z",
     "shell.execute_reply": "2022-06-22T22:10:53.646516Z"
    }
   },
   "outputs": [
    {
     "ename": "NameError",
     "evalue": "name 'G_loc_w_cthyb' is not defined",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)",
      "Input \u001b[0;32mIn [9]\u001b[0m, in \u001b[0;36m<cell line: 3>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m fig, ax \u001b[38;5;241m=\u001b[39m plt\u001b[38;5;241m.\u001b[39msubplots(\u001b[38;5;241m1\u001b[39m,dpi\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m150\u001b[39m,figsize\u001b[38;5;241m=\u001b[39m(\u001b[38;5;241m6\u001b[39m,\u001b[38;5;241m3\u001b[39m))\n\u001b[0;32m----> 3\u001b[0m ax\u001b[38;5;241m.\u001b[39moplot(\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m\u001b[38;5;241m/\u001b[39mnp\u001b[38;5;241m.\u001b[39mpi\u001b[38;5;241m*\u001b[39m\u001b[43mG_loc_w_cthyb\u001b[49m\u001b[38;5;241m.\u001b[39mimag, label\u001b[38;5;241m=\u001b[39m\u001b[38;5;124mr\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mA($\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124momega$) cthyb\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m      5\u001b[0m ax\u001b[38;5;241m.\u001b[39moplot(\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m\u001b[38;5;241m/\u001b[39mnp\u001b[38;5;241m.\u001b[39mpi\u001b[38;5;241m*\u001b[39mG_atomic_w[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mup_0\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mimag, label\u001b[38;5;241m=\u001b[39m\u001b[38;5;124mr\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mA($\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124momega$) atomic\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m      7\u001b[0m ax\u001b[38;5;241m.\u001b[39moplot(\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m\u001b[38;5;241m/\u001b[39mnp\u001b[38;5;241m.\u001b[39mpi\u001b[38;5;241m*\u001b[39mG_loc_w\u001b[38;5;241m.\u001b[39mimag, label\u001b[38;5;241m=\u001b[39m\u001b[38;5;124mr\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mA($\u001b[39m\u001b[38;5;124m\\\u001b[39m\u001b[38;5;124momega$) loc\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "\u001b[0;31mNameError\u001b[0m: name 'G_loc_w_cthyb' is not defined"
     ]
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 900x450 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, ax = plt.subplots(1,dpi=150,figsize=(6,3))\n",
    "\n",
    "ax.oplot(-1/np.pi*G_loc_w_cthyb.imag, label=r'A($\\omega$) cthyb')\n",
    "\n",
    "ax.oplot(-1/np.pi*G_atomic_w['up_0'].imag, label=r'A($\\omega$) atomic')\n",
    "\n",
    "ax.oplot(-1/np.pi*G_loc_w.imag, label=r'A($\\omega$) loc')\n",
    "\n",
    "ax.set_ylabel(r'A($\\omega$)')\n",
    "ax.set_xlabel(r'$\\omega$')\n",
    "ax.set_xlim(-5,5)\n",
    "ax.set_ylim(0,1.1)\n",
    "ax.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0da6b552-c197-4ed0-aeb9-6240778b4640",
   "metadata": {},
   "source": [
    "## Advanced: Running a Full charge self-consistent DFT+DMFT calculation\n",
    "\n",
    "Now that you have mastered the one-shot calculation, you can repeat the calculation with full charge self-consistency and see how the solution changes. Instructions are described in the tutorial:\n",
    "[flatironinstitute.github.io/solid_dmft/tutorials/Ce2O3_csc_w90/tutorial](https://flatironinstitute.github.io/solid_dmft/tutorials/Ce2O3_csc_w90/tutorial.html)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
