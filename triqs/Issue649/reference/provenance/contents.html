<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Reproducibility, provenance. &mdash; TRIQS  documentation</title>
    
    <link rel="stylesheet" href="../../_static/triqs.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=default"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="TRIQS  documentation" href="../../contents.html" />
    <link rel="up" title="Reference" href="../../reference.html" />
    <link rel="next" title="Version compatibility" href="../../versions.html" />
    <link rel="prev" title="The class_ class" href="../cpp2py/class.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    
    <li><a href="../../install.html">Install</a></li>
    
    <li><a href="../../reference.html">Reference</a></li>
    
    <li><a href="../../tutorials.html">Tutorials</a></li>
    
    <li><a href="../../applications.html">Applications</a></li>
    
    <li><a href="../../issues.html">Issues</a></li>
    
    <li><a href="../../about.html">About TRIQS</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../../index.html">triqs</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">a Toolbox for Research on Interacting Quantum Systems</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../versions.html" title="Version compatibility"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../cpp2py/class.html" title="The class_ class"
             accesskey="P">previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../reference.html" accesskey="U">Reference</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Reproducibility, provenance.</a><ul>
<li><a class="reference internal" href="#triqs-code-version">TRIQS code version</a></li>
<li><a class="reference internal" href="#saving-the-script-in-the-data-archive">Saving the script in the data archive</a></li>
<li><a class="reference internal" href="#from-the-data-to-the-figures">From the data to the figures</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../cpp2py/class.html"
                        title="previous chapter">The class_ class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../versions.html"
                        title="next chapter">Version compatibility</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/reference/provenance/contents.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="reproducibility-provenance">
<h1>Reproducibility, provenance.<a class="headerlink" href="#reproducibility-provenance" title="Permalink to this headline">¶</a></h1>
<p>Scientific numerical calculations are ... scientific calculations.</p>
<p>Hence, like any other kind of calculations, according to the basic principles of science,
everyone should be able to reproduce them, reuse or modify them.
Therefore, the detailed instructions leading to results or figures
should be published along with them.
To achieve these goals, in practice we need to be able to do simply the following things:</p>
<ul class="simple">
<li>Store along with the data the version of the code used to produced them (or even the code itself!),
and the configuration options of this code.</li>
<li>Keep with the figures all the instructions (i.e. the script) that have produced it.</li>
<li>We want to do that <strong>easily at no cost in human time</strong>, and hence
without adding a new layer of tools (which means new things to learn,
which takes time, etc.).
Indeed this task is important but admittedly extremely boring for physicists!</li>
</ul>
<p>Fortunately, python helps solve these issues easily and efficiently.</p>
<p>TRIQS adds very little to the standard python tools here.
So this page should be viewed more as a wiki page of examples.
TRIQS does not impose any framework on you, it just provides tools
and lets you organize your work as you wish.</p>
<div class="section" id="triqs-code-version">
<h2>TRIQS code version<a class="headerlink" href="#triqs-code-version" title="Permalink to this headline">¶</a></h2>
<p>The tiny module <code class="docutils literal"><span class="pre">pytriqs.version</span></code> contains various pieces of information
configured automatically at compile time</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pytriqs.version</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">version</span>    <span class="c1"># The version of the TRIQS library</span>
<span class="n">release</span>    <span class="c1"># The release number of the library</span>
<span class="n">git_hash</span>   <span class="c1"># The git commit used at compilation</span>

<span class="c1"># publishing this information may lead to a security issue....</span>
<span class="n">show_machine_info</span><span class="p">()</span>   <span class="c1"># Hostname and login of the compilation</span>
</pre></div>
</div>
</div>
<div class="section" id="saving-the-script-in-the-data-archive">
<h2>Saving the script in the data archive<a class="headerlink" href="#saving-the-script-in-the-data-archive" title="Permalink to this headline">¶</a></h2>
<p>It is actually very simple to  save the script
(hence the parameters) along with the data,
simply by putting it in the HDFArchive, e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c1"># ... computation ...</span>
<span class="n">Results</span> <span class="o">=</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s2">&quot;solution.h5&quot;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">Results</span><span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">G</span> <span class="c1"># save the results</span>

<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">pytriqs.version</span> <span class="kn">as</span> <span class="nn">version</span>
<span class="n">Results</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">Results</span><span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">]</span>
<span class="n">log</span><span class="p">[</span><span class="s2">&quot;code_version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">release</span>
<span class="n">log</span><span class="p">[</span><span class="s2">&quot;script&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read myself !</span>
</pre></div>
</div>
<p>The script that is currently being executed will be copied into the file <cite>solution.h5</cite>, under the subgroup <cite>/log/script</cite>.</p>
<p>In a more complex situation, you may decompose your computation in several scripts, e.g.</p>
<ul class="simple">
<li>A script common.py, with some common functions, classes...</li>
<li>A little one, computation1.py for each computations.</li>
</ul>
<p>In such situation, one can simply use the <cite>inspect</cite> module of the python standard library e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">common</span>
<span class="c1"># set parameters</span>
<span class="c1"># run...</span>
<span class="c1"># save...</span>
<span class="c1"># Ok, I need to save common too !</span>
<span class="kn">import</span> <span class="nn">inspect</span><span class="o">,</span><span class="nn">sys</span><span class="o">,</span> <span class="nn">pytriqs.version</span> <span class="kn">as</span> <span class="nn">version</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">Results</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">log</span><span class="p">[</span><span class="s2">&quot;code_version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">version</span><span class="o">.</span><span class="n">release</span>
<span class="n">log</span><span class="p">[</span><span class="s2">&quot;script&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">log</span><span class="p">[</span><span class="s2">&quot;common&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getsource</span><span class="p">(</span><span class="n">common</span><span class="p">)</span> <span class="c1"># This retrieves the source of the module in a string</span>
</pre></div>
</div>
</div>
<div class="section" id="from-the-data-to-the-figures">
<h2>From the data to the figures<a class="headerlink" href="#from-the-data-to-the-figures" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">TO BE WRITTEN</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../versions.html" title="Version compatibility"
             >next</a> |</li>
        <li class="right" >
          <a href="../cpp2py/class.html" title="The class_ class"
             >previous</a> |</li>
    <li><a href="../../index.html">Home</a> &raquo;</li>

          <li class="nav-item nav-item-1"><a href="../../reference.html" >Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2017, The TRIQS collaboration.
    </div>
  </body>
</html>