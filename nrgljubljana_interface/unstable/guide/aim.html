<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Anderson impurity model (SIAM) &mdash; nrgljubljana_interface  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/triqs_favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Anderson-Holstein impurity model" href="holstein.html" />
    <link rel="prev" title="Documentation" href="../documentation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            nrgljubljana_interface
          </a>
              <div class="version">
                3.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install nrgljubljana_interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-nrgljubljana-interface-from-source">Compiling nrgljubljana_interface from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../documentation.html#examples">Examples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Anderson impurity model (SIAM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="holstein.html">Anderson-Holstein impurity model</a></li>
<li class="toctree-l3"><a class="reference internal" href="hubbard.html">DMFT for Hubbard and Hubbard-like models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#model-templates">Model templates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../templates/SIAM_QS.html">SIAM (QS)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QS.html#hamiltonian">Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QS.html#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QS.html#expectation-values">Expectation values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QS.html#structure-of-green-s-functions">Structure of Green’s functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QS.html#dynamic-susceptibilities">Dynamic susceptibilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../templates/SIAM_QSZ.html">SIAM (QSZ)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QSZ.html#hamiltonian">Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QSZ.html#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QSZ.html#expectation-values">Expectation values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QSZ.html#structure-of-green-s-functions">Structure of Green’s functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/SIAM_QSZ.html#dynamic-susceptibilities">Dynamic susceptibilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../templates/Holstein_QS.html">Holstein (QS)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../templates/Holstein_QS.html#hamiltonian">Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/Holstein_QS.html#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/Holstein_QS.html#expectation-values">Expectation values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/Holstein_QS.html#structure-of-green-s-functions">Structure of Green’s functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/Holstein_QS.html#dynamic-susceptibilities">Dynamic susceptibilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/Holstein_QS.html#additional-quantities">Additional quantities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../templates/2orb-UJ_QS.html">2orb-UJ (QS)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../templates/2orb-UJ_QS.html#hamiltonian">Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/2orb-UJ_QS.html#parameters">Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/2orb-UJ_QS.html#expectation-values">Expectation values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/2orb-UJ_QS.html#structure-of-green-s-functions">Structure of Green’s functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../templates/2orb-UJ_QS.html#dynamic-susceptibilities">Dynamic susceptibilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="defining_models.html">Generating new templates for custom models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#miscelaneous">Miscelaneous</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html">Install nrgljubljana_interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../install.html#compiling-nrgljubljana-interface-from-source">Compiling nrgljubljana_interface from source</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l5"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l5"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l5"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../parallelization.html">Parallelization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../temporary.html">Temporary files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about.html">About nrgljubljana_interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../about.html#license">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation.html#c-reference-manual">C++ reference manual</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../cpp2rst_generated/nrgljubljana_interface.html">nrgljubljana_interface</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/nrgljubljana_interface.html#type-aliases">Type aliases</a></li>
<li class="toctree-l5"><a class="reference internal" href="../cpp2rst_generated/nrgljubljana_interface.html#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../documentation.html#module-nrgljubljana_interface">Python reference manual</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.Flat"><code class="docutils literal notranslate"><span class="pre">Flat</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SemiCircular"><code class="docutils literal notranslate"><span class="pre">SemiCircular</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.Solver"><code class="docutils literal notranslate"><span class="pre">Solver</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.Solver.solve"><code class="docutils literal notranslate"><span class="pre">Solver.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore"><code class="docutils literal notranslate"><span class="pre">SolverCore</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.A_w"><code class="docutils literal notranslate"><span class="pre">SolverCore.A_w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.B_w"><code class="docutils literal notranslate"><span class="pre">SolverCore.B_w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.Delta_w"><code class="docutils literal notranslate"><span class="pre">SolverCore.Delta_w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.F_w"><code class="docutils literal notranslate"><span class="pre">SolverCore.F_w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.G_w"><code class="docutils literal notranslate"><span class="pre">SolverCore.G_w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.Sigma_w"><code class="docutils literal notranslate"><span class="pre">SolverCore.Sigma_w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.check_model_params"><code class="docutils literal notranslate"><span class="pre">SolverCore.check_model_params()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.chi_NN_w"><code class="docutils literal notranslate"><span class="pre">SolverCore.chi_NN_w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.chi_SS_w"><code class="docutils literal notranslate"><span class="pre">SolverCore.chi_SS_w</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.chi_struct"><code class="docutils literal notranslate"><span class="pre">SolverCore.chi_struct</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.create_tempdir"><code class="docutils literal notranslate"><span class="pre">SolverCore.create_tempdir()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.expv"><code class="docutils literal notranslate"><span class="pre">SolverCore.expv</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.generate_param_file"><code class="docutils literal notranslate"><span class="pre">SolverCore.generate_param_file()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.gf_struct"><code class="docutils literal notranslate"><span class="pre">SolverCore.gf_struct</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.hdf5_format"><code class="docutils literal notranslate"><span class="pre">SolverCore.hdf5_format()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.instantiate"><code class="docutils literal notranslate"><span class="pre">SolverCore.instantiate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.log_mesh"><code class="docutils literal notranslate"><span class="pre">SolverCore.log_mesh</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.nrg_params"><code class="docutils literal notranslate"><span class="pre">SolverCore.nrg_params</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.readA"><code class="docutils literal notranslate"><span class="pre">SolverCore.readA()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.readGF"><code class="docutils literal notranslate"><span class="pre">SolverCore.readGF()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.read_structure"><code class="docutils literal notranslate"><span class="pre">SolverCore.read_structure()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.readexpv"><code class="docutils literal notranslate"><span class="pre">SolverCore.readexpv()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.set_nrg_params"><code class="docutils literal notranslate"><span class="pre">SolverCore.set_nrg_params()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.set_verbosity"><code class="docutils literal notranslate"><span class="pre">SolverCore.set_verbosity()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.solve"><code class="docutils literal notranslate"><span class="pre">SolverCore.solve()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.solve_one"><code class="docutils literal notranslate"><span class="pre">SolverCore.solve_one()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../documentation.html#nrgljubljana_interface.SolverCore.tdfdm"><code class="docutils literal notranslate"><span class="pre">SolverCore.tdfdm</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-2-0">Version 3.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#general">General</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-1-0">Version 3.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id2">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#jenkins">jenkins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-0-0">Version 3.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id3">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#doc">doc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#id4">jenkins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#cmake">cmake</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#py3">py3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-2-0">Version 2.2.0</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About nrgljubljana_interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">nrgljubljana_interface</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../documentation.html">Documentation</a></li>
      <li class="breadcrumb-item active">Anderson impurity model (SIAM)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/guide/aim.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="anderson-impurity-model-siam">
<span id="aim"></span><h1>Anderson impurity model (SIAM)<a class="headerlink" href="#anderson-impurity-model-siam" title="Permalink to this heading"></a></h1>
<p>To illustrate how the NRG solver works in practice, we show the example of
one-orbital Anderson impurity embedded in a flat (Wilson) conduction bath. The
interacting part of the local Hamiltonian of this problem is simply:</p>
<div class="math notranslate nohighlight">
\[\mathcal{H}_\mathrm{int} = U n_\uparrow n_\downarrow,\]</div>
<p>and the non-interacting Green’s function is:</p>
<div class="math notranslate nohighlight">
\[G^{-1}_{0,\sigma} (\omega) = \omega - \epsilon_f - V^2 g(\omega).\]</div>
<p>In this example, there is a Coulomb interaction <span class="math notranslate nohighlight">\(U\)</span> on the impurity level,
which is at an energy <span class="math notranslate nohighlight">\(\epsilon_f\)</span>. The bath Green’s function is
<span class="math notranslate nohighlight">\(g(\omega)\)</span>, and it has a flat density of states over the interval
<span class="math notranslate nohighlight">\([-1,1]\)</span>.  Finally, <span class="math notranslate nohighlight">\(V\)</span> is the hybridization amplitude between the
impurity and the bath. Let us solve this problem with the NRG solver. Here is
the python <a class="reference download internal" download="" href="../_downloads/a5116e82d4b839b26a4877e721da5a67/aim.py"><code class="xref download docutils literal notranslate"><span class="pre">script</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nrgljubljana_interface</span> <span class="kn">import</span> <span class="n">Solver</span><span class="p">,</span> <span class="n">Flat</span>
<span class="kn">from</span> <span class="nn">h5</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Parameters</span>
<span class="n">D</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">e_f</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="o">/</span><span class="mf">2.0</span> <span class="c1"># particle-hole symmetric case</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">1e-5</span>

<span class="c1"># Set up the Solver</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;SIAM&quot;</span><span class="p">,</span> <span class="n">symtype</span> <span class="o">=</span> <span class="s2">&quot;QS&quot;</span><span class="p">,</span> <span class="n">mesh_max</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">mesh_min</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">mesh_ratio</span> <span class="o">=</span> <span class="mf">1.01</span><span class="p">)</span>

<span class="c1"># Solve Parameters</span>
<span class="n">sp</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="s2">&quot;Lambda&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;Nz&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Tmin&quot;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="s2">&quot;keep&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s2">&quot;keepenergy&quot;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s2">&quot;bandrescale&quot;</span><span class="p">:</span> <span class="mf">1.0</span> <span class="p">}</span>

<span class="c1"># Model Parameters</span>
<span class="n">mp</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;U1&quot;</span><span class="p">:</span> <span class="n">U</span><span class="p">,</span> <span class="s2">&quot;eps1&quot;</span><span class="p">:</span> <span class="n">e_f</span> <span class="p">}</span>
<span class="n">sp</span><span class="p">[</span><span class="s2">&quot;model_parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mp</span>

<span class="c1"># Initialize hybridization function</span>
<span class="n">S</span><span class="o">.</span><span class="n">Delta_w</span><span class="p">[</span><span class="s1">&#39;imp&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Flat</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>

<span class="c1"># Solve the impurity model</span>
<span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="o">**</span><span class="n">sp</span><span class="p">)</span>

<span class="c1"># Store the Result</span>
<span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s2">&quot;aim_solution.h5&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">arch</span><span class="p">:</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;A_w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">A_w</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;G_w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">G_w</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;F_w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">F_w</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;Sigma_w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Sigma_w</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;expv&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">expv</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;n&gt;=&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">expv</span><span class="p">[</span><span class="s2">&quot;n_d&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Running this script takes a few minutes and generates an
HDF5 archive file called <code class="file docutils literal notranslate"><span class="pre">aim_solution.h5</span></code>. This file contains
the impurity spectral function, Green’s function, auxiliary Green’s function,
self-energy, and expectation values of local variables, here
<span class="math notranslate nohighlight">\(\langle n \rangle\)</span> and <span class="math notranslate nohighlight">\(\langle n^2 \rangle\)</span>. Let us plot
the spectral function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">triqs.gf</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">h5</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">nrgljubljana_interface</span> <span class="kn">import</span> <span class="n">MeshReFreqPts</span>

<span class="k">def</span> <span class="nf">A_to_nparrays</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">lx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">ly</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">real</span>
    <span class="k">return</span> <span class="n">lx</span><span class="p">,</span> <span class="n">ly</span>

<span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s1">&#39;aim_solution.h5&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ar</span><span class="p">:</span>
    <span class="c1"># Expectation values</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;n&gt;=&quot;</span><span class="p">,</span><span class="n">ar</span><span class="p">[</span><span class="s1">&#39;expv&#39;</span><span class="p">][</span><span class="s1">&#39;n_d&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;n^2&gt;=&quot;</span><span class="p">,</span><span class="n">ar</span><span class="p">[</span><span class="s1">&#39;expv&#39;</span><span class="p">][</span><span class="s1">&#39;n_d^2&#39;</span><span class="p">])</span>

    <span class="c1"># Spectral function</span>
    <span class="n">A_w</span> <span class="o">=</span> <span class="n">ar</span><span class="p">[</span><span class="s1">&#39;A_w&#39;</span><span class="p">][</span><span class="s1">&#39;imp&#39;</span><span class="p">]</span>
    <span class="n">lx</span><span class="p">,</span> <span class="n">ly</span> <span class="o">=</span> <span class="n">A_to_nparrays</span><span class="p">(</span><span class="n">A_w</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>As expected, the result shows a particle-hole symmetric impurity
spectral function.</p>
<p>Let us now go through the script in some more detail:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nrgljubljana_interface</span> <span class="kn">import</span> <span class="n">Solver</span><span class="p">,</span> <span class="n">Flat</span>
<span class="kn">from</span> <span class="nn">h5</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>These lines import the classes to run the NRG solver and to store the results
in a HDF5 archive file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">D</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">e_f</span> <span class="o">=</span> <span class="o">-</span><span class="n">U</span><span class="o">/</span><span class="mf">2.0</span> <span class="c1"># particle-hole symmetric case</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">1e-5</span>
</pre></div>
</div>
<p>These lines define the impurity parameters, the (half)bandwidth <span class="math notranslate nohighlight">\(D=1\)</span>,
and the physical temperature <span class="math notranslate nohighlight">\(T\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">Solver</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;SIAM&quot;</span><span class="p">,</span> <span class="n">symtype</span> <span class="o">=</span> <span class="s2">&quot;QS&quot;</span><span class="p">,</span> <span class="n">mesh_max</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">mesh_min</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="n">mesh_ratio</span> <span class="o">=</span> <span class="mf">1.01</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we construct the Solver object. The most important parameters here
are the model name and its symmetry type, as well as the mesh parameters which
define the logarithmic discretization mesh on which all quantities (input and
output) are defined. The models are described in template files in the directory
<code class="docutils literal notranslate"><span class="pre">templates/</span></code>. The program
will automatically determine the correct block structure of hybridisation
and Green’s functions from the templates. This ensures that all quantities
within Solver are correctly initialized, and in particular that the block structure
of all Green’s function objects is consistent.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="s2">&quot;Lambda&quot;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s2">&quot;Nz&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Tmin&quot;</span><span class="p">:</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="s2">&quot;keep&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span> <span class="s2">&quot;keepenergy&quot;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s2">&quot;bandrescale&quot;</span><span class="p">:</span> <span class="mf">1.0</span> <span class="p">}</span>
</pre></div>
</div>
<p>This line defines, in addition to the physical temperature,
the key solve parameters which affect the quality of the results: the
discretization parameter <span class="math notranslate nohighlight">\(\Lambda\)</span>, the number of the interleaved
discretization meshes <span class="math notranslate nohighlight">\(N_z\)</span>, the scale <code class="docutils literal notranslate"><span class="pre">Tmin</span></code> which defines the length
of the Wilson chain (and which should be lower than the lowest physical temperature
scale in the problem, in this case lower than the Kondo temperature), and
the trucation settings which are determined by two parameters, the maximum number
of states kept <code class="docutils literal notranslate"><span class="pre">keep</span></code> and the truncation energy cutoff <code class="docutils literal notranslate"><span class="pre">keepenergy</span></code>.
We also explicitly set the NRG energy window to the interval <span class="math notranslate nohighlight">\([-1:1]\)</span>, since
the default is to use an energy window with the same extent as the
logarithmic mesh, which in this example would be <span class="math notranslate nohighlight">\([-2:2]\)</span>, i.e., larger
than the support of the hybridisation function that we actually use; this
is achieved by setting the parameter <code class="docutils literal notranslate"><span class="pre">bandrescale</span></code> (back) to 1.
All other parameters have suitable default values for our purposes.</p>
<p>Finally, we have set the model parameters. These are contained in a separate Python
dictionary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mp</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;U1&quot;</span><span class="p">:</span> <span class="n">U</span><span class="p">,</span> <span class="s2">&quot;eps1&quot;</span><span class="p">:</span> <span class="n">e_f</span> <span class="p">}</span>
<span class="n">sp</span><span class="p">[</span><span class="s2">&quot;model_parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mp</span>
</pre></div>
</div>
<p>The hybridisation function is set by the following line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">Delta_w</span><span class="p">[</span><span class="s1">&#39;imp&#39;</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Flat</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
<p>We can now call the solver…</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="o">**</span><span class="n">sp</span><span class="p">)</span>
</pre></div>
</div>
<p>… and store the results in an HDF5 archive:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">HDFArchive</span><span class="p">(</span><span class="s2">&quot;aim_solution.h5&quot;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">arch</span><span class="p">:</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;A_w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">A_w</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;G_w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">G_w</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;F_w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">F_w</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;Sigma_w&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Sigma_w</span>
    <span class="n">arch</span><span class="p">[</span><span class="s2">&quot;expv&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">expv</span>
</pre></div>
</div>
<p>The expectation values can be accessed through the Python dictionary
<code class="docutils literal notranslate"><span class="pre">S.expv</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&lt;n&gt;=&quot;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">expv</span><span class="p">[</span><span class="s2">&quot;n_d&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>A version of this example can also be found in <code class="docutils literal notranslate"><span class="pre">tutorial/1_AIM</span></code>
in the form of a Python script and a Jupyter (IPython) notebook.</p>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../documentation.html" class="btn btn-neutral float-left" title="Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="holstein.html" class="btn btn-neutral float-right" title="Anderson-Holstein impurity model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019 R. Žitko, N. Wentzell.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>