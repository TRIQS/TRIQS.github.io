<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Measurements: definitions &mdash; TRIQS Hybridization Expansion Solver  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=f7f783a0" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../_static/triqs_favicon.ico"/>
  
        <script src="../_static/jquery.js?v=8dae8fb0"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Setting the parameters" href="../guide/settingparameters.html" />
    <link rel="prev" title="QMC moves" href="moves.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >

          
          
          <a href="../index.html" class="icon icon-home">
            TRIQS Hybridization Expansion Solver
          </a>
              <div class="version">
                3.3.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Install CTHYB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#packaged-versions-of-cthyb">Packaged Versions of CTHYB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#ubuntu-debian-packages">Ubuntu Debian packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#anaconda">Anaconda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#docker">Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#compiling-cthyb-from-source">Compiling CTHYB from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../documentation.html#basic-notions">Basic notions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cthyb.html">A word on the algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="moves.html">QMC moves</a><ul>
<li class="toctree-l4"><a class="reference internal" href="moves.html#insert-one-pair-of-operators">Insert one pair of operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="moves.html#remove-one-pair-of-operators">Remove one pair of operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="moves.html#insert-two-pairs-of-operators">Insert two pairs of operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="moves.html#remove-two-pairs-of-operators">Remove two pairs of operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="moves.html#shift-one-operator">Shift one operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="moves.html#global-move-change-of-operator-indices">Global move - change of operator indices</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Measurements: definitions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#green-s-function">Green’s function</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#imaginary-time">Imaginary time</a></li>
<li class="toctree-l5"><a class="reference internal" href="#legendre-polynomial-basis">Legendre polynomial basis</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#local-susceptibility-and-other-operator-pairs">Local susceptibility and other operator pairs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#two-particle-green-s-functions">Two-particle Green’s functions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#imaginary-time-binning">Imaginary time binning</a></li>
<li class="toctree-l5"><a class="reference internal" href="#matsubara-frequency-measurements">Matsubara frequency measurements</a></li>
<li class="toctree-l5"><a class="reference internal" href="#mixed-matsubara-frequency-and-legendre-measurements">Mixed Matsubara Frequency and Legendre measurements</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#impurity-density-matrix">Impurity density matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#perturbation-order-histograms">Perturbation order histograms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#average-sign">Average sign</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#user-guide">User guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/settingparameters.html">Setting the parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/settingparameters.html#step-1-construct-the-solver-instance">Step 1 - construct the solver instance</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../guide/settingparameters.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../guide/settingparameters.html#step-2-the-hamiltonian">Step 2 - the Hamiltonian</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../guide/settingparameters.html#id1">Examples</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../guide/settingparameters.html#step-3-the-monte-carlo-parameters">Step 3 - the Monte Carlo parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/settingparameters.html#step-6-legendre-or-not">Step 6 - Legendre or not?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/settingparameters.html#step-7-prepare-the-non-interacting-green-s-function">Step 7 - prepare the non-interacting Green’s function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/settingparameters.html#step-8-we-re-ready-to-go">Step 8 - we’re ready to go!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/settingparameters.html#final-step-analyze-the-output">Final Step - analyze the output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/dmft.html">Building DMFT calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/dmft.html#plain-vanilla-dmft-the-bethe-lattice">Plain-vanilla DMFT: the Bethe lattice</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/random.html">Random number generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/static_observables_notebook.html">Measuring static observables / impurity density matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/static_observables_notebook.html#Measuring-\hat{\rho}_\mathrm{imp}-in-cthyb">Measuring <span class="math notranslate nohighlight">\(\hat{\rho}_\mathrm{imp}\)</span> in cthyb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/static_observables_notebook.html#Compute-expactation-values-of-static-observables">Compute expactation values of static observables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/static_observables_notebook.html#Measuring-moments-of-Green’s-function-and-self-energy">Measuring moments of Green’s function and self-energy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/static_observables_notebook.html#Evaluation-of-the-impurity-interaction-energy">Evaluation of the impurity interaction energy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/multiplet_analysis_notebook.html">Multiplet analysis &amp; particle number histograms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/multiplet_analysis_notebook.html#Analysis-of-results">Analysis of results</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../guide/multiplet_analysis_notebook.html#plot-particle-number-histogram">plot particle number histogram</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../guide/multiplet_analysis_notebook.html#More-complex-example">More complex example</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/dynamic_susceptibility_notebook.html">Dynamical spin-spin susceptibility <span class="math notranslate nohighlight">\(\chi_{S_z S_z}(\tau)\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/perturbation_order_notebook.html">Perturbation order histograms</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/perturbation_order_notebook.html#Plotting-perturbation-order-histograms">Plotting perturbation order histograms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/CRM_Dyson_solver.html">Tail fitting via the CRM Dyson solver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/CRM_Dyson_solver.html#Setup">Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/CRM_Dyson_solver.html#Using-the-Constrained-Residual-Minimization-Dyson-solver">Using the Constrained Residual Minimization Dyson solver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../guide/aim.html">The Anderson impurity model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/slater_five_band.html">Multiorbital impurity model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guide/cthyb_convergence_tests.html">Convergence test of CTHYB solver parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/cthyb_convergence_tests.html#Overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cthyb_convergence_tests.html#1.-length_cycle">1. length_cycle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cthyb_convergence_tests.html#2.-n_warmup_cycles">2. n_warmup_cycles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cthyb_convergence_tests.html#3.-n_cycles">3. n_cycles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cthyb_convergence_tests.html#4.-n_iw">4. n_iw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cthyb_convergence_tests.html#5.-n_l">5. n_l</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/cthyb_convergence_tests.html#6.-n_tau">6. n_tau</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../guide/high_freq_moments.html">High Frequency Moments of the Green’s Functions and Self-energy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../guide/high_freq_moments.html#Derivation">Derivation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../guide/high_freq_moments.html#Implentation-in-TRIQS/cthyb">Implentation in TRIQS/cthyb</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#reference-manual">Reference manual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../_ref/triqs_cthyb.multiplet_tools.html">triqs_cthyb.multiplet_tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.multiplet_tools.multiplet_analysis.html">triqs_cthyb.multiplet_tools.multiplet_analysis</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.multiplet_tools.multiplet_analysis.html#triqs_cthyb.multiplet_tools.multiplet_analysis"><code class="docutils literal notranslate"><span class="pre">multiplet_analysis()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_ref/triqs_cthyb.solver.html">triqs_cthyb.solver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.html">triqs_cthyb.solver.Solver</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.html#triqs_cthyb.solver.Solver"><code class="docutils literal notranslate"><span class="pre">Solver</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.__init__.html">triqs_cthyb.solver.Solver.__init__</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.solve.html">triqs_cthyb.solver.Solver.solve</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.Delta_infty.html">triqs_cthyb.solver.Solver.Delta_infty</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.Delta_tau.html">triqs_cthyb.solver.Solver.Delta_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G0_iw.html">triqs_cthyb.solver.Solver.G0_iw</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G2_iw.html">triqs_cthyb.solver.Solver.G2_iw</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G2_iw_nfft.html">triqs_cthyb.solver.Solver.G2_iw_nfft</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G2_iw_ph.html">triqs_cthyb.solver.Solver.G2_iw_ph</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G2_iw_ph_nfft.html">triqs_cthyb.solver.Solver.G2_iw_ph_nfft</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G2_iw_pp.html">triqs_cthyb.solver.Solver.G2_iw_pp</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G2_iw_pp_nfft.html">triqs_cthyb.solver.Solver.G2_iw_pp_nfft</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G2_iwll_ph.html">triqs_cthyb.solver.Solver.G2_iwll_ph</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G2_iwll_pp.html">triqs_cthyb.solver.Solver.G2_iwll_pp</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G2_tau.html">triqs_cthyb.solver.Solver.G2_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G_l.html">triqs_cthyb.solver.Solver.G_l</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G_tau.html">triqs_cthyb.solver.Solver.G_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.G_tau_accum.html">triqs_cthyb.solver.Solver.G_tau_accum</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.O_tau.html">triqs_cthyb.solver.Solver.O_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.asymmetry_G_tau.html">triqs_cthyb.solver.Solver.asymmetry_G_tau</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.auto_corr_time.html">triqs_cthyb.solver.Solver.auto_corr_time</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.average_order.html">triqs_cthyb.solver.Solver.average_order</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.average_sign.html">triqs_cthyb.solver.Solver.average_sign</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.constr_parameters.html">triqs_cthyb.solver.Solver.constr_parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.density_matrix.html">triqs_cthyb.solver.Solver.density_matrix</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.h_loc.html">triqs_cthyb.solver.Solver.h_loc</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.h_loc0.html">triqs_cthyb.solver.Solver.h_loc0</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.h_loc_diagonalization.html">triqs_cthyb.solver.Solver.h_loc_diagonalization</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.hybridisation_is_complex.html">triqs_cthyb.solver.Solver.hybridisation_is_complex</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.last_constr_parameters.html">triqs_cthyb.solver.Solver.last_constr_parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.last_solve_parameters.html">triqs_cthyb.solver.Solver.last_solve_parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.local_hamiltonian_is_complex.html">triqs_cthyb.solver.Solver.local_hamiltonian_is_complex</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.performance_analysis.html">triqs_cthyb.solver.Solver.performance_analysis</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.perturbation_order.html">triqs_cthyb.solver.Solver.perturbation_order</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.perturbation_order_total.html">triqs_cthyb.solver.Solver.perturbation_order_total</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.solve_parameters.html">triqs_cthyb.solver.Solver.solve_parameters</a></li>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.solve_status.html">triqs_cthyb.solver.Solver.solve_status</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_ref/triqs_cthyb.tail_fit.html">triqs_cthyb.tail_fit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.tail_fit.green_high_frequency_moments.html">triqs_cthyb.tail_fit.green_high_frequency_moments</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.tail_fit.green_high_frequency_moments.html#triqs_cthyb.tail_fit.green_high_frequency_moments"><code class="docutils literal notranslate"><span class="pre">green_high_frequency_moments()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.tail_fit.sigma_high_frequency_moments.html">triqs_cthyb.tail_fit.sigma_high_frequency_moments</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.tail_fit.sigma_high_frequency_moments.html#triqs_cthyb.tail_fit.sigma_high_frequency_moments"><code class="docutils literal notranslate"><span class="pre">sigma_high_frequency_moments()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.tail_fit.tail_fit.html">triqs_cthyb.tail_fit.tail_fit</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.tail_fit.tail_fit.html#triqs_cthyb.tail_fit.tail_fit"><code class="docutils literal notranslate"><span class="pre">tail_fit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_ref/triqs_cthyb.util.html">triqs_cthyb.util</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.util.block_size_from_gf_struct.html">triqs_cthyb.util.block_size_from_gf_struct</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.util.block_size_from_gf_struct.html#triqs_cthyb.util.block_size_from_gf_struct"><code class="docutils literal notranslate"><span class="pre">block_size_from_gf_struct()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.util.estimate_nfft_buf_size.html">triqs_cthyb.util.estimate_nfft_buf_size</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.util.estimate_nfft_buf_size.html#triqs_cthyb.util.estimate_nfft_buf_size"><code class="docutils literal notranslate"><span class="pre">estimate_nfft_buf_size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.util.orbital_occupations.html">triqs_cthyb.util.orbital_occupations</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../_ref/triqs_cthyb.util.orbital_occupations.html#triqs_cthyb.util.orbital_occupations"><code class="docutils literal notranslate"><span class="pre">orbital_occupations()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.solve_parameters.html">triqs_cthyb.solver.Solver.solve_parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.solve_parameters.html#triqs_cthyb.solver.Solver.solve_parameters"><code class="docutils literal notranslate"><span class="pre">Solver.solve_parameters</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.constr_parameters.html">triqs_cthyb.solver.Solver.constr_parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../_ref/triqs_cthyb.solver.Solver.constr_parameters.html#triqs_cthyb.solver.Solver.constr_parameters"><code class="docutils literal notranslate"><span class="pre">Solver.constr_parameters</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../documentation.html#faqs">FAQs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../faqs.html">Frequently-asked questions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../faqs.html#q-why-is-my-code-running-so-slowly">Q: Why is my code running so slowly?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs.html#q-how-do-i-save-the-triqs-and-cthyb-hash-and-script-for-debugging-purposes">Q: How do I save the triqs and cthyb hash and script for debugging purposes?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs.html#q-why-does-my-data-look-so-noisy">Q: Why does my data look so noisy?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faqs.html#q-how-do-i-use-the-segment-picture">Q: How do I use the segment picture?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-3-0">Version 3.3.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#doc">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#jenkins">jenkins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-2-1">Version 3.2.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id2">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id3">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id4">jenkins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-2-0">Version 3.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id5">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id6">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#fix">fix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-1-1">Version 3.1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id7">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id8">Doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#numpy">Numpy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-1-0">Version 3.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#delta-interface">Delta Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id9">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id10">jenkins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id11">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#cmake">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#gh-actions">gh-actions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-3-0-0">Version 3.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#fundamental-green-function-symmetries">Fundamental Green Function Symmetries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#dependency-management">Dependency Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#other-changes">Other Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-2-1">Version 2.2.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id12">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id13">General</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-2-0">Version 2.2.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id14">cmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id15">doc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#id16">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#h5">h5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#packaging">packaging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ChangeLog.html#version-2-1-0">Version 2.1.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#contributors">Contributors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#testers">Testers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#changes-in-installation-and-cmake-files">Changes in installation and cmake files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#solver-interface">Solver Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#changes-in-behavior">Changes in behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ChangeLog.html#dependencies">Dependencies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">Authors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#citation">Citation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#license">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#disclaimer">Disclaimer</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #7E588A" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TRIQS Hybridization Expansion Solver</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../documentation.html">Documentation</a></li>
      <li class="breadcrumb-item active">Measurements: definitions</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/basicnotions/measurements.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="measurements-definitions">
<span id="measurements"></span><h1>Measurements: definitions<a class="headerlink" href="#measurements-definitions" title="Link to this heading"></a></h1>
<p>Here we list all the observables that can be measured by the solver along with their definitions.
Each measurement can be turned on or off via the corresponding <span class="xref std std-ref">solve() parameters</span>.</p>
<section id="green-s-function">
<h2>Green’s function<a class="headerlink" href="#green-s-function" title="Link to this heading"></a></h2>
<p>The single-particle Green’s function can be measured in imaginary time or the Legendre basis
(see <a class="reference external" href="http://link.aps.org/doi/10.1103/PhysRevB.84.075145" rel="noopener noreferrer" target="_blank">L. Boehnke et al., Phys. Rev. B 84, 075145 (2011)</a>).</p>
<section id="imaginary-time">
<h3>Imaginary time<a class="headerlink" href="#imaginary-time" title="Link to this heading"></a></h3>
<p>The imaginary-time Green’s function is defined as</p>
<div class="math notranslate nohighlight">
\[G^A_{ij}(\tau) = -\langle \mathcal{T}_\tau c_{Ai}(\tau)c_{Aj}^\dagger(0) \rangle,\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is a block index and <span class="math notranslate nohighlight">\(i,j\)</span> are inner indices within the block.
The block structure of <span class="math notranslate nohighlight">\(G^A_{ij}(\tau)\)</span>, i.e. valid values of the indices, is fixed by
constructor’s parameter <code class="docutils literal notranslate"><span class="pre">gf_struct</span></code>.</p>
<p>This measurement is turned on by setting <code class="docutils literal notranslate"><span class="pre">measure_G_tau</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
The result of accumulation is accessible as <code class="docutils literal notranslate"><span class="pre">G_tau</span></code> attribute of the solver object.
The number of time points on the grid is specified through constructor’s parameter <code class="docutils literal notranslate"><span class="pre">n_tau</span></code> .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The imaginary-time measurement is most efficient. The performance of the algorithm does not scale
with the number of points in the grid on which it is measured, so this number can and should be
chosen large. By Nyquist’s theorem, the Fourier transform will correctly reproduce the function
in the frequency domain on the first <span class="math notranslate nohighlight">\(N_\omega\approx N_\tau/4\pi\)</span> frequencies.</p>
</div>
</section>
<section id="legendre-polynomial-basis">
<h3>Legendre polynomial basis<a class="headerlink" href="#legendre-polynomial-basis" title="Link to this heading"></a></h3>
<p>The Legendre coefficients of the Green’s function are defined as</p>
<div class="math notranslate nohighlight">
\[G^A_{ij}(l) = \sqrt{2l+1}\int_0^\beta d\tau\, P_l[x(\tau)] G^A_{ij}(\tau),\]</div>
<p>where <span class="math notranslate nohighlight">\(x(\tau)=2\tau/\beta-1\)</span>, and <span class="math notranslate nohighlight">\(P_l(x)\)</span> are Legendre polynomials of order <span class="math notranslate nohighlight">\(l\)</span>.</p>
<p>This measurement is controlled through the switch <code class="docutils literal notranslate"><span class="pre">measure_G_l</span></code>.
The result of accumulation is accessible as <code class="docutils literal notranslate"><span class="pre">G_l</span></code> attribute of the solver object.
The number of Legendre coefficients to be measured is specified through constructor’s parameter <code class="docutils literal notranslate"><span class="pre">n_l</span></code>.</p>
</section>
</section>
<section id="local-susceptibility-and-other-operator-pairs">
<h2>Local susceptibility and other operator pairs<a class="headerlink" href="#local-susceptibility-and-other-operator-pairs" title="Link to this heading"></a></h2>
<p>Higher order response functions like local susceptibilities</p>
<div class="math notranslate nohighlight">
\[\chi_{\hat{O}_1, \hat{O}_2}(\tau) \equiv \langle \hat{O}_1(\tau) \hat{O}_2 \rangle\]</div>
<p>can be sampled (by insertion) in the trace. This approach is limited to operators <span class="math notranslate nohighlight">\(\hat{O}_1\)</span> and <span class="math notranslate nohighlight">\(\hat{O}_2\)</span> that commutes with each other and the local Hamiltonian, <span class="math notranslate nohighlight">\([\hat{O}_1, \hat{O}_2] = 0\)</span>, <span class="math notranslate nohighlight">\([\hat{O}_i, H_{loc}]=0\)</span>.</p>
<p>This measurement is controlled by the argument <code class="docutils literal notranslate"><span class="pre">measure_O_tau</span></code>. To enable the measurement pass a tuple of the operators to be sampled, e.g. <code class="docutils literal notranslate"><span class="pre">measure_O_tau</span> <span class="pre">=</span> <span class="pre">(n('up',0),</span> <span class="pre">n('do',0))</span></code> will measure the response function <span class="math notranslate nohighlight">\(\langle \hat{n}_\uparrow(\tau) \hat{n}_\downarrow \rangle\)</span>. The resulting response function is accessible as the <code class="docutils literal notranslate"><span class="pre">O_tau</span></code> attribute of the solver object. The number of operator insertions is by default taken to be the square of the perturbation order of each configuration, however, for cases with perturbation order lower than the parameter <code class="docutils literal notranslate"><span class="pre">measure_O_tau_min_ins</span></code> the number of insertions is kept fixed to this minimum value, the default value is a minimum of 10 insertions.</p>
</section>
<section id="two-particle-green-s-functions">
<h2>Two-particle Green’s functions<a class="headerlink" href="#two-particle-green-s-functions" title="Link to this heading"></a></h2>
<p>CTHYB implements several ways to measure the two-particle Green’s functions.
We define <span class="math notranslate nohighlight">\(G^{(2)}\)</span> in the imaginary time as</p>
<div class="math notranslate nohighlight">
\[G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3,\tau_4) =
\langle\mathcal{T}_\tau c^\dagger_\alpha(\tau_1) c_\beta(\tau_2) c^\dagger_\gamma(\tau_3) c_\delta(\tau_4)\rangle.\]</div>
<p>Depending on the value of the <code class="docutils literal notranslate"><span class="pre">measure_G2_block_order</span></code> parameter the combined block/inner indices
<span class="math notranslate nohighlight">\(\alpha,\beta,\gamma,\delta\)</span> are interpreted differently.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">measure_g2_block_order</span> <span class="pre">=</span> <span class="pre">'AABB'</span></code>: <span class="math notranslate nohighlight">\(\{\alpha,\beta,\gamma,\delta\} = \{(A,a),(A,b),(B,c),(B,d)\}\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">measure_g2_block_order</span> <span class="pre">=</span> <span class="pre">'ABBA'</span></code>: <span class="math notranslate nohighlight">\(\{\alpha,\beta,\gamma,\delta\} = \{(A,a),(B,b),(B,c),(A,d)\}\)</span>.</p></li>
</ul>
<p>These two combinations exhaust all the possibilities for non-vanishing contributions to <span class="math notranslate nohighlight">\(G^{(2)}\)</span>.</p>
<p>Measuring <span class="math notranslate nohighlight">\(G^{(2)}\)</span> is in general expensive, and in some cases time can be saved by skipping
particular block pairs <span class="math notranslate nohighlight">\((A,B)\)</span>. Block pairs to be measured are selected via the <code class="docutils literal notranslate"><span class="pre">measure_G2_blocks</span></code>
parameter (all possible pairs are selected by default):</p>
<p><code class="docutils literal notranslate"><span class="pre">measure_G2_blocks</span> <span class="pre">=</span> <span class="pre">set([(&quot;A1&quot;,&quot;B1&quot;),</span> <span class="pre">(&quot;A2&quot;,&quot;B2&quot;),</span> <span class="pre">...])</span></code></p>
<p>See the <a class="reference external" href="http://ediss.sub.uni-hamburg.de/volltexte/2015/7325/pdf/Dissertation.pdf" rel="noopener noreferrer" target="_blank">PhD thesis of L. Boehnke</a>
for an in-depth discussion of these measurements.</p>
<section id="imaginary-time-binning">
<h3>Imaginary time binning<a class="headerlink" href="#imaginary-time-binning" title="Link to this heading"></a></h3>
<p>The simplest measure is to bin <span class="math notranslate nohighlight">\(G^{(2)}\)</span> directly in three imaginary times, after using time-tranlsational invariance to fix <span class="math notranslate nohighlight">\(\tau_4 = 0\)</span>.</p>
<ul>
<li><p>The imaginary time binning is switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_tau</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<div class="math notranslate nohighlight">
\[G^{(2)}_{\alpha\beta\gamma\delta}( \tau_1, \tau_2, \tau_3) \equiv
G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3, 0)\]</div>
<p>Accumulation result is available via the <code class="docutils literal notranslate"><span class="pre">G2_tau</span></code> solver attribute.</p>
</li>
</ul>
<p>The number of bins in each imaginary time dimension is set by <code class="docutils literal notranslate"><span class="pre">measure_G2_n_tau</span></code>.</p>
</section>
<section id="matsubara-frequency-measurements">
<h3>Matsubara frequency measurements<a class="headerlink" href="#matsubara-frequency-measurements" title="Link to this heading"></a></h3>
<p>In Matsubara frequency space there are three different measurements:</p>
<ul>
<li><p>Three Fermionic Matsubara frequency measurement, switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iw</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)}_{\alpha\beta\gamma\delta}(\nu_1, \nu_2, \nu_3) =
\int_0^\beta d\tau_1 d\tau_2 d\tau_3 \,
e^{-i\nu_1 \tau_1 + i\nu_2 \tau_2 - i\nu_3 \tau_3}
G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3,0) \, .\]</div>
</div></blockquote>
<p>Accumulation result is available via the <code class="docutils literal notranslate"><span class="pre">G2_inu</span></code> solver attribute.</p>
</li>
<li><p>Particle-hole channel measurement,
with one Bosonic (<span class="math notranslate nohighlight">\(\omega\)</span>) and two Fermionic (<span class="math notranslate nohighlight">\(\nu, \nu'\)</span>) frequencies,
switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iw_ph</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)ph}_{\alpha\beta\gamma\delta}(\omega;\nu,\nu') =
\frac{1}{\beta}\int_0^\beta d\tau_1d\tau_2d\tau_3d\tau_4 \,
e^{-i\nu\tau_1 + i(\nu+\omega)\tau_2 - i(\nu'+\omega)\tau_3 + i\nu'\tau_4}
G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3,\tau_4) \, .\]</div>
</div></blockquote>
<p>Accumulation result is available via <code class="docutils literal notranslate"><span class="pre">G2_iw_ph</span></code> solver attribute.</p>
</li>
<li><p>Particle-particle channel measurement,
with one Bosonic (<span class="math notranslate nohighlight">\(\Omega\)</span>) and two Fermionic (<span class="math notranslate nohighlight">\(\nu, \nu'\)</span>) frequencies,
switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iw_pp</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)pp}_{\alpha\beta\gamma\delta}(\omega;\nu,\nu') =
\frac{1}{\beta}\int_0^\beta d\tau_1d\tau_2d\tau_3d\tau_4\
e^{-i\nu\tau_1 + i(\omega-\nu')\tau_2 - i(\omega-\nu)\tau_3 + i\nu'\tau_4}
G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3,\tau_4).\]</div>
</div></blockquote>
<p>Accumulation result is available via <code class="docutils literal notranslate"><span class="pre">G2_iw_pp</span></code> solver attribute.</p>
</li>
</ul>
<p>The number of Bosonic and Fermionic Matsubara frequencies are set by the <code class="docutils literal notranslate"><span class="pre">measure_G2_n_bosonic</span></code>
and <code class="docutils literal notranslate"><span class="pre">measure_G2_n_fermionic</span></code> parameters respectively.</p>
<p>All these frequency measurements use direct evaluation in frequency space, using an optimized frequency spreader that avoids the re-evaluation of exponential functions. This implementation performs well for low perturbation order and small number of sampled Matsubara frequencies.</p>
<p>As an alternative all frequency measurements are also implemented using non-equidistant fast fourier transform (NFFT) to speed up the sampling procedure. The corresponding flags and attributes are:</p>
<ul class="simple">
<li><p>(<code class="docutils literal notranslate"><span class="pre">measure_G2_iw_nfft</span></code>, <code class="docutils literal notranslate"><span class="pre">G2_iw_nfft</span></code>),</p></li>
<li><p>(<code class="docutils literal notranslate"><span class="pre">measure_G2_iw_ph_nfft</span></code>, <code class="docutils literal notranslate"><span class="pre">G2_iw_ph_nfft</span></code>), and</p></li>
<li><p>(<code class="docutils literal notranslate"><span class="pre">measure_G2_pp_nfft</span></code>, <code class="docutils literal notranslate"><span class="pre">G2_iw_ph_nfft</span></code>).</p></li>
</ul>
<p>Depending on the impurity model the NFFT buffer can be adjusted for maximum performance by setting <code class="docutils literal notranslate"><span class="pre">nfft_buf_sizes</span></code>.</p>
<p>Whether the direct frequency evaluation or NFFT performs better is problem dependent and has to be tested case by case.</p>
</section>
<section id="mixed-matsubara-frequency-and-legendre-measurements">
<h3>Mixed Matsubara Frequency and Legendre measurements<a class="headerlink" href="#mixed-matsubara-frequency-and-legendre-measurements" title="Link to this heading"></a></h3>
<ul>
<li><p>Particle-hole channel, switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iwll_ph</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)ph}_{\alpha\beta\gamma\delta}(\omega_m;\ell,\ell') \equiv \sum_{n,n'\in\mathbb{Z}}
\bar T_{2n+m+1,\ell}
G^{(2)ph}_{\alpha\beta\gamma\delta}(\omega_m;\nu_n,\nu_{n'})
\bar T^*_{2n'+m+1,\ell'}.\]</div>
<p>Accumulation result is available via <code class="docutils literal notranslate"><span class="pre">G2_iwll_ph</span></code> solver attribute.</p>
</div></blockquote>
</li>
<li><p>Particle-particle channel, switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iwll_pp</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)pp}_{\alpha\beta\gamma\delta}(\omega_m;\ell,\ell') \equiv \sum_{n,n'\in\mathbb{Z}}
\bar T_{2n+m+1,\ell}
G^{(2)pp}_{\alpha\beta\gamma\delta}(\omega_m;\nu_n,\nu_{n'})
\bar T^*_{2n'+m+1,\ell'}.\]</div>
<p>Accumulation result is available via <code class="docutils literal notranslate"><span class="pre">G2_iwll_pp</span></code> solver attribute.</p>
</div></blockquote>
</li>
</ul>
<p>Numbers of bosonic Matsubara frequencies and Legendre coefficients are set by the <code class="docutils literal notranslate"><span class="pre">measure_G2_n_iw</span></code>
and <code class="docutils literal notranslate"><span class="pre">measure_G2_n_l</span></code> parameters respectively.</p>
<p>The one Bosonic Matsubara frequency is treated using non-equidistant fast fourier tranform (NFFT) and the NFFT buffer size is set by <code class="docutils literal notranslate"><span class="pre">measure_G2_iwll_nfft_buf_size</span></code>.</p>
<p>The transformation matrices <span class="math notranslate nohighlight">\(\bar{T}_{o, \ell}\)</span> introduced above transforms from the Matsubara frequency domain to the Legendre polynomial basis:</p>
<div class="math notranslate nohighlight">
\[\bar T_{o,\ell} \equiv \frac{\sqrt{2\ell+1}}{\beta}
\int_0^\beta d\tau e^{io\pi\frac{\tau}{\beta}} P_\ell[x(\tau)] =
\sqrt{2\ell+1}i^o i^\ell j_\ell\left(\frac{o\pi}{2}\right).\]</div>
</section>
</section>
<section id="impurity-density-matrix">
<h2>Impurity density matrix<a class="headerlink" href="#impurity-density-matrix" title="Link to this heading"></a></h2>
<p>The impurity density matrix (a.k.a. reduced density matrix) is the full density matrix of the system
with the bath degrees of freedom traced out.</p>
<div class="math notranslate nohighlight">
\[\hat\rho_\mathrm{imp} = \mathrm{Tr}_\mathrm{bath}[e^{-\beta\hat H}/Z].\]</div>
<p>One can use this object to <a class="reference internal" href="../guide/static_observables_notebook.html"><span class="doc">estimate average values</span></a>
of the static (<span class="math notranslate nohighlight">\(\tau\)</span>-independent) impurity observables,</p>
<div class="math notranslate nohighlight">
\[\langle\hat O\rangle = \mathrm{Tr}_\mathrm{at}[\hat O\hat\rho_\mathrm{imp}].\]</div>
<p>This measurement is activated by setting <code class="docutils literal notranslate"><span class="pre">measure_density_matrix</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>. It also requires
enabling <code class="docutils literal notranslate"><span class="pre">use_norm_as_weight</span></code> parameter.</p>
<p>The impurity density matrix is accessible as <code class="docutils literal notranslate"><span class="pre">density_matrix</span></code> attribute of the solver object.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Presently the density matrix is treated as block-diagonal with the same block structure as
<span class="math notranslate nohighlight">\(\hat H_\mathrm{loc}\)</span>. The block-offdiagonal matrix elements are not accumulated,
so results can only be reliably used with static observables of the same block structure.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">density_matrix</span></code> attribute returns a list of matrices, one matrix per diagonal block.</p>
</div>
</section>
<section id="perturbation-order-histograms">
<h2>Perturbation order histograms<a class="headerlink" href="#perturbation-order-histograms" title="Link to this heading"></a></h2>
<p>The perturbation order within a block <span class="math notranslate nohighlight">\(A\)</span> is defined as a half of the number of
operators with the block index <span class="math notranslate nohighlight">\(A\)</span> in the dynamical trace.
The total perturbation order is similarly related to the total number of operators in the dynamical trace.</p>
<p>Statistical histograms of the block-wise, as well as total perturbation orders will be measured if
<code class="docutils literal notranslate"><span class="pre">measure_pert_order</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These two kinds of histograms are independent measurements. The total perturbation order histogram
is expressed as a convolution of the block-wise histograms solely for the non-interacting systems.</p>
</div>
<p>For each block, the corresponding partial histogram is accessible as <code class="docutils literal notranslate"><span class="pre">perturbation_order[block_name]</span></code>.
The <code class="docutils literal notranslate"><span class="pre">perturbation_order_total</span></code> attribute holds the total perturbation order histogram.</p>
</section>
<section id="average-sign">
<h2>Average sign<a class="headerlink" href="#average-sign" title="Link to this heading"></a></h2>
<p>The average sign is defined as a ratio of two Monte-Carlo averages</p>
<div class="math notranslate nohighlight">
\[\langle\mathrm{sign}\rangle = \frac
{\langle\mathrm{sign}(W)(|\mathrm{Tr}_{at}[\ldots]|/W_{at})\rangle_{MC}}
{\langle|\mathrm{Tr}_{at}[\ldots]|/W_{at}\rangle_{MC}},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathrm{sign}(W)\)</span> is the sign of the total weight of a configuration,
and <span class="math notranslate nohighlight">\(|\mathrm{Tr}_{at}[\ldots]|/W_{at}\)</span> is the atomic reweighting factor.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">use_norm_as_weight</span> <span class="pre">=</span> <span class="pre">False</span></code> (no reweighting of the atomic problem), the reweighting
factor equals 1, and our definition of the average sign coincides with the usual one for
fermionic QMC algorithms. Otherwise, the denominator ensures the correct normalization
of the observable.</p>
<p>Result of this measurement is always available as <code class="docutils literal notranslate"><span class="pre">average_sign</span></code> attribute of the solver.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="moves.html" class="btn btn-neutral float-left" title="QMC moves" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../guide/settingparameters.html" class="btn btn-neutral float-right" title="Setting the parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014-2021, Simons Foundation, P. Seth, I. Krivenko, H. Strand, M. Ferrero, O. Parcollet.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>