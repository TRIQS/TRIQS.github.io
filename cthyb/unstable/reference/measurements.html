
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Measurements: definitions &#8212; TRIQS Hybridization Expansion Solver  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/triqs.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=default"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>
    <script src="../_static/cufon-yui.js" type="text/javascript"></script>
    <script src="../_static/spaceman.cufonfonts.js" type="text/javascript"></script>
    <script type="text/javascript">
      Cufon.replace('.triqs', { fontFamily: 'spaceman', hover: true }); 
    </script>
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>

  </head><body>
<div class="pageheader">
  <ul>
    
    <li><a href="../install.html">Install</a></li>
    
    <li><a href="../documentation.html">Documentation</a></li>
    
    <li><a href="../issues.html">Issues</a></li>
    
    <li><a href="../about.html">About CTHYB</a></li>
    
  </ul>
  <div>
    <h1 style="padding:0; margin: 10px 0 0 0;"><a class="triqs" href="../index.html">cthyb</a></h1>
    <span style="font-size: 14px; margin: 0px; padding: 0px;">a generic quantum impurity solver based on the <a class="triqs" style="font-size: 12px" href="https://triqs.github.io">TRIQS</a> library</span>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

        <li class="nav-item nav-item-this"><a href="">Measurements: definitions</a></li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Measurements: definitions</a><ul>
<li><a class="reference internal" href="#green-s-function">Green’s function</a><ul>
<li><a class="reference internal" href="#imaginary-time">Imaginary time</a></li>
<li><a class="reference internal" href="#legendre-polynomial-basis">Legendre polynomial basis</a></li>
</ul>
</li>
<li><a class="reference internal" href="#local-susceptibility-and-other-operator-pairs">Local susceptibility and other operator pairs</a></li>
<li><a class="reference internal" href="#two-particle-green-s-functions">Two-particle Green’s functions</a><ul>
<li><a class="reference internal" href="#imaginary-time-binning">Imaginary time binning</a></li>
<li><a class="reference internal" href="#matsubara-frequency-measurements">Matsubara frequency measurements</a></li>
<li><a class="reference internal" href="#mixed-matsubara-frequency-and-legendre-measurements">Mixed Matsubara Frequency and Legendre measurements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#impurity-density-matrix">Impurity density matrix</a></li>
<li><a class="reference internal" href="#perturbation-order-histograms">Perturbation order histograms</a></li>
<li><a class="reference internal" href="#average-sign">Average sign</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/measurements.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="measurements-definitions">
<span id="measurements"></span><h1>Measurements: definitions<a class="headerlink" href="#measurements-definitions" title="Permalink to this headline">¶</a></h1>
<p>Here we list all the observables that can be measured by the solver along with their definitions.
Each measurement can be turned on or off via the corresponding <a class="reference internal" href="solve_parameters.html"><span class="doc">solve() parameters</span></a>.</p>
<div class="section" id="green-s-function">
<h2>Green’s function<a class="headerlink" href="#green-s-function" title="Permalink to this headline">¶</a></h2>
<p>The single-particle Green’s function can be measured in imaginary time or the Legendre basis
(see <a class="reference external" href="http://link.aps.org/doi/10.1103/PhysRevB.84.075145">L. Boehnke et al., Phys. Rev. B 84, 075145 (2011)</a>).</p>
<div class="section" id="imaginary-time">
<h3>Imaginary time<a class="headerlink" href="#imaginary-time" title="Permalink to this headline">¶</a></h3>
<p>The imaginary-time Green’s function is defined as</p>
<div class="math notranslate nohighlight">
\[G^A_{ij}(\tau) = -\langle \mathcal{T}_\tau c_{Ai}(\tau)c_{Aj}^\dagger(0) \rangle,\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is a block index and <span class="math notranslate nohighlight">\(i,j\)</span> are inner indices within the block.
The block structure of <span class="math notranslate nohighlight">\(G^A_{ij}(\tau)\)</span>, i.e. valid values of the indices, is fixed by
constructor’s parameter <code class="docutils literal notranslate"><span class="pre">gf_struct</span></code>.</p>
<p>This measurement is turned on by setting <code class="docutils literal notranslate"><span class="pre">measure_G_tau</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
The result of accumulation is accessible as <code class="docutils literal notranslate"><span class="pre">G_tau</span></code> attribute of the solver object.
The number of time points on the grid is specified through constructor’s parameter <code class="docutils literal notranslate"><span class="pre">n_tau</span></code> .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The imaginary-time measurement is most efficient. The performance of the algorithm does not scale
with the number of points in the grid on which it is measured, so this number can and should be
chosen large. By Nyquist’s theorem, the Fourier transform will correctly reproduce the function
in the frequency domain on the first <span class="math notranslate nohighlight">\(N_\omega\approx N_\tau/4\pi\)</span> frequencies.</p>
</div>
</div>
<div class="section" id="legendre-polynomial-basis">
<h3>Legendre polynomial basis<a class="headerlink" href="#legendre-polynomial-basis" title="Permalink to this headline">¶</a></h3>
<p>The Legendre coefficients of the Green’s function are defined as</p>
<div class="math notranslate nohighlight">
\[G^A_{ij}(l) = \sqrt{2l+1}\int_0^\beta d\tau\, P_l[x(\tau)] G^A_{ij}(\tau),\]</div>
<p>where <span class="math notranslate nohighlight">\(x(\tau)=2\tau/\beta-1\)</span>, and <span class="math notranslate nohighlight">\(P_l(x)\)</span> are Legendre polynomials of order <span class="math notranslate nohighlight">\(l\)</span>.</p>
<p>This measurement is controlled through the switch <code class="docutils literal notranslate"><span class="pre">measure_G_l</span></code>.
The result of accumulation is accessible as <code class="docutils literal notranslate"><span class="pre">G_l</span></code> attribute of the solver object.
The number of Legendre coefficients to be measured is specified through constructor’s parameter <code class="docutils literal notranslate"><span class="pre">n_l</span></code>.</p>
</div>
</div>
<div class="section" id="local-susceptibility-and-other-operator-pairs">
<h2>Local susceptibility and other operator pairs<a class="headerlink" href="#local-susceptibility-and-other-operator-pairs" title="Permalink to this headline">¶</a></h2>
<p>Higher order response functions like local susceptibilities</p>
<div class="math notranslate nohighlight">
\[\chi_{\hat{O}_1, \hat{O}_2}(\tau) \equiv \langle \hat{O}_1(\tau) \hat{O}_2 \rangle\]</div>
<p>can be sampled (by insertion) in the trace. This approach is limited to operators <span class="math notranslate nohighlight">\(\hat{O}_1\)</span> and <span class="math notranslate nohighlight">\(\hat{O}_2\)</span> that commutes with each other and the local Hamiltonian, <span class="math notranslate nohighlight">\([\hat{O}_1, \hat{O}_2] = 0\)</span>, <span class="math notranslate nohighlight">\([\hat{O}_i, H_{loc}]=0\)</span>.</p>
<p>This measurement is controlled by the argument <code class="docutils literal notranslate"><span class="pre">measure_O_tau</span></code>. To enable the measurement pass a tuple of the operators to be sampled, e.g. <code class="docutils literal notranslate"><span class="pre">measure_O_tau</span> <span class="pre">=</span> <span class="pre">(n('up',0),</span> <span class="pre">n('do',0))</span></code> will measure the response function <span class="math notranslate nohighlight">\(\langle \hat{n}_\uparrow(\tau) \hat{n}_\downarrow \rangle\)</span>. The resulting response function is accessible as the <code class="docutils literal notranslate"><span class="pre">O_tau</span></code> attribute of the solver object. The number of operator insertions is by default taken to be the square of the perturbation order of each configuration, however, for cases with perturbation order lower than the parameter <code class="docutils literal notranslate"><span class="pre">measure_O_tau_min_ins</span></code> the number of insertions is kept fixed to this minimum value, the default value is a minimum of 10 insertions.</p>
</div>
<div class="section" id="two-particle-green-s-functions">
<h2>Two-particle Green’s functions<a class="headerlink" href="#two-particle-green-s-functions" title="Permalink to this headline">¶</a></h2>
<p>CTHYB implements several ways to measure the two-particle Green’s functions.
We define <span class="math notranslate nohighlight">\(G^{(2)}\)</span> in the imaginary time as</p>
<div class="math notranslate nohighlight">
\[G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3,\tau_4) =
\langle\mathcal{T}_\tau c^\dagger_\alpha(\tau_1) c_\beta(\tau_2) c^\dagger_\gamma(\tau_3) c_\delta(\tau_4)\rangle.\]</div>
<p>Depending on the value of the <code class="docutils literal notranslate"><span class="pre">measure_G2_block_order</span></code> parameter the combined block/inner indices
<span class="math notranslate nohighlight">\(\alpha,\beta,\gamma,\delta\)</span> are interpreted differently.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">measure_g2_block_order</span> <span class="pre">=</span> <span class="pre">'AABB'</span></code>: <span class="math notranslate nohighlight">\(\{\alpha,\beta,\gamma,\delta\} = \{(A,a),(A,b),(B,c),(B,d)\}\)</span>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">measure_g2_block_order</span> <span class="pre">=</span> <span class="pre">'ABBA'</span></code>: <span class="math notranslate nohighlight">\(\{\alpha,\beta,\gamma,\delta\} = \{(A,a),(B,b),(B,c),(A,d)\}\)</span>.</p></li>
</ul>
<p>These two combinations exhaust all the possibilities for non-vanishing contributions to <span class="math notranslate nohighlight">\(G^{(2)}\)</span>.</p>
<p>Measuring <span class="math notranslate nohighlight">\(G^{(2)}\)</span> is in general expensive, and in some cases time can be saved by skipping
particular block pairs <span class="math notranslate nohighlight">\((A,B)\)</span>. Block pairs to be measured are selected via the <code class="docutils literal notranslate"><span class="pre">measure_G2_blocks</span></code>
parameter (all possible pairs are selected by default):</p>
<p><code class="docutils literal notranslate"><span class="pre">measure_G2_blocks</span> <span class="pre">=</span> <span class="pre">set([(&quot;A1&quot;,&quot;B1&quot;),</span> <span class="pre">(&quot;A2&quot;,&quot;B2&quot;),</span> <span class="pre">...])</span></code></p>
<p>See the <a class="reference external" href="http://ediss.sub.uni-hamburg.de/volltexte/2015/7325/pdf/Dissertation.pdf">PhD thesis of L. Boehnke</a>
for an in-depth discussion of these measurements.</p>
<div class="section" id="imaginary-time-binning">
<h3>Imaginary time binning<a class="headerlink" href="#imaginary-time-binning" title="Permalink to this headline">¶</a></h3>
<p>The simplest measure is to bin <span class="math notranslate nohighlight">\(G^{(2)}\)</span> directly in three imaginary times, after using time-tranlsational invariance to fix <span class="math notranslate nohighlight">\(\tau_4 = 0\)</span>.</p>
<ul>
<li><p>The imaginary time binning is switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_tau</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<div class="math notranslate nohighlight">
\[G^{(2)}_{\alpha\beta\gamma\delta}( \tau_1, \tau_2, \tau_3) \equiv
G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3, 0)\]</div>
<p>Accumulation result is available via the <code class="docutils literal notranslate"><span class="pre">G2_tau</span></code> solver attribute.</p>
</li>
</ul>
<p>The number of bins in each imaginary time dimension is set by <code class="docutils literal notranslate"><span class="pre">measure_G2_n_tau</span></code>.</p>
</div>
<div class="section" id="matsubara-frequency-measurements">
<h3>Matsubara frequency measurements<a class="headerlink" href="#matsubara-frequency-measurements" title="Permalink to this headline">¶</a></h3>
<p>In Matsubara frequency space there are three different measurements:</p>
<ul>
<li><p>Three Fermionic Matsubara frequency measurement, switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iw</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)}_{\alpha\beta\gamma\delta}(\nu_1, \nu_2, \nu_3) =
\int_0^\beta d\tau_1 d\tau_2 d\tau_3 \,
e^{-i\nu_1 \tau_1 + i\nu_2 \tau_2 - i\nu_3 \tau_3}
G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3,0) \, .\]</div>
</div></blockquote>
<p>Accumulation result is available via the <code class="docutils literal notranslate"><span class="pre">G2_inu</span></code> solver attribute.</p>
</li>
<li><p>Particle-hole channel measurement,
with one Bosonic (<span class="math notranslate nohighlight">\(\omega\)</span>) and two Fermionic (<span class="math notranslate nohighlight">\(\nu, \nu'\)</span>) frequencies,
switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iw_ph</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)ph}_{\alpha\beta\gamma\delta}(\omega;\nu,\nu') =
\frac{1}{\beta}\int_0^\beta d\tau_1d\tau_2d\tau_3d\tau_4 \,
e^{-i\nu\tau_1 + i(\nu+\omega)\tau_2 - i(\nu'+\omega)\tau_3 + i\nu'\tau_4}
G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3,\tau_4) \, .\]</div>
</div></blockquote>
<p>Accumulation result is available via <code class="docutils literal notranslate"><span class="pre">G2_iw_ph</span></code> solver attribute.</p>
</li>
<li><p>Particle-particle channel measurement,
with one Bosonic (<span class="math notranslate nohighlight">\(\Omega\)</span>) and two Fermionic (<span class="math notranslate nohighlight">\(\nu, \nu'\)</span>) frequencies,
switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iw_pp</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)pp}_{\alpha\beta\gamma\delta}(\omega;\nu,\nu') =
\frac{1}{\beta}\int_0^\beta d\tau_1d\tau_2d\tau_3d\tau_4\
e^{-i\nu\tau_1 + i(\omega-\nu')\tau_2 - i(\omega-\nu)\tau_3 + i\nu'\tau_4}
G^{(2)}_{\alpha\beta\gamma\delta}(\tau_1,\tau_2,\tau_3,\tau_4).\]</div>
</div></blockquote>
<p>Accumulation result is available via <code class="docutils literal notranslate"><span class="pre">G2_iw_pp</span></code> solver attribute.</p>
</li>
</ul>
<p>The number of Bosonic and Fermionic Matsubara frequencies are set by the <code class="docutils literal notranslate"><span class="pre">measure_G2_n_bosonic</span></code>
and <code class="docutils literal notranslate"><span class="pre">measure_G2_n_fermionic</span></code> parameters respectively.</p>
<p>All these frequency measurements use direct evaluation in frequency space, using an optimized frequency spreader that avoids the re-evaluation of exponential functions. This implementation performs well for low perturbation order and small number of sampled Matsubara frequencies.</p>
<p>As an alternative all frequency measurements are also implemented using non-equidistant fast fourier transform (NFFT) to speed up the sampling procedure. The corresponding flags and attributes are:</p>
<ul class="simple">
<li><p>(<code class="docutils literal notranslate"><span class="pre">measure_G2_iw_nfft</span></code>, <code class="docutils literal notranslate"><span class="pre">G2_iw_nfft</span></code>),</p></li>
<li><p>(<code class="docutils literal notranslate"><span class="pre">measure_G2_iw_ph_nfft</span></code>, <code class="docutils literal notranslate"><span class="pre">G2_iw_ph_nfft</span></code>), and</p></li>
<li><p>(<code class="docutils literal notranslate"><span class="pre">measure_G2_pp_nfft</span></code>, <code class="docutils literal notranslate"><span class="pre">G2_iw_ph_nfft</span></code>).</p></li>
</ul>
<p>Depending on the impurity model the NFFT buffer can be adjusted for maximum performance by setting <code class="docutils literal notranslate"><span class="pre">nfft_buf_sizes</span></code>.</p>
<p>Whether the direct frequency evaluation or NFFT performs better is problem dependent and has to be tested case by case.</p>
</div>
<div class="section" id="mixed-matsubara-frequency-and-legendre-measurements">
<h3>Mixed Matsubara Frequency and Legendre measurements<a class="headerlink" href="#mixed-matsubara-frequency-and-legendre-measurements" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Particle-hole channel, switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iwll_ph</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)ph}_{\alpha\beta\gamma\delta}(\omega_m;\ell,\ell') \equiv \sum_{n,n'\in\mathbb{Z}}
\bar T_{2n+m+1,\ell}
G^{(2)ph}_{\alpha\beta\gamma\delta}(\omega_m;\nu_n,\nu_{n'})
\bar T^*_{2n'+m+1,\ell'}.\]</div>
<p>Accumulation result is available via <code class="docutils literal notranslate"><span class="pre">G2_iwll_ph</span></code> solver attribute.</p>
</div></blockquote>
</li>
<li><p>Particle-particle channel, switched on by <code class="docutils literal notranslate"><span class="pre">measure_G2_iwll_pp</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[G^{(2)pp}_{\alpha\beta\gamma\delta}(\omega_m;\ell,\ell') \equiv \sum_{n,n'\in\mathbb{Z}}
\bar T_{2n+m+1,\ell}
G^{(2)pp}_{\alpha\beta\gamma\delta}(\omega_m;\nu_n,\nu_{n'})
\bar T^*_{2n'+m+1,\ell'}.\]</div>
<p>Accumulation result is available via <code class="docutils literal notranslate"><span class="pre">G2_iwll_pp</span></code> solver attribute.</p>
</div></blockquote>
</li>
</ul>
<p>Numbers of bosonic Matsubara frequencies and Legendre coefficients are set by the <code class="docutils literal notranslate"><span class="pre">measure_G2_n_iw</span></code>
and <code class="docutils literal notranslate"><span class="pre">measure_G2_n_l</span></code> parameters respectively.</p>
<p>The one Bosonic Matsubara frequency is treated using non-equidistant fast fourier tranform (NFFT) and the NFFT buffer size is set by <code class="docutils literal notranslate"><span class="pre">measure_G2_iwll_nfft_buf_size</span></code>.</p>
<p>The transformation matrices <span class="math notranslate nohighlight">\(\bar{T}_{o, \ell}\)</span> introduced above transforms from the Matsubara frequency domain to the Legendre polynomial basis:</p>
<div class="math notranslate nohighlight">
\[\bar T_{o,\ell} \equiv \frac{\sqrt{2\ell+1}}{\beta}
\int_0^\beta d\tau e^{io\pi\frac{\tau}{\beta}} P_\ell[x(\tau)] =
\sqrt{2\ell+1}i^o i^\ell j_\ell\left(\frac{o\pi}{2}\right).\]</div>
</div>
</div>
<div class="section" id="impurity-density-matrix">
<h2>Impurity density matrix<a class="headerlink" href="#impurity-density-matrix" title="Permalink to this headline">¶</a></h2>
<p>The impurity density matrix (a.k.a. reduced density matrix) is the full density matrix of the system
with the bath degrees of freedom traced out.</p>
<div class="math notranslate nohighlight">
\[\hat\rho_\mathrm{imp} = \mathrm{Tr}_\mathrm{bath}[e^{-\beta\hat H}/Z].\]</div>
<p>One can use this object to <span class="xref std std-ref">estimate average values</span>
of the static (<span class="math notranslate nohighlight">\(\tau\)</span>-independent) impurity observables,</p>
<div class="math notranslate nohighlight">
\[\langle\hat O\rangle = \mathrm{Tr}_\mathrm{at}[\hat O\hat\rho_\mathrm{imp}].\]</div>
<p>This measurement is activated by setting <code class="docutils literal notranslate"><span class="pre">measure_density_matrix</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>. It also requires
enabling <code class="docutils literal notranslate"><span class="pre">use_norm_as_weight</span></code> parameter.</p>
<p>The impurity density matrix is accessible as <code class="docutils literal notranslate"><span class="pre">density_matrix</span></code> attribute of the solver object.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Presently the density matrix is treated as block-diagonal with the same block structure as
<span class="math notranslate nohighlight">\(\hat H_\mathrm{loc}\)</span>. The block-offdiagonal matrix elements are not accumulated,
so results can only be reliably used with static observables of the same block structure.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">density_matrix</span></code> attribute returns a list of matrices, one matrix per diagonal block.</p>
</div>
</div>
<div class="section" id="perturbation-order-histograms">
<h2>Perturbation order histograms<a class="headerlink" href="#perturbation-order-histograms" title="Permalink to this headline">¶</a></h2>
<p>The perturbation order within a block <span class="math notranslate nohighlight">\(A\)</span> is defined as a half of the number of
operators with the block index <span class="math notranslate nohighlight">\(A\)</span> in the dynamical trace.
The total perturbation order is similarly related to the total number of operators in the dynamical trace.</p>
<p>Statistical histograms of the block-wise, as well as total perturbation orders will be measured if
<code class="docutils literal notranslate"><span class="pre">measure_pert_order</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These two kinds of histograms are independent measurements. The total perturbation order histogram
is expressed as a convolution of the block-wise histograms solely for the non-interacting systems.</p>
</div>
<p>For each block, the corresponding partial histogram is accessible as <code class="docutils literal notranslate"><span class="pre">perturbation_order[block_name]</span></code>.
The <code class="docutils literal notranslate"><span class="pre">perturbation_order_total</span></code> attribute holds the total perturbation order histogram.</p>
</div>
<div class="section" id="average-sign">
<h2>Average sign<a class="headerlink" href="#average-sign" title="Permalink to this headline">¶</a></h2>
<p>The average sign is defined as a ratio of two Monte-Carlo averages</p>
<div class="math notranslate nohighlight">
\[\langle\mathrm{sign}\rangle = \frac
{\langle\mathrm{sign}(W)(|\mathrm{Tr}_{at}[\ldots]|/W_{at})\rangle_{MC}}
{\langle|\mathrm{Tr}_{at}[\ldots]|/W_{at}\rangle_{MC}},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathrm{sign}(W)\)</span> is the sign of the total weight of a configuration,
and <span class="math notranslate nohighlight">\(|\mathrm{Tr}_{at}[\ldots]|/W_{at}\)</span> is the atomic reweighting factor.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">use_norm_as_weight</span> <span class="pre">=</span> <span class="pre">False</span></code> (no reweighting of the atomic problem), the reweighting
factor equals 1, and our definition of the average sign coincides with the usual one for
fermionic QMC algorithms. Otherwise, the denominator ensures the correct normalization
of the observable.</p>
<p>Result of this measurement is always available as <code class="docutils literal notranslate"><span class="pre">average_sign</span></code> attribute of the solver.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
    <li><a href="../index.html">Home</a> &raquo;</li>

        <li class="nav-item nav-item-this"><a href="">Measurements: definitions</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014-2018, P. Seth, I. Krivenko, H. Strand, M. Ferrero, O. Parcollet.
    </div>
  </body>
</html>