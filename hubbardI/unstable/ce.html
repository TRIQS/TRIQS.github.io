

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>DFT+DMFT example for Ce with VASP &mdash; triqs_hubbardI - A TRIQS based hubbardI solver  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reporting issues" href="issues.html" />
    <link rel="prev" title="Single band Anderson impurity model" href="single_band.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #7E588A" >
          

          
            <a href="index.html" class="icon icon-home"> triqs_hubbardI - A TRIQS based hubbardI solver
          

          
          </a>

          
            
            
              <div class="version">
                3.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Install hubbardI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#compiling-hubbardi-from-source">Compiling hubbardI from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#installation-steps">Installation steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#version-compatibility">Version compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#custom-cmake-options">Custom CMake options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="documentation.html#c-reference-manual">C++ reference manual</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="install.html">Install hubbardI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install.html#compiling-hubbardi-from-source">Compiling hubbardI from source</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="reference internal" href="examples.html">Examples</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="single_band.html">Single band Anderson impurity model</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">DFT+DMFT example for Ce with VASP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="issues.html">Reporting issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="about.html">About hubbardI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html#python-reference-manual">Python reference manual</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="ChangeLog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ChangeLog.html#version-3-0-0">Version 3.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="ChangeLog.html#version-2-2">Version 2.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="ChangeLog.html#version-1-4">Version 1.4</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About hubbardI</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">triqs_hubbardI - A TRIQS based hubbardI solver</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="documentation.html">Documentation</a> &raquo;</li>
        
          <li><a href="examples.html">Examples</a> &raquo;</li>
        
      <li>DFT+DMFT example for Ce with VASP</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/ce.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="dft-dmft-example-for-ce-with-vasp">
<span id="ce"></span><h1>DFT+DMFT example for Ce with VASP<a class="headerlink" href="#dft-dmft-example-for-ce-with-vasp" title="Permalink to this headline">Â¶</a></h1>
<p>Here we perform a DFT+DMFT calculation for Ce in its high temperature gamma phase, as discussed, e.g., in references <a class="reference external" href="https://doi.org/10.1088/0953-8984/24/7/075604" rel="noopener noreferrer" target="_blank">[1]</a> and as a tutorial in dft_tools for charge self consistent DFT+DMFT calculations with Wien2K and the old Hubbard-I version 1.4. For simplicity, we do no charge self-consistency. We rely on DFT calculations done with VASP and the VASP interface to triqs implemented in the <a class="reference external" href="https://triqs.github.io/dft_tools/latest/index.html" rel="noopener noreferrer" target="_blank">dft_tools app</a>. For all DFT related details have a look in the detailed documentation of dft_tools and especially the VASP interface.</p>
<p>We perform a VASP calculation with input files <a class="reference internal" href="ce_input/INCAR.html#incar"><span class="std std-ref">INCAR</span></a>, <a class="reference internal" href="ce_input/KPOINTS.html#kpoints"><span class="std std-ref">KPOINTS</span></a>, <a class="reference internal" href="ce_input/POSCAR.html#poscar"><span class="std std-ref">POSCAR</span></a>, and an appropriate <cite>POTCAR</cite>. Non standard flags in the <cite>INCAR</cite> are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LORBIT</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">EMIN</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">EMAX</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">LOCPROJ</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">f</span> <span class="p">:</span> <span class="n">Pr</span> <span class="mi">1</span>
<span class="n">ISYM</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>These select a special way of calculating projectors which optimize the overlap of bands in an energy window (<cite>EMIN</cite> and <cite>EMAX</cite>) and the Ce f states. We also switch off all symmetries (<cite>ISYM=-1</cite>).</p>
<p>After executing <cite>VASP</cite> we orthonormalize the raw projectors in the VASP output using <cite>plovasp</cite> and a corresponding input file <a class="reference download internal" download="" href="_downloads/63318d5c106b07cb572ac69015bd99fe/plo.cfg"><code class="xref download docutils literal notranslate"><span class="pre">plo.cfg</span></code></a> which selects the correlated subspace and an energy window in which the orthonormalization is done:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plovasp</span> <span class="n">plo</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
<p>We convert the <cite>plovasp</cite> output to a h5 archive called <cite>ce.h5</cite> using the script <a class="reference download internal" download="" href="_downloads/5885092e0cd34e85949f20fc90b51cec/converter.py"><code class="xref download docutils literal notranslate"><span class="pre">converter.py</span></code></a> which serves as an input to triqs/dft_tools:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">converter</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>We can finally perform the dmft loop using a quite plain setup as implemented in the script <a class="reference download internal" download="" href="_downloads/98adbd417a883a1eee94e5a3be72dfda/ce.py"><code class="xref download docutils literal notranslate"><span class="pre">ce.py</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">ce</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>For each iteration we calculate the self energy on Matsubara frequencies and the real axis by the <cite>calc_gw</cite> flag:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">h_int</span> <span class="o">=</span> <span class="n">H</span><span class="p">,</span> <span class="n">calc_gw</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
</pre></div>
</div>
<p>All results are saved in the archive <cite>ce.h5</cite>. To compare with results from literature, let us calculate the local lattice green function. We use the script <a class="reference download internal" download="" href="_downloads/152a81853476ca21993ef0f6444a1035/ce_local_lattice.py"><code class="xref download docutils literal notranslate"><span class="pre">ce_local_lattice.py</span></code></a>, where we load the self energy on the real axis from the last dmft iteration and plug it into the equation for the lattice green function. The result is again saved in the archive. Letâs look at the result, which can, e.g., be generated by the script <a class="reference download internal" download="" href="_downloads/125c11a3a4d4187ba16dd5054433d8f5/plot_dos.py"><code class="xref download docutils literal notranslate"><span class="pre">plot_dos.py</span></code></a>.</p>
<a class="reference internal image-reference" href="_images/ce_spectrum.png"><img alt="_images/ce_spectrum.png" class="align-center" src="_images/ce_spectrum.png" style="width: 400px;" /></a>
<p>We can nicely see, that the non-interacting DOS shows a large density of states close to the Fermi energy and that these states mostly consist of Ce f states. Including local atomic interactions leads to a splitting of these states into multipletts, which end up far away from the Fermi energy.</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="issues.html" class="btn btn-neutral float-right" title="Reporting issues" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="single_band.html" class="btn btn-neutral float-left" title="Single band Anderson impurity model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019-2020 M. Schueler 2019-2020 The Simons Foundation, authors: N. Wentzell.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>